{"file_contents":{"src/assets/assets.d.ts":{"content":"// Auto-generated assets typings\ndeclare module 'assets' {\n  const assets: {\n    avatars: { [key: string]: any };\n    ui: { [key: string]: any };\n    mascots: { [key: string]: any };\n  };\n  export default assets;\n}\n","path":null,"size_bytes":215,"size_tokens":null},"src/components/EditAvatarModal.jsx":{"content":"import React from \"react\";\nimport assets from \"../assets/assets\";\nimport { AVAILABLE_AVATARS } from \"../utils/avatarUtils\";\n\nexport default function EditAvatarModal({ isOpen, onClose, currentAvatar, onSave }) {\n  if (!isOpen) return null;\n\n  // Only show AVAILABLE_AVATARS (excludes hidden ninja avatars)\n  const avatarList = AVAILABLE_AVATARS.map(key => assets.avatars[key]);\n\n  const handleSelect = (avatar) => {\n    // Extract avatar key from full path (e.g., \"/src/assets/avatars/avatar_robot.png.webp\" -> \"avatar_robot\")\n    const key = avatar.split(\"/\").pop().split(\".\")[0];\n    onSave(key);\n    onClose();\n  };\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        inset: 0,\n        background: \"rgba(0,0,0,0.8)\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        zIndex: 100,\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: \"#0a0a1a\",\n          border: \"1px solid rgba(255,215,0,0.2)\",\n          padding: \"20px\",\n          borderRadius: \"12px\",\n          display: \"grid\",\n          gridTemplateColumns: \"repeat(auto-fill, 80px)\",\n          gap: \"10px\",\n          maxWidth: \"90vw\",\n          maxHeight: \"80vh\",\n          overflowY: \"auto\",\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {avatarList.map((a, i) => (\n          <img\n            key={i}\n            src={a}\n            alt=\"avatar\"\n            onClick={() => handleSelect(a)}\n            style={{\n              width: \"80px\",\n              height: \"80px\",\n              borderRadius: \"50%\",\n              cursor: \"pointer\",\n              border: currentAvatar === a ? \"3px solid #FFD700\" : \"2px solid transparent\",\n              transition: \"all 0.2s\",\n            }}\n            onMouseOver={(e) => {\n              if (currentAvatar !== a) {\n                e.target.style.border = \"2px solid #FFD700\";\n              }\n            }}\n            onMouseOut={(e) => {\n              if (currentAvatar !== a) {\n                e.target.style.border = \"2px solid transparent\";\n              }\n            }}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2161,"size_tokens":null},"src/store/useUserStore.js":{"content":"// src/store/useUserStore.js\n// -------------------------------------------------------\n// Identity Store - Manages username, avatar, handle\n// Separate from progressStore which manages xp/coins/streak\n// -------------------------------------------------------\n// ARCHITECTURE (Nov 2025):\n// - Profiles are ONLY created after onboarding via createProfileAfterOnboarding()\n// - init() only CHECKS for existing profile, never creates one\n// - completeOnboarding() creates the profile if it doesn't exist\n\nimport { create } from \"zustand\";\nimport { createDailyLeaderboardSnapshot } from \"../backend/leaderboardSnapshots\";\nimport { supabase, ensureSignedIn } from \"../lib/supabaseClient\";\nimport { safeCall } from \"../lib/supabaseSafe\";\nimport { \n  checkProfileExists, \n  createProfileAfterOnboarding,\n  loadCloudProfile, \n  saveCloudProfile, \n  isProfileComplete \n} from \"../lib/userProfile\";\n\n// Default avatar for new users\nconst DEFAULT_AVATAR = \"avatar_man_lantern\";\n\n// Generate or load stable device fingerprint\nfunction loadDeviceId() {\n  let id = localStorage.getItem(\"device_id\");\n  if (!id) {\n    id = crypto.randomUUID();\n    localStorage.setItem(\"device_id\", id);\n  }\n  return id;\n}\n\n// Ensure device_id always exists\nif (!localStorage.getItem(\"device_id\")) {\n  localStorage.setItem(\"device_id\", crypto.randomUUID());\n}\n\n// Check if onboarding was completed based on localStorage flag\nfunction checkOnboardedFromStorage() {\n  try {\n    const profileStr = localStorage.getItem(\"iq_profile_complete\");\n    return profileStr === \"true\";\n  } catch (e) {}\n  return false;\n}\n\nexport const useUserStore = create((set, get) => ({\n  // Core state\n  loading: true,\n  isHydrated: false,\n  hasOnboarded: checkOnboardedFromStorage(),\n  profileReady: false,  // True when profile is fully loaded from cloud\n  \n  // Auth state\n  user: null,\n  userId: null,\n  profile: null,\n  deviceId: loadDeviceId(),\n\n  // Identity fields (synced to cloud via saveProfile)\n  name: localStorage.getItem(\"iq_name\") || \"\",\n  avatar: localStorage.getItem(\"iq_avatar\") || DEFAULT_AVATAR,\n  username: localStorage.getItem(\"iq_username\") || \"\",\n  handle: localStorage.getItem(\"iq_handle\") || \"\",\n\n  // Progress sync fields\n  xp: 0,\n  streak: 0,\n  lastStreakUpdate: null,\n  streakShield: false,\n  lastXpGain: null,\n\n  // Setters for userId and deviceId\n  setUserId: (userId) => set({ userId }),\n  setDeviceId: (deviceId) => {\n    localStorage.setItem(\"device_id\", deviceId);\n    set({ deviceId });\n  },\n\n  // --------------------------------------------------\n  // INIT ‚Üí Called from App.jsx after silentAuth\n  // Only CHECKS for profile - NEVER creates one\n  // Includes timeout to prevent app getting stuck\n  // --------------------------------------------------\n  init: async () => {\n    // Prevent double initialization\n    const currentState = get();\n    if (currentState.isHydrated) {\n      console.log(\"[UserStore] Already hydrated, skipping init\");\n      return;\n    }\n\n    set({ loading: true });\n    console.log(\"[UserStore] Starting init...\");\n\n    // Timeout to ensure we never get stuck on loading screen\n    const timeoutPromise = new Promise((_, reject) => \n      setTimeout(() => reject(new Error(\"Init timeout\")), 10000)\n    );\n\n    try {\n      const initLogic = async () => {\n        console.log(\"[UserStore] Calling ensureSignedIn...\");\n        const user = (await safeCall(() => ensureSignedIn())) ?? null;\n        console.log(\"[UserStore] ensureSignedIn result:\", user?.id || \"null\");\n\n        if (!user) {\n          console.error(\"Silent auth failed\");\n          set({ loading: false, isHydrated: true, profileReady: false, hasOnboarded: false });\n          return;\n        }\n\n        set({ user, userId: user.id });\n\n        // Check if profile exists (DO NOT create it here)\n        console.log(\"[UserStore] Checking profile for user:\", user.id);\n        const existingProfile = await checkProfileExists(user.id);\n\n        if (!existingProfile) {\n          // No profile = user needs onboarding\n          console.log(\"NO PROFILE ‚Üí ONBOARDING REQUIRED\");\n          localStorage.removeItem(\"iq_profile_complete\");\n          set({ \n            loading: false, \n            isHydrated: true, \n            profileReady: false,\n            hasOnboarded: false,\n          });\n          return;\n        }\n\n        // Profile exists - load full data\n        const fullProfile = await loadCloudProfile(user.id);\n\n        if (!fullProfile) {\n          console.warn(\"[UserStore] Missing profile from cloud\");\n          set({ loading: false, isHydrated: true, profileReady: false, hasOnboarded: false });\n          return;\n        }\n        \n        // Determine if onboarding is complete\n        const needsOnboarding = !isProfileComplete(fullProfile);\n        \n        if (needsOnboarding) {\n          // Profile exists but is incomplete (missing username/handle)\n          localStorage.removeItem(\"iq_profile_complete\");\n          console.log(\"INCOMPLETE PROFILE ‚Üí ONBOARDING REQUIRED\");\n        } else {\n          // Profile is complete - restore local state from cloud\n          localStorage.setItem(\"iq_profile_complete\", \"true\");\n          if (fullProfile) {\n            localStorage.setItem(\"iq_username\", fullProfile.username || \"\");\n            localStorage.setItem(\"iq_handle\", fullProfile.handle || \"\");\n            localStorage.setItem(\"iq_avatar\", fullProfile.avatar || DEFAULT_AVATAR);\n          }\n          console.log(\"PROFILE COMPLETE ‚Üí Loading app\");\n        }\n\n        set({\n          profile: fullProfile,\n          profileReady: !needsOnboarding,\n          hasOnboarded: !needsOnboarding,\n          loading: false,\n          isHydrated: true,\n          // Restore identity from cloud profile\n          username: fullProfile?.username || \"\",\n          handle: fullProfile?.handle || \"\",\n          avatar: fullProfile?.avatar || DEFAULT_AVATAR,\n          name: fullProfile?.username || \"\",\n        });\n      };\n\n      await Promise.race([initLogic(), timeoutPromise]);\n      console.log(\"[UserStore] Init completed successfully\");\n\n    } catch (error) {\n      console.error(\"Init error:\", error?.message || error);\n      // Always set isHydrated to prevent stuck loading screen\n      set({ loading: false, isHydrated: true, profileReady: false, hasOnboarded: false });\n    }\n  },\n\n  // --------------------------------------------------\n  // ONBOARDING SETTERS\n  // Store locally during onboarding, sync to cloud at end\n  // --------------------------------------------------\n  setName: (name) => {\n    localStorage.setItem(\"iq_name\", name);\n    set({ name });\n    // Sync name change to cloud (stored as username)\n    const saveProfile = get().saveProfile;\n    if (saveProfile) {\n      saveProfile({ username: name });\n    }\n  },\n\n  setAvatar: (avatar) => {\n    localStorage.setItem(\"iq_avatar\", avatar);\n    set({ avatar });\n    // Sync avatar change to cloud\n    const saveProfile = get().saveProfile;\n    if (saveProfile) {\n      saveProfile({ avatar });\n    }\n  },\n\n  setUsername: (username) => {\n    localStorage.setItem(\"iq_username\", username);\n    set({ username });\n  },\n\n  setHandle: (handle) => {\n    localStorage.setItem(\"iq_handle\", handle);\n    set({ handle });\n  },\n\n  // --------------------------------------------------\n  // SET PROFILE FROM SYNC - Called by profileSync merge\n  // --------------------------------------------------\n  setProfileFromSync: (data) => {\n    if (!data) return;\n    set({\n      xp: data.xp ?? 0,\n      streak: data.streak ?? 0,\n      lastStreakUpdate: data.lastStreakUpdate ?? data.lastStreakDate ?? null,\n      streakShield: data.streakShield ?? data.shieldCount ?? 0,\n      lastXpGain: data.lastXpGain ?? null,\n    });\n  },\n\n  // --------------------------------------------------\n  // SET ONBOARDED - Only call after profile save succeeds\n  // --------------------------------------------------\n  setOnboarded: (value) => {\n    if (value) {\n      localStorage.setItem(\"iq_profile_complete\", \"true\");\n    } else {\n      localStorage.removeItem(\"iq_profile_complete\");\n    }\n    set({ hasOnboarded: value });\n  },\n\n  // --------------------------------------------------\n  // SAVE PROFILE - Updates ONLY identity fields\n  // Only works if profile already exists\n  // --------------------------------------------------\n  saveProfile: async (updates) => {\n    const userId = get().user?.id || get().userId;\n    if (!userId) {\n      console.warn(\"saveProfile: No userId available\");\n      return { success: false };\n    }\n\n    // Filter to only identity fields - strip any progress fields\n    const identityFields = {};\n    if (updates.username) identityFields.username = updates.username;\n    if (updates.avatar) identityFields.avatar = updates.avatar;\n    if (updates.handle) identityFields.handle = updates.handle;\n\n    // Don't send empty updates\n    if (Object.keys(identityFields).length === 0) {\n      console.warn(\"saveProfile: No identity fields to update\");\n      return { success: false };\n    }\n\n    const result = await saveCloudProfile(userId, identityFields);\n\n    if (result.success) {\n      // Reload profile from cloud to confirm changes\n      const updated = await loadCloudProfile(userId);\n      if (updated) {\n        set({ profile: updated });\n      }\n    }\n\n    return result;\n  },\n\n  // --------------------------------------------------\n  // COMPLETE ONBOARDING - Final step after all screens\n  // Creates profile if missing, then marks onboarding done\n  // --------------------------------------------------\n  completeOnboarding: async () => {\n    const { username, avatar, handle, userId, user, deviceId } = get();\n    const uid = user?.id || userId;\n\n    if (!uid) {\n      console.error(\"completeOnboarding: No user ID\");\n      return false;\n    }\n\n    // Validate all required fields are present\n    if (!username || !handle) {\n      console.error(\"completeOnboarding: Missing required fields\", { username, handle });\n      return false;\n    }\n\n    // Check if profile already exists\n    const existingProfile = await checkProfileExists(uid);\n\n    let result;\n    if (existingProfile) {\n      // Profile exists - update it\n      console.log(\"Profile exists, updating identity fields...\");\n      result = await saveCloudProfile(uid, {\n        username,\n        avatar: avatar || DEFAULT_AVATAR,\n        handle,\n      });\n    } else {\n      // No profile - create it\n      console.log(\"Creating new profile...\");\n      result = await createProfileAfterOnboarding({\n        userId: uid,\n        deviceId: deviceId,\n        username,\n        avatar: avatar || DEFAULT_AVATAR,\n        handle,\n      });\n    }\n\n    if (result.success) {\n      // Load the full profile\n      const fullProfile = await loadCloudProfile(uid);\n      \n      // Update localStorage\n      localStorage.setItem(\"iq_profile_complete\", \"true\");\n      localStorage.setItem(\"iq_username\", username);\n      localStorage.setItem(\"iq_handle\", handle);\n      localStorage.setItem(\"iq_avatar\", avatar || DEFAULT_AVATAR);\n      \n      // Update store\n      set({ \n        hasOnboarded: true, \n        profileReady: true,\n        profile: fullProfile,\n      });\n      \n      console.log(\"ONBOARDING COMPLETE ‚Üí Profile saved\");\n      return { success: true };\n    }\n\n    console.error(\"completeOnboarding: Save failed\", result.error);\n    return { success: false, error: result.error };\n  },\n\n  // --------------------------------------------------\n  // REFRESH PROFILE FROM DB\n  // --------------------------------------------------\n  reloadProfile: async () => {\n    const userId = get().user?.id || get().userId;\n    if (!userId) return;\n\n    const profile = await loadCloudProfile(userId);\n    if (profile) {\n      set({ \n        profile,\n        username: profile.username || \"\",\n        handle: profile.handle || \"\",\n        avatar: profile.avatar || DEFAULT_AVATAR,\n      });\n    }\n  },\n\n  // --------------------------------------------------\n  // SYNC USER PROFILE - Refresh from cloud\n  // --------------------------------------------------\n  syncUserProfile: async () => {\n    const { data } = await supabase.auth.getUser();\n    const userId = data?.user?.id;\n    if (!userId) return;\n\n    const { data: profile } = await supabase\n      .from(\"profiles\")\n      .select(\"*\")\n      .eq(\"user_id\", userId)\n      .single();\n\n    if (profile) {\n      set({\n        xp: profile.xp ?? 0,\n        streak: profile.streak ?? 0,\n        streakShield: profile.shield_count ?? 0,\n      });\n    }\n  },\n\n  // --------------------------------------------------\n  // RESET USER DATA (for logout)\n  // --------------------------------------------------\n  resetUserData: () => {\n    // Clear all identity localStorage items\n    localStorage.removeItem(\"iq_name\");\n    localStorage.removeItem(\"iq_avatar\");\n    localStorage.removeItem(\"iq_username\");\n    localStorage.removeItem(\"iq_handle\");\n    localStorage.removeItem(\"iq_profile_complete\");\n    localStorage.removeItem(\"device_id\");\n    \n    // Reset store state\n    set({\n      user: null,\n      userId: null,\n      profile: null,\n      profileReady: false,\n      hasOnboarded: false,\n      name: \"\",\n      avatar: DEFAULT_AVATAR,\n      username: \"\",\n      handle: \"\",\n      deviceId: \"\",\n      loading: false,\n      isHydrated: true,\n    });\n  },\n\n  // Alias for setName (used by Login.jsx)\n  setDisplayName: (name) => {\n    localStorage.setItem(\"iq_name\", name);\n    set({ name });\n  },\n}));\n","path":null,"size_bytes":13383,"size_tokens":null},"src/App.css":{"content":":root {\n  --navy: #0a2a43;        /* background */\n  --navy-dark: #0a2a43;   /* darker surfaces */\n  --gold: #D4AF37;        /* accents */\n  --green: #10B981;       /* emerald highlights */\n  --text: #f3f4f6;        /* light text */\n}\n\n* {\n  box-sizing: border-box;\n}\n\nhtml {\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n  background: #0a2a43;\n  overscroll-behavior: none;\n}\n\nbody {\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n  background: #0a2a43;\n  overscroll-behavior: none;\n}\n\n#root {\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n  background: #0a2a43;\n}\n\n/* Arabic honorific font - forces Ô∑ª (U+FDFC) and Ô∑∫ (U+FDFA) to use Arabic calligraphic style */\n@font-face {\n  font-family: 'Arabic Honorific';\n  src: local('Noto Naskh Arabic'), local('Amiri'), \n       url('https://fonts.gstatic.com/s/notonaskharabic/v33/RrQ5bpV-9Dd1b1OAGA6M9PkyDuVBPDL5sDxbzkCbMnsfNiN9ug.woff2') format('woff2');\n  unicode-range: U+FDFA, U+FDFC;\n}\n\n/* üëá KEY: this globally prevents content going under the fixed nav */\nbody {\n  color: var(--text);\n  font-family: \"Arabic Honorific\", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,\n    \"Helvetica Neue\", Arial, sans-serif;\n  max-width: 100vw;\n  padding-bottom: 0;\n}\n\n/* Main screen wrapper used on most pages */\n.screen {\n  background-color: #0a2a43;\n  min-height: 100%;\n  padding: 0;\n  padding-bottom: 56px;\n  padding-bottom: calc(56px + env(safe-area-inset-bottom, 0px));\n  max-width: 100%;\n  overflow-x: hidden;\n  box-sizing: border-box;\n}\n\n/* Prevents extra space and scroll issues */\n.no-extra-space {\n  overflow-y: auto;\n  overscroll-behavior: contain;\n  margin-bottom: 0;\n}\n\n/* Combined selector to restore bottom nav clearance when both classes are used */\n.screen.no-extra-space {\n  padding-bottom: 56px !important;\n  padding-bottom: calc(56px + env(safe-area-inset-bottom, 0px)) !important;\n}\n\n/* Onboarding screens - remove bottom padding */\n.onboarding-screen {\n  padding: 0 !important;\n  margin: 0 !important;\n  min-height: 100vh;\n  width: 100%;\n  background: #0a2a43;\n  overflow: hidden;\n}\n\n/* App root container safe-area support */\n.app-root-container {\n  padding-bottom: 90px !important;\n  padding-bottom: calc(90px + env(safe-area-inset-bottom, 0px)) !important;\n}\n\n/* ScreenContainer safe-area support */\n.screen-container-root {\n  padding-bottom: 110px !important;\n  padding-bottom: calc(110px + env(safe-area-inset-bottom, 0px)) !important;\n}\n\n/* Headings */\nh1 {\n  margin: 0 0 8px;\n  color: var(--gold);\n  font-size: clamp(1.2rem, 4vw, 1.8rem);\n  max-width: 100%;\n  word-wrap: break-word;\n}\n\n/* Links */\na {\n  color: inherit;\n  text-decoration: none;\n}\n\n/* Bottom navigation styling */\n.bottom-nav {\n  background: var(--navy-dark);\n  border-top: none !important;\n}\n","path":null,"size_bytes":2788,"size_tokens":null},"src/components/BottomNav.jsx":{"content":"import React, { useEffect } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { Home, BookOpen, Sword, Users, User } from \"lucide-react\";\nimport { useFriendsStore } from \"../store/friendsStore\";\nimport { useFriendChallengesStore } from \"../store/friendChallengesStore\";\n\nconst NAV_HEIGHT = 76;\n\nexport default function BottomNav() {\n  const navigate = useNavigate();\n  const { pathname } = useLocation();\n  const { receivedRequests, initialized: friendsInitialized, initialize: initFriends } = useFriendsStore();\n  const { unreadCount: challengeUnreadCount, initialize: initChallenges, initialized: challengesInitialized } = useFriendChallengesStore();\n\n  useEffect(() => {\n    // Initialize both stores with real-time subscriptions\n    if (!friendsInitialized) initFriends();\n    if (!challengesInitialized) initChallenges();\n  }, [friendsInitialized, challengesInitialized, initFriends, initChallenges]);\n\n  const friendBadgeCount = (receivedRequests?.length || 0) + challengeUnreadCount;\n\n  const tabs = [\n    { path: \"/\", label: \"Home\", icon: <Home size={22} /> },\n    { path: \"/revise\", label: \"Revise\", icon: <BookOpen size={22} /> },\n    { path: \"/challenge\", label: \"Challenge\", icon: <Sword size={22} /> },\n    { path: \"/friends\", label: \"Friends\", icon: <Users size={22} />, badge: friendBadgeCount },\n    { path: \"/profile\", label: \"Profile\", icon: <User size={22} /> },\n  ];\n\n  return (\n    <nav\n      className=\"bottom-nav\"\n      style={{\n        position: \"fixed\",\n        bottom: 0,\n        left: 0,\n        right: 0,\n        height: `${NAV_HEIGHT}px`,\n        background: \"#0e2340\",\n        borderTop: \"1px solid #0e2340\",\n        boxShadow: \"none\",\n        display: \"flex\",\n        justifyContent: \"space-around\",\n        alignItems: \"center\",\n        zIndex: 1000,\n        paddingBottom: \"env(safe-area-inset-bottom)\",\n      }}\n    >\n      {tabs.map((tab) => {\n        const active = pathname === tab.path;\n        return (\n          <button\n            key={tab.path}\n            onClick={() => navigate(tab.path)}\n            style={{\n              background: \"transparent\",\n              border: \"none\",\n              color: active ? \"var(--gold)\" : \"rgba(243,244,246,0.6)\",\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"center\",\n              fontSize: \"12px\",\n              cursor: \"pointer\",\n              gap: \"4px\",\n              transform: active ? \"scale(1.08)\" : \"scale(1)\",\n              transition: \"all 0.2s ease\",\n              position: \"relative\",\n            }}\n          >\n            {tab.icon}\n            <span style={{ fontWeight: active ? 600 : 400 }}>\n              {tab.label}\n            </span>\n            {tab.badge > 0 && (\n              <span\n                style={{\n                  position: \"absolute\",\n                  top: -4,\n                  right: \"calc(50% - 20px)\",\n                  background: \"#ef4444\",\n                  color: \"white\",\n                  borderRadius: \"50%\",\n                  width: 18,\n                  height: 18,\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  fontSize: \"10px\",\n                  fontWeight: \"bold\",\n                  boxShadow: \"0 0 10px rgba(239, 68, 68, 0.6)\",\n                }}\n              >\n                {tab.badge}\n              </span>\n            )}\n          </button>\n        );\n      })}\n    </nav>\n  );\n}\n","path":null,"size_bytes":3542,"size_tokens":null},"src/components/ScreenWrapper.jsx":{"content":"import React from \"react\";\n\nexport default function ScreenWrapper({ children }) {\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        width: \"100%\",\n        background: \"var(--navy)\",\n        paddingLeft: \"clamp(12px, 3vw, 24px)\",\n        paddingRight: \"clamp(12px, 3vw, 24px)\",\n        paddingTop: \"clamp(12px, 3vw, 24px)\",\n        boxSizing: \"border-box\",\n        overflowX: \"hidden\",\n      }}\n    >\n      {children}\n    </div>\n  );\n}\n","path":null,"size_bytes":468,"size_tokens":null},"src/screens/QuizScreen.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { getQuizForLesson, calculateResults } from \"../data/quizEngine\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useReviseStore } from \"../store/reviseStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { useAnalytics } from \"../hooks/useAnalytics\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { logLessonComplete } from \"../backend/lessonProgress\";\nimport { logXpEvent } from \"../backend/xpLogs\";\nimport PointingMascot from \"../assets/mascots/mascot_pointing_v2.webp\";\nimport SittingMascot from \"../assets/mascots/mascot_sitting_v2.webp\";\nimport CongratsMascot from \"../assets/mascots/mascot_congratulation.webp\";\n\nimport QuizHeader from \"../components/quiz/QuizHeader\";\nimport QuestionCard from \"../components/quiz/QuestionCard\";\n\nconst shuffleQuestion = (q) => {\n  const order = q.options.map((_, i) => i);\n  for (let i = order.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [order[i], order[j]] = [order[j], order[i]];\n  }\n  const options = order.map((i) => q.options[i]);\n  const correctIndex = order.indexOf(q.correctIndex);\n  return { ...q, options, correctIndex };\n};\n\nconst QuizScreen = () => {\n  const { pathId, lessonId } = useParams();\n  const navigate = useNavigate();\n  const analytics = useAnalytics();\n\n  const [quizData, setQuizData] = useState([]);\n  const [currentQ, setCurrentQ] = useState(0);\n  const [selected, setSelected] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [isQuizDone, setIsQuizDone] = useState(false);\n  const [mascotMood, setMascotMood] = useState(\"start\");\n  const [results, setResults] = useState(null);\n\n  const applyQuizResults = useProgressStore((s) => s.applyQuizResults);\n  const getLessonLockState = useProgressStore((s) => s.getLessonLockState);\n  const unlockReviewMistakes = useProgressStore((s) => s.unlockReviewMistakes);\n  const { showModal } = useModalStore();\n  const saveWrongQuestion = useReviseStore((s) => s.saveWrongQuestion);\n\n  const sendLessonCompleteLog = async (score, passed, xpAmount) => {\n    const { data } = await supabase.auth.getUser();\n    const userId = data?.user?.id;\n    if (!userId || !lessonId || !pathId) return;\n\n    await logLessonComplete(userId, parseInt(pathId), parseInt(lessonId), score, passed);\n\n    if (xpAmount) {\n      await logXpEvent(userId, xpAmount, \"lesson_complete\");\n    }\n  };\n\n  // üîí PREMIUM GUARD: Block direct URL access to premium-locked quizzes\n  useEffect(() => {\n    if (!pathId || !lessonId) return;\n    \n    const numericPathId = parseInt(pathId, 10);\n    const numericLessonId = parseInt(lessonId, 10);\n    \n    // Check the specific lock state\n    const lockState = getLessonLockState(numericPathId, numericLessonId);\n    \n    // Only redirect to premium for actual premium locks\n    // For progress locks, redirect back to path view for normal progression\n    if (lockState === \"premiumLocked\") {\n      navigate(\"/premium\", { replace: true });\n    } else if (lockState === \"progressLocked\") {\n      // Redirect back to path view for normal progression locks\n      navigate(`/path/${numericPathId}`, { replace: true });\n    }\n  }, [pathId, lessonId, getLessonLockState, navigate]);\n\n  useEffect(() => {\n    const raw = getQuizForLesson(lessonId, pathId) || [];\n    const prepared = raw.map(shuffleQuestion);\n    setQuizData(prepared);\n    setCurrentQ(0);\n    setSelected(null);\n    setAnswers([]);\n    setIsQuizDone(false);\n    setResults(null);\n    setMascotMood(\"start\");\n  }, [lessonId, pathId]);\n\n  const handleSelect = (index) => {\n    if (selected !== null || isQuizDone) return;\n    const q = quizData[currentQ];\n    if (!q) return;\n\n    const isCorrect = index === q.correctIndex;\n    const updatedAnswers = [\n      ...answers,\n      { questionId: q.id, correct: isCorrect },\n    ];\n\n    setSelected(index);\n    setAnswers(updatedAnswers);\n\n    if (!isCorrect) {\n      const cardId = `${pathId}_${lessonId}_${currentQ}`;\n      saveWrongQuestion(cardId, parseInt(lessonId), unlockReviewMistakes);\n    }\n\n    setTimeout(() => {\n      const isLast = currentQ === quizData.length - 1;\n      if (isLast) {\n        finishQuiz(updatedAnswers);\n      } else {\n        setCurrentQ((prev) => prev + 1);\n        setSelected(null);\n        window.scrollTo({ top: 0, behavior: \"smooth\" });\n      }\n    }, 900);\n  };\n\n  const finishQuiz = async (finalAnswers) => {\n    const res = calculateResults(finalAnswers);\n    setResults(res);\n    \n    // Log lesson completion to Supabase\n    const xpReward = res.passed ? res.xp : 0;\n    await sendLessonCompleteLog(res.correct, res.passed, xpReward);\n    \n    // Apply quiz results with score tracking\n    applyQuizResults(\n      { xp: res.xp, coins: res.coins },\n      parseInt(pathId),\n      parseInt(lessonId),\n      res.passed,\n      res.correct // Pass actual score for tracking\n    );\n    \n    // Track quiz completion for analytics\n    analytics('quiz_completed', {\n      pathId: parseInt(pathId),\n      lessonId: parseInt(lessonId),\n      score: res.correct,\n      total: res.total,\n      passed: res.passed,\n      xpEarned: res.passed ? res.xp : 0,\n      coinsEarned: res.passed ? res.coins : 0\n    });\n    \n    setIsQuizDone(true);\n    \n    // Get correct mascot based on score\n    const mascotImg = res.passed ? CongratsMascot : SittingMascot;\n    \n    // Show reward modal\n    showModal(MODAL_TYPES.REWARD, {\n      score: res.correct,\n      totalQ: res.total,\n      xp: res.xp,\n      coins: res.coins,\n      passed: res.passed,\n      mascotImg: mascotImg,\n      onRetry: handleRetry,\n      onContinue: handleContinue\n    });\n  };\n\n  const handleRetry = () => {\n    const raw = getQuizForLesson(lessonId, pathId) || [];\n    const prepared = raw.map(shuffleQuestion);\n    setQuizData(prepared);\n    setCurrentQ(0);\n    setSelected(null);\n    setAnswers([]);\n    setIsQuizDone(false);\n    setResults(null);\n    setMascotMood(\"start\");\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  };\n\n  const handleContinue = () => {\n    // Check if next lesson is premium-locked\n    const nextLessonId = parseInt(lessonId, 10) + 1;\n    const nextLockState = getLessonLockState(parseInt(pathId, 10), nextLessonId);\n    \n    if (nextLockState === \"premiumLocked\") {\n      // Next lesson is premium - redirect to premium page\n      navigate(\"/premium\", { replace: true });\n    } else {\n      // Go back to path view\n      navigate(`/path/${pathId}`);\n    }\n  };\n\n  if (!quizData || quizData.length === 0) {\n    return (\n      <div className=\"screen no-extra-space flex flex-col items-center justify-center text-center text-white\">\n        <p>No quiz data found for this lesson.</p>\n        <button\n          className=\"mt-4 px-4 py-2 bg-[#F4C542] text-black rounded-xl\"\n          onClick={() => navigate(-1)}\n        >\n          Go Back\n        </button>\n      </div>\n    );\n  }\n\n  const progress =\n    ((isQuizDone ? quizData.length : currentQ + 1) / quizData.length) * 100;\n\n  return (\n    <div className=\"screen no-extra-space bg-gradient-to-b from-[#0A0F1E] to-[#030614] text-white flex flex-col\">\n      <QuizHeader\n        currentQ={currentQ}\n        totalQ={quizData.length}\n        mascotMood=\"thinking\"\n        isQuizDone={isQuizDone}\n        progressMascot={PointingMascot}\n      />\n\n      <div className=\"h-2 bg-gray-800 w-full\">\n        <div\n          className=\"h-2 bg-[#F4C542] transition-all duration-500\"\n          style={{ width: `${progress}%` }}\n        />\n      </div>\n\n      <div className=\"flex-1 flex items-center justify-center px-4 py-6\">\n        {!isQuizDone && (\n          <QuestionCard\n            question={quizData[currentQ]}\n            currentQ={currentQ}\n            totalQ={quizData.length}\n            selected={selected}\n            onSelect={handleSelect}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default QuizScreen;\n","path":null,"size_bytes":8006,"size_tokens":null},"src/components/ProgressBar.jsx":{"content":"import React from \"react\";\n\nconst ProgressBar = React.memo(function ProgressBar({ value, max = 1 }) {\n  const width = Math.min(100, (value / max) * 100);\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"8px\",\n        background: \"rgba(255,255,255,0.1)\",\n        borderRadius: \"10px\",\n        overflow: \"hidden\",\n        marginTop: \"8px\",\n      }}\n    >\n      <div\n        style={{\n          width: `${width}%`,\n          height: \"100%\",\n          background: \"linear-gradient(90deg,#FFD700,#FFB100)\",\n          borderRadius: \"10px\",\n          transition: \"width 0.3s ease\",\n        }}\n      ></div>\n    </div>\n  );\n});\n\nexport default ProgressBar;\n","path":null,"size_bytes":674,"size_tokens":null},"src/store/leaderboardStore.js":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"src/index.css":{"content":"/* Islam Quest global styles */\n\n/* Custom Yuzarsif font for branding */\n@font-face {\n  font-family: 'Yuzarsif';\n  src: url('./assets/fonts/Yuzarsif.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n/* Hidayatullah Arabic-style font for title */\n@font-face {\n  font-family: 'Hidayatullah';\n  src: url('./assets/fonts/HidayatullahDemo.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n/* TT Chocolates font for greeting text */\n@font-face {\n  font-family: 'TT Chocolates';\n  src: url('./assets/fonts/TTChocolates.otf') format('opentype');\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n/* Reset */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n/* Allow text selection in inputs and textareas */\ninput, textarea, .selectable-text {\n  user-select: text;\n  -webkit-user-select: text;\n}\n\n/* Base font + colours */\nhtml {\n  font-size: 16px;\n}\n\nbody {\n  font-family: \"Poppins\", \"Nunito\", system-ui, sans-serif;\n  background: #0a2a43;\n  color: #fff;\n  height: 100%;\n  -webkit-font-smoothing: antialiased;\n  margin: 0;\n}\n\n/* Make sure our root fills the page */\n#root {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n/* Utility: simple fade-in for pages */\n.screen {\n  animation: fadeIn 0.35s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(4px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n/* Scrollbar clean for mobile */\n::-webkit-scrollbar {\n  width: 0;\n  height: 0;\n}\n\n/* === Islam Quest Pathway Page Styling === */\n.pathway-page {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  max-width: 480px;\n  margin: 0 auto;\n  text-align: center;\n  overflow-y: auto;\n  background: #e8faff;\n}\n\n.pathway-header {\n  position: relative;\n  width: 100%;\n  padding: 0.5rem 0 1rem;\n}\n\n.pathway-header h1 {\n  font-size: clamp(1.1rem, 4vw, 1.4rem);\n  font-weight: 700;\n  color: #004b5c;\n  margin-bottom: 0.5rem;\n}\n\n.pathway-header img {\n  position: absolute;\n  right: 0.5rem;\n  top: 0;\n  width: clamp(50px, 12vw, 70px);\n  height: clamp(50px, 12vw, 70px);\n  object-fit: contain;\n  animation: float 3s ease-in-out infinite;\n}\n\n@keyframes float {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-5px); }\n}\n\n.progress-ring {\n  background: #dff8f2;\n  color: #047857;\n  border-radius: 50%;\n  width: clamp(55px, 12vw, 70px);\n  height: clamp(55px, 12vw, 70px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0.5rem auto;\n  font-weight: 600;\n  font-size: clamp(0.9rem, 2.5vw, 1rem);\n}\n\n.lesson-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  width: 100%;\n  margin-top: 1rem;\n}\n\n.lesson-card {\n  background: white;\n  border-radius: 1rem;\n  padding: 0.875rem;\n  transition: transform 0.2s ease;\n  text-align: left;\n}\n\n.lesson-card:hover {\n  transform: scale(1.02);\n}\n\n.lesson-card.locked {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.lesson-card h3 {\n  font-weight: 600;\n  font-size: clamp(0.9rem, 2.5vw, 1rem);\n  margin-bottom: 0.25rem;\n  color: #333;\n}\n\n.lesson-card p {\n  color: #666;\n  font-size: clamp(0.8rem, 2vw, 0.85rem);\n  line-height: 1.4;\n}\n\n.pathway-footer {\n  font-size: clamp(0.75rem, 2vw, 0.85rem);\n  color: #555;\n  margin-top: 1rem;\n  padding: 0.5rem 0;\n}\n\n/* Responsive adjustments */\n@media (max-width: 640px) {\n  .pathway-page {\n    padding: 0.75rem;\n  }\n  .pathway-header {\n    padding: 0.25rem 0 0.75rem;\n  }\n}\n\n/* üõ°Ô∏è Prevent mascots from filling the screen */\nimg[src*=\"mascot_zayd_\"],\nimg[src*=\"mascot_\"] {\n  width: clamp(100px, 25vw, 140px) !important;\n  height: auto !important;\n  max-width: 140px !important;\n  max-height: 140px !important;\n  object-fit: contain !important;\n  display: block;\n  margin: 0 auto;\n}\n\n/* üíé Diamond Level System Animations */\n@keyframes sparkle {\n  0%, 100% {\n    transform: translate(-50%, -50%) rotate(45deg) scale(1);\n    opacity: 1;\n  }\n  50% {\n    transform: translate(-50%, -50%) rotate(45deg) scale(1.1);\n    opacity: 0.8;\n  }\n}\n\n@keyframes pulse {\n  0%, 100% {\n    transform: translate(-50%, -50%) rotate(45deg) scale(1);\n    opacity: 1;\n  }\n  50% {\n    transform: translate(-50%, -50%) rotate(45deg) scale(1.08);\n    opacity: 0.85;\n  }\n}\n\n@keyframes bounceIn {\n  0% {\n    transform: scale(0.3);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.05);\n  }\n  70% {\n    transform: scale(0.9);\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n@keyframes bounceOut {\n  0% {\n    transform: scale(1);\n    opacity: 1;\n  }\n  100% {\n    transform: scale(0.3);\n    opacity: 0;\n  }\n}\n\n@keyframes scaleIn {\n  0% {\n    transform: scale(0);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n@keyframes bounce {\n  0%, 100% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-10px);\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n","path":null,"size_bytes":5034,"size_tokens":null},"src/App.jsx":{"content":"// src/App.jsx\nimport React, { useEffect, Suspense, lazy } from \"react\";\nimport { BrowserRouter, Routes, Route, useNavigate, Navigate } from \"react-router-dom\";\n\n// ‚úÖ Critical imports (loaded immediately)\nimport GlobalErrorBoundary from \"./components/GlobalErrorBoundary.jsx\";\nimport ErrorBoundary from \"./components/ErrorBoundary.jsx\";\nimport BottomNav from \"./components/BottomNav.jsx\";\nimport ScrollToTop from \"./components/ScrollToTop.jsx\";\nimport ModalController from \"./components/ModalController.jsx\";\nimport OfflineConnectionBanner from \"./components/OfflineConnectionBanner.jsx\";\nimport { ModalProvider, ModalRoot } from \"./providers/ModalProvider.jsx\";\nimport { ShimmerCard, ShimmerImage } from \"./components/ShimmerLoader.jsx\";\nimport { useUserStore } from \"./store/useUserStore\";\nimport { useProgressStore } from \"./store/progressStore\";\nimport { useDailyQuestStore } from \"./store/dailyQuestStore\";\nimport { preloadAllAssets } from \"./utils/imagePreloader\";\nimport { useModalStore, MODAL_TYPES } from \"./store/modalStore\";\nimport { supabase, ensureSignedIn } from \"./lib/supabaseClient\";\nimport { getDeviceFingerprint } from \"./lib/deviceFingerprint\";\nimport { syncOnAppOpen, syncOnForeground } from \"./sync/engine.js\";\nimport OneSignal from \"react-onesignal\";\nimport { createDailyLeaderboardSnapshot } from \"./backend/leaderboardSnapshots\";\n\n\n// ‚úÖ Onboarding screens (loaded immediately for first-time users)\nimport BismillahScreen from \"./onboarding/BismillahScreen.jsx\";\nimport SalaamScreen from \"./onboarding/SalaamScreen.jsx\";\nimport AuthChoiceScreen from \"./onboarding/AuthChoiceScreen.jsx\";\nimport NameHandleScreen from \"./onboarding/NameHandleScreen.jsx\";\nimport AvatarScreen from \"./onboarding/AvatarScreen.jsx\";\nimport HandleScreen from \"./onboarding/HandleScreen.jsx\";\n\n// üöÄ LAZY LOADED ROUTES - Split bundle for proper hydration\nconst Home = lazy(() => import(\"./pages/Home\"));\nconst Pathway = lazy(() => import(\"./screens/Pathway.jsx\"));\nconst Lesson = lazy(() => import(\"./pages/Lesson.jsx\"));\nconst Challenge = lazy(() => import(\"./pages/Challenge.jsx\"));\nconst ChallengeGame = lazy(\n  () => import(\"./pages/challenges/ChallengeGame.jsx\"),\n);\nconst FriendChallengeGame = lazy(\n  () => import(\"./pages/challenges/FriendChallengeGame.jsx\"),\n);\nconst DailyQuestGame = lazy(() => import(\"./pages/DailyQuestGame.jsx\"));\nconst Friends = lazy(() => import(\"./pages/Friends.jsx\"));\nconst FriendProfile = lazy(() => import(\"./pages/FriendProfile\"));\nconst Profile = lazy(() => import(\"./pages/Profile.jsx\"));\nconst Premium = lazy(() => import(\"./pages/Premium.jsx\"));\nconst Settings = lazy(() => import(\"./pages/Settings.jsx\"));\nconst Revise = lazy(() => import(\"./pages/Revise.jsx\"));\nconst AuthPage = lazy(() => import(\"./pages/AuthPage.jsx\"));\nconst LoginPage = lazy(() => import(\"./pages/LoginPage.jsx\"));\nconst SignUpPage = lazy(() => import(\"./pages/SignUpPage.jsx\"));\nconst QuizScreen = lazy(() => import(\"./screens/QuizScreen.jsx\"));\nconst GlobalEvents = lazy(() => import(\"./pages/GlobalEvents.jsx\"));\nconst ResetPremium = lazy(() => import(\"./pages/ResetPremium.jsx\"));\nconst ResetPassword = lazy(() => import(\"./pages/ResetPassword.jsx\"));\nconst Goodbye = lazy(() => import(\"./pages/Goodbye.jsx\"));\nconst CheckEmailScreen = lazy(() => import(\"./pages/CheckEmailScreen.jsx\"));\n\n// üåô Loading Component for lazy routes\nfunction LoadingScreen() {\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background:\n          \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n        color: \"white\",\n        padding: \"20px\",\n      }}\n    >\n      {/* Header Shimmer */}\n      <div style={{ maxWidth: \"800px\", margin: \"0 auto\" }}>\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"16px\",\n            marginBottom: \"24px\",\n          }}\n        >\n          <ShimmerImage width=\"60px\" height=\"60px\" borderRadius=\"50%\" />\n          <div style={{ flex: 1 }}>\n            <ShimmerCard\n              style={{ marginBottom: \"8px\", height: \"24px\", width: \"70%\" }}\n            />\n            <ShimmerCard style={{ height: \"16px\", width: \"50%\" }} />\n          </div>\n        </div>\n\n        {/* Content Cards Shimmer */}\n        <ShimmerCard style={{ marginBottom: \"16px\" }} />\n        <ShimmerCard style={{ marginBottom: \"16px\" }} />\n        <ShimmerCard />\n\n        {/* Loading Indicator */}\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: \"12px\",\n            marginTop: \"40px\",\n          }}\n        >\n          <div\n            style={{\n              width: \"40px\",\n              height: \"40px\",\n              border: \"3px solid rgba(212, 175, 55, 0.3)\",\n              borderTop: \"3px solid #D4AF37\",\n              borderRadius: \"50%\",\n              animation: \"spin 1s linear infinite\",\n            }}\n          />\n          <p style={{ color: \"#D4AF37\", fontSize: \"0.95rem\", fontWeight: 500 }}>\n            Loading‚Ä¶\n          </p>\n        </div>\n      </div>\n\n      <style>{`\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  );\n}\n\n// üîÑ Onboarding step redirector - resumes from saved step\nfunction OnboardingRedirector() {\n  const savedStep = localStorage.getItem(\"iq_onboarding_step\");\n  \n  const hasName = localStorage.getItem(\"iq_name\");\n  const hasHandle = localStorage.getItem(\"iq_handle\");\n  \n  if (hasName && hasHandle && !savedStep) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  \n  const stepRoutes = {\n    bismillah: \"/onboarding/bismillah\",\n    salaam: \"/onboarding/salaam\",\n    authchoice: \"/onboarding/auth-choice\",\n    login: \"/login\",\n    signup: \"/signup\",\n    namehandle: \"/onboarding/namehandle\",\n    avatar: \"/onboarding/avatar\",\n    handle: \"/onboarding/handle\",\n    auth: \"/login\",\n    checkemail: \"/check-email\",\n  };\n  \n  const targetRoute = (savedStep && stepRoutes[savedStep]) \n    ? stepRoutes[savedStep] \n    : \"/onboarding/bismillah\";\n  \n  return <Navigate to={targetRoute} replace />;\n}\n\n// ‚úÖ Optional: temporary placeholder for future quiz\nfunction PlaceholderQuizPage() {\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background:\n          \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n        color: \"white\",\n        padding: \"16px\",\n      }}\n    >\n      <div\n        style={{\n          fontSize: \"0.8rem\",\n          color: \"#8b8b8b\",\n          fontWeight: 500,\n          textTransform: \"uppercase\",\n          letterSpacing: \"0.05em\",\n          marginBottom: \"8px\",\n        }}\n      >\n        Quiz (Coming Soon)\n      </div>\n\n      <div\n        style={{\n          fontSize: \"1rem\",\n          fontWeight: 600,\n          lineHeight: 1.4,\n          background:\n            \"linear-gradient(90deg, #fff 0%, #fff6d2 40%, #ffd98a 100%)\",\n          WebkitBackgroundClip: \"text\",\n          color: \"transparent\",\n          marginBottom: \"12px\",\n        }}\n      >\n        You'll answer questions from this lesson for XP and coins.\n      </div>\n\n      <div style={{ color: \"#cfcfcf\", fontSize: \"0.9rem\", lineHeight: 1.5 }}>\n        You tapped ‚ÄúTake Quiz üéØ‚Äù. This will become a scored quiz in shƒÅ‚Äô AllƒÅh.\n      </div>\n    </div>\n  );\n}\n\n// üîÑ PRODUCTION STORAGE VERSION\nconst PRODUCTION_VERSION = \"iq_production_v1\";\n\nexport default function App() {\n  const { hasOnboarded, isHydrated } = useUserStore();\n  const { grantCoins, coins } = useProgressStore();\n  \n  // Force re-render workaround for Zustand subscription issues in React StrictMode\n  const [renderKey, setRenderKey] = React.useState(0);\n  const [forceReady, setForceReady] = React.useState(false);\n  \n  React.useEffect(() => {\n    // Subscribe to store changes and force re-render when hydration completes\n    const unsubscribe = useUserStore.subscribe(\n      (state) => {\n        if (state.isHydrated && !isHydrated) {\n          console.log(\"[App] Store hydrated, triggering re-render\");\n          setRenderKey(prev => prev + 1);\n        }\n      }\n    );\n    \n    // Also check immediately in case we missed the update\n    const currentState = useUserStore.getState();\n    if (currentState.isHydrated && !isHydrated) {\n      console.log(\"[App] Store already hydrated, triggering re-render\");\n      setRenderKey(prev => prev + 1);\n    }\n    \n    // Fallback: Force ready after 5 seconds to prevent infinite loading\n    const timeout = setTimeout(() => {\n      const state = useUserStore.getState();\n      if (!state.isHydrated) {\n        console.warn(\"[App] Timeout: Forcing app ready after 5 seconds\");\n        useUserStore.setState({ \n          isHydrated: true, \n          loading: false,\n          hasOnboarded: false,\n          profileReady: false,\n        });\n        setForceReady(true);\n      }\n    }, 5000);\n    \n    return () => {\n      unsubscribe();\n      clearTimeout(timeout);\n    };\n  }, [isHydrated]);\n  \n  // Get the most current state directly from store to avoid stale closure issues\n  const storeState = useUserStore.getState();\n  const actualIsHydrated = isHydrated || storeState.isHydrated || forceReady;\n  const actualHasOnboarded = storeState.hasOnboarded;\n\n  // üîÑ VERSIONED STORAGE RESET: Clear all legacy data on first production load\n  // IMPORTANT: Uses module-level flag to prevent reload loops from React StrictMode\n  useEffect(() => {\n    // Prevent double-run from React StrictMode\n    if (window.__iq_migration_running || window.__iq_migration_complete) {\n      console.log(\"‚è≠Ô∏è Skipping storage migration (already processed this session)\");\n      return;\n    }\n    window.__iq_migration_running = true;\n\n    if (window.__iq_migration_failed) {\n      console.warn(\"‚ö†Ô∏è Skipping storage migration (storage unavailable)\");\n      window.__iq_migration_running = false;\n      return;\n    }\n\n    // Capability probe: check if localStorage is available\n    const isStorageAvailable = () => {\n      try {\n        const testKey = \"__iq_storage_test__\";\n        localStorage.setItem(testKey, \"1\");\n        localStorage.removeItem(testKey);\n        return true;\n      } catch (e) {\n        console.error(\"localStorage not available:\", e);\n        window.__iq_migration_failed = true;\n        return false;\n      }\n    };\n\n    if (!isStorageAvailable()) {\n      console.warn(\n        \"‚ö†Ô∏è Storage migration skipped: localStorage unavailable (private mode?)\",\n      );\n      window.__iq_migration_running = false;\n      return;\n    }\n\n    try {\n      // Skip migration if it previously failed (persist across sessions)\n      const migrationFailed = localStorage.getItem(\"iq_migration_failed\");\n      if (migrationFailed === \"true\") {\n        console.warn(\"‚ö†Ô∏è Skipping storage migration (previous failure)\");\n        window.__iq_migration_complete = true;\n        window.__iq_migration_running = false;\n        return;\n      }\n\n      const currentVersion = localStorage.getItem(\"app_storage_version\");\n\n      if (currentVersion !== PRODUCTION_VERSION) {\n        console.log(\"üîÑ Production migration: Clearing all legacy data...\");\n\n        let allKeysRemoved = true;\n\n        // Get all localStorage keys\n        const keysToRemove = [];\n        for (let i = 0; i < localStorage.length; i++) {\n          const key = localStorage.key(i);\n          // Keep only the new production namespace\n          if (\n            key &&\n            !key.startsWith(PRODUCTION_VERSION) &&\n            key !== \"app_storage_version\"\n          ) {\n            keysToRemove.push(key);\n          }\n        }\n\n        // Clear legacy keys\n        keysToRemove.forEach((key) => {\n          try {\n            localStorage.removeItem(key);\n          } catch (e) {\n            console.warn(`Failed to remove key: ${key}`, e);\n            allKeysRemoved = false;\n          }\n        });\n\n        // Clear sessionStorage completely\n        try {\n          sessionStorage.clear();\n        } catch (e) {\n          console.warn(\"Failed to clear sessionStorage\", e);\n          allKeysRemoved = false;\n        }\n\n        // Set new version marker\n        try {\n          localStorage.setItem(\"app_storage_version\", PRODUCTION_VERSION);\n        } catch (e) {\n          console.error(\"Failed to set version marker\", e);\n          allKeysRemoved = false;\n        }\n\n        // Only reload if storage operations succeeded AND not in dev mode reload loop\n        if (allKeysRemoved) {\n          console.log(\n            \"‚úÖ Production migration complete. App will start fresh.\",\n          );\n          window.__iq_migration_complete = true;\n          // Use a short delay to ensure state is saved before reload\n          setTimeout(() => {\n            window.location.reload();\n          }, 100);\n          return;\n        } else {\n          console.warn(\n            \"‚ö†Ô∏è Storage migration partially failed. Continuing with current state.\",\n          );\n          // Mark migration as failed to prevent infinite retry loops\n          try {\n            localStorage.setItem(\"iq_migration_failed\", \"true\");\n          } catch (e) {\n            console.error(\"Cannot persist migration failure flag\", e);\n          }\n        }\n      } else {\n        console.log(\"‚úÖ Storage version matches, no migration needed\");\n      }\n\n      window.__iq_migration_complete = true;\n      window.__iq_migration_running = false;\n    } catch (error) {\n      // Fallback for private mode or localStorage errors\n      console.error(\"Storage reset failed:\", error);\n      try {\n        localStorage.setItem(\"iq_migration_failed\", \"true\");\n      } catch (e) {\n        // Silently fail - app will continue with defaults\n      }\n      window.__iq_migration_complete = true;\n      window.__iq_migration_running = false;\n      // Continue app initialization with default state (no reload)\n    }\n  }, []);\n\n  // üîê SUPABASE: Silent auth + profile check + email confirmation + cloud sync\n  // SEQUENCE: deviceId ‚Üí auth check ‚Üí email confirmation check ‚Üí profile check ‚Üí onboarding OR load stores\n  // IMPORTANT: Uses module-level flag to prevent double-init from React StrictMode\n  useEffect(() => {\n    // Prevent double-run from React StrictMode\n    // BUT: If store is not hydrated, we must run init even if flags are set (HMR recovery)\n    const storeState = useUserStore.getState();\n    if ((window.__iq_auth_init_running || window.__iq_auth_init_complete) && storeState.isHydrated) {\n      console.log(\"‚è≠Ô∏è Skipping auth init (already processed this session)\");\n      return;\n    }\n    window.__iq_auth_init_running = true;\n\n    async function initAuth() {\n      try {\n        const { setDeviceId } = useUserStore.getState();\n\n        const fp = getDeviceFingerprint();\n        setDeviceId(fp);\n\n        const { data: { session } } = await supabase.auth.getSession();\n        \n        if (session?.user) {\n          if (!session.user.email_confirmed_at && !session.user.email?.includes('@iq-hidden-')) {\n            console.log(\"User logged in but email not confirmed ‚Üí check-email\");\n            localStorage.setItem(\"iq_onboarding_step\", \"checkemail\");\n            useUserStore.setState({ \n              user: session.user, \n              userId: session.user.id,\n              loading: false, \n              isHydrated: true, \n              profileReady: false,\n              hasOnboarded: false,\n            });\n            window.__iq_auth_init_complete = true;\n            window.__iq_auth_init_running = false;\n            return;\n          }\n        }\n\n        await useUserStore.getState().init();\n\n        const { user, profileReady, handle, hasOnboarded } = useUserStore.getState();\n        \n        if (!user) {\n          console.warn(\"No user after init\");\n          window.__iq_auth_init_complete = true;\n          window.__iq_auth_init_running = false;\n          return;\n        }\n\n        console.log(\"üîê Signed in as\", user.id);\n\n        if (profileReady && hasOnboarded && !handle) {\n          console.error(\"üö® CRITICAL: User marked as onboarded but missing handle - forcing handle screen\");\n          localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n          useUserStore.setState({ \n            profileReady: false,\n            hasOnboarded: false,\n          });\n          window.__iq_auth_init_complete = true;\n          window.__iq_auth_init_running = false;\n          return;\n        }\n\n        if (profileReady) {\n          await useUserStore.getState().syncUserProfile();\n          await useDailyQuestStore.getState().loadDailyQuestFromCloud(user.id);\n          await useProgressStore.getState().loadStreakShieldFromCloud();\n          console.log(\"‚úÖ Cloud sync completed\");\n        }\n\n        window.__iq_auth_init_complete = true;\n        window.__iq_auth_init_running = false;\n      } catch (error) {\n        console.error(\"initAuth error:\", error);\n        window.__iq_auth_init_complete = true;\n        window.__iq_auth_init_running = false;\n      }\n    }\n\n    initAuth();\n  }, []);\n\n  // üöÄ PERFORMANCE: Preload ALL assets and route modules IMMEDIATELY for instant Duolingo-style loading\n  useEffect(() => {\n    // Preload ALL images instantly (mascots, avatars, UI icons, everything)\n    preloadAllAssets();\n\n    // Eagerly preload ALL route modules to avoid suspension on any navigation\n    Promise.all([\n      import(\"./pages/Home\"),\n      import(\"./screens/Pathway.jsx\"),\n      import(\"./pages/Lesson.jsx\"),\n      import(\"./screens/QuizScreen.jsx\"),\n      import(\"./pages/Challenge.jsx\"),\n      import(\"./pages/challenges/ChallengeGame.jsx\"),\n      import(\"./pages/DailyQuestGame.jsx\"),\n      import(\"./pages/GlobalEvents.jsx\"),\n      import(\"./pages/Friends.jsx\"),\n      import(\"./pages/Profile.jsx\"),\n      import(\"./pages/Settings.jsx\"),\n      import(\"./pages/Revise.jsx\"),\n      import(\"./pages/AuthPage.jsx\"),\n    ]);\n  }, []);\n\n  // üîô GLOBAL BACK BUTTON HANDLER: Intercept physical phone back button\n  useEffect(() => {\n    const { showModal } = useModalStore.getState();\n\n    // Push initial state when app loads (creates back history entry)\n    window.history.pushState({ isAppEntry: true }, \"\", window.location.href);\n\n    const handleBackButton = (event) => {\n      // Prevent default browser back behavior\n      event.preventDefault();\n\n      // Push another state to prevent actual navigation\n      window.history.pushState({ isAppEntry: true }, \"\", window.location.href);\n\n      // Show custom exit confirmation modal\n      showModal(MODAL_TYPES.EXIT_CONFIRMATION, {\n        onConfirm: () => {\n          // User confirmed - actually exit the app\n          // For web apps, this will go back or close if opened as PWA\n          window.history.go(-2); // Go back twice (past our dummy states)\n        },\n        // onCancel is handled by hideModal in ModalController (stays in app)\n      });\n    };\n\n    // Listen for popstate (back button press)\n    window.addEventListener(\"popstate\", handleBackButton);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener(\"popstate\", handleBackButton);\n    };\n  }, []);\n  \n  // üîÑ SYNC ENGINE LIFECYCLE HOOKS\n  useEffect(() => {\n    // Sync on app open\n    syncOnAppOpen();\n\n    // Sync when app/tab regains focus\n    const handleFocus = () => {\n      syncOnForeground();\n    };\n\n    window.addEventListener(\"focus\", handleFocus);\n\n    return () => {\n      window.removeEventListener(\"focus\", handleFocus);\n    };\n  }, []);\n\n  // üìä DAILY LEADERBOARD SNAPSHOT (once per day)\n  useEffect(() => {\n    const runDailySnapshot = async () => {\n      const lastRun = localStorage.getItem(\"last_snapshot_run\");\n      const today = new Date().toDateString();\n\n      if (lastRun !== today) {\n        await createDailyLeaderboardSnapshot();\n        localStorage.setItem(\"last_snapshot_run\", today);\n      }\n    };\n\n    runDailySnapshot();\n  }, []);\n\n  // üîî ONESIGNAL PUSH NOTIFICATIONS\n  useEffect(() => {\n    const initOneSignal = async () => {\n      try {\n        const oneSignalAppId = import.meta.env.VITE_ONESIGNAL_APP_ID;\n        \n        if (!oneSignalAppId || oneSignalAppId === \"YOUR-ONESIGNAL-APP-ID\") {\n          console.log(\"üîî OneSignal: No App ID configured, skipping init\");\n          return;\n        }\n\n        await OneSignal.init({\n          appId: oneSignalAppId,\n          allowLocalhostAsSecureOrigin: true,\n        });\n\n        const { data: auth } = await supabase.auth.getUser();\n        if (!auth?.user) return;\n\n        await OneSignal.login(auth.user.id);\n\n        const permission = await OneSignal.Notifications.permission;\n        if (!permission) {\n          await OneSignal.Slidedown.promptPush();\n        }\n\n        const subscriptionId = await OneSignal.User.PushSubscription.id;\n        if (!subscriptionId) {\n          console.log(\"üîî OneSignal: No subscription ID yet (permission pending)\");\n          return;\n        }\n\n        await supabase.from(\"push_tokens\").upsert({\n          user_id: auth.user.id,\n          device_token: subscriptionId,\n          platform: \"web\",\n          updated_at: new Date().toISOString()\n        }, {\n          onConflict: \"user_id,device_token\"\n        });\n\n        console.log(\"üîî OneSignal initialized, subscription saved\");\n      } catch (err) {\n        console.warn(\"OneSignal init failed:\", err.message);\n      }\n    };\n\n    if (actualHasOnboarded) {\n      initOneSignal();\n    }\n  }, [actualHasOnboarded]);\n\n  // ‚úÖ Wait until Zustand store is rehydrated (prevents onboarding redirect)\n  if (!actualIsHydrated) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"radial-gradient(circle at 20% 20%, #0a0f1e, #030614)\",\n          color: \"white\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      >\n        <p>Loading your progress‚Ä¶ üåô</p>\n      </div>\n    );\n  }\n\n  return (\n    <GlobalErrorBoundary>\n      <ErrorBoundary>\n        <OfflineConnectionBanner />\n        <ModalProvider>\n        <BrowserRouter>\n          <ScrollToTop />\n          <div\n            className=\"screen no-extra-space app-root-container\"\n            style={{\n              background:\n                \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n              color: \"white\",\n            }}\n          >\n            <Routes>\n              {!actualHasOnboarded ? (\n                <>\n                  {/* ‚úÖ ONBOARDING FLOW: Bismillah ‚Üí Salaam ‚Üí AuthChoice ‚Üí (Login OR SignUp) ‚Üí CheckEmail ‚Üí Home */}\n                  <Route\n                    path=\"/onboarding/bismillah\"\n                    element={<BismillahScreen />}\n                  />\n                  <Route path=\"/onboarding/salaam\" element={<SalaamScreen />} />\n                  <Route path=\"/onboarding/auth-choice\" element={<AuthChoiceScreen />} />\n                  {/* Legacy routes (for resume support) */}\n                  <Route path=\"/onboarding/namehandle\" element={<NameHandleScreen />} />\n                  <Route path=\"/onboarding/avatar\" element={<AvatarScreen />} />\n                  <Route path=\"/onboarding/handle\" element={<HandleScreen />} />\n                  {/* Login page */}\n                  <Route\n                    path=\"/login\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <LoginPage />\n                      </Suspense>\n                    }\n                  />\n                  {/* Sign up page */}\n                  <Route\n                    path=\"/signup\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <SignUpPage />\n                      </Suspense>\n                    }\n                  />\n                  {/* Legacy auth page (redirect to login) */}\n                  <Route\n                    path=\"/auth\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <LoginPage />\n                      </Suspense>\n                    }\n                  />\n                  {/* Check email confirmation screen */}\n                  <Route\n                    path=\"/check-email\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <CheckEmailScreen />\n                      </Suspense>\n                    }\n                  />\n                  {/* Reset password route available during onboarding */}\n                  <Route\n                    path=\"/reset-password\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <ResetPassword />\n                      </Suspense>\n                    }\n                  />\n                  {/* Goodbye screen after account deletion */}\n                  <Route\n                    path=\"/goodbye\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Goodbye />\n                      </Suspense>\n                    }\n                  />\n                  {/* Fallback ‚Äî resume from saved step or start from bismillah */}\n                  <Route path=\"*\" element={<OnboardingRedirector />} />\n                </>\n              ) : (\n                <>\n                  {/* ‚úÖ MAIN APP ROUTES - Lazy loaded for proper hydration */}\n                  <Route\n                    path=\"/\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Home />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/path/:pathId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Pathway />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/path/:pathId/lesson/:lessonId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Lesson />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/path/:pathId/quiz/:lessonId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <QuizScreen />\n                      </Suspense>\n                    }\n                  />\n\n                  <Route\n                    path=\"/challenge\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Challenge />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/challenge/:challengeId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <ChallengeGame />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/challenge/friend/:challengeId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <FriendChallengeGame />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/daily-quest\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <DailyQuestGame />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/events\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <GlobalEvents />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/friends\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Friends />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/friend/:userId\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <FriendProfile />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/profile\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Profile />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/premium\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Premium />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/settings\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Settings />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/revise\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Revise />\n                      </Suspense>\n                    }\n                  />\n                  {/* /auth redirects to login for backward compatibility */}\n                  <Route\n                    path=\"/auth\"\n                    element={<Navigate to=\"/\" replace />}\n                  />\n                  <Route\n                    path=\"/reset-premium\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <ResetPremium />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/reset-password\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <ResetPassword />\n                      </Suspense>\n                    }\n                  />\n                  <Route\n                    path=\"/goodbye\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Goodbye />\n                      </Suspense>\n                    }\n                  />\n\n                  {/* fallback */}\n                  <Route\n                    path=\"*\"\n                    element={\n                      <Suspense fallback={<LoadingScreen />}>\n                        <Home />\n                      </Suspense>\n                    }\n                  />\n                </>\n              )}\n            </Routes>\n          </div>\n\n          {/* ‚úÖ Persistent bottom navigation */}\n          {actualHasOnboarded && <BottomNav />}\n\n          {/* üíé Centralized Modal System */}\n          <ModalController />\n\n          {/* üö™ Portal root for heavy modals */}\n          <ModalRoot />\n        </BrowserRouter>\n      </ModalProvider>\n      </ErrorBoundary>\n    </GlobalErrorBoundary>\n  );\n}\n","path":null,"size_bytes":31330,"size_tokens":null},"src/pages/Home.jsx":{"content":"/**\n * IslamQuest ‚Äî Home Screen (Premium Polished Build, Updated for 14 Paths)\n * ---------------------------------------------------------------------------\n * This file preserves your full visual design, styling, layout, glow,\n * animations, header, mascot, Daily Quest card, carousel, dev slider,\n * etc. Nothing in the look/feel is removed.\n *\n * Changes in this version:\n *\n * 1) Uses `paths` from progressStore.js (14 unlocked learning paths).\n * 2) All paths are clickable (status: \"available\" assumed for launch).\n * 3) Each path card has its own gradient background (on-theme).\n * 4) Progress bar:\n *    - Gradient gold fill\n *    - Uses `p.progress` from store (0‚Äì1)\n *    - Shows `completedLessons / totalLessons Lessons`\n *    - Soft gold pulse glow when full (progress >= 1).\n * 5) Daily Quest uses triggerDailyStudy() from store.\n */\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { Footprints, Lock } from \"lucide-react\";\n\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useDailyQuestStore } from \"../store/dailyQuestStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { isPremiumOnlyPath } from \"../store/premiumConfig\";\n\n// Components\nimport DailyQuestCard from \"../components/dailyquest/DailyQuestCard\";\n\n// Mascots & UI assets\nimport Zayd from \"../assets/mascots/mascot_waving.webp\";\nimport ZaydChallenge from \"../assets/mascots/mascot_boss.webp\";\nimport MainMascot from \"../assets/mascots/mascot_sitting.webp\";\nimport ui_xp from \"../assets/ui/ui_xp.webp\";\nimport ui_streak from \"../assets/ui/ui_streak.webp\";\nimport ui_coin from \"../assets/ui/ui_coin.webp\";\nimport ui_shield from \"../assets/ui/ui_shield.webp\";\n\nexport default function Home() {\n  // Navigation\n  const navigate = useNavigate();\n  const { name } = useUserStore();\n  const { premium, premiumStatus } = useProgressStore();\n  const isUserPremium = premium || premiumStatus !== \"free\";\n\n  // Horizontal scroll ref for the learning path cards\n  const carouselRef = useRef(null);\n\n  // Which \"page\" of the carousel we're on (0 / 1 / 2)\n  const [page, setPage] = useState(0);\n\n  // üéâ Easter Egg: Mascot tap counter\n  const [mascotTaps, setMascotTaps] = useState(0);\n  const [showSparkle, setShowSparkle] = useState(false);\n  const tapTimeoutRef = useRef(null);\n  const sparkleTimeoutRef = useRef(null);\n\n  // Ramadan countdown state (3-segment: months/weeks/days)\n  const [ramadanStats, setRamadanStats] = useState({\n    months: \"--\",\n    weeks: \"--\",\n    days: \"--\",\n  });\n\n  // Modal store\n  const { showModal } = useModalStore();\n\n  // Pull live data from the store\n  const {\n    xp,\n    coins,\n    streak,\n    shieldCount,\n    needsRepairPrompt,\n    paths,\n    triggerDailyStudy,\n    checkStreakOnAppOpen,\n    ensureLocksReady,\n    addXP,\n  } = useProgressStore();\n\n  // Load Daily Quest state from localStorage on mount\n  const { loadDailyQuest } = useDailyQuestStore();\n  useEffect(() => {\n    loadDailyQuest();\n  }, [loadDailyQuest]);\n\n  // Check streak status on mount and show repair modal if needed\n  useEffect(() => {\n    checkStreakOnAppOpen();\n  }, [checkStreakOnAppOpen]);\n\n  // Show repair modal if needed\n  useEffect(() => {\n    if (needsRepairPrompt) {\n      showModal(MODAL_TYPES.REPAIR_STREAK);\n    }\n  }, [needsRepairPrompt, showModal]);\n\n  // Ramadan countdown timer (updates every minute to GMT)\n  useEffect(() => {\n    function calculateDiff() {\n      // Target: 18 February 2026 00:00 GMT\n      const target = new Date(Date.UTC(2026, 1, 18, 0, 0, 0));\n      const now = new Date();\n\n      const diff = target.getTime() - now.getTime();\n\n      if (diff <= 0) {\n        setRamadanStats({ months: \"00\", weeks: \"00\", days: \"00\" });\n        return;\n      }\n\n      const totalDays = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n      const months = Math.floor(totalDays / 30.44);\n      const remainingAfterMonths = totalDays % 30.44;\n\n      const weeks = Math.floor(remainingAfterMonths / 7);\n      const days = Math.floor(remainingAfterMonths % 7);\n\n      setRamadanStats({\n        months: months.toString().padStart(2, \"0\"),\n        weeks: weeks.toString().padStart(2, \"0\"),\n        days: days.toString().padStart(2, \"0\"),\n      });\n    }\n\n    calculateDiff();\n    const interval = setInterval(calculateDiff, 1000 * 60);\n    return () => clearInterval(interval);\n  }, []);\n\n  /**\n   * Sync carousel scroll -> page indicator dots\n   */\n  useEffect(() => {\n    const el = carouselRef.current;\n    if (!el) return;\n\n    const onScroll = () => {\n      const max = el.scrollWidth - el.clientWidth;\n      const ratio = max > 0 ? el.scrollLeft / max : 0;\n      const newPage = ratio < 0.33 ? 0 : ratio < 0.66 ? 1 : 2;\n      if (newPage !== page) {\n        setPage(newPage);\n      }\n    };\n\n    onScroll();\n    el.addEventListener(\"scroll\", onScroll, { passive: true });\n    return () => el.removeEventListener(\"scroll\", onScroll);\n  }, [page]);\n\n  /**\n   * Programmatically scroll the carousel to a page index (0,1,2)\n   * Used by the page dots\n   */\n  const goToPage = (i) => {\n    const el = carouselRef.current;\n    if (!el) return;\n    const max = el.scrollWidth - el.clientWidth;\n    const stops = [0, Math.round(max / 2), max]; // 3 logical stops\n    const idx = Math.max(0, Math.min(2, i));\n    el.scrollTo({ left: stops[idx], behavior: \"smooth\" });\n    setPage(idx);\n  };\n\n  /**\n   * On click of a path card:\n   * - Ensure locks are ready (prevent race conditions)\n   * - Check if path is premium-locked\n   * - If locked, show premium paywall modal\n   * - Otherwise navigate to /pathway/:id\n   */\n  const handlePathClick = (p) => {\n    // Ensure locks are initialized before checking\n    ensureLocksReady();\n    \n    // Check if path is premium-locked\n    const isPremiumPath = isPremiumOnlyPath(p.id);\n    if (isPremiumPath && !isUserPremium) {\n      // Show premium paywall modal instead of navigating\n      showModal(MODAL_TYPES.PURCHASE);\n      return;\n    }\n    \n    navigate(`/path/${p.id}`);\n  };\n\n  /**\n   * üéâ Easter Egg: Handle mascot tap\n   * - Count taps within 3.5 second window\n   * - Award +1 XP on 5th tap\n   * - Show sparkle animation on XP counter\n   */\n  const handleMascotTap = () => {\n    // Clear existing timeout\n    if (tapTimeoutRef.current) {\n      clearTimeout(tapTimeoutRef.current);\n    }\n\n    // Increment tap count\n    const newTapCount = mascotTaps + 1;\n    setMascotTaps(newTapCount);\n\n    // Check if we've hit 5 taps\n    if (newTapCount === 5) {\n      // Award +1 XP using the same method as normal XP\n      addXP(1);\n      \n      // Clear any existing sparkle timeout\n      if (sparkleTimeoutRef.current) {\n        clearTimeout(sparkleTimeoutRef.current);\n      }\n      \n      // Show sparkle animation\n      setShowSparkle(true);\n      sparkleTimeoutRef.current = setTimeout(() => setShowSparkle(false), 500);\n      \n      // Reset tap counter\n      setMascotTaps(0);\n    } else {\n      // Set timeout to reset counter after 3.5 seconds of inactivity\n      tapTimeoutRef.current = setTimeout(() => {\n        setMascotTaps(0);\n      }, 3500);\n    }\n  };\n\n  /**\n   * üéâ Easter Egg: Cleanup timeouts on unmount\n   */\n  useEffect(() => {\n    return () => {\n      if (tapTimeoutRef.current) {\n        clearTimeout(tapTimeoutRef.current);\n      }\n      if (sparkleTimeoutRef.current) {\n        clearTimeout(sparkleTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  /**\n   * Card gradients ‚Äî one per learning path (index-based)\n   * Order aligns with your 14 paths in progressStore.\n   */\n  const gradients = [\n    \"linear-gradient(145deg, #e8c87e, #d4a74f)\", // Names of Allah\n    \"linear-gradient(145deg, #2a5298, #1e3c72)\", // Foundations of Islam\n    \"linear-gradient(145deg, #ff758c, #ff7eb3)\", // Stories of Prophets\n    \"linear-gradient(145deg, #00a859, #004d26)\", // Life of Muhammad Ô∑∫\n    \"linear-gradient(145deg, #cc6600, #663300)\", // Wives of the Prophet Ô∑∫\n    \"linear-gradient(145deg, #d91e36, #60001a)\", // Ten Promised Jannah\n    \"linear-gradient(145deg, #9c27b0, #3e0069)\", // Four Greatest Women\n    \"linear-gradient(145deg, #26c6da, #004d66)\", // Stories of the Companions\n    \"linear-gradient(145deg, #ff9800, #7a3600)\", // Angels and Jinns\n    \"linear-gradient(145deg, #607d8b, #1a252f)\", // The End Times\n    \"linear-gradient(145deg, #6a11cb, #2575fc)\", // The Grave\n    \"linear-gradient(145deg, #2e8b57, #0d2614)\", // Day of Judgement\n    \"linear-gradient(145deg, #b31217, #240b36)\", // Hellfire\n    \"linear-gradient(145deg, #f7971e, #ffd200)\", // Paradise\n  ];\n\n  return (\n    <div\n      className=\"screen no-extra-space page-transition\"\n      style={{\n        background: \"#0e2340\",\n        color: \"white\",\n        overflowX: \"hidden\",\n        position: \"relative\",\n      }}\n    >\n      {/*\n       * ===============================================================\n       * HEADER BAR\n       * ===============================================================\n       */}\n      <div\n        style={{\n          display: \"grid\",\n          gridTemplateColumns: \"1fr auto 1fr\",\n          alignItems: \"center\",\n          marginBottom: 8,\n          columnGap: 8,\n          padding: \"12px 16px 0 16px\",\n        }}\n      >\n        {/* Left cluster: Streak + XP */}\n        <div style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n          {[\n            { icon: ui_streak, label: \"Streak\", value: streak },\n            { icon: ui_xp, label: \"XP\", value: xp },\n          ].map(({ icon, value }, i) => (\n            <div\n              key={i}\n              style={{\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                minWidth: 40,\n                position: \"relative\",\n              }}\n            >\n              <img\n                src={icon}\n                alt={i === 0 ? \"Streak\" : \"XP\"}\n                loading=\"eager\"\n                style={{ width: 40, height: 40 }}\n              />\n              <span\n                style={{\n                  marginTop: 4,\n                  fontSize: \"0.85rem\",\n                  fontWeight: 700,\n                  color: \"#ffd85a\",\n                  position: \"relative\",\n                }}\n              >\n                {typeof value === \"number\" ? value.toLocaleString() : value}\n                {/* üéâ Easter Egg: Sparkle animation on XP counter */}\n                {i === 1 && showSparkle && (\n                  <>\n                    <span\n                      style={{\n                        position: \"absolute\",\n                        top: \"50%\",\n                        left: \"50%\",\n                        transform: \"translate(-50%, -50%)\",\n                        fontSize: \"1.5rem\",\n                        animation: \"sparkle 0.5s ease-out\",\n                        pointerEvents: \"none\",\n                      }}\n                    >\n                      ‚ú®\n                    </span>\n                    <span\n                      style={{\n                        position: \"absolute\",\n                        top: \"-10px\",\n                        right: \"-10px\",\n                        fontSize: \"1rem\",\n                        animation: \"sparkle 0.5s ease-out 0.1s\",\n                        pointerEvents: \"none\",\n                      }}\n                    >\n                      ‚ú®\n                    </span>\n                    <span\n                      style={{\n                        position: \"absolute\",\n                        bottom: \"-10px\",\n                        left: \"-10px\",\n                        fontSize: \"1rem\",\n                        animation: \"sparkle 0.5s ease-out 0.2s\",\n                        pointerEvents: \"none\",\n                      }}\n                    >\n                      ‚ú®\n                    </span>\n                  </>\n                )}\n              </span>\n            </div>\n          ))}\n        </div>\n\n        {/* Center mascot */}\n        <div style={{ textAlign: \"center\" }}>\n          <img\n            src={MainMascot}\n            alt=\"Main Mascot\"\n            loading=\"eager\"\n            onClick={handleMascotTap}\n            style={{\n              width: 100,\n              height: 100,\n              display: \"block\",\n              margin: \"0 auto\",\n              willChange: \"transform\",\n              transform: \"translateZ(0)\",\n              cursor: \"pointer\",\n              userSelect: \"none\",\n              WebkitTapHighlightColor: \"transparent\",\n              outline: \"none\",\n            }}\n          />\n        </div>\n\n        {/* Right cluster: Coins + Shield */}\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"flex-end\",\n            gap: 12,\n          }}\n        >\n          {/* Coins */}\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"center\",\n            }}\n          >\n            <img src={ui_coin} alt=\"Coins\" loading=\"eager\" style={{ width: 40, height: 40 }} />\n            <span\n              style={{\n                marginTop: 4,\n                fontSize: \"0.75rem\",\n                fontWeight: 700,\n                color: \"gold\",\n              }}\n            >\n              {typeof coins === \"number\" ? coins.toLocaleString() : coins}\n            </span>\n          </div>\n\n          {/* Streak Freeze Shield */}\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"center\",\n            }}\n          >\n            <img\n              src={ui_shield}\n              alt=\"Shield\"\n              loading=\"eager\"\n              title=\"Streak Freeze\"\n              onClick={() => showModal(MODAL_TYPES.PURCHASE_STREAK_FREEZE)}\n              style={{\n                width: 44,\n                height: 44,\n                borderRadius: \"50%\",\n                border: \"2px solid gold\",\n                padding: 4,\n                background: \"rgba(0, 102, 204, 0.2)\",\n                boxShadow: \"0 0 14px rgba(255,215,0,0.7)\",\n                animation: \"shieldGlow 2.5s ease-in-out infinite alternate\",\n                cursor: \"pointer\",\n                transition: \"transform 0.15s ease\",\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.transform = \"scale(1.07)\";\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.transform = \"scale(1)\";\n              }}\n              onMouseDown={(e) => {\n                e.currentTarget.style.transform = \"scale(0.92)\";\n              }}\n              onMouseUp={(e) => {\n                e.currentTarget.style.transform = \"scale(1.07)\";\n              }}\n            />\n            <span\n              style={{\n                marginTop: 4,\n                fontSize: \"0.75rem\",\n                fontWeight: 700,\n                color: \"#4fd5ff\",\n                textShadow: \"0 2px 4px rgba(0,0,0,0.55)\",\n              }}\n            >\n              {shieldCount}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {/*\n       * ===============================================================\n       * TITLE + SMALL GREETING\n       * ===============================================================\n       */}\n      <div style={{ textAlign: \"center\", marginBottom: 6, padding: \"0 16px\" }}>\n        <h1\n          className=\"title-shimmer\"\n          style={{\n            willChange: \"transform\",\n            transform: \"translateZ(0)\",\n            fontFamily: \"'Hidayatullah', serif\",\n            fontSize: \"2.8rem\",\n            fontWeight: \"normal\",\n            letterSpacing: \"1px\",\n          }}\n        >\n          IslamQuest\n        </h1>\n      </div>\n\n      <p\n        style={{\n          textAlign: \"center\",\n          fontSize: \"1.15rem\",\n          margin: \"0 16px 24px 16px\",\n          fontWeight: \"800\",\n          color: \"#FFD700\",\n          textShadow: \"0 2px 8px rgba(212, 175, 55, 0.4)\",\n          letterSpacing: \"0.5px\",\n          fontFamily: \"'TT Chocolates', sans-serif\",\n        }}\n      >\n        Assalamu Alaikum, {name || \"Explorer\"} üëã\n      </p>\n\n      {/*\n       * ===============================================================\n       * DAILY QUEST CARD\n       * ===============================================================\n       */}\n      <div style={{ padding: \"0 16px\" }}>\n        <DailyQuestCard />\n      </div>\n\n      {/*\n       * ===============================================================\n       * LEARNING PATHS CAROUSEL\n       * ===============================================================\n       */}\n      <div style={{ position: \"relative\", padding: \"0 0 12px\" }}>\n        <div\n          ref={carouselRef}\n          style={{\n            display: \"flex\",\n            overflowX: \"auto\",\n            gap: 14,\n            paddingLeft: 16,\n            paddingRight: 16,\n            paddingBottom: 8,\n            scrollBehavior: \"smooth\",\n            scrollbarWidth: \"none\",\n            msOverflowStyle: \"none\",\n          }}\n          className=\"hide-scrollbar\"\n        >\n          {paths.map((p, index) => {\n            const gradient =\n              gradients[index] || gradients[index % gradients.length];\n            const progress = typeof p.progress === \"number\" ? p.progress : 0;\n            const percent = Math.min(100, Math.max(0, progress * 100));\n            const completed = p.completedLessons || 0;\n            const total = p.totalLessons || 0;\n            const isFull = total > 0 && completed >= total;\n            \n            // Check if path is premium-locked\n            const isPremiumPath = isPremiumOnlyPath(p.id);\n            const isLocked = isPremiumPath && !isUserPremium;\n\n            return (\n              <div\n                key={p.id}\n                onClick={() => handlePathClick(p)}\n                style={{\n                  minWidth: 160,\n                  height: 230,\n                  background: gradient,\n                  borderRadius: 18,\n                  position: \"relative\",\n                  color: \"#fff\",\n                  textAlign: \"center\",\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  justifyContent: \"center\",\n                  alignItems: \"center\",\n                  cursor: \"pointer\",\n                  transition: \"transform 0.2s\",\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.transform = \"scale(1.05)\";\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.transform = \"scale(1)\";\n                }}\n              >\n                {/* Grey lock overlay for premium-only paths */}\n                {isLocked && (\n                  <div\n                    style={{\n                      position: \"absolute\",\n                      top: 0,\n                      left: 0,\n                      right: 0,\n                      bottom: 0,\n                      background: \"rgba(30, 30, 30, 0.85)\",\n                      borderRadius: 18,\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      zIndex: 10,\n                      gap: 8,\n                    }}\n                  >\n                    <Lock \n                      size={32} \n                      color=\"#D4AF37\" \n                      strokeWidth={2.5}\n                      style={{ filter: \"drop-shadow(0 0 4px rgba(212,175,55,0.5))\" }}\n                    />\n                    <span\n                      style={{\n                        fontSize: \"0.75rem\",\n                        color: \"#D4AF37\",\n                        fontWeight: 700,\n                        textShadow: \"0 2px 4px rgba(0,0,0,0.5)\",\n                      }}\n                    >\n                      Premium Only\n                    </span>\n                  </div>\n                )}\n                {/* Title of the path */}\n                <h3\n                  style={{\n                    margin: \"10px 0 4px\",\n                    fontSize: \"1.05rem\",\n                  }}\n                >\n                  {p.title}\n                </h3>\n\n                {/* Gradient Progress Bar */}\n                <div\n                  style={{\n                    height: 10,\n                    width: \"65%\",\n                    background: \"#0a1a2f\",\n                    borderRadius: 10,\n                    overflow: \"hidden\",\n                    marginTop: 6,\n                    boxShadow: isFull\n                      ? \"0 0 16px rgba(255,215,0,0.6)\"\n                      : \"inset 0 0 4px rgba(255,255,255,0.3)\",\n                    animation: isFull\n                      ? \"barPulse 3s ease-in-out infinite\"\n                      : \"none\",\n                  }}\n                >\n                  <div\n                    style={{\n                      width: `${percent}%`,\n                      height: \"100%\",\n                      background: \"linear-gradient(90deg, #ffd85a, #ffb700)\",\n                      transition: \"width 0.3s ease\",\n                    }}\n                  />\n                </div>\n\n                {/* Lesson Counter */}\n                <div\n                  style={{\n                    fontSize: \"0.75rem\",\n                    color: \"#e8e8e8\",\n                    marginTop: 4,\n                    fontWeight: 600,\n                  }}\n                >\n                  {completed} / {total} Lessons\n                </div>\n\n                {/* Footprints badge, pulsing */}\n                <div\n                  style={{\n                    position: \"absolute\",\n                    bottom: 18,\n                    width: 38,\n                    height: 38,\n                    borderRadius: \"50%\",\n                    background: \"rgba(255,215,0,0.3)\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    animation: \"pawPulse 2.2s infinite ease-in-out\",\n                  }}\n                >\n                  <Footprints \n                    size={20} \n                    strokeWidth={2.5}\n                    color=\"#FFD700\"\n                    style={{ filter: \"drop-shadow(0 0 3px rgba(255,215,0,0.4))\" }}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/*\n       * ===============================================================\n       * PAGE DOTS\n       * ===============================================================\n       */}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          marginTop: 8,\n          marginBottom: 8,\n        }}\n      >\n        {[0, 1, 2].map((i) => (\n          <div\n            key={i}\n            onClick={() => goToPage(i)}\n            style={{\n              width: 8,\n              height: 8,\n              borderRadius: \"50%\",\n              background: i === page ? \"gold\" : \"#555\",\n              boxShadow: i === page ? \"0 0 10px gold\" : \"none\",\n              transform: i === page ? \"scale(1.2)\" : \"scale(1)\",\n              transition: \"all 0.25s ease\",\n              margin: \"0 6px\",\n              cursor: \"pointer\",\n            }}\n          />\n        ))}\n      </div>\n\n      {/*\n       * ===============================================================\n       * RAMADAN COUNTDOWN WIDGET (3-Segment Pill) / GLOBAL EVENTS\n       * ===============================================================\n       */}\n      <div\n        onClick={() => {\n          // Check if user has premium access before navigating to Global Events\n          if (!isUserPremium) {\n            showModal(MODAL_TYPES.PURCHASE);\n            return;\n          }\n          showModal(MODAL_TYPES.RAMADAN_COMING_SOON);\n        }}\n        style={{\n          margin: \"10px 16px 0 16px\",\n          background: \"#0a2a43\",\n          borderRadius: 22,\n          padding: \"14px 16px\",\n          border: \"1.5px solid rgba(255,215,0,0.35)\",\n          boxShadow: \"0 0 12px rgba(255,215,0,0.18)\",\n          cursor: \"pointer\",\n          animation: \"floatY 3.5s ease-in-out infinite\",\n          position: \"relative\",\n        }}\n      >\n        {/* Title */}\n        <div\n          style={{\n            textAlign: \"center\",\n            fontWeight: 700,\n            fontSize: \"0.95rem\",\n            color: \"#FFD700\",\n            marginBottom: 10,\n            letterSpacing: \"0.3px\",\n          }}\n        >\n          üåô Ramadan Countdown\n        </div>\n\n        {/* Segmented Pill Bar */}\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            gap: 8,\n          }}\n        >\n          {[\n            { value: ramadanStats.months, label: \"Months\" },\n            { value: ramadanStats.weeks, label: \"Weeks\" },\n            { value: ramadanStats.days, label: \"Days\" },\n          ].map((seg, i) => (\n            <div\n              key={i}\n              style={{\n                flex: 1,\n                background: \"rgba(255,215,0,0.08)\",\n                borderRadius: 16,\n                padding: \"10px 0\",\n                border: \"1px solid rgba(255,215,0,0.25)\",\n                boxShadow: \"0 0 8px rgba(255,215,0,0.12)\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: 2,\n              }}\n            >\n              <div\n                style={{\n                  fontSize: \"1.15rem\",\n                  fontWeight: 700,\n                  color: \"#FFD700\",\n                }}\n              >\n                {seg.value}\n              </div>\n              <div\n                style={{\n                  fontSize: \"0.7rem\",\n                  color: \"#d4d4d4\",\n                }}\n              >\n                {seg.label}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/*\n       * ===============================================================\n       * INLINE CSS (keyframes, shimmer, pulses, glow)\n       * ===============================================================\n       */}\n      <style>{`\n        .title-shimmer {\n          font-size: 1.8rem;\n          font-weight: 800;\n          margin: 0;\n          color: gold;\n        }\n\n        .page-transition {\n          animation: fadeSlideIn 520ms cubic-bezier(.16,.84,.44,1) both;\n        }\n\n        @keyframes floatY {\n          0%   { transform: translateY(0); }\n          50%  { transform: translateY(-3px); }\n          100% { transform: translateY(0); }\n        }\n\n        @keyframes fadeSlideIn {\n          from { opacity: 0; transform: translateY(12px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n\n        @keyframes sparkle {\n          0% {\n            opacity: 0;\n            transform: translate(-50%, -50%) scale(0.5);\n          }\n          50% {\n            opacity: 1;\n            transform: translate(-50%, -50%) scale(1.2);\n          }\n          100% {\n            opacity: 0;\n            transform: translate(-50%, -50%) scale(1);\n          }\n        }\n\n        @keyframes bounceYSmooth {\n          0% { transform: translateY(0) scale(1); }\n          25% { transform: translateY(-12px) scale(1.02); }\n          50% { transform: translateY(-6px) scale(1.01); }\n          75% { transform: translateY(-2px) scale(1.005); }\n          100% { transform: translateY(0) scale(1); }\n        }\n\n        @keyframes pawPulse {\n          0% { transform: scale(1); opacity: 0.9; }\n          50% { transform: scale(1.15); opacity: 1; }\n          100% { transform: scale(1); opacity: 0.9; }\n        }\n\n        @keyframes barPulse {\n          0% { box-shadow: 0 0 10px rgba(255,215,0,0.3); }\n          50% { box-shadow: 0 0 22px rgba(255,215,0,0.8); }\n          100% { box-shadow: 0 0 10px rgba(255,215,0,0.3); }\n        }\n\n        @keyframes shieldGlow {\n          0% { box-shadow: 0 0 14px rgba(255,215,0,0.6); }\n          100% { box-shadow: 0 0 24px rgba(255,215,0,0.9); }\n        }\n\n        .hide-scrollbar::-webkit-scrollbar {\n          display: none;\n        }\n        .hide-scrollbar {\n          -ms-overflow-style: none;\n          scrollbar-width: none;\n        }\n        \n        ::-webkit-scrollbar { height: 6px; }\n        ::-webkit-scrollbar-thumb {\n          background: rgba(255,215,0,0.6);\n          border-radius: 3px;\n        }\n        ::-webkit-scrollbar-track {\n          background: rgba(255,255,255,0.05);\n        }\n\n        html, body, * {\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n          text-rendering: geometricPrecision;\n        }\n\n        * {\n          image-rendering: -webkit-optimize-contrast;\n          backface-visibility: hidden;\n        }\n      `}</style>\n    </div>\n  );\n}\n","path":null,"size_bytes":29015,"size_tokens":null},"src/onboarding/SalaamScreen.jsx":{"content":"import React, { useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport zayd from \"../assets/mascots/mascot_onboarding.webp\";\n\nexport default function SalaamScreen() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"salaam\");\n  }, []);\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: 24,\n        paddingRight: 24,\n        paddingTop: 24,\n      }}\n    >\n      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ duration: 0.8 }}>\n        <h2 style={{ fontFamily: \"Amiri, serif\", color: \"#D4AF37\", fontSize: \"1.5rem\" }}>\n          ÿßŸÑÿ≥ŸÑÿßŸÖ ÿπŸÑŸäŸÉŸÖ Ÿàÿ±ÿ≠ŸÖÿ© ÿßŸÑŸÑŸá Ÿàÿ®ÿ±ŸÉÿßÿ™Ÿá\n        </h2>\n        <p style={{ marginTop: 10, color: \"#e5e5e5\" }}>\n          Peace be upon you and the mercy of Allah and His blessings\n        </p>\n        <p style={{ marginTop: 6, color: \"#cfcfcf\" }}>Welcome to your journey of sacred knowledge.</p>\n\n        <img\n          src={zayd}\n          alt=\"Zayd mascot\"\n          style={{ marginTop: 28, width: 160, height: \"auto\", objectFit: \"contain\" }}\n        />\n\n        <button\n          onClick={() => navigate(\"/onboarding/auth-choice\")}\n          style={{\n            marginTop: 28,\n            background: \"#D4AF37\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: 10,\n            padding: \"12px 36px\",\n            fontWeight: 600,\n            fontSize: \"1rem\",\n            cursor: \"pointer\",\n          }}\n        >\n          Continue\n        </button>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1914,"size_tokens":null},"README.md":{"content":"## Running React on Replit\n\n[React](https://reactjs.org/) is a popular JavaScript library for building user interfaces.\n\n[Vite](https://vitejs.dev/) is a blazing fast frontend build tool that includes features like Hot Module Reloading (HMR), optimized builds, and TypeScript support out of the box.\n\nUsing the two in conjunction is one of the fastest ways to build a web app.\n\n### Getting Started\n- Hit run\n- Edit [App.jsx](#src/App.jsx) and watch it live update!\n\nBy default, Replit runs the `dev` script, but you can configure it by changing the `run` field in the [configuration file](#.replit). Here are the vite docs for [serving production websites](https://vitejs.dev/guide/build.html)\n\n### Typescript\n\nJust rename any file from `.jsx` to `.tsx`. You can also try our [TypeScript Template](https://replit.com/@replit/React-TypeScript)","path":null,"size_bytes":842,"size_tokens":null},"vite.config.js":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\n\nexport default defineConfig({\n  plugins: [react()],\n  resolve: {\n    alias: {\n      '@assets': path.resolve(__dirname, './src/assets'),\n    },\n  },\n  server: {\n    host: '0.0.0.0',\n    port: 5000,\n    allowedHosts: true,\n    headers: {\n      'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate',\n      'Pragma': 'no-cache',\n      'Expires': '0'\n    }\n  },\n  build: {\n    sourcemap: false,\n    minify: 'terser',\n    terserOptions: {\n      compress: {\n        drop_console: true,\n        drop_debugger: true\n      }\n    },\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          vendor: ['react', 'react-dom', 'react-router-dom'],\n          supabase: ['@supabase/supabase-js'],\n          animations: ['framer-motion'],\n        }\n      }\n    }\n  }\n});\n","path":null,"size_bytes":889,"size_tokens":null},"src/pages/Lesson.jsx":{"content":"import React, { useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { getLessonsForPath } from \"../data/lessonLoader\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useVibration } from \"../hooks/useVibration\";\nimport zaydTeachingMascot from \"../assets/mascots/mascot_sitting.webp\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { logLessonStart, logLessonExit } from \"../backend/lessonProgress\";\n\nexport default function Lesson() {\n  const { pathId, lessonId } = useParams();\n  const navigate = useNavigate();\n  const { getLessonLockState } = useProgressStore();\n  const { vibrate } = useVibration();\n\n  // Get lessons for the current path\n  const pathLessons = getLessonsForPath(pathId);\n  \n  // Find the lesson by ID\n  const lesson = pathLessons.find(\n    (l) => l.id === parseInt(lessonId, 10)\n  );\n\n  useEffect(() => {\n    let userIdRef = null;\n    const numericPathId = parseInt(pathId, 10);\n\n    const loadUser = async () => {\n      const { data } = await supabase.auth.getUser();\n      userIdRef = data?.user?.id;\n      if (userIdRef && lesson?.id && numericPathId) {\n        logLessonStart(userIdRef, numericPathId, lesson.id);\n      }\n    };\n\n    loadUser();\n\n    return () => {\n      if (userIdRef && lesson?.id && numericPathId) {\n        logLessonExit(userIdRef, numericPathId, lesson.id);\n      }\n    };\n  }, [lesson, pathId]);\n\n  // üîí PREMIUM GUARD: Block direct URL access to premium-locked lessons\n  useEffect(() => {\n    if (!pathId || !lessonId) return;\n    \n    const numericPathId = parseInt(pathId, 10);\n    const numericLessonId = parseInt(lessonId, 10);\n    \n    // Check the specific lock state\n    const lockState = getLessonLockState(numericPathId, numericLessonId);\n    \n    // Only redirect to premium for actual premium locks\n    // For progress locks, let the normal flow handle it (user stays on path view)\n    if (lockState === \"premiumLocked\") {\n      navigate(\"/premium\", { replace: true });\n    } else if (lockState === \"progressLocked\") {\n      // Redirect back to path view for normal progression locks\n      navigate(`/path/${numericPathId}`, { replace: true });\n    }\n  }, [pathId, lessonId, getLessonLockState, navigate]);\n\n  function handleBack() {\n    if (pathId) navigate(`/path/${pathId}`);\n    else navigate(-1);\n  }\n\n  // Wire exit confirmation when navigating away from lesson\n  function handleExit() {\n    const { showModal, MODAL_TYPES } = require(\"../store/modalStore\");\n    const { useModalStore } = require(\"../store/modalStore\");\n    const store = useModalStore.getState();\n    store.showModal(\"EXIT_CONFIRMATION\", {\n      onConfirm: () => handleBack()\n    });\n  }\n\n  if (!lesson) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background:\n            \"radial-gradient(circle at 20% 20%, #1a2337 0%, #000814 70%)\",\n          color: \"white\",\n          paddingLeft: \"24px\",\n          paddingRight: \"24px\",\n          paddingTop: \"24px\",\n          textAlign: \"center\",\n        }}\n      >\n        <button\n          onClick={handleBack}\n          style={{\n            appearance: \"none\",\n            background: \"rgba(255,255,255,0.07)\",\n            border: \"1px solid rgba(255,255,255,0.18)\",\n            color: \"white\",\n            fontSize: \"0.8rem\",\n            borderRadius: \"10px\",\n            padding: \"8px 10px\",\n            marginBottom: \"20px\",\n          }}\n        >\n          ‚Üê Back\n        </button>\n        <div\n          style={{\n            fontSize: \"1rem\",\n            fontWeight: 600,\n            background:\n              \"linear-gradient(90deg,#fff 0%,#fff6d2 40%,#ffd88a 100%)\",\n            WebkitBackgroundClip: \"text\",\n            color: \"transparent\",\n          }}\n        >\n          Lesson not found\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background:\n          \"radial-gradient(circle at 20% 20%, #1a2337 0%, #000814 70%)\",\n        color: \"white\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n        paddingTop: \"20px\",\n        maxWidth: \"480px\",\n        margin: \"0 auto\",\n        position: \"relative\",\n      }}\n    >\n      {/* Mascot top-right */}\n      <img\n        src={zaydTeachingMascot}\n        alt=\"Zayd teaching\"\n        style={{\n          position: \"absolute\",\n          top: \"16px\",\n          right: \"16px\",\n          width: \"72px\",\n          height: \"72px\",\n          objectFit: \"contain\",\n          borderRadius: \"50%\",\n          boxShadow: \"0 0 20px rgba(255, 216, 138, 0.5)\",\n          background: \"rgba(255,255,255,0.05)\",\n        }}\n      />\n\n      {/* Arabic name */}\n      <div\n        style={{\n          fontSize: \"clamp(1.4rem, 5vw, 1.9rem)\",\n          fontWeight: 700,\n          color: \"#ffe99a\",\n          textAlign: \"center\",\n          textShadow: \"0 0 12px rgba(255,215,0,0.4)\",\n          marginTop: \"100px\",\n          marginBottom: \"8px\",\n        }}\n      >\n        {lesson.arabic}\n      </div>\n\n      {/* English title */}\n      <div\n        style={{\n          fontSize: \"clamp(1rem, 3vw, 1.2rem)\",\n          fontWeight: 600,\n          textAlign: \"center\",\n          color: \"white\",\n          marginBottom: \"4px\",\n        }}\n      >\n        {lesson.title}\n      </div>\n\n      {/* Meaning - Only show for Names of Allah (pathId 1) */}\n      {pathId === \"1\" && lesson.meaning && (\n        <div\n          style={{\n            fontSize: \"0.9rem\",\n            color: \"#ffd85a\",\n            textAlign: \"center\",\n            marginBottom: \"16px\",\n          }}\n        >\n          {lesson.meaning}\n        </div>\n      )}\n\n      {/* Description */}\n      <div\n        style={{\n          fontSize: \"0.9rem\",\n          color: \"#d0d4e4\",\n          lineHeight: 1.6,\n          background: \"rgba(255,255,255,0.03)\",\n          border: \"1px solid rgba(255,255,255,0.1)\",\n          borderRadius: \"14px\",\n          padding: \"16px\",\n          marginBottom: \"16px\",\n          wordWrap: \"break-word\",\n          overflowWrap: \"break-word\",\n          wordBreak: \"break-word\",\n        }}\n      >\n        {lesson.description?.map((para, i) => (\n          <p key={i} style={{ \n            marginBottom: \"12px\",\n            wordWrap: \"break-word\",\n            overflowWrap: \"break-word\",\n            wordBreak: \"break-word\",\n            hyphens: \"auto\",\n            overflow: \"hidden\",\n          }}>\n            {para}\n          </p>\n        ))}\n        \n        {/* Content fallback for any lessons using old format */}\n        {!lesson.description && lesson.content && (\n          <div style={{ whiteSpace: \"pre-line\" }}>{lesson.content}</div>\n        )}\n      </div>\n\n      {/* Evidence Block - For Foundations path */}\n      {lesson.evidence && (\n        <div\n          style={{\n            background: \"linear-gradient(135deg, rgba(212,175,55,0.1) 0%, rgba(16,185,129,0.05) 100%)\",\n            border: \"1px solid rgba(212,175,55,0.3)\",\n            borderRadius: \"14px\",\n            padding: \"16px\",\n            marginBottom: \"16px\",\n          }}\n        >\n          <div\n            style={{\n              fontSize: \"1.1rem\",\n              fontWeight: 600,\n              color: \"#D4AF37\",\n              textAlign: \"center\",\n              marginBottom: \"12px\",\n              fontFamily: \"serif\",\n            }}\n          >\n            {lesson.evidence.arabic}\n          </div>\n          <div\n            style={{\n              fontSize: \"0.85rem\",\n              color: \"#d0d4e4\",\n              textAlign: \"center\",\n              fontStyle: \"italic\",\n              marginBottom: \"6px\",\n            }}\n          >\n            {lesson.evidence.translation}\n          </div>\n          <div\n            style={{\n              fontSize: \"0.75rem\",\n              color: \"#ffd85a\",\n              textAlign: \"center\",\n              fontWeight: 500,\n            }}\n          >\n            ‚Äî {lesson.evidence.source}\n          </div>\n        </div>\n      )}\n\n      {/* Reflection */}\n      <div\n        style={{\n          fontWeight: 700,\n          color: \"#ffd85a\",\n          textAlign: \"center\",\n          marginBottom: \"20px\",\n        }}\n      >\n        {lesson.reflection}\n      </div>\n\n      {/* Back + Quiz buttons */}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          gap: \"12px\",\n          marginTop: \"8px\",\n        }}\n      >\n        <button\n          onClick={() => {\n            vibrate(50);\n            handleBack();\n          }}\n          style={{\n            flex: 1,\n            background:\n              \"linear-gradient(135deg,rgba(255,255,255,0.12) 0%,rgba(255,255,255,0) 60%)\",\n            border: \"1px solid rgba(255,255,255,0.2)\",\n            color: \"white\",\n            borderRadius: \"12px\",\n            padding: \"12px\",\n            fontSize: \"0.8rem\",\n            fontWeight: 500,\n          }}\n        >\n          ‚Üê Back\n        </button>\n\n        <button\n          onClick={() => {\n            vibrate(50);\n            navigate(`/path/${pathId}/quiz/${lessonId}`);\n          }}\n          style={{\n            flex: 1,\n            backgroundColor: \"#ffd88a\",\n            color: \"#000814\",\n            border: \"1px solid rgba(255,255,255,0.2)\",\n            borderRadius: \"12px\",\n            padding: \"12px\",\n            fontSize: \"0.8rem\",\n            fontWeight: 600,\n            boxShadow:\n              \"0 12px 25px rgba(0,0,0,0.7), 0 0 30px rgba(255,235,167,0.4) inset\",\n          }}\n        >\n          Test My Knowledge üåü\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9594,"size_tokens":null},"src/screens/Pathway.jsx":{"content":"import React, { useEffect, useMemo, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { getAvatarImage } from \"../utils/avatarUtils\";\nimport { Lock, Crown } from \"lucide-react\";\nimport { isPremiumOnlyPath, FREE_LESSON_LIMITS } from \"../store/premiumConfig\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\n\n// Lesson data loader\nimport { getLessonsForPath } from \"../data/lessonLoader.js\";\n\n// Mascots\nimport CompletionMascot from \"../assets/mascots/mascot_welldone.webp\";\nimport mascot_sitting from \"../assets/mascots/mascot_sitting.webp\";\n\nexport default function Pathway() {\n  const { pathId } = useParams();\n  const navigate = useNavigate();\n  const scrollRef = useRef(null);\n  const numericPathId = Number(pathId);\n  const [showCompletion, setShowCompletion] = React.useState(false);\n\n  const { paths, lessonStates, canAccessLesson, premium, premiumStatus } = useProgressStore();\n  const { id: userId, avatar } = useUserStore();\n  const { showModal } = useModalStore();\n  \n  const isUserPremium = premium || premiumStatus !== \"free\";\n  const isPathPremiumOnly = isPremiumOnlyPath(numericPathId);\n\n  // Check if all lessons are completed\n  React.useEffect(() => {\n    const baseLessons = getLessonsForPath(numericPathId);\n    const pathLessonState = lessonStates?.[numericPathId] || {};\n    const allCompleted = baseLessons.length > 0 && \n      baseLessons.every(lesson => !!pathLessonState[lesson.id]?.passed);\n    \n    if (allCompleted && baseLessons.length > 0) {\n      setShowCompletion(true);\n    }\n  }, [numericPathId, lessonStates]);\n\n  const pathMeta = useMemo(\n    () => paths.find((p) => p.id === numericPathId),\n    [paths, numericPathId]\n  );\n\n  const baseLessons = useMemo(() => {\n    return getLessonsForPath(numericPathId);\n  }, [numericPathId]);\n\n  // Fallback if path/lessons not wired yet\n  if (!pathMeta || baseLessons.length === 0) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"linear-gradient(to bottom, #061326, #000814 80%)\",\n          color: \"white\",\n          padding: \"32px 20px\",\n          textAlign: \"center\",\n        }}\n      >\n        <button onClick={() => navigate(\"/\")} style={backButtonStyle}>\n          ‚Üê Back\n        </button>\n        <h2 style={{ marginTop: 24, fontSize: \"1.2rem\", color: \"#ffd85a\" }}>\n          Path not ready yet\n        </h2>\n      </div>\n    );\n  }\n\n  // Build lesson states (completed / locked)\n  // üîí Using NEW unified locking system via canAccessLesson()\n  const pathLessonState = lessonStates?.[numericPathId] || {};\n  const lessons = baseLessons.map((lesson) => {\n    const isCompleted = !!pathLessonState[lesson.id]?.passed;\n    // Use the NEW canAccessLesson function from unified locking system\n    const unlocked = canAccessLesson(numericPathId, lesson.id);\n    const isLocked = !unlocked;\n\n    return { ...lesson, isCompleted, isLocked };\n  });\n\n  // Active node = first not completed & not locked\n  // If all remaining lessons are premium-locked, stay at the last completed lesson\n  let activeIndex = lessons.findIndex((l) => !l.isCompleted && !l.isLocked);\n  if (activeIndex === -1) {\n    // Find the last completed lesson\n    const lastCompletedIndex = lessons.map((l, i) => l.isCompleted ? i : -1).filter(i => i !== -1).pop();\n    activeIndex = lastCompletedIndex !== undefined ? lastCompletedIndex : 0;\n  }\n\n  const completedCount = lessons.filter((l) => l.isCompleted).length;\n  const totalLessons = lessons.length;\n\n  // Always start view at top when entering\n  useEffect(() => {\n    const el = scrollRef.current;\n    if (!el) return;\n    const handle = setTimeout(() => {\n      el.scrollTop = 0;\n    }, 200);\n    return () => clearTimeout(handle);\n  }, [numericPathId, totalLessons]);\n\n  const handleLessonClick = (lesson) => {\n    console.log('üéØ Lesson clicked:', lesson.id, 'locked:', lesson.isLocked);\n    \n    // FIRST: Check premium paywall (even for sequentially unlocked lessons)\n    const freeLimit = FREE_LESSON_LIMITS[numericPathId] || 0;\n    if (!isUserPremium && lesson.id > freeLimit) {\n      console.log('üîí Premium paywall triggered - showing modal');\n      showModal(MODAL_TYPES.PURCHASE);\n      return;\n    }\n    \n    // Block access to premium-only paths for free users (lesson 1 of premium paths)\n    if (isPathPremiumOnly && !isUserPremium) {\n      console.log('üîí Premium-only path - showing modal');\n      showModal(MODAL_TYPES.PURCHASE);\n      return;\n    }\n    \n    // SECOND: Check sequential lock (must complete previous lesson)\n    if (lesson.isLocked) {\n      console.log('‚è≥ Sequential lock - must complete previous lesson');\n      return;\n    }\n    \n    // All checks passed - navigate\n    console.log('‚úÖ Navigating to lesson');\n    navigate(`/path/${pathId}/lesson/${lesson.id}`);\n  };\n\n  // Get the correct avatar image from the stored key - always use the user's selected avatar\n  const avatarSrc = getAvatarImage(avatar, { userId });\n\n  // If all lessons completed, show completion screen\n  if (showCompletion && completedCount === totalLessons && totalLessons > 0) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"radial-gradient(circle at top, #0f2344 0%, #020815 70%)\",\n          color: \"white\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          padding: \"40px 20px\",\n          textAlign: \"center\",\n          minHeight: \"100vh\",\n          gap: \"20px\",\n        }}\n      >\n        <img\n          src={CompletionMascot}\n          alt=\"Completed\"\n          style={{\n            width: 120,\n            height: \"auto\",\n            filter: \"drop-shadow(0 0 12px rgba(255,215,0,0.8))\",\n            animation: \"bounce 1s ease-in-out infinite\",\n          }}\n        />\n\n        <h1\n          style={{\n            fontSize: \"2.2rem\",\n            fontWeight: 800,\n            background: \"linear-gradient(90deg, #10b981, #D4AF37)\",\n            WebkitBackgroundClip: \"text\",\n            WebkitTextFillColor: \"transparent\",\n            margin: \"20px 0 0\",\n          }}\n        >\n          Path Completed! üéâ\n        </h1>\n\n        <p\n          style={{\n            fontSize: \"1.1rem\",\n            color: \"rgba(255,255,255,0.9)\",\n            maxWidth: 320,\n            lineHeight: 1.5,\n          }}\n        >\n          masha'Allah! You have mastered all lessons in this path.\n        </p>\n\n        <button\n          onClick={() => navigate(\"/\")}\n          style={{\n            marginTop: 20,\n            background: \"linear-gradient(135deg, #D4AF37, #FFA500)\",\n            color: \"#0a2a43\",\n            border: \"none\",\n            padding: \"14px 32px\",\n            borderRadius: \"12px\",\n            fontSize: \"1rem\",\n            fontWeight: \"700\",\n            cursor: \"pointer\",\n            boxShadow: \"0 6px 20px rgba(212, 175, 55, 0.4)\",\n            transition: \"all 0.3s\",\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.transform = \"translateY(-2px)\";\n            e.currentTarget.style.boxShadow = \"0 8px 25px rgba(212, 175, 55, 0.6)\";\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.transform = \"translateY(0)\";\n            e.currentTarget.style.boxShadow = \"0 6px 20px rgba(212, 175, 55, 0.4)\";\n          }}\n        >\n          Back to Home üè°\n        </button>\n\n        <style>{`\n          @keyframes bounce {\n            0%, 100% { transform: translateY(0); }\n            50% { transform: translateY(-15px); }\n          }\n        `}</style>\n      </div>\n    );\n  }\n\n  // --- Layout constants for perfect alignment ---\n  const NODE_SIZE = 70;\n  const FIRST_NODE_TOP = 20;\n  const NODE_SPACING = 120;\n\n  const lineTop = FIRST_NODE_TOP + NODE_SIZE / 2;\n  const lineBottom =\n    FIRST_NODE_TOP + NODE_SPACING * Math.max(lessons.length - 1, 0) + NODE_SIZE / 2;\n  const lineHeight = Math.max(lineBottom - lineTop, 0);\n  const containerHeight =\n    FIRST_NODE_TOP + NODE_SPACING * Math.max(lessons.length - 1, 0) + NODE_SIZE + 80;\n\n  return (\n    <div\n      ref={scrollRef}\n      className=\"screen no-extra-space\"\n      style={{\n        overflowY: \"auto\",\n        background: \"radial-gradient(circle at top, #0f2344 0%, #020815 70%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        paddingLeft: \"16px\",\n        paddingRight: \"16px\",\n        paddingTop: \"0\",\n        boxSizing: \"border-box\",\n        position: \"relative\",\n      }}\n    >\n      {/* Premium Overlay for paths 11-14 */}\n      {isPathPremiumOnly && !isUserPremium && (\n        <div\n          onClick={() => navigate(\"/premium\")}\n          style={{\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            background: \"rgba(0, 0, 0, 0.85)\",\n            backdropFilter: \"blur(8px)\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            zIndex: 1000,\n            cursor: \"pointer\",\n            padding: \"32px\",\n            textAlign: \"center\",\n          }}\n        >\n          <div\n            style={{\n              width: \"80px\",\n              height: \"80px\",\n              borderRadius: \"50%\",\n              background: \"linear-gradient(135deg, #D4AF37, #FFA500)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              marginBottom: \"24px\",\n              boxShadow: \"0 8px 32px rgba(212, 175, 55, 0.4)\",\n            }}\n          >\n            <Lock size={40} color=\"white\" />\n          </div>\n          \n          <h2\n            style={{\n              fontSize: \"1.8rem\",\n              fontWeight: 800,\n              marginBottom: \"12px\",\n              background: \"linear-gradient(90deg, #D4AF37, #FFA500)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n            }}\n          >\n            Premium Path üëë\n          </h2>\n          \n          <p\n            style={{\n              fontSize: \"1rem\",\n              color: \"rgba(255, 255, 255, 0.85)\",\n              maxWidth: \"350px\",\n              lineHeight: 1.6,\n              marginBottom: \"8px\",\n            }}\n          >\n            This path is part of Islam Quest Premium\n          </p>\n          \n          <p\n            style={{\n              fontSize: \"0.9rem\",\n              color: \"rgba(255, 255, 255, 0.65)\",\n              maxWidth: \"320px\",\n              marginBottom: \"32px\",\n            }}\n          >\n            Unlock all 14 paths and compete in global events\n          </p>\n          \n          <div\n            style={{\n              background: \"linear-gradient(135deg, #D4AF37, #FFA500)\",\n              color: \"white\",\n              padding: \"16px 40px\",\n              borderRadius: \"12px\",\n              fontSize: \"1.1rem\",\n              fontWeight: 700,\n              boxShadow: \"0 6px 24px rgba(212, 175, 55, 0.5)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: \"8px\",\n            }}\n          >\n            <Crown size={24} />\n            Unlock Premium\n          </div>\n          \n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              navigate(\"/\");\n            }}\n            style={{\n              marginTop: \"24px\",\n              background: \"transparent\",\n              border: \"2px solid rgba(255, 255, 255, 0.3)\",\n              color: \"white\",\n              padding: \"10px 24px\",\n              borderRadius: \"8px\",\n              fontSize: \"0.95rem\",\n              fontWeight: 600,\n              cursor: \"pointer\",\n            }}\n          >\n            Back to Home\n          </button>\n        </div>\n      )}\n      \n      {/* Header */}\n      <div\n        style={{\n          textAlign: \"center\",\n          marginTop: 20,\n          marginBottom: 16,\n          lineHeight: 1.3,\n        }}\n      >\n        <h2\n          style={{\n            fontSize: \"1.45rem\",\n            fontWeight: 700,\n            background:\n              \"linear-gradient(90deg,#fff6d2 0%,#ffd85a 50%,#ffe99a 100%)\",\n            WebkitBackgroundClip: \"text\",\n            color: \"transparent\",\n            marginBottom: 6,\n          }}\n        >\n          {pathMeta.title}\n        </h2>\n        <div style={{ fontSize: \"0.85rem\", color: \"#d0d4e4\" }}>\n          {completedCount} of {totalLessons} lessons completed\n        </div>\n      </div>\n\n      {/* User Avatar + message */}\n      <div\n        style={{\n          position: \"absolute\",\n          top: 180,\n          left: \"max(5%, calc(50% - 210px))\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          gap: 6,\n        }}\n      >\n        <img\n          src={mascot_sitting}\n          alt=\"Learning guide\"\n          style={{\n            width: 70,\n            height: \"auto\",\n            filter: \"drop-shadow(0 0 8px rgba(255,215,0,0.6))\",\n          }}\n        />\n        <div\n          style={{\n            maxWidth: 120,\n            fontSize: \"0.7rem\",\n            color: \"#fff8d6\",\n            textAlign: \"center\",\n            background: \"rgba(0,0,0,0.6)\",\n            padding: \"4px 8px\",\n            borderRadius: 8,\n            border: \"1px solid rgba(255,215,0,0.25)\",\n            wordWrap: \"break-word\",\n            whiteSpace: \"normal\",\n          }}\n        >\n          {numericPathId === 1\n            ? \"Assalamu Alaikum wa Rahmatullah, We find the name... üåô\"\n            : numericPathId === 2 \n            ? \"Let's strengthen your faith together üí™\"\n            : numericPathId === 3\n            ? \"Let's journey through the lives of the Prophets üåô\"\n            : numericPathId === 4\n            ? \"Let's follow the footsteps of the Prophet Ô∑∫ üåô\"\n            : numericPathId === 5\n            ? \"Meet the noble Mothers of the Believers üå∏\"\n            : numericPathId === 6\n            ? \"Learn from the heroes promised Paradise üïäÔ∏è\"\n            : numericPathId === 7\n            ? \"Celebrate the four greatest women in Islam ‚ú®\"\n            : numericPathId === 8\n            ? \"Discover the greatest Companions of the Prophet Ô∑∫ ‚≠ê\"\n            : numericPathId === 9\n            ? \"Meet the noble Angels of Allah ‚ú®\"\n            : numericPathId === 10\n            ? \"Prepare for the Signs of the Hour ‚è≥\"\n            : numericPathId === 11\n            ? \"Understand the journey of the Grave üïäÔ∏è\"\n            : numericPathId === 12\n            ? \"Prepare for the Day of Reckoning ‚öñÔ∏è\"\n            : numericPathId === 13\n            ? \"Learn about the Fire and seek protection üî•\"\n            : numericPathId === 14\n            ? \"Dream of eternal bliss in Paradise üå∫\"\n            : \"Begin your journey of knowledge üìñ\"}\n        </div>\n      </div>\n\n      {/* Lessons container */}\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: 480,\n          position: \"relative\",\n          height: containerHeight,\n          marginTop: 10,\n        }}\n      >\n        {/* Lesson nodes + titles */}\n        {lessons.map((lesson, i) => {\n          const isActive = i === activeIndex;\n          const top = FIRST_NODE_TOP + i * NODE_SPACING;\n\n          // Section headers for Foundations of Islam (pathId 2), Stories of Prophets (pathId 3), and Prophet's Life (pathId 4)\n          let sectionHeaders = {};\n          if (numericPathId === 2) {\n            sectionHeaders = {\n              1: \"The Five Pillars of Islam\",\n              6: \"The Six Pillars of Belief (ƒ™mƒÅn)\",\n              12: \"Living Islam\"\n            };\n          } else if (numericPathId === 3) {\n            sectionHeaders = {\n              1: \"Early Prophets\",\n              18: \"Prophets of Bani Isra'il\",\n              42: \"Prophets Before 'ƒ™sƒÅ\"\n            };\n          } else if (numericPathId === 4) {\n            sectionHeaders = {\n              13: \"Makkah Period\",\n              41: \"Madinah Period\",\n              71: \"Final Years\"\n            };\n          }\n          const showSectionHeader = (numericPathId === 2 || numericPathId === 3 || numericPathId === 4) && sectionHeaders[lesson.id];\n\n          return (\n            <React.Fragment key={lesson.id}>\n              {/* Section Header (Foundations and Prophets paths) */}\n              {showSectionHeader && (\n                <div\n                  style={{\n                    position: \"absolute\",\n                    top: top - 40,\n                    left: \"calc(50% - 80px)\",\n                    color: \"#D4AF37\",\n                    fontSize: \"0.95rem\",\n                    fontWeight: 700,\n                    textAlign: \"left\",\n                    letterSpacing: \"0.5px\",\n                    textTransform: \"uppercase\",\n                    textShadow: \"0 0 10px rgba(212,175,55,0.5)\",\n                    pointerEvents: \"none\",\n                    zIndex: 3,\n                  }}\n                >\n                  {sectionHeaders[lesson.id]}\n                </div>\n              )}\n\n              <div>\n              {/* Node */}\n              <div\n                onClick={() => handleLessonClick(lesson)}\n                style={{\n                  position: \"absolute\",\n                  top,\n                  left: \"50%\",\n                  transform: \"translateX(-50%)\",\n                  width: NODE_SIZE,\n                  height: NODE_SIZE,\n                  borderRadius: \"50%\",\n                  background: getNodeBackground(lesson, isActive),\n                  boxShadow: getNodeShadow(lesson, isActive),\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  cursor: lesson.isLocked ? \"default\" : \"pointer\",\n                  border: isActive\n                    ? \"2px solid rgba(255,215,0,0.85)\"\n                    : \"1px solid rgba(255,255,255,0.15)\",\n                  animation: isActive ? \"pulseGlow 2s infinite ease-in-out\" : \"none\",\n                  zIndex: 2,\n                }}\n              >\n                {isActive ? (\n                  <img\n                    src={avatarSrc}\n                    alt=\"avatar\"\n                    style={{\n                      width: \"85%\",\n                      height: \"85%\",\n                      borderRadius: \"50%\",\n                      objectFit: \"contain\",\n                    }}\n                  />\n                ) : (\n                  <span\n                    style={{\n                      fontWeight: 700,\n                      color: lesson.isLocked ? \"#666\" : \"#fff\",\n                      fontSize: \"1rem\",\n                    }}\n                  >\n                    {lesson.id}\n                  </span>\n                )}\n\n                {lesson.isLocked && (\n                  <span\n                    style={{\n                      position: \"absolute\",\n                      fontSize: \"1.4rem\",\n                      color: \"rgba(255,255,255,0.85)\",\n                      pointerEvents: \"none\",\n                    }}\n                  >\n                    üîí\n                  </span>\n                )}\n              </div>\n\n              {/* Title + meaning */}\n              <div\n                style={{\n                  position: \"absolute\",\n                  top: top + NODE_SIZE / 2 - 10,\n                  left: \"calc(50% + 55px)\",\n                  transform: \"translateY(-50%)\",\n                  textAlign: \"left\",\n                  color: \"#fff\",\n                  fontSize: \"0.9rem\",\n                  lineHeight: 1.4,\n                  whiteSpace: \"normal\",\n                  maxWidth: \"calc(50vw - 85px)\",\n                  wordWrap: \"break-word\",\n                }}\n              >\n                <div\n                  style={{\n                    fontWeight: 600,\n                    color: lesson.isCompleted\n                      ? \"#9bf6ff\"\n                      : isActive\n                      ? \"#ffe99a\"\n                      : \"#e2e2e2\",\n                  }}\n                >\n                  {shortenTitleEnglish(lesson.title)}\n                </div>\n\n                {/* NEW: English meaning line (hidden for paths 2-6) */}\n                {numericPathId !== 2 && numericPathId !== 3 && numericPathId !== 4 && numericPathId !== 5 && numericPathId !== 6 && lesson.meaning && (\n                  <div style={{ fontSize: \"0.75rem\", color: \"#ccc\" }}>\n                    {lesson.meaning}\n                  </div>\n                )}\n\n                {lesson.isCompleted && (\n                  <div style={{ fontSize: \"0.7rem\", color: \"#7cffc4\" }}>\n                    Completed ‚úÖ\n                  </div>\n                )}\n\n                {isActive && !lesson.isLocked && (\n                  <div style={{ fontSize: \"0.7rem\", color: \"#ffd85a\" }}>\n                    This is your next step ‚≠ê\n                  </div>\n                )}\n              </div>\n            </div>\n            </React.Fragment>\n          );\n        })}\n      </div>\n\n      <style>{`\n        @keyframes pulseGlow {\n          0% { box-shadow: 0 0 10px rgba(255, 232, 150, 0.3); }\n          50% { box-shadow: 0 0 25px rgba(255, 232, 150, 0.8); }\n          100% { box-shadow: 0 0 10px rgba(255, 232, 150, 0.3); }\n        }\n      `}</style>\n    </div>\n  );\n}\n\n// Helpers\nconst backButtonStyle = {\n  padding: \"6px 10px\",\n  borderRadius: 10,\n  border: \"1px solid rgba(255,255,255,0.25)\",\n  background: \"rgba(0,0,0,0.5)\",\n  color: \"white\",\n  fontSize: \"0.75rem\",\n  cursor: \"pointer\",\n};\n\nfunction getNodeBackground(lesson, isActive) {\n  if (lesson.isCompleted) return \"linear-gradient(145deg, #ffe99a, #f6d96b)\";\n  if (lesson.isLocked) return \"linear-gradient(145deg, #1b1f2b, #0c0f18)\";\n  if (isActive) return \"linear-gradient(145deg, #f6d96b, #ffe99a)\";\n  return \"linear-gradient(145deg, #2a2f3e, #10131b)\";\n}\n\nfunction getNodeShadow(lesson, isActive) {\n  if (lesson.isCompleted) return \"0 0 14px rgba(255,232,150,0.4)\";\n  if (lesson.isLocked) return \"0 0 6px rgba(0,0,0,0.7)\";\n  if (isActive) return \"0 0 16px rgba(255,232,150,0.7)\";\n  return \"0 0 8px rgba(255,215,0,0.3)\";\n}\n\nfunction shortenTitleEnglish(title) {\n  return title.split(\"(\")[0].replace(\"The Name\", \"\").trim();\n}\n","path":null,"size_bytes":22447,"size_tokens":null},"src/onboarding/AvatarScreen.jsx":{"content":"import React, { useState, useMemo, useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { motion } from \"framer-motion\";\nimport assets from \"../assets/assets\";\nimport { AVAILABLE_AVATARS } from \"../utils/avatarUtils\";\n\nexport default function AvatarScreen() {\n  const navigate = useNavigate();\n  const { setAvatar } = useUserStore();\n  const [selected, setSelected] = useState(null);\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"avatar\");\n  }, []);\n\n  // Only show AVAILABLE_AVATARS (excludes hidden ninja avatars)\n  const sortedAvatars = useMemo(() => \n    AVAILABLE_AVATARS.map(key => assets.avatars[key]).filter(Boolean), \n  []);\n\n  const handleContinue = () => {\n    if (!selected) return;\n    \n    const avatarKey = selected.split(\"/\").pop().split(\".\")[0];\n    setAvatar(avatarKey);\n    \n    localStorage.setItem(\"iq_avatar\", avatarKey);\n    localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n    \n    navigate(\"/onboarding/handle\");\n  };\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: \"24px\",\n        paddingRight: \"24px\",\n        paddingTop: \"24px\",\n        justifyContent: \"center\",\n      }}\n    >\n      <h2 style={{ color: \"#D4AF37\", fontSize: \"1.4rem\", marginBottom: \"8px\" }}>\n        Choose your avatar\n      </h2>\n      <p style={{ color: \"#ccc\", fontSize: \"0.95rem\", marginBottom: 20 }}>\n        Tap to choose your look üëá\n      </p>\n\n      <div\n        style={{\n          display: \"grid\",\n          gridTemplateColumns: \"repeat(auto-fit, minmax(90px, 1fr))\",\n          gap: 16,\n          width: \"90%\",\n          maxWidth: 360,\n          justifyItems: \"center\",\n        }}\n      >\n        {sortedAvatars.map((src, i) => (\n          <motion.button\n            key={src}\n            onClick={() => setSelected(src)}\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: i * 0.05 }}\n            whileHover={{ scale: 1.05, filter: \"brightness(1.1)\" }}\n            whileTap={{ scale: 0.95 }}\n            style={{\n              width: 90,\n              height: 90,\n              borderRadius: \"50%\",\n              padding: 0,\n              border:\n                selected === src\n                  ? \"3px solid #D4AF37\"\n                  : \"2px solid transparent\",\n              background: \"#0E1625\",\n              overflow: \"hidden\",\n              cursor: \"pointer\",\n            }}\n          >\n            <motion.img\n              src={src}\n              alt=\"Avatar\"\n              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ duration: 0.4 }}\n            />\n          </motion.button>\n        ))}\n      </div>\n\n      <motion.button\n        onClick={handleContinue}\n        disabled={!selected}\n        whileHover={selected ? { scale: 1.03, filter: \"brightness(1.1)\" } : {}}\n        whileTap={selected ? { scale: 0.97 } : {}}\n        style={{\n          marginTop: 28,\n          background: selected ? \"#D4AF37\" : \"#7e6a2b\",\n          color: \"#0A1A2F\",\n          border: \"none\",\n          borderRadius: 10,\n          padding: \"12px 36px\",\n          fontWeight: 600,\n          fontSize: \"1rem\",\n          cursor: selected ? \"pointer\" : \"not-allowed\",\n        }}\n      >\n        Continue\n      </motion.button>\n    </div>\n  );\n}\n","path":null,"size_bytes":3703,"size_tokens":null},"src/components/ProfileCard.jsx":{"content":"import React from \"react\";\n\nconst ProfileCard = React.memo(function ProfileCard({ icon, label, value, color = \"#FFD700\" }) {\n  return (\n    <div\n      style={{\n        textAlign: \"center\",\n        background: \"rgba(255,255,255,0.05)\",\n        borderRadius: \"16px\",\n        padding: \"16px 20px\",\n        border: \"1px solid rgba(255,215,0,0.2)\",\n        color: \"white\",\n        minWidth: \"100px\",\n        flex: \"1 1 0\",\n        maxWidth: \"120px\",\n      }}\n    >\n      {icon && (\n        <img\n          src={icon}\n          alt={label}\n          style={{ width: \"32px\", height: \"32px\", marginBottom: \"8px\" }}\n        />\n      )}\n      <p style={{ fontSize: \"0.8rem\", opacity: 0.7, margin: \"4px 0\" }}>{label}</p>\n      <p style={{ color, fontWeight: \"bold\", fontSize: \"1.1rem\", margin: \"4px 0\" }}>{value}</p>\n    </div>\n  );\n});\n\nexport default ProfileCard;\n","path":null,"size_bytes":854,"size_tokens":null},"src/components/ScreenContainer.jsx":{"content":"import React from \"react\";\n\nconst NAV_HEIGHT = 76;\n\nexport default function ScreenContainer({ children }) {\n  return (\n    <div\n      className=\"screen no-extra-space screen-container-root\"\n      style={{\n        background: \"var(--navy)\",\n        paddingLeft: \"clamp(12px, 3vw, 24px)\",\n        paddingRight: \"clamp(12px, 3vw, 24px)\",\n        paddingTop: \"clamp(12px, 3vw, 24px)\",\n        maxWidth: \"100%\",\n        width: \"100%\",\n        boxSizing: \"border-box\",\n        overflowX: \"hidden\",\n      }}\n    >\n      {children}\n    </div>\n  );\n}\n","path":null,"size_bytes":542,"size_tokens":null},"src/lib/supabase.js":{"content":"import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\n// This client lets the rest of the app talk to Supabase\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n","path":null,"size_bytes":300,"size_tokens":null},"src/components/DevRepair.jsx":{"content":"import React from \"react\";\n\nexport default function DevRepair() {\n  return (\n    <div\n      style={{\n        textAlign: \"center\",\n        padding: \"20px\",\n        color: \"#FFD700\",\n        opacity: 0.8,\n      }}\n    >\n      üß∞ Developer Repair Mode ‚Äî under maintenance\n    </div>\n  );\n}\n","path":null,"size_bytes":291,"size_tokens":null},"src/assets/assets.js":{"content":"// src/assets/assets.js\n\n// ============ MASCOTS ============\n// Using only the \"1 Mascot\" culturally authentic Islamic mascots\nimport mascot_boss from \"./mascots/mascot_boss.webp\";\nimport mascot_congratulation from \"./mascots/mascot_congratulation.webp\";\nimport mascot_welldone from \"./mascots/mascot_welldone.webp\";\nimport mascot_sitting_v2 from \"./mascots/mascot_sitting_v2.webp\";\nimport mascot_onboarding from \"./mascots/mascot_onboarding.webp\";\nimport mascot_pointing from \"./mascots/mascot_pointing.webp\";\nimport mascot_running from \"./mascots/mascot_running.webp\";\nimport mascot_sitting from \"./mascots/mascot_sitting.webp\";\nimport mascot_waving from \"./mascots/mascot_waving.webp\";\nimport mascot_defeated from \"./mascots/mascot_defeated.webp\";\n\n// Additional mascot variants\nimport mascot_pointing_v2 from \"./mascots/mascot_pointing_v2.webp\";\nimport mascot_quiz from \"./mascots/mascot_quiz.webp\";\nimport mascot_locked from \"./mascots/mascot_locked.webp\";\nimport mascot_power from \"./mascots/mascot_power.webp\";\nimport mascot_countdown from \"./mascots/mascot_countdown.webp\";\nimport mascot_streak_freeze from \"./mascots/mascot_streak_freeze.webp\";\n\n// ============ AVATARS ============\n// Male avatars\nimport avatar_man_lantern from \"./avatars/avatar_man_lantern.webp\";\nimport avatar_man_tasbih from \"./avatars/avatar_man_tasbih.webp\";\nimport avatar_man_cup from \"./avatars/avatar_man_cup.webp\";\nimport avatar_man_spoon from \"./avatars/avatar_man_spoon.webp\";\nimport avatar_man_soccer from \"./avatars/avatar_man_soccer.webp\";\nimport avatar_man_sunglasses from \"./avatars/avatar_man_sunglasses.webp\";\nimport avatar_man_construction from \"./avatars/avatar_man_construction.webp\";\nimport avatar_man_thumbsup from \"./avatars/avatar_man_thumbsup.webp\";\nimport avatar_man_scholar from \"./avatars/avatar_man_scholar.webp\";\nimport avatar_ninja_male from \"./avatars/avatar_ninja_male.png.webp\";\n\n// Female avatars\nimport avatar_woman_hijab_book from \"./avatars/avatar_woman_hijab_book.webp\";\nimport avatar_woman_hijab_dua from \"./avatars/avatar_woman_hijab_dua.webp\";\nimport avatar_woman_hijab_tasbih from \"./avatars/avatar_woman_hijab_tasbih.webp\";\nimport avatar_woman_hijab_studying from \"./avatars/avatar_woman_hijab_studying.webp\";\nimport avatar_woman_hijab_beads from \"./avatars/avatar_woman_hijab_beads.webp\";\nimport avatar_woman_niqab from \"./avatars/avatar_woman_niqab.webp\";\nimport avatar_woman_cartoon from \"./avatars/avatar_woman_cartoon.webp\";\nimport avatar_woman_pixel from \"./avatars/avatar_woman_pixel.webp\";\nimport avatar_woman_neon from \"./avatars/avatar_woman_neon.webp\";\nimport avatar_woman_crown from \"./avatars/avatar_woman_crown.webp\";\nimport avatar_woman_cooking from \"./avatars/avatar_woman_cooking.webp\";\nimport avatar_woman_elder_cane from \"./avatars/avatar_woman_elder_cane.webp\";\nimport avatar_woman_hawa from \"./avatars/avatar_woman_hawa.webp\";\nimport avatar_woman_hijab_pink from \"./avatars/avatar_woman_hijab_pink.webp\";\nimport avatar_woman_hijab_tan from \"./avatars/avatar_woman_hijab_tan.webp\";\nimport avatar_woman_hijab_purse from \"./avatars/avatar_woman_hijab_purse.webp\";\nimport avatar_ninja_female from \"./avatars/avatar_ninja_female.png.webp\";\n\n// Other avatars (animals, robots, etc.)\nimport avatar_dino from \"./avatars/avatar_dino.png.webp\";\nimport avatar_fox from \"./avatars/avatar_fox.png.webp\";\nimport avatar_panda from \"./avatars/avatar_panda.webp\";\nimport avatar_rabbit from \"./avatars/avatar_rabbit.png.webp\";\nimport avatar_robot from \"./avatars/avatar_robot.png.webp\";\nimport avatar_unicorn from \"./avatars/avatar_unicorn.png.webp\";\n\n// ============ UI ============\nimport ui_coin from \"./ui/ui_coin.webp\";\nimport ui_shield from \"./ui/ui_shield.webp\";\nimport ui_streak from \"./ui/ui_streak.webp\";\nimport ui_xp from \"./ui/ui_xp.webp\";\n\n// ============ EXPORT ============\nconst assets = {\n  mascots: {\n    mascot_boss,\n    mascot_congratulation,\n    mascot_welldone,\n    mascot_sitting_v2,\n    mascot_onboarding,\n    mascot_pointing,\n    mascot_running,\n    mascot_sitting,\n    mascot_waving,\n    mascot_defeated,\n    mascot_pointing_v2,\n    mascot_quiz,\n    mascot_locked,\n    mascot_power,\n    mascot_countdown,\n    mascot_streak_freeze,\n  },\n  avatars: {\n    // Male avatars first\n    avatar_man_lantern,\n    avatar_man_tasbih,\n    avatar_man_cup,\n    avatar_man_spoon,\n    avatar_man_soccer,\n    avatar_man_sunglasses,\n    avatar_man_construction,\n    avatar_man_thumbsup,\n    avatar_man_scholar,\n    avatar_ninja_male,\n    // Female avatars second\n    avatar_woman_hijab_book,\n    avatar_woman_hijab_dua,\n    avatar_woman_hijab_tasbih,\n    avatar_woman_hijab_studying,\n    avatar_woman_hijab_beads,\n    avatar_woman_niqab,\n    avatar_woman_cartoon,\n    avatar_woman_pixel,\n    avatar_woman_neon,\n    avatar_woman_crown,\n    avatar_woman_cooking,\n    avatar_woman_elder_cane,\n    avatar_woman_hawa,\n    avatar_woman_hijab_pink,\n    avatar_woman_hijab_tan,\n    avatar_woman_hijab_purse,\n    avatar_ninja_female,\n    // Other avatars last\n    avatar_dino,\n    avatar_fox,\n    avatar_panda,\n    avatar_rabbit,\n    avatar_robot,\n    avatar_unicorn,\n  },\n  ui: {\n    ui_coin,\n    ui_shield,\n    ui_streak,\n    ui_xp,\n  },\n};\n\nexport default assets;\n","path":null,"size_bytes":5192,"size_tokens":null},"src/pages/Profile.jsx":{"content":"// src/pages/Profile.jsx\nimport React from \"react\";\nimport ScreenContainer from \"../components/ScreenContainer\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport ProfileCard from \"../components/ProfileCard\";\nimport { LevelBadge } from \"../components/LevelBadge\";\nimport { getCurrentLevel, getXPProgress } from \"../utils/diamondLevels\";\nimport { LOCAL_VERSION, shouldShowUpdateBanner } from \"../config/versionConfig\";\nimport { getAvatarImage } from \"../utils/avatarUtils\";\nimport ui_xp from \"../assets/ui/ui_xp.webp\";\nimport ui_coin from \"../assets/ui/ui_coin.webp\";\nimport ui_streak from \"../assets/ui/ui_streak.webp\";\nimport ui_shield from \"../assets/ui/ui_shield.webp\";\n\n// Extract avatar key from full path (e.g., \"/src/assets/avatars/avatar_robot.png.webp\" -> \"avatar_robot\")\nconst extractAvatarKey = (path) => {\n  if (!path) return null;\n  const file = path.split(\"/\").pop();\n  return file.split(\".\")[0];\n};\n\nexport default function Profile() {\n  const navigate = useNavigate();\n  const { id: userId, name, avatar, handle, setName, setAvatar } = useUserStore();\n  const { \n    xp, \n    coins, \n    streak, \n    shieldCount,\n    premiumStatus,\n    vibrationEnabled,\n    setVibrationEnabled,\n    purchaseIndividual,\n  } = useProgressStore();\n  \n  const { showModal } = useModalStore();\n\n  const currentLevel = getCurrentLevel(xp);\n  const xpProgress = getXPProgress(xp);\n  const progress = xpProgress.percentage;\n  \n  // Get the avatar image path from the stored key\n  const avatarImage = avatar ? getAvatarImage(avatar, { userId }) : \"/default-avatar.png\";\n\n  return (\n    <ScreenContainer>\n      <div\n        style={{\n          textAlign: \"center\",\n          padding: \"clamp(20px, 6vw, 40px) 20px 90px\",\n          color: \"white\",\n        }}\n      >\n        {/* === Header === */}\n        <h1\n          style={{\n            fontSize: \"clamp(1.3rem, 5vw, 1.8rem)\",\n            fontWeight: 800,\n            margin: 0,\n            background: \"linear-gradient(90deg, #FFD700, #FFA500, #FFD700)\",\n            WebkitBackgroundClip: \"text\",\n            WebkitTextFillColor: \"transparent\",\n            backgroundSize: \"200%\",\n            animation: \"shimmer 8s linear infinite\",\n          }}\n        >\n          My Profile\n        </h1>\n        <p style={{ opacity: 0.9, marginTop: 8 }}>\n          Review your XP, coins, and progress üåô\n        </p>\n\n        {/* === Avatar + Nickname === */}\n        <div style={{ marginTop: 24 }}>\n          <button\n            onClick={() => showModal(MODAL_TYPES.EDIT_AVATAR, {\n              currentAvatar: avatar,\n              onSave: (selectedAvatar) => setAvatar(extractAvatarKey(selectedAvatar))\n            })}\n            style={{\n              border: \"none\",\n              background: \"transparent\",\n              cursor: \"pointer\",\n            }}\n          >\n            <img\n              src={avatarImage}\n              alt=\"Avatar\"\n              loading=\"eager\"\n              style={{\n                width: 100,\n                height: 100,\n                borderRadius: \"50%\",\n                border: \"3px solid #FFD700\",\n                objectFit: \"contain\",\n              }}\n            />\n          </button>\n\n          <div style={{ marginTop: 12 }}>\n            <h2\n              onClick={() => showModal(MODAL_TYPES.EDIT_NAME, {\n                initialName: name,\n                onSave: setName\n              })}\n              style={{\n                cursor: \"pointer\",\n                fontSize: \"1.3rem\",\n                fontWeight: 600,\n                color: \"#FFD700\",\n                marginBottom: 4,\n              }}\n            >\n              {name || \"Explorer\"}\n            </h2>\n            \n            {handle && (\n              <p style={{\n                color: \"rgba(255, 255, 255, 0.5)\",\n                fontSize: \"0.9rem\",\n                margin: 0,\n              }}>\n                @{handle}\n              </p>\n            )}\n            \n            {/* üíé Diamond Level Badge */}\n            <div \n              style={{ \n                marginTop: 16,\n                display: \"flex\",\n                justifyContent: \"center\",\n              }}\n            >\n              <LevelBadge\n                xp={xp}\n                size=\"large\"\n                showXP={true}\n                animated={false}\n              />\n            </div>\n\n            {/* XP Progress Info */}\n            {xpProgress.nextLevel && (\n              <p style={{\n                marginTop: 8,\n                color: \"rgba(212, 175, 55, 0.7)\",\n                fontSize: \"0.85rem\",\n              }}>\n                {xpProgress.currentLevelXP.toLocaleString()} / {xpProgress.requiredDelta.toLocaleString()} XP to Level {xpProgress.nextLevel.level}\n              </p>\n            )}\n          </div>\n        </div>\n\n        {/* === XP Progress Bar === */}\n        <div\n          style={{\n            width: \"80%\",\n            maxWidth: 350,\n            margin: \"16px auto 8px\",\n            background: \"rgba(255,255,255,0.1)\",\n            borderRadius: 12,\n            overflow: \"hidden\",\n            height: 14,\n          }}\n        >\n          <div\n            style={{\n              width: `${progress}%`,\n              height: \"100%\",\n              background: currentLevel.gradient,\n              boxShadow: currentLevel.glow,\n              transition: \"width 0.6s ease\",\n            }}\n          />\n        </div>\n\n        {/* View All Levels Button */}\n        <button\n          onClick={() => showModal(MODAL_TYPES.VIEW_ALL_LEVELS, { currentXP: xp })}\n          style={{\n            background: \"linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(244, 208, 63, 0.1) 100%)\",\n            border: \"1px solid rgba(212, 175, 55, 0.4)\",\n            borderRadius: 12,\n            padding: \"10px 20px\",\n            color: \"#D4AF37\",\n            fontWeight: \"600\",\n            cursor: \"pointer\",\n            fontSize: \"0.9rem\",\n            marginTop: 12,\n          }}\n        >\n          üíé View All Levels\n        </button>\n\n        {/* === Stats cards === */}\n        <div\n          style={{\n            display: \"flex\",\n            gap: 12,\n            justifyContent: \"center\",\n            flexWrap: \"wrap\",\n            marginTop: 20,\n          }}\n        >\n          <ProfileCard icon={ui_xp} label=\"XP\" value={xp} />\n          <ProfileCard\n            icon={ui_coin}\n            label=\"Coins\"\n            value={coins}\n            color=\"#FFA500\"\n          />\n          <ProfileCard\n            icon={ui_streak}\n            label=\"Streak\"\n            value={`${streak} üî•`}\n            color=\"#FF6347\"\n          />\n          <ProfileCard\n            icon={ui_shield}\n            label=\"Shields\"\n            value={`${shieldCount}/3 üõ°Ô∏è`}\n            color=\"#4fd5ff\"\n          />\n        </div>\n\n        {/* === Add Freeze Button === */}\n        <button\n          onClick={() => showModal(MODAL_TYPES.PURCHASE_STREAK_FREEZE)}\n          style={{\n            background: \"linear-gradient(135deg, rgba(79, 213, 255, 0.2) 0%, rgba(16, 185, 129, 0.2) 100%)\",\n            border: \"1px solid rgba(79, 213, 255, 0.4)\",\n            borderRadius: 12,\n            padding: \"12px 24px\",\n            color: \"#4fd5ff\",\n            fontWeight: \"600\",\n            cursor: \"pointer\",\n            fontSize: \"0.95rem\",\n            marginTop: 20,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: 8,\n            margin: \"20px auto 0\",\n          }}\n        >\n          <span>üõ°Ô∏è</span>\n          <span>Add Streak Freeze</span>\n        </button>\n\n        {/* === Update Banner === */}\n        {shouldShowUpdateBanner() && (\n          <div\n            style={{\n              maxWidth: 400,\n              margin: \"20px auto 0\",\n              padding: \"16px\",\n              background: \"linear-gradient(135deg, rgba(79, 213, 255, 0.15) 0%, rgba(16, 185, 129, 0.15) 100%)\",\n              border: \"1px solid rgba(79, 213, 255, 0.4)\",\n              borderRadius: 12,\n              color: \"#4fd5ff\",\n              fontSize: \"0.95rem\",\n              fontWeight: \"600\",\n              textAlign: \"center\",\n            }}\n          >\n            ‚ú® New update available!\n          </div>\n        )}\n\n        {/* === Settings Button === */}\n        <button\n          onClick={() => navigate(\"/settings\")}\n          style={{\n            background: \"linear-gradient(135deg, rgba(79, 213, 255, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%)\",\n            border: \"1px solid rgba(79, 213, 255, 0.3)\",\n            borderRadius: 12,\n            padding: \"14px 24px\",\n            color: \"#4fd5ff\",\n            fontWeight: \"600\",\n            cursor: \"pointer\",\n            fontSize: \"0.95rem\",\n            marginTop: 20,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: 8,\n            margin: \"20px auto 0\",\n            maxWidth: 400,\n            width: \"100%\",\n          }}\n        >\n          <span>‚öôÔ∏è</span>\n          <span>Settings</span>\n        </button>\n\n        {/* === Version Display (kept for logging) === */}\n        <div\n          style={{\n            marginTop: 20,\n            fontSize: \"0.75rem\",\n            color: \"rgba(255,255,255,0.4)\",\n            textAlign: \"center\",\n          }}\n        >\n          Version {LOCAL_VERSION}\n        </div>\n\n        {/* === Premium Section === */}\n        <div\n          style={{\n            maxWidth: 400,\n            margin: \"32px auto 0\",\n            padding: 20,\n            background: \"rgba(255, 215, 0, 0.05)\",\n            border: \"1px solid rgba(255, 215, 0, 0.2)\",\n            borderRadius: 16,\n          }}\n        >\n          <h3\n            style={{\n              color: \"#FFD700\",\n              fontSize: \"1.2rem\",\n              fontWeight: 700,\n              marginBottom: 16,\n            }}\n          >\n            üí≥ Premium Status\n          </h3>\n\n          {/* Current Plan */}\n          <div\n            style={{\n              background: \"rgba(255, 255, 255, 0.03)\",\n              padding: 16,\n              borderRadius: 12,\n              marginBottom: 16,\n            }}\n          >\n            <div style={{ color: \"#cbd5e1\", fontSize: \"0.9rem\", marginBottom: 8 }}>\n              Current Plan:\n            </div>\n            <div\n              style={{\n                color: \"#FFD700\",\n                fontSize: \"1.1rem\",\n                fontWeight: 700,\n                textTransform: \"capitalize\",\n              }}\n            >\n              {premiumStatus === \"free\" ? \"Free üÜì\" : \"Premium ‚≠ê\"}\n            </div>\n          </div>\n\n          {/* Upgrade Button - Only show for free users */}\n          {premiumStatus === \"free\" && (\n            <button\n              onClick={() => showModal(MODAL_TYPES.PURCHASE)}\n              style={{\n                background: \"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)\",\n                color: \"#111827\",\n                border: \"none\",\n                borderRadius: 12,\n                padding: \"14px 24px\",\n                fontSize: \"1rem\",\n                fontWeight: 700,\n                width: \"100%\",\n                cursor: \"pointer\",\n                boxShadow: \"0 4px 12px rgba(255, 215, 0, 0.3)\",\n              }}\n            >\n              ‚≠ê Upgrade to Premium\n            </button>\n          )}\n        </div>\n\n        <style>\n          {`\n            @keyframes shimmer {\n              0% { background-position: 0% 50%; }\n              100% { background-position: 200% 50%; }\n            }\n          `}\n        </style>\n      </div>\n    </ScreenContainer>\n  );\n}\n","path":null,"size_bytes":11775,"size_tokens":null},"src/components/BackButton.jsx":{"content":"import React from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\n\nexport default function BackButton({ label = \"Back\" }) {\n  const navigate = useNavigate();\n  return (\n    <button\n      onClick={() => navigate(-1)}\n      style={{\n        background: \"rgba(255,255,255,0.08)\",\n        color: \"#FFD700\",\n        border: \"1px solid rgba(255,215,0,0.4)\",\n        borderRadius: \"12px\",\n        padding: \"8px 16px\",\n        margin: \"10px\",\n        cursor: \"pointer\",\n        fontWeight: 600,\n      }}\n    >\n      ‚Üê {label}\n    </button>\n  );\n}\n","path":null,"size_bytes":554,"size_tokens":null},"src/components/LevelDetailModal.jsx":{"content":"import React from \"react\";\n\nexport default function LevelDetailModal({ xp, level, onClose }) {\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        inset: 0,\n        background: \"rgba(0,0,0,0.8)\",\n        color: \"white\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        zIndex: 100,\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: \"#0a0a1a\",\n          borderRadius: \"16px\",\n          padding: \"30px\",\n          border: \"1px solid rgba(255,215,0,0.3)\",\n          textAlign: \"center\",\n          width: \"280px\",\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <h3 style={{ color: \"#FFD700\" }}>Level {level}</h3>\n        <p>{xp} XP earned!</p>\n        <button\n          onClick={onClose}\n          style={{\n            background: \"#FFD700\",\n            border: \"none\",\n            borderRadius: \"8px\",\n            padding: \"10px 20px\",\n            marginTop: \"15px\",\n            cursor: \"pointer\",\n            fontWeight: 600,\n          }}\n        >\n          Close\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1142,"size_tokens":null},"src/index.jsx":{"content":"import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App.jsx\";\nimport \"./index.css\";\nimport \"./App.css\";\n\nReactDOM.createRoot(document.getElementById(\"root\")).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n);\n","path":null,"size_bytes":260,"size_tokens":null},"src/components/ScrollToTop.jsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nexport default function ScrollToTop() {\n  const { pathname } = useLocation();\n  \n  useEffect(() => {\n    // Scroll to top immediately when route changes\n    window.scrollTo({ top: 0, left: 0, behavior: 'instant' });\n    \n    // Also scroll the document element and body (for better cross-browser support)\n    document.documentElement.scrollTop = 0;\n    document.body.scrollTop = 0;\n    \n    // Scroll any scrollable containers with the 'screen' class\n    const screenElements = document.querySelectorAll('.screen');\n    screenElements.forEach(el => {\n      el.scrollTop = 0;\n    });\n  }, [pathname]);\n  \n  return null;\n}\n","path":null,"size_bytes":705,"size_tokens":null},"src/store/progressStore.js":{"content":"// src/store/progressStore.js\nimport { create } from \"zustand\";\nimport { getCurrentLevel, checkLevelUp } from \"../utils/diamondLevels\";\nimport { FREE_LESSON_LIMITS, PREMIUM_ONLY_PATHS, isPremiumOnlyPath } from \"./premiumConfig\";\nimport { useModalStore, MODAL_TYPES } from \"./modalStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport CryptoJS from \"crypto-js\";\nimport { getQuizForLesson } from \"../data/quizEngine\";\nimport { logStreakEvent } from \"../backend/streakLogs\";\nimport { logXpEvent } from \"../backend/xpLogs\";\nimport { logPurchase } from \"../backend/purchaseLogs\";\n\nconst STORAGE_KEY = \"islamQuestProgress_v4\";\n\nconst DEFAULT_PATHS = [\n  { id: 1, title: \"Names of Allah\", progress: 0, totalLessons: 104, completedLessons: 0, status: \"available\" },\n  { id: 2, title: \"Foundations of Islam\", progress: 0, totalLessons: 17, completedLessons: 0, status: \"available\" },\n  { id: 3, title: \"Stories of Prophets\", progress: 0, totalLessons: 47, completedLessons: 0, status: \"available\" },\n  { id: 4, title: \"Life of Muhammad Ô∑∫\", progress: 0, totalLessons: 78, completedLessons: 0, status: \"available\" },\n  { id: 5, title: \"Wives of the Prophet Ô∑∫\", progress: 0, totalLessons: 13, completedLessons: 0, status: \"available\" },\n  { id: 6, title: \"Ten Promised Jannah\", progress: 0, totalLessons: 10, completedLessons: 0, status: \"available\" },\n  { id: 7, title: \"Four Greatest Women\", progress: 0, totalLessons: 12, completedLessons: 0, status: \"available\" },\n  { id: 8, title: \"Stories of the Companions\", progress: 0, totalLessons: 32, completedLessons: 0, status: \"available\" },\n  { id: 9, title: \"Angels\", progress: 0, totalLessons: 11, completedLessons: 0, status: \"available\" },\n  { id: 10, title: \"The End Times\", progress: 0, totalLessons: 13, completedLessons: 0, status: \"available\" },\n  { id: 11, title: \"The Grave\", progress: 0, totalLessons: 12, completedLessons: 0, status: \"available\" },\n  { id: 12, title: \"Day of Judgement\", progress: 0, totalLessons: 16, completedLessons: 0, status: \"available\" },\n  { id: 13, title: \"Hellfire\", progress: 0, totalLessons: 19, completedLessons: 0, status: \"available\" },\n  { id: 14, title: \"Paradise\", progress: 0, totalLessons: 20, completedLessons: 0, status: \"available\" },\n];\n\nconst ENCRYPTION_KEY = \"IQ_SYNC_V1\";\n\nfunction encryptJSON(obj) {\n  try {\n    return CryptoJS.AES.encrypt(JSON.stringify(obj), ENCRYPTION_KEY).toString();\n  } catch (e) {\n    console.error(\"Encryption failed:\", e);\n    return null;\n  }\n}\n\nfunction decryptJSON(cipher) {\n  try {\n    const bytes = CryptoJS.AES.decrypt(cipher, ENCRYPTION_KEY);\n    return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n  } catch (e) {\n    console.error(\"Decryption failed:\", e);\n    return null;\n  }\n}\n\nexport const useProgressStore = create((set, get) => ({\n  // ü™ô Base user stats\n  xp: 0,\n  coins: 0,\n  streak: 0,\n  lastStudyDate: null,\n  lastCompletedActivityDate: null, // Unified tracking for all activities\n  shieldCount: 0, // Streak freeze shields (max 3)\n  needsRepairPrompt: false, // Show repair modal on next open\n  brokenStreakValue: 0, // Store streak value before break for repair\n  xpMultiplier: 0,\n  level: 1, // Diamond level (1-10)\n  lastLogin: null,\n  lessonStates: {},\n  lockedLessons: {},\n  hasPremium: false, // Deprecated: derived from premiumStatus, kept for backwards compatibility\n  \n  // üí≥ Premium System (Supabase-ready)\n  premium: false, // New: Simple boolean for premium status\n  premiumType: null, // null | \"individual\" | \"family\"\n  premiumActivatedAt: null, // Timestamp when premium was activated\n  premiumStatus: \"free\", // \"free\" | \"individual\" (kept for backwards compatibility)\n  \n  // üîä System Preferences\n  vibrationEnabled: true, // Haptic feedback toggle\n  _premiumMigrationV1: false, // Internal: tracks if premium lock migration has run\n\n  // üìö Revise Feature Unlocks\n  reviewMistakesUnlocked: false, // Unlocks after first mistake\n  smartRevisionUnlocked: false, // Unlocks after 40 completed lessons\n\n  // üåô Learning Paths\n  paths: DEFAULT_PATHS,\n  \n  // üîí Lock Readiness Flag\n  locksReady: false, // Gates lock checks until applyLockingRules completes\n\n  // üß† Save & Load\n  saveProgress: () => {\n    const data = get();\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\n  },\n\n  saveLessonSummary: async (lessonId, status) => {\n    // status = \"completed\", \"in-progress\", \"started\"\n    const current = get().lessonStates || {};\n    const updated = {\n      ...current,\n      [lessonId]: {\n        status,\n        updatedAt: Date.now(),\n      },\n    };\n\n    set({ lessonStates: updated });\n\n    // Push encrypted lesson_states to profile\n    const { data } = await supabase.auth.getUser();\n    const userId = data?.user?.id;\n    if (!userId) return;\n\n    // Encrypt lesson_states before sending to Supabase (column is TEXT type)\n    const encryptedStates = encryptJSON(updated);\n    if (!encryptedStates) {\n      console.error(\"Failed to encrypt lesson_states\");\n      return;\n    }\n\n    const { error } = await supabase\n      .from(\"profiles\")\n      .update({\n        lesson_states: encryptedStates,\n        updated_at: new Date().toISOString(),\n      })\n      .eq(\"user_id\", userId);\n    \n    if (error) {\n      console.error(\"Failed to save lesson summary:\", error);\n    }\n  },\n\n  loadProgress: () => {\n    const saved = localStorage.getItem(STORAGE_KEY);\n    if (saved) {\n      const savedData = JSON.parse(saved);\n      if (savedData.paths) {\n        savedData.paths = savedData.paths.map(savedPath => {\n          const defaultPath = DEFAULT_PATHS.find(p => p.id === savedPath.id);\n          return {\n            ...savedPath,\n            totalLessons: defaultPath ? defaultPath.totalLessons : savedPath.totalLessons,\n            title: defaultPath ? defaultPath.title : savedPath.title,\n          };\n        });\n      }\n      \n      // üîí Initialize lockedLessons based on existing progress for migration\n      if (!savedData.lockedLessons || Object.keys(savedData.lockedLessons).length === 0) {\n        savedData.lockedLessons = get().normalizeLocks(savedData.lessonStates || {});\n      }\n      \n      // üí≥ Migrate legacy hasPremium to premiumStatus\n      if (!savedData.premiumStatus) {\n        savedData.premiumStatus = savedData.hasPremium ? \"individual\" : \"free\";\n      }\n      // Derive hasPremium from premiumStatus for backwards compatibility\n      savedData.hasPremium = savedData.premiumStatus !== \"free\";\n      \n      if (savedData.vibrationEnabled === undefined) {\n        savedData.vibrationEnabled = true;\n      }\n      \n      // üìö MIGRATION: Initialize Revise unlock flags if missing\n      if (savedData.reviewMistakesUnlocked === undefined) {\n        savedData.reviewMistakesUnlocked = false;\n      }\n      if (savedData.smartRevisionUnlocked === undefined) {\n        savedData.smartRevisionUnlocked = false;\n      }\n      \n      set(savedData);\n      \n      // üìö MIGRATION: Recalculate Revise unlock states from existing data\n      // This ensures legacy users get unlocks based on their existing progress\n      get().migrateReviseUnlocks();\n      \n      // üîí MIGRATION: Recalculate all locks for premium system (Nov 2025 premium rebuild)\n      // This ensures legacy users who unlocked premium lessons before the premium\n      // system rebuild have their locks re-evaluated based on new premium rules\n      const needsMigration = !savedData._premiumMigrationV1;\n      if (needsMigration) {\n        console.log(\"üîí Running premium system migration...\");\n        get().applyLockingRules(); // Recalculate all locks\n        set({ _premiumMigrationV1: true }); // Mark migration as complete\n      }\n      \n      set({ locksReady: true }); // Mark locks as ready\n      get().saveProgress(); // Persist the normalized locks, premium status, and migration flag\n    } else {\n      // üîí CRITICAL: For fresh installs (including post-storage-reset), ensure defaults exist and apply locking\n      console.log(\"üîí Initializing premium locking for fresh install...\");\n      \n      // Explicitly initialize default state for fresh install\n      const currentState = get();\n      if (!currentState.paths || currentState.paths.length === 0) {\n        set({ paths: DEFAULT_PATHS });\n      }\n      if (!currentState.lockedLessons || Object.keys(currentState.lockedLessons).length === 0) {\n        set({ lockedLessons: {} });\n      }\n      \n      // Now apply locking rules on initialized state\n      get().applyLockingRules();\n      set({ locksReady: true }); // Mark locks as ready\n      get().saveProgress(); // Persist the initial locked state\n    }\n  },\n\n  // üîä Toggle vibration\n  setVibrationEnabled: (enabled) => {\n    set({ vibrationEnabled: enabled });\n    get().saveProgress();\n  },\n\n  // Set streak shield from sync (cloud ‚Üí local)\n  setStreakShieldFromSync: (data) => {\n    if (!data) return;\n    set({\n      shieldCount: data.shieldCount ?? 0,\n      lastShieldUsed: data.lastUsed ?? null,\n    });\n  },\n  \n  // üîí Normalize locks based on lesson completion\n  normalizeLocks: (lessonStates) => {\n    const locks = {};\n    \n    // For each path, unlock lessons based on completion\n    for (let pathId = 1; pathId <= 14; pathId++) {\n      locks[pathId] = {};\n      const pathState = lessonStates[pathId] || {};\n      const passedLessons = Object.keys(pathState)\n        .filter(lessonId => pathState[lessonId]?.passed)\n        .map(Number)\n        .sort((a, b) => a - b);\n      \n      // Find the highest completed lesson\n      const maxCompleted = passedLessons.length > 0 ? Math.max(...passedLessons) : 0;\n      \n      // Unlock all lessons up to and including the next lesson after max completed\n      for (let lessonId = 1; lessonId <= maxCompleted + 1; lessonId++) {\n        locks[pathId][lessonId] = { unlocked: true };\n      }\n    }\n    \n    return locks;\n  },\n\n  // üõ°Ô∏è Mark day as complete (unified tracking for all activities)\n  // Called from: applyQuizResults, daily quest completion, challenge completion, event completion\n  markDayComplete: () => {\n    const today = new Date().toDateString();\n    const { lastCompletedActivityDate, streak } = get();\n\n    // Already counted today (but allow restart if streak is 0 from skip/break)\n    if (lastCompletedActivityDate === today && streak > 0) return;\n\n    // First time user\n    if (!lastCompletedActivityDate) {\n      set({ \n        streak: 1,\n        lastCompletedActivityDate: today,\n        lastStudyDate: today,\n      });\n      get().calculateXPMultiplier();\n      get().saveProgress();\n      return;\n    }\n\n    // Calculate days since last activity\n    const lastDate = new Date(lastCompletedActivityDate);\n    const currentDate = new Date(today);\n    const diffTime = currentDate - lastDate;\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n    // Consecutive day - increment streak\n    if (diffDays === 1) {\n      const newStreak = streak + 1;\n      set({ \n        streak: newStreak,\n        lastCompletedActivityDate: today,\n        lastStudyDate: today,\n      });\n      get().calculateXPMultiplier();\n      get().saveProgress();\n      \n      // Log streak maintained\n      (async () => {\n        const { data } = await supabase.auth.getUser();\n        const userId = data?.user?.id;\n        if (userId) {\n          logStreakEvent(userId, true);\n        }\n      })();\n    } else if (diffDays === 0) {\n      // Same day - check if streak needs to be initialized (from skip repair)\n      if (streak === 0) {\n        set({ \n          streak: 1,\n          lastCompletedActivityDate: today,\n          lastStudyDate: today,\n        });\n        get().calculateXPMultiplier();\n        get().saveProgress();\n      } else {\n        // Already counted today with active streak\n        set({ \n          lastCompletedActivityDate: today,\n          lastStudyDate: today,\n        });\n        get().saveProgress();\n      }\n    } else {\n      // Gap > 1 day - streak was broken, start fresh\n      set({ \n        streak: 1,\n        lastCompletedActivityDate: today,\n        lastStudyDate: today,\n      });\n      get().calculateXPMultiplier();\n      get().saveProgress();\n    }\n  },\n\n  // üåô Check streak status on app open\n  // This runs once per session to detect breaks and consume shields if needed\n  checkStreakOnAppOpen: () => {\n    const today = new Date().toDateString();\n    const { lastCompletedActivityDate, streak, shieldCount, needsRepairPrompt } = get();\n\n    // Already checked today or already needs repair\n    if (lastCompletedActivityDate === today || needsRepairPrompt) return;\n\n    // First time user\n    if (!lastCompletedActivityDate) {\n      return;\n    }\n\n    // Calculate days since last activity\n    const lastDate = new Date(lastCompletedActivityDate);\n    const currentDate = new Date(today);\n    const diffTime = currentDate - lastDate;\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n    // Streak is safe (activity yesterday or today)\n    if (diffDays <= 1) {\n      return;\n    }\n\n    // Calculate how many shields needed to cover the gap\n    // If missed 2 days, need 1 shield. If missed 3 days, need 2 shields, etc.\n    const shieldsNeeded = diffDays - 1;\n\n    // Try to use shields to cover the gap\n    if (shieldCount >= shieldsNeeded) {\n      // Enough shields - consume them and preserve streak\n      // Set lastCompletedActivityDate to yesterday so next activity increments properly\n      const yesterday = new Date();\n      yesterday.setDate(yesterday.getDate() - 1);\n      const yesterdayStr = yesterday.toDateString();\n      \n      set({ \n        shieldCount: shieldCount - shieldsNeeded,\n        lastCompletedActivityDate: yesterdayStr,\n        lastStudyDate: yesterdayStr, // Keep for consistency\n      });\n      get().saveProgress();\n      \n      // üåê Phase 4: Sync consumed shields to cloud\n      setTimeout(() => get().syncStreakShieldToCloud(), 50);\n      \n      // Log streak maintained (shield saved it)\n      (async () => {\n        const { data } = await supabase.auth.getUser();\n        const userId = data?.user?.id;\n        if (userId) {\n          logStreakEvent(userId, true);\n        }\n      })();\n      \n      return;\n    }\n\n    // No shields - streak breaks\n    const brokenValue = streak;\n    set({ \n      brokenStreakValue: streak,\n      streak: 0,\n      needsRepairPrompt: true,\n    });\n    get().calculateXPMultiplier();\n    get().saveProgress();\n    \n    // Log streak break\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logStreakEvent(userId, false);\n      }\n    })();\n  },\n\n  // üõ°Ô∏è Purchase streak freeze shield\n  // Phase 4: Now syncs shield count to Supabase cloud\n  purchaseShield: async () => {\n    const { coins, shieldCount } = get();\n    const SHIELD_COST = 100;\n    const MAX_SHIELDS = 3;\n\n    // Already at max\n    if (shieldCount >= MAX_SHIELDS) {\n      return { success: false, reason: \"max\" };\n    }\n\n    // Not enough coins\n    if (coins < SHIELD_COST) {\n      return { success: false, reason: \"insufficient_coins\" };\n    }\n\n    // Purchase successful\n    const newShieldCount = shieldCount + 1;\n    set({ \n      coins: coins - SHIELD_COST,\n      shieldCount: newShieldCount,\n    });\n    get().saveProgress();\n    \n    // üåê Phase 4: Sync shield count to cloud\n    setTimeout(() => get().syncStreakShieldToCloud(), 50);\n    \n    // Log streak maintained (shield purchased)\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logStreakEvent(userId, true);\n      }\n    })();\n    \n    return { success: true };\n  },\n\n  // üîß Repair broken streak\n  // Phase 4: Now syncs shield count AND full progress to Supabase cloud\n  repairStreak: async () => {\n    const { coins, brokenStreakValue, shieldCount } = get();\n    const REPAIR_COST = 200;\n    const MAX_SHIELDS = 3;\n\n    // Not enough coins\n    if (coins < REPAIR_COST) {\n      return { success: false, reason: \"insufficient_coins\" };\n    }\n\n    // Repair successful - restore streak to previous value\n    const restoredStreak = brokenStreakValue;\n    const newShieldCount = Math.min(shieldCount + 1, MAX_SHIELDS);\n    const today = new Date().toDateString();\n    \n    set({ \n      coins: coins - REPAIR_COST,\n      streak: restoredStreak,\n      shieldCount: newShieldCount,\n      needsRepairPrompt: false,\n      brokenStreakValue: 0,\n      lastCompletedActivityDate: today,\n    });\n    get().calculateXPMultiplier();\n    get().saveProgress();\n    \n    // üåê Sync repaired streak + coins + shield to Supabase cloud immediately\n    const { data } = await supabase.auth.getUser();\n    const userId = data?.user?.id;\n    if (userId) {\n      try {\n        await supabase.from(\"profiles\").update({\n          streak: restoredStreak,\n          coins: coins - REPAIR_COST,\n          shield_count: newShieldCount,\n          last_completed_activity_date: today,\n        }).eq(\"id\", userId);\n        console.log(\"‚úÖ Streak repaired and synced to cloud:\", restoredStreak);\n      } catch (err) {\n        console.error(\"Failed to sync repaired streak to cloud:\", err);\n      }\n      \n      // Log streak repaired event\n      logStreakEvent(userId, true);\n    }\n    \n    return { success: true, giftedShield: true, restoredStreak };\n  },\n\n  // ‚ùå Skip streak repair\n  skipRepair: () => {\n    const today = new Date().toDateString();\n    set({ \n      needsRepairPrompt: false,\n      brokenStreakValue: 0,\n      streak: 0,\n      lastCompletedActivityDate: today,\n      lastStudyDate: today,\n    });\n    get().calculateXPMultiplier();\n    get().saveProgress();\n  },\n\n  // üåô Legacy function - kept for backward compatibility\n  triggerDailyStudy: () => {\n    get().markDayComplete();\n  },\n\n  // ‚≠ê XP multiplier\n  calculateXPMultiplier: () => {\n    const streak = get().streak;\n    let bonus = 0;\n    if (streak >= 30) bonus = 50;\n    else if (streak >= 14) bonus = 30;\n    else if (streak >= 7) bonus = 20;\n    else if (streak >= 3) bonus = 10;\n    set({ xpMultiplier: bonus });\n  },\n\n  // ü™ô XP & Coins\n  addXP: (amount) => {\n    const { xp, xpMultiplier } = get();\n    const bonus = Math.round((amount * xpMultiplier) / 100);\n    const total = amount + bonus;\n    const newXP = xp + total;\n    \n    // üíé Check for level up using Diamond Level System\n    const levelUpResult = checkLevelUp(xp, newXP);\n    const newDiamondLevel = getCurrentLevel(newXP);\n    \n    set({ \n      xp: newXP, \n      level: newDiamondLevel.level,\n    });\n    \n    // üéâ Trigger level-up notification if leveled up\n    if (levelUpResult.leveledUp) {\n      useModalStore.getState().showModal(MODAL_TYPES.LEVEL_UP, {\n        levelUpData: levelUpResult\n      });\n    }\n    \n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n    \n    // Log streak maintained (daily activity)\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logStreakEvent(userId, true);\n      }\n    })();\n  },\n\n  addCoins: (amount) => {\n    set((s) => ({ coins: s.coins + amount }));\n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n  },\n\n  // Combined helper for XP and coins (used by Daily Quest, Revise, etc.)\n  addXPAndCoins: (xp, coins) => {\n    if (xp) get().addXP(xp);\n    if (coins) get().addCoins(coins);\n  },\n\n  removeCoins: (amount) => {\n    const { coins } = get();\n    if (coins < amount) {\n      return false; // Insufficient funds\n    }\n    set((s) => ({ coins: s.coins - amount }));\n    get().saveProgress();\n    return true; // Success\n  },\n\n  // üõ†Ô∏è Dev helper - grant coins for testing\n  grantCoins: (amount) => {\n    set((s) => ({ coins: s.coins + amount }));\n    get().saveProgress();\n  },\n\n  // üìò Path progress\n  setPathProgress: (pathId, completedLessons, totalLessons) => {\n    const { paths } = get();\n    const ratio = totalLessons > 0 ? completedLessons / totalLessons : 0;\n    const updated = paths.map((p) =>\n      p.id === pathId\n        ? { ...p, completedLessons, totalLessons, progress: ratio }\n        : p\n    );\n    set({ paths: updated });\n    get().saveProgress();\n  },\n\n  // ‚úÖ Quiz results\n  applyQuizResults: (payload, pathId, lessonId, passed = true, score = null) => {\n    if (!payload) return;\n    const { xp, coins } = payload;\n    \n    // Always record attempt in lessonStates (for tracking/analytics)\n    set((state) => {\n      const lessonStates = { ...(state.lessonStates || {}) };\n      const pathState = { ...(lessonStates[pathId] || {}) };\n      const currentState = pathState[lessonId] || { passed: false, bestScore: 0 };\n      \n      // Update state: preserve previous pass status, update best score\n      pathState[lessonId] = { \n        passed: passed || currentState.passed, // Once passed, always passed\n        bestScore: score !== null ? Math.max(score, currentState.bestScore || 0) : currentState.bestScore\n      };\n      lessonStates[pathId] = pathState;\n      return { lessonStates };\n    });\n    \n    // Only award XP/coins, update progress, and unlock if passed\n    if (passed) {\n      if (xp) get().addXP(xp);\n      if (coins) get().addCoins(coins);\n      \n      // Log XP event for quiz completion\n      if (xp) {\n        (async () => {\n          const { data } = await supabase.auth.getUser();\n          const userId = data?.user?.id;\n          if (userId) {\n            logXpEvent(userId, xp, \"quiz\");\n          }\n        })();\n      }\n\n      const path = get().paths.find((x) => x.id === pathId);\n      const passedCount = Object.values(get().lessonStates[pathId] || {}).filter(\n        (x) => x.passed\n      ).length;\n\n      const ratio =\n        path && path.totalLessons > 0\n          ? Math.min(1, passedCount / path.totalLessons)\n          : 0;\n\n      get().setPathProgress(pathId, passedCount, path ? path.totalLessons : 0);\n\n      // unlock next lesson\n      get().unlockLesson(pathId, lessonId + 1);\n      \n      // üõ°Ô∏è Mark day as complete for streak tracking\n      get().markDayComplete();\n      \n      // üìö Check and unlock Smart Revision if 40 lessons completed\n      get().checkAndUnlockSmartRevision();\n    }\n    \n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n  },\n\n  // üîí Lock/Unlock\n  unlockLesson: (pathId, lessonId) => {\n    const { lockedLessons } = get();\n    const updated = { ...lockedLessons };\n    if (!updated[pathId]) updated[pathId] = {};\n    updated[pathId][lessonId] = { unlocked: true };\n    set({ lockedLessons: updated });\n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n  },\n\n  // üîí CRITICAL: Ensure locks are ready before any access\n  // Returns false if locks aren't ready, otherwise true\n  ensureLocksReady: () => {\n    const { locksReady } = get();\n    return locksReady;\n  },\n\n  // üîí Central lesson unlock check (combines sequential + premium limits)\n  // This is the NEW core function - use this everywhere!\n  isLessonUnlocked: (pathId, lessonId) => {\n    // Gate all lock checks until hydration completes\n    if (!get().ensureLocksReady()) {\n      return false; // Safe default: locked during hydration\n    }\n    \n    const { lockedLessons, premiumStatus } = get();\n    \n    // Lesson 1 is always unlocked\n    if (lessonId === 1) return true;\n    \n    // Check sequential unlocking FIRST (applies to ALL users including premium)\n    // Must complete previous lesson to unlock next one\n    if (!lockedLessons[pathId]) return false;\n    const isSequentiallyUnlocked = !!(\n      lockedLessons[pathId][lessonId] &&\n      lockedLessons[pathId][lessonId].unlocked\n    );\n    \n    if (!isSequentiallyUnlocked) return false;\n    \n    // For free users: check premium paywall limits\n    if (premiumStatus === \"free\") {\n      const freeLimit = FREE_LESSON_LIMITS[pathId] || 0;\n      if (lessonId > freeLimit) {\n        return false; // Locked by premium paywall\n      }\n    }\n    \n    // Premium users: sequential check passed, premium bypass applies\n    return true;\n  },\n\n  // üîí DEPRECATED: Backwards compatibility wrapper\n  // Use isLessonUnlocked() instead\n  isUnlocked: (pathId, lessonId) => {\n    return get().isLessonUnlocked(pathId, lessonId);\n  },\n\n  // üîí NEW UNIFIED LOCKING SYSTEM (Spec-compliant)\n  // Returns the lock state of a lesson: \"unlocked\" | \"progressLocked\" | \"premiumLocked\"\n  getLessonLockState: (pathId, lessonId) => {\n    const { lockedLessons, premium, premiumStatus, locksReady, lessonStates } = get();\n    \n    // CRITICAL: During initialization, assume all lessons are locked until locks are computed\n    if (!locksReady) {\n      return \"progressLocked\"; // Safe default during hydration\n    }\n    \n    const isUserPremium = premium || premiumStatus !== \"free\";\n    \n    // Lesson 1 is always unlocked (except for premium-only paths)\n    if (lessonId === 1) {\n      // Check if path itself is premium-only\n      if (isPremiumOnlyPath(pathId) && !isUserPremium) {\n        return \"premiumLocked\";\n      }\n      return \"unlocked\";\n    }\n    \n    // üéØ NEW: Check if path is fully completed - if so, unlock all lessons for replay\n    const pathLessonCounts = {\n      1: 104, 2: 17, 3: 22, 4: 17, 5: 13, 6: 10, 7: 4, 8: 10,\n      9: 10, 10: 17, 11: 6, 12: 7, 13: 6, 14: 6\n    };\n    const totalLessons = pathLessonCounts[pathId] || 0;\n    const pathState = lessonStates[pathId] || {};\n    const completedCount = Object.keys(pathState)\n      .filter(id => pathState[id]?.passed)\n      .length;\n    \n    const isPathCompleted = completedCount === totalLessons && totalLessons > 0;\n    \n    // If path is completed, all lessons are unlocked (premium check still applies)\n    if (isPathCompleted) {\n      // Still check premium paywall for completed paths\n      if (!isUserPremium) {\n        const freeLimit = FREE_LESSON_LIMITS[pathId] || 0;\n        if (lessonId > freeLimit) {\n          return \"premiumLocked\";\n        }\n      }\n      return \"unlocked\";\n    }\n    \n    // Check sequential progress lock FIRST\n    const isSequentiallyUnlocked = !!(\n      lockedLessons[pathId] &&\n      lockedLessons[pathId][lessonId] &&\n      lockedLessons[pathId][lessonId].unlocked\n    );\n    \n    if (!isSequentiallyUnlocked) {\n      return \"progressLocked\"; // Must complete previous lessons first\n    }\n    \n    // Check premium paywall limits\n    if (!isUserPremium) {\n      const freeLimit = FREE_LESSON_LIMITS[pathId] || 0;\n      if (lessonId > freeLimit) {\n        return \"premiumLocked\"; // Beyond free tier limit\n      }\n    }\n    \n    return \"unlocked\";\n  },\n\n  // üîí Check if lesson is locked due to premium paywall\n  isPremiumLocked: (pathId, lessonId) => {\n    if (!get().ensureLocksReady()) {\n      return false; // Safe default during hydration\n    }\n    const lockState = get().getLessonLockState(pathId, lessonId);\n    return lockState === \"premiumLocked\";\n  },\n\n  // üîí Check if user can access a lesson (for UI/navigation)\n  canAccessLesson: (pathId, lessonId) => {\n    if (!get().ensureLocksReady()) {\n      return false; // Safe default: no access during hydration\n    }\n    const lockState = get().getLessonLockState(pathId, lessonId);\n    return lockState === \"unlocked\";\n  },\n\n  // üîí Apply locking rules (recalculate all locks based on current progress)\n  applyLockingRules: () => {\n    const { lessonStates } = get();\n    const locks = {};\n    \n    // Helper: Get total lessons for each path\n    const pathLessonCounts = {\n      1: 104, // Names of Allah\n      2: 17,  // Foundations\n      3: 22,  // Prophets\n      4: 17,  // Prophet's Life\n      5: 13,  // Wives\n      6: 10,  // Ten Promised\n      7: 4,   // Four Women\n      8: 10,  // Companions\n      9: 10,  // Angels\n      10: 17, // End Times\n      11: 6,  // The Grave\n      12: 7,  // Judgement\n      13: 6,  // Hellfire\n      14: 6,  // Paradise\n    };\n    \n    // For each path, unlock lessons based on completion\n    for (let pathId = 1; pathId <= 14; pathId++) {\n      locks[pathId] = {};\n      const pathState = lessonStates[pathId] || {};\n      const passedLessons = Object.keys(pathState)\n        .filter(lessonId => pathState[lessonId]?.passed)\n        .map(Number)\n        .sort((a, b) => a - b);\n      \n      const totalLessons = pathLessonCounts[pathId] || 0;\n      const completedCount = passedLessons.length;\n      \n      // üéØ NEW: If path is fully completed, unlock ALL lessons for replay\n      if (completedCount === totalLessons && totalLessons > 0) {\n        for (let lessonId = 1; lessonId <= totalLessons; lessonId++) {\n          locks[pathId][lessonId] = { unlocked: true };\n        }\n      } else {\n        // Standard sequential unlocking: unlock up to next lesson\n        const maxCompleted = passedLessons.length > 0 ? Math.max(...passedLessons) : 0;\n        for (let lessonId = 1; lessonId <= maxCompleted + 1; lessonId++) {\n          locks[pathId][lessonId] = { unlocked: true };\n        }\n      }\n    }\n    \n    set({ lockedLessons: locks, locksReady: true });\n    get().saveProgress();\n  },\n\n  // üí≥ Premium unlock (updates all premium fields)\n  unlockPremium: (planType = \"individual\") => {\n    const now = Date.now();\n    set({ \n      premium: true,\n      premiumType: planType,\n      premiumActivatedAt: now,\n      premiumStatus: planType, // backwards compatibility\n      hasPremium: true, // backwards compatibility\n    });\n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n  },\n\n  // üí≥ ASYNC PLACEHOLDER: Purchase Individual Plan (¬£4.99)\n  // Later: integrate with payment provider (Stripe/RevenueCat/Supabase)\n  purchaseIndividual: async () => {\n    const now = Date.now();\n    // Simulate async payment (will be real API call later)\n    await new Promise(resolve => setTimeout(resolve, 100));\n    \n    set({ \n      premium: true,\n      premiumType: \"individual\",\n      premiumActivatedAt: now,\n      premiumStatus: \"individual\", // backwards compatibility\n      hasPremium: true, // backwards compatibility\n    });\n    get().saveProgress();\n    setTimeout(() => get().syncToSupabase(), 50);\n    \n    // Log purchase to Supabase\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logPurchase(userId, \"individual_plan\", 4.99, \"GBP\");\n      }\n    })();\n    \n    return { success: true, plan: \"individual\" };\n  },\n\n  // üí≥ PLACEHOLDER: Restore previous purchases\n  // Later: check with payment provider for existing purchases\n  restorePurchases: () => {\n    // Read from localStorage to check for saved premium status\n    const saved = localStorage.getItem(STORAGE_KEY);\n    if (!saved) {\n      return { \n        success: false, \n        message: \"No previous purchases found\" \n      };\n    }\n    \n    const savedData = JSON.parse(saved);\n    const savedPremiumStatus = savedData.premiumStatus || \"free\";\n    \n    if (savedPremiumStatus !== \"free\") {\n      // Rehydrate premium state from localStorage\n      set({ \n        premiumStatus: savedPremiumStatus,\n        hasPremium: true,\n      });\n      get().saveProgress(); // Ensure consistency\n      \n      return { \n        success: true, \n        message: \"Premium plan restored successfully!\",\n        plan: savedPremiumStatus \n      };\n    }\n    \n    return { \n      success: false, \n      message: \"No previous purchases found\" \n    };\n  },\n\n  resetAllLocks: () => {\n    set({ lockedLessons: {} });\n    get().saveProgress();\n  },\n\n  // üìö Get total completed lessons across all paths\n  getTotalCompletedLessons: () => {\n    const { lessonStates } = get();\n    let total = 0;\n    \n    Object.keys(lessonStates).forEach(pathId => {\n      const pathState = lessonStates[pathId] || {};\n      const passedCount = Object.values(pathState).filter(lesson => lesson.passed).length;\n      total += passedCount;\n    });\n    \n    return total;\n  },\n\n  // üìö Unlock Review Mistakes (called when first mistake is saved)\n  unlockReviewMistakes: () => {\n    const { reviewMistakesUnlocked } = get();\n    if (!reviewMistakesUnlocked) {\n      set({ reviewMistakesUnlocked: true });\n      get().saveProgress();\n    }\n  },\n\n  // üìö Check and unlock Smart Revision if 40 lessons completed\n  checkAndUnlockSmartRevision: () => {\n    const { smartRevisionUnlocked } = get();\n    if (smartRevisionUnlocked) return; // Already unlocked\n    \n    const totalCompleted = get().getTotalCompletedLessons();\n    if (totalCompleted >= 40) {\n      set({ smartRevisionUnlocked: true });\n      get().saveProgress();\n    }\n  },\n\n  // üìö MIGRATION: Recalculate Revise unlock states from existing data\n  // Called during loadProgress to ensure legacy users get unlocks\n  migrateReviseUnlocks: () => {\n    const { reviewMistakesUnlocked, smartRevisionUnlocked } = get();\n    let needsSave = false;\n    \n    // Check Review Mistakes: unlock if weak pool exists in reviseStore\n    if (!reviewMistakesUnlocked) {\n      const reviseData = localStorage.getItem(\"islamQuestRevise\");\n      if (reviseData) {\n        const parsed = JSON.parse(reviseData);\n        if (parsed.weakPool && parsed.weakPool.length > 0) {\n          set({ reviewMistakesUnlocked: true });\n          needsSave = true;\n        }\n      }\n    }\n    \n    // Check Smart Revision: unlock if 40+ lessons completed\n    if (!smartRevisionUnlocked) {\n      const totalCompleted = get().getTotalCompletedLessons();\n      if (totalCompleted >= 40) {\n        set({ smartRevisionUnlocked: true });\n        needsSave = true;\n      }\n    }\n    \n    if (needsSave) {\n      get().saveProgress();\n    }\n  },\n  \n  // üßπ Reset all progress to default (for developer/testing purposes)\n  resetAllProgress: () => {\n    set({\n      xp: 0,\n      coins: 0,\n      streak: 0,\n      level: 1, // Reset Diamond level\n      lastStudyDate: null,\n      lastCompletedActivityDate: null,\n      lastLogin: null,\n      shieldCount: 0,\n      needsRepairPrompt: false,\n      brokenStreakValue: 0,\n      xpMultiplier: 0,\n      lessonStates: {},\n      lockedLessons: {},\n      paths: DEFAULT_PATHS,\n      premiumStatus: \"free\",\n      hasPremium: false,\n      reviewMistakesUnlocked: false,\n      smartRevisionUnlocked: false,\n    });\n    get().saveProgress();\n  },\n  \n  // üßπ Force reset for testing (removes all progress)\n  forceResetForTesting: () => {\n    localStorage.clear();\n    window.location.reload();\n  },\n\n  serializeForSupabase: () => {\n    const state = get();\n\n    // ONLY sync progress fields - NEVER identity fields\n    // Identity (username, avatar, handle) is managed by useUserStore\n    return {\n      xp: state.xp,\n      coins: state.coins,\n      streak: state.streak,\n      premium: state.premium,\n      shield_count: state.shieldCount,\n      // Encrypt lesson progress data for cloud storage\n      lesson_states: state.lessonStates && Object.keys(state.lessonStates).length > 0 \n        ? encryptJSON(state.lessonStates) \n        : null,\n      paths: state.paths && state.paths.length > 0 \n        ? encryptJSON(state.paths) \n        : null,\n      locked_lessons: state.lockedLessons && Object.keys(state.lockedLessons).length > 0 \n        ? encryptJSON(state.lockedLessons) \n        : null,\n      updated_at: new Date().toISOString()\n    };\n  },\n\n  getLastUpdatedAt: () => {\n    const ts = localStorage.getItem(\"iq_last_cloud_sync\");\n    return ts ? Number(ts) : 0;\n  },\n\n  setLastUpdatedAt: (ts) => {\n    localStorage.setItem(\"iq_last_cloud_sync\", String(ts));\n  },\n\n  setFromCloudSync: (data, cloudUpdatedAt = null) => {\n    if (!data) return;\n    \n    const newLevel = getCurrentLevel(data.xp || 0);\n    \n    set({\n      xp: data.xp ?? get().xp,\n      coins: data.coins ?? get().coins,\n      streak: data.streak ?? get().streak,\n      shieldCount: data.shieldCount ?? get().shieldCount,\n      premium: data.premium ?? get().premium,\n      hasPremium: data.premium ?? get().hasPremium,\n      premiumStatus: data.premium ? (get().premiumStatus !== \"free\" ? get().premiumStatus : \"individual\") : \"free\",\n      level: newLevel?.level ?? get().level,\n    });\n    \n    if (cloudUpdatedAt) {\n      get().setLastUpdatedAt(new Date(cloudUpdatedAt).getTime());\n    }\n    get().saveProgress();\n  },\n\n  syncToSupabase: async () => {\n    try {\n      const user = await supabase.auth.getUser();\n      if (!user || !user.data || !user.data.user) return;\n\n      const userId = user.data.user.id;\n\n      const payload = get().serializeForSupabase();\n      const last = get().getLastUpdatedAt();\n      const now = Date.now();\n\n      // avoid excessive calls\n      if (now - last < 5000) return;\n\n      // write\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update(payload)\n        .eq(\"user_id\", userId);\n\n      if (!error) {\n        get().setLastUpdatedAt(now);\n        console.log(\"‚úÖ Synced to Supabase\");\n      } else {\n        console.log(\"‚ùå Sync error:\", error);\n      }\n\n    } catch (err) {\n      console.log(\"‚ùå Sync failed:\", err);\n    }\n  },\n\n  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n  // üõ°Ô∏è PHASE 4: STREAK SHIELD CLOUD SYNC FUNCTIONS\n  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n  // Load streak shields from Supabase profiles table\n  loadStreakShieldFromCloud: async () => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth || !auth.user) {\n        console.log(\"‚ùå loadStreakShieldFromCloud: No user logged in\");\n        return;\n      }\n\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"shield_count\")\n        .eq(\"user_id\", auth.user.id)\n        .maybeSingle();\n\n      if (error) {\n        console.log(\"‚ùå loadStreakShieldFromCloud error:\", error.message);\n        return;\n      }\n\n      if (data && data.shield_count !== undefined) {\n        set({ shieldCount: data.shield_count });\n        get().saveProgress();\n        console.log(\"‚úÖ Streak shields loaded from cloud:\", data.shield_count);\n      }\n\n    } catch (err) {\n      console.log(\"‚ùå loadStreakShieldFromCloud failed:\", err);\n    }\n  },\n\n  // Sync streak shields to Supabase profiles table\n  syncStreakShieldToCloud: async () => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth || !auth.user) {\n        console.log(\"‚ùå syncStreakShieldToCloud: No user logged in\");\n        return;\n      }\n\n      const { shieldCount } = get();\n\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update({ \n          shield_count: shieldCount,\n          updated_at: new Date().toISOString()\n        })\n        .eq(\"user_id\", auth.user.id);\n\n      if (error) {\n        console.log(\"‚ùå syncStreakShieldToCloud error:\", error.message);\n        return;\n      }\n\n      console.log(\"‚úÖ Streak shields synced to cloud:\", shieldCount);\n\n    } catch (err) {\n      console.log(\"‚ùå syncStreakShieldToCloud failed:\", err);\n    }\n  },\n\n  loadFromSupabase: async () => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth || !auth.user) {\n        console.log(\"No Supabase user logged in.\");\n        return;\n      }\n\n      const userId = auth.user.id;\n\n      // Load cloud row\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"*\")\n        .eq(\"user_id\", userId)\n        .maybeSingle();\n\n      if (error || !data) {\n        console.log(\"No cloud profile found or error:\", error);\n        return;\n      }\n\n      // Decrypt encrypted JSON fields\n      const lessonStates = data.lesson_states ? decryptJSON(data.lesson_states) : {};\n      const lockedLessons = data.locked_lessons ? decryptJSON(data.locked_lessons) : {};\n      const paths = data.paths ? decryptJSON(data.paths) : null;\n\n      const cloudTs = new Date(data.updated_at).getTime();\n      const localTs = get().getLastUpdatedAt();\n\n      // Choose freshest source\n      const shouldOverwriteLocal = cloudTs > localTs;\n\n      if (!shouldOverwriteLocal) {\n        console.log(\"Local data newer ‚Üí keeping device data.\");\n        return;\n      }\n\n      // Build final restored state\n      // NOTE: ONLY progress fields - identity (username, avatar, handle) is managed by useUserStore\n      const restored = {\n        xp: data.xp ?? get().xp,\n        coins: data.coins ?? get().coins,\n        streak: data.streak ?? get().streak,\n\n        premium: data.premium ?? false,\n        hasPremium: data.premium ?? false,\n\n        // üõ°Ô∏è Phase 4: Streak shields cloud sync\n        shieldCount: data.shield_count ?? get().shieldCount,\n      };\n      \n      // Restore lesson progress if cloud has data\n      if (lessonStates && Object.keys(lessonStates).length > 0) {\n        restored.lessonStates = lessonStates;\n      }\n      if (lockedLessons && Object.keys(lockedLessons).length > 0) {\n        restored.lockedLessons = lockedLessons;\n      }\n      if (paths && paths.length > 0) {\n        // Merge cloud paths with defaults to ensure totalLessons is correct\n        restored.paths = paths.map(cloudPath => {\n          const defaultPath = DEFAULT_PATHS.find(p => p.id === cloudPath.id);\n          return {\n            ...cloudPath,\n            totalLessons: defaultPath ? defaultPath.totalLessons : cloudPath.totalLessons,\n            title: defaultPath ? defaultPath.title : cloudPath.title,\n          };\n        });\n      }\n\n      // Apply restored state\n      set(restored);\n      get().saveProgress();\n\n      // Mark restore time\n      get().setLastUpdatedAt(Date.now());\n\n      console.log(\"‚úÖ Restored from Supabase (cloud ‚Üí device)\", { \n        xp: restored.xp, \n        coins: restored.coins, \n        lessonStatesCount: Object.keys(restored.lessonStates || {}).length,\n        pathsCount: restored.paths?.length || 0\n      });\n    } catch (err) {\n      console.log(\"‚ùå loadFromSupabase failed:\", err);\n    }\n  },\n}));\n\nuseProgressStore.getState().loadProgress();\n\nsetTimeout(() => {\n  useProgressStore.getState().loadFromSupabase();\n}, 300);\n","path":null,"size_bytes":42130,"size_tokens":null},"src/pages/Revise.jsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport ScreenContainer from \"../components/ScreenContainer\";\nimport { useReviseStore } from \"../store/reviseStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useAnalytics } from \"../hooks/useAnalytics\";\nimport { getQuizForLesson } from \"../data/quizEngine\";\nimport QuestionCard from \"../components/quiz/QuestionCard\";\nimport assets from \"../assets/assets\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { logXpEvent } from \"../backend/xpLogs\";\n\nfunction parseCardId(cardId) {\n  if (!cardId || typeof cardId !== \"string\") return null;\n  const parts = cardId.split(\"_\");\n  if (parts.length < 3) return null;\n  const pathId = parseInt(parts[0], 10);\n  const lessonId = parseInt(parts[1], 10);\n  const questionIndex = parseInt(parts[2], 10);\n  if (isNaN(pathId) || isNaN(lessonId) || isNaN(questionIndex)) return null;\n  return { pathId, lessonId, questionIndex };\n}\n\nfunction lookupQuestion(cardId, lessonId) {\n  const parsed = parseCardId(cardId);\n  if (!parsed) return null;\n  \n  const questions = getQuizForLesson(parsed.lessonId, parsed.pathId);\n  if (!questions || !Array.isArray(questions)) return null;\n  \n  const q = questions[parsed.questionIndex];\n  if (!q) return null;\n  \n  return {\n    id: cardId,\n    cardId,\n    lessonId,\n    question: q.text || q.question,\n    options: q.options,\n    answer: q.correctIndex !== undefined ? q.correctIndex : q.answer,\n    pathId: parsed.pathId,\n    questionIndex: parsed.questionIndex,\n  };\n}\n\nfunction enrichWeakPool(weakPool) {\n  return weakPool\n    .map((item) => {\n      const enriched = lookupQuestion(item.cardId, item.lessonId);\n      if (!enriched) return null;\n      return {\n        ...enriched,\n        timesWrong: item.timesWrong || 0,\n        timesCorrect: item.timesCorrect || 0,\n        reviewedOnce: item.reviewedOnce || false,\n        lastReviewedAt: item.lastReviewedAt,\n        firstWrongAt: item.firstWrongAt,\n      };\n    })\n    .filter(Boolean);\n}\n\nfunction shuffle(array) {\n  const arr = [...array];\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr;\n}\n\nexport default function Revise() {\n  const [mode, setMode] = useState(null);\n  const [questions, setQuestions] = useState([]);\n  const [currentQ, setCurrentQ] = useState(0);\n  const [selected, setSelected] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [showResults, setShowResults] = useState(false);\n\n  const { loadReviseData, getWeakPool, clearCorrectQuestion, saveWrongQuestion, markQuestionReviewed } = useReviseStore();\n  const { addXPAndCoins, reviewMistakesUnlocked, smartRevisionUnlocked, getTotalCompletedLessons, paths, unlockReviewMistakes } = useProgressStore();\n  const analytics = useAnalytics();\n\n  useEffect(() => {\n    loadReviseData();\n  }, [loadReviseData]);\n\n  const weakPool = getWeakPool();\n  const enrichedPool = useMemo(() => enrichWeakPool(weakPool), [weakPool]);\n  const hasWeakQuestions = enrichedPool.length > 0;\n\n  const getRevisionSession = (count = 10) => {\n    if (enrichedPool.length === 0) return [];\n    const sorted = [...enrichedPool].sort((a, b) => {\n      const aReviewed = a.reviewedOnce ? 1 : 0;\n      const bReviewed = b.reviewedOnce ? 1 : 0;\n      if (aReviewed !== bReviewed) return aReviewed - bReviewed;\n      return (b.timesWrong || 0) - (a.timesWrong || 0);\n    });\n    return shuffle(sorted.slice(0, count));\n  };\n\n  const getWeakestPath = () => {\n    if (enrichedPool.length === 0) return null;\n    \n    const pathStats = {};\n    enrichedPool.forEach((q) => {\n      if (!pathStats[q.pathId]) {\n        pathStats[q.pathId] = { pathId: q.pathId, wrongCount: 0, questions: [] };\n      }\n      pathStats[q.pathId].wrongCount += q.timesWrong || 0;\n      pathStats[q.pathId].questions.push(q);\n    });\n\n    let weakest = null;\n    Object.values(pathStats).forEach((stat) => {\n      if (!weakest || stat.wrongCount > weakest.wrongCount) {\n        weakest = stat;\n      }\n    });\n\n    if (!weakest) return null;\n\n    const pathInfo = paths?.find((p) => p.id === weakest.pathId);\n    return {\n      pathId: weakest.pathId,\n      title: pathInfo?.title || `Path ${weakest.pathId}`,\n      totalQuestions: weakest.questions.length,\n      wrongQuestions: weakest.wrongCount,\n      completedLessons: pathInfo?.completedLessons || 0,\n      questions: weakest.questions,\n    };\n  };\n\n  const getSmartRevisionPack = () => {\n    const weakestPath = getWeakestPath();\n    if (!weakestPath || weakestPath.questions.length === 0) return [];\n    return shuffle(weakestPath.questions).slice(0, 8);\n  };\n\n  const startMistakesReview = () => {\n    const session = getRevisionSession(10);\n    if (session.length === 0) return;\n    setQuestions(session);\n    setMode(\"mistakes\");\n    setCurrentQ(0);\n    setSelected(null);\n    setAnswers([]);\n    setShowResults(false);\n  };\n\n  const startSmartRevision = () => {\n    const pack = getSmartRevisionPack();\n    if (pack.length === 0) return;\n    setQuestions(pack);\n    setMode(\"smart\");\n    setCurrentQ(0);\n    setSelected(null);\n    setAnswers([]);\n    setShowResults(false);\n  };\n\n  const handleSelect = (index) => {\n    if (selected !== null) return;\n\n    const question = questions[currentQ];\n    const isCorrect = index === question.answer;\n\n    setSelected(index);\n    const newAnswers = [...answers, { cardId: question.cardId, lessonId: question.lessonId, correct: isCorrect }];\n    setAnswers(newAnswers);\n\n    setTimeout(() => {\n      if (currentQ < questions.length - 1) {\n        setCurrentQ(currentQ + 1);\n        setSelected(null);\n      } else {\n        finishSession(newAnswers);\n      }\n    }, 1200);\n  };\n\n  const finishSession = (finalAnswers) => {\n    const correctCount = finalAnswers.filter((a) => a.correct).length;\n    const totalQuestions = questions.length;\n\n    if (mode === \"mistakes\") {\n      finalAnswers.forEach((ans) => {\n        markQuestionReviewed(ans.cardId, ans.lessonId, ans.correct);\n      });\n\n      const xpPerCorrect = 4;\n      const xpEarned = correctCount * xpPerCorrect;\n      const bonusXP = correctCount === totalQuestions ? 10 : 0;\n      const totalXP = xpEarned + bonusXP;\n\n      if (totalXP > 0) {\n        addXPAndCoins(totalXP, 0);\n        analytics(\"revision_completed\", {\n          mode: \"mistakes\",\n          score: correctCount,\n          total: totalQuestions,\n          xpEarned: totalXP,\n        });\n        \n        // Log XP event for revision mistakes mode\n        (async () => {\n          const { data } = await supabase.auth.getUser();\n          const userId = data?.user?.id;\n          if (userId) {\n            logXpEvent(userId, totalXP, \"revision\");\n          }\n        })();\n      }\n    } else if (mode === \"smart\") {\n      const xp = 25;\n      const coins = 10;\n      addXPAndCoins(xp, coins);\n      analytics(\"revision_completed\", {\n        mode: \"smart\",\n        score: correctCount,\n        total: totalQuestions,\n        xpEarned: xp,\n        coinsEarned: coins,\n      });\n      \n      // Log XP event for smart revision mode\n      (async () => {\n        const { data } = await supabase.auth.getUser();\n        const userId = data?.user?.id;\n        if (userId) {\n          logXpEvent(userId, xp, \"revision\");\n        }\n      })();\n    }\n\n    setShowResults(true);\n  };\n\n  const goBack = () => {\n    setMode(null);\n    setQuestions([]);\n    setCurrentQ(0);\n    setSelected(null);\n    setAnswers([]);\n    setShowResults(false);\n  };\n\n  if (showResults) {\n    const correctCount = answers.filter((a) => a.correct).length;\n    const totalQuestions = questions.length;\n    const passed = correctCount >= totalQuestions * 0.5;\n\n    let rewardXP = 0;\n    let rewardCoins = 0;\n\n    if (mode === \"mistakes\") {\n      rewardXP = correctCount * 4;\n      if (correctCount === totalQuestions) rewardXP += 10;\n    } else if (mode === \"smart\") {\n      rewardXP = 25;\n      rewardCoins = 10;\n    }\n\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n          color: \"#ffffff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          padding: \"20px\",\n        }}\n      >\n        <div\n          style={{\n            background: \"rgba(255, 255, 255, 0.05)\",\n            borderRadius: \"20px\",\n            padding: \"40px\",\n            maxWidth: \"500px\",\n            width: \"100%\",\n            textAlign: \"center\",\n            border: \"2px solid #D4AF37\",\n            boxShadow: \"0 10px 40px rgba(212, 175, 55, 0.3)\",\n          }}\n        >\n          <img\n            src={passed ? assets.mascots.mascot_congratulation : assets.mascots.mascot_sitting_v2}\n            alt=\"Mascot\"\n            style={{\n              width: \"100px\",\n              height: \"auto\",\n              margin: \"0 auto 20px\",\n              animation: \"bounce 1.5s infinite\",\n            }}\n          />\n\n          <style>{`\n            @keyframes bounce {\n              0%, 100% { transform: translateY(0); }\n              50% { transform: translateY(-10px); }\n            }\n          `}</style>\n\n          <h1\n            style={{\n              fontSize: \"2rem\",\n              fontWeight: 700,\n              color: passed ? \"#10B981\" : \"#D4AF37\",\n              marginBottom: \"20px\",\n            }}\n          >\n            {passed ? \"Great Work!\" : \"Keep Learning!\"}\n          </h1>\n\n          <div\n            style={{\n              fontSize: \"3rem\",\n              fontWeight: 900,\n              color: \"#D4AF37\",\n              marginBottom: \"30px\",\n            }}\n          >\n            {correctCount}/{totalQuestions}\n          </div>\n\n          {rewardXP > 0 && (\n            <div\n              style={{\n                background: \"rgba(212, 175, 55, 0.1)\",\n                borderRadius: \"16px\",\n                padding: \"20px\",\n                marginBottom: \"20px\",\n              }}\n            >\n              <p style={{ fontSize: \"1.1rem\", color: \"#10B981\", fontWeight: 600, margin: \"0 0 10px\" }}>\n                Rewards Earned!\n              </p>\n              <div style={{ fontSize: \"1.5rem\", color: \"#D4AF37\" }}>\n                +{rewardXP} XP\n                {rewardCoins > 0 && ` +${rewardCoins} Coins`}\n              </div>\n            </div>\n          )}\n\n          {mode === \"mistakes\" && correctCount === totalQuestions && (\n            <p style={{ color: \"#10B981\", fontWeight: 600, marginBottom: \"20px\" }}>\n              Perfect Score Bonus: +10 XP\n            </p>\n          )}\n\n          {mode === \"mistakes\" && correctCount > 0 && (\n            <p style={{ opacity: 0.8, marginBottom: \"20px\", fontSize: \"0.95rem\" }}>\n              {correctCount} question{correctCount > 1 ? \"s\" : \"\"} improved!\n            </p>\n          )}\n\n          <button\n            onClick={goBack}\n            style={{\n              marginTop: \"10px\",\n              background: \"#D4AF37\",\n              border: \"none\",\n              padding: \"14px 28px\",\n              borderRadius: \"12px\",\n              fontWeight: \"bold\",\n              fontSize: \"1rem\",\n              cursor: \"pointer\",\n              color: \"#0B1E2D\",\n              transition: \"all 0.2s\",\n            }}\n          >\n            Back to Revise\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (mode && questions.length > 0) {\n    const currentQuestion = {\n      text: questions[currentQ].question,\n      options: questions[currentQ].options,\n      correctIndex: questions[currentQ].answer,\n    };\n\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n          color: \"#ffffff\",\n          padding: \"20px\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      >\n        <div style={{ width: \"100%\", maxWidth: \"600px\" }}>\n          <div style={{ textAlign: \"center\", marginBottom: \"30px\" }}>\n            <h2 style={{ fontSize: \"1.5rem\", color: \"#D4AF37\", marginBottom: \"10px\" }}>\n              {mode === \"mistakes\" ? \"Review Mistakes\" : \"Smart Revision\"}\n            </h2>\n            <p style={{ opacity: 0.8, fontSize: \"0.9rem\" }}>\n              {mode === \"mistakes\" ? \"Master your weak areas\" : \"Strengthen your weakest path\"}\n            </p>\n            <img\n              src={assets.mascots.mascot_pointing_v2}\n              alt=\"Mascot\"\n              style={{ width: \"80px\", height: \"auto\", margin: \"20px auto 0\" }}\n            />\n          </div>\n\n          <QuestionCard\n            question={currentQuestion}\n            selected={selected}\n            onSelect={handleSelect}\n            currentQ={currentQ}\n            totalQ={questions.length}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  const weakestPath = getWeakestPath();\n  const hasWeakestPath = weakestPath !== null && weakestPath.totalQuestions > 0;\n  const totalCompleted = getTotalCompletedLessons();\n  const isSmartActive = smartRevisionUnlocked && hasWeakestPath;\n\n  return (\n    <ScreenContainer>\n      <div style={{ position: \"relative\", padding: \"20px 20px 40px\" }}>\n        <div style={{ textAlign: \"center\", marginTop: \"20px\", marginBottom: \"30px\" }}>\n          <h1\n            style={{\n              fontSize: \"clamp(1.5rem, 5vw, 2rem)\",\n              fontWeight: 800,\n              margin: 0,\n              background: \"linear-gradient(90deg, #FFD700, #FFA500, #FFD700)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n              backgroundSize: \"200%\",\n              animation: \"shimmer 8s linear infinite\",\n            }}\n          >\n            Revise & Master\n          </h1>\n          <p style={{ opacity: 0.9, marginTop: 8, fontSize: \"0.95rem\" }}>\n            Turn your mistakes into mastery\n          </p>\n        </div>\n\n        <div\n          onClick={reviewMistakesUnlocked && hasWeakQuestions ? startMistakesReview : null}\n          style={{\n            background: reviewMistakesUnlocked\n              ? (hasWeakQuestions \n                  ? \"linear-gradient(145deg, rgba(212,175,55,0.2), rgba(16,185,129,0.1))\"\n                  : \"linear-gradient(145deg, rgba(16,185,129,0.1), rgba(107,114,128,0.1))\")\n              : \"linear-gradient(145deg, rgba(107,114,128,0.2), rgba(75,85,99,0.1))\",\n            border: `2px solid ${reviewMistakesUnlocked ? (hasWeakQuestions ? \"rgba(212,175,55,0.5)\" : \"rgba(16,185,129,0.3)\") : \"rgba(107,114,128,0.3)\"}`,\n            borderRadius: 20,\n            padding: 24,\n            marginBottom: 20,\n            cursor: reviewMistakesUnlocked && hasWeakQuestions ? \"pointer\" : \"default\",\n            transition: \"all 0.3s ease\",\n            boxShadow: reviewMistakesUnlocked\n              ? (hasWeakQuestions \n                  ? \"0 8px 20px rgba(212,175,55,0.2)\"\n                  : \"0 4px 15px rgba(16,185,129,0.1)\")\n              : \"0 4px 10px rgba(0,0,0,0.1)\",\n            opacity: reviewMistakesUnlocked ? 1 : 0.6,\n          }}\n        >\n          <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n            <div>\n              <h3 style={{ fontSize: \"1.3rem\", fontWeight: 700, color: reviewMistakesUnlocked ? \"#D4AF37\" : \"#9CA3AF\", margin: \"0 0 8px\" }}>\n                Review Mistakes\n              </h3>\n              <p style={{ opacity: 0.85, margin: \"0 0 12px\", fontSize: \"0.9rem\", lineHeight: 1.5 }}>\n                {reviewMistakesUnlocked && !hasWeakQuestions \n                  ? \"No mistakes to review - keep up the great work!\"\n                  : \"Fix mistakes from past lessons, quizzes, and challenges.\"}\n              </p>\n              <div style={{ display: \"flex\", gap: 10, flexWrap: \"wrap\", fontSize: \"0.85rem\", opacity: 0.7 }}>\n                <span>10 questions</span>\n                <span>|</span>\n                <span>No timer</span>\n                <span>|</span>\n                <span>+4 XP per correct</span>\n              </div>\n            </div>\n            <div\n              style={{\n                background: reviewMistakesUnlocked\n                  ? (hasWeakQuestions ? \"rgba(212,175,55,0.2)\" : \"rgba(16,185,129,0.2)\")\n                  : \"rgba(107,114,128,0.2)\",\n                borderRadius: \"50%\",\n                width: 60,\n                height: 60,\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                fontSize: \"1.8rem\",\n                flexShrink: 0,\n                color: reviewMistakesUnlocked \n                  ? (hasWeakQuestions ? \"#D4AF37\" : \"#10B981\")\n                  : \"#9CA3AF\",\n              }}\n            >\n              {reviewMistakesUnlocked ? (hasWeakQuestions ? enrichedPool.length : \"‚úì\") : \"?\"}\n            </div>\n          </div>\n\n          {!reviewMistakesUnlocked && (\n            <div\n              style={{\n                marginTop: 15,\n                padding: 12,\n                background: \"rgba(255,255,255,0.05)\",\n                borderRadius: 10,\n                fontSize: \"0.85rem\",\n                opacity: 0.8,\n              }}\n            >\n              Get your first question wrong in any quiz to unlock this feature!\n            </div>\n          )}\n\n          {reviewMistakesUnlocked && !hasWeakQuestions && (\n            <div\n              style={{\n                marginTop: 15,\n                padding: 12,\n                background: \"rgba(255,255,255,0.05)\",\n                borderRadius: 10,\n                fontSize: \"0.85rem\",\n                opacity: 0.8,\n              }}\n            >\n              No mistakes to review! You've mastered all your weak areas!\n            </div>\n          )}\n        </div>\n\n        <div\n          onClick={isSmartActive ? startSmartRevision : null}\n          style={{\n            background: isSmartActive\n              ? \"linear-gradient(145deg, rgba(59,130,246,0.2), rgba(147,51,234,0.1))\"\n              : \"linear-gradient(145deg, rgba(107,114,128,0.2), rgba(75,85,99,0.1))\",\n            border: `2px solid ${isSmartActive ? \"rgba(59,130,246,0.5)\" : \"rgba(107,114,128,0.3)\"}`,\n            borderRadius: 20,\n            padding: 24,\n            cursor: isSmartActive ? \"pointer\" : \"not-allowed\",\n            transition: \"all 0.3s ease\",\n            boxShadow: isSmartActive ? \"0 8px 20px rgba(59,130,246,0.2)\" : \"0 4px 10px rgba(0,0,0,0.1)\",\n            opacity: isSmartActive ? 1 : 0.6,\n          }}\n        >\n          <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n            <div>\n              <h3 style={{ fontSize: \"1.3rem\", fontWeight: 700, color: isSmartActive ? \"#3B82F6\" : \"#9CA3AF\", margin: \"0 0 8px\" }}>\n                Smart Revision\n              </h3>\n              <p style={{ opacity: 0.85, margin: \"0 0 12px\", fontSize: \"0.9rem\", lineHeight: 1.5 }}>\n                {isSmartActive ? `Revise your weakest topic: ${weakestPath.title}` : \"Revise your weakest topics intelligently.\"}\n              </p>\n              <div style={{ display: \"flex\", gap: 10, flexWrap: \"wrap\", fontSize: \"0.85rem\", opacity: 0.7 }}>\n                <span>8 questions</span>\n                <span>|</span>\n                <span>No timer</span>\n                <span>|</span>\n                <span>+25 XP +10 Coins</span>\n              </div>\n            </div>\n            <div\n              style={{\n                background: isSmartActive ? \"rgba(59,130,246,0.2)\" : \"rgba(107,114,128,0.2)\",\n                borderRadius: \"50%\",\n                width: 60,\n                height: 60,\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                fontSize: \"1.8rem\",\n                flexShrink: 0,\n              }}\n            >\n              {isSmartActive ? \"+\" : \"?\"}\n            </div>\n          </div>\n\n          {isSmartActive && weakestPath.wrongQuestions > 0 && (\n            <div\n              style={{\n                marginTop: 15,\n                padding: 12,\n                background: \"rgba(59,130,246,0.1)\",\n                borderRadius: 10,\n                fontSize: \"0.85rem\",\n                opacity: 0.9,\n              }}\n            >\n              {weakestPath.wrongQuestions} mistakes found | {weakestPath.completedLessons} lessons completed\n            </div>\n          )}\n\n          {!smartRevisionUnlocked && (\n            <div\n              style={{\n                marginTop: 15,\n                padding: 12,\n                background: \"rgba(255,255,255,0.05)\",\n                borderRadius: 10,\n                fontSize: \"0.85rem\",\n                opacity: 0.8,\n              }}\n            >\n              Complete 40 lessons to unlock Smart Revision! ({totalCompleted}/40)\n            </div>\n          )}\n\n          {smartRevisionUnlocked && !hasWeakestPath && (\n            <div\n              style={{\n                marginTop: 15,\n                padding: 12,\n                background: \"rgba(255,255,255,0.05)\",\n                borderRadius: 10,\n                fontSize: \"0.85rem\",\n                opacity: 0.8,\n              }}\n            >\n              Keep learning! Complete more lessons to build your revision pack.\n            </div>\n          )}\n        </div>\n      </div>\n\n      <style>\n        {`\n          @keyframes shimmer {\n            0% { background-position: 0% 50%; }\n            100% { background-position: 200% 50%; }\n          }\n        `}\n      </style>\n    </ScreenContainer>\n  );\n}\n","path":null,"size_bytes":21540,"size_tokens":null},"src/components/EditNameInput.jsx":{"content":"import React, { useState } from \"react\";\n\nexport default function EditNameInput({ isOpen, onClose, currentName, onSave }) {\n  const [name, setName] = useState(currentName || \"\");\n\n  if (!isOpen) return null;\n\n  const handleSave = () => {\n    if (name.trim()) {\n      onSave(name.trim());\n      onClose();\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: \"rgba(0, 0, 0, 0.8)\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        zIndex: 100,\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          background: \"#0B1E2D\",\n          padding: \"24px\",\n          borderRadius: \"16px\",\n          border: \"2px solid rgba(212, 175, 55, 0.3)\",\n          textAlign: \"center\",\n          maxWidth: \"90%\",\n          width: \"300px\",\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <h3 style={{ color: \"#D4AF37\", marginBottom: \"16px\" }}>Edit Name</h3>\n        <input\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          placeholder=\"Enter your name\"\n          style={{\n            width: \"100%\",\n            padding: \"12px\",\n            borderRadius: \"8px\",\n            border: \"1px solid rgba(255,215,0,0.4)\",\n            background: \"rgba(255,255,255,0.05)\",\n            color: \"white\",\n            textAlign: \"center\",\n            fontSize: \"1rem\",\n            marginBottom: \"16px\",\n          }}\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\") handleSave();\n          }}\n        />\n        <div style={{ display: \"flex\", gap: \"8px\", justifyContent: \"center\" }}>\n          <button\n            onClick={onClose}\n            style={{\n              padding: \"10px 20px\",\n              borderRadius: \"8px\",\n              border: \"1px solid rgba(255, 255, 255, 0.2)\",\n              background: \"transparent\",\n              color: \"white\",\n              fontWeight: 600,\n              cursor: \"pointer\",\n            }}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            style={{\n              padding: \"10px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: \"#FFD700\",\n              color: \"#0B1E2D\",\n              fontWeight: 600,\n              cursor: \"pointer\",\n            }}\n          >\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2521,"size_tokens":null},"src/onboarding/BismillahScreen.jsx":{"content":"import React, { useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\n\nexport default function BismillahScreen() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"bismillah\");\n  }, []);\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background:\n          \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: \"24px\",\n        paddingRight: \"24px\",\n        paddingTop: \"24px\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 40 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 1 }}\n      >\n        <h2 style={{ fontFamily: \"Amiri, serif\", color: \"#D4AF37\", fontSize: \"1.6rem\" }}>\n          ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸëŸ∞ŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê\n        </h2>\n        <p style={{ marginTop: \"8px\", color: \"#e5e5e5\" }}>\n          In the name of Allah, the Most Merciful, the Most Compassionate\n        </p>\n        <p style={{ marginTop: \"20px\", color: \"#bbb\", fontSize: \"0.95rem\" }}>\n          Begin with a pure intention. <br />\n          Seek knowledge to get closer to Allah.\n        </p>\n        <p style={{ marginTop: \"8px\", fontSize: \"0.9rem\", color: \"#888\" }}>\n          May Allah bless your learning and efforts.\n        </p>\n\n        <button\n          onClick={() => navigate(\"/onboarding/salaam\")}\n          style={{\n            marginTop: \"32px\",\n            background: \"#D4AF37\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: \"10px\",\n            padding: \"12px 36px\",\n            fontWeight: \"600\",\n            fontSize: \"1rem\",\n            cursor: \"pointer\",\n          }}\n        >\n          Bismillah\n        </button>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2015,"size_tokens":null},"src/pages/Friends.jsx":{"content":"import { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useFriendsStore } from \"../store/friendsStore\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useFriendChallengesStore } from \"../store/friendChallengesStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  Search,\n  UserPlus,\n  Users,\n  Send,\n  X,\n  Check,\n  Clock,\n  Trophy,\n  Flame,\n  MessageCircle,\n  Swords,\n  Globe,\n  Zap,\n} from \"lucide-react\";\nimport { LevelBadgeCompact } from \"../components/LevelBadge\";\nimport { getAvatarImage } from \"../utils/avatarUtils\";\nimport { getCurrentLevel } from \"../utils/diamondLevels\";\nimport { getModeIcon, getModeName } from \"../utils/challengeQuestions\";\nimport QuickMessageModal from \"../components/QuickMessageModal\";\nimport assets from \"../assets/assets\";\n\nconst highlightStyle = `\n.highlight-user {\n  border: 2px solid gold !important;\n  background: rgba(255, 215, 0, 0.15) !important;\n  box-shadow: 0 0 12px rgba(255, 215, 0, 0.3) !important;\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(1);\n    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.5);\n  }\n  50% {\n    transform: scale(1.05);\n    box-shadow: 0 0 0 8px rgba(34, 197, 94, 0);\n  }\n  100% {\n    transform: scale(1);\n    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);\n  }\n}\n`;\n\nexport default function Friends() {\n  const navigate = useNavigate();\n  const { id: currentUserId, name, avatar, username } = useUserStore();\n  const { xp: currentUserXP, streak: currentUserStreak } = useProgressStore();\n  const { showModal } = useModalStore();\n\n  const {\n    loadAll,\n    loadFriends,\n    loadRequests,\n    loadPendingRequests,\n    getAllFriends,\n    getSentRequests,\n    getReceivedRequests,\n    searchUsers,\n    sendFriendRequest,\n    acceptFriendRequest,\n    declineFriendRequest,\n    cancelSentRequest,\n    isFriend,\n    canSendRequest,\n    getFriendship,\n    loadLeaderboard,\n    getGlobalLeaderboard,\n  } = useFriendsStore();\n\n  const {\n    initialize: initFriendChallenges,\n    loadChallenges,\n    pendingIncoming,\n    pendingOutgoing,\n    activeChallenges,\n    resultsToView,\n    currentUserId: challengeUserId,\n    unreadCount: challengeUnreadCount,\n    getChallengeStateForFriend,\n    acceptChallenge,\n    declineChallenge,\n    clearPendingIncomingCount,\n    markResultViewed,\n  } = useFriendChallengesStore();\n\n  const [activeTab, setActiveTab] = useState(\"friends\");\n  const [leaderboardTab, setLeaderboardTab] = useState(\"friends\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [searchResults, setSearchResults] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [quickMessageFriend, setQuickMessageFriend] = useState(null);\n  const [globalLeaderboard, setGlobalLeaderboard] = useState([]);\n  const [loadingGlobal, setLoadingGlobal] = useState(true);\n  const [acceptingChallengeId, setAcceptingChallengeId] = useState(null);\n\n  useEffect(() => {\n    if (!currentUserId) return;\n    // Initial load - parallel for speed\n    Promise.all([\n      useFriendsStore.getState().loadAll(),\n      initFriendChallenges().then(() => loadChallenges()),\n    ]);\n    clearPendingIncomingCount();\n  }, [currentUserId]);\n  \n  useEffect(() => {\n    const handleFocus = () => {\n      // Parallel refresh on window focus\n      Promise.all([\n        useFriendsStore.getState().loadAll(),\n        loadChallenges(),\n      ]);\n    };\n    window.addEventListener('focus', handleFocus);\n    return () => window.removeEventListener('focus', handleFocus);\n  }, [loadChallenges]);\n\n  // Lightweight background poll as fallback (real-time handles most updates)\n  useEffect(() => {\n    let isMounted = true;\n    const poll = () => {\n      if (!isMounted) return;\n      Promise.all([\n        useFriendsStore.getState().loadAll(),\n        loadChallenges(),\n      ]);\n    };\n    const intervalId = setInterval(poll, 15000); // Reduced frequency since real-time handles instant updates\n    return () => { isMounted = false; clearInterval(intervalId); };\n  }, [loadChallenges]);\n\n  const loadGlobalLeaderboard = useCallback(async () => {\n    setLoadingGlobal(true);\n\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp, streak\")\n        .order(\"xp\", { ascending: false })\n        .limit(100);\n\n      if (error) {\n        console.log(\"Global leaderboard fetch error:\", error.message);\n      }\n\n      const THE_DEV_ENTRY = {\n        user_id: \"the_dev_permanent\",\n        username: \"The Dev\",\n        handle: \"thedev\",\n        avatar: \"avatar_ninja_male\",\n        xp: 168542,\n        streak: 82,\n        isPermanent: true,\n      };\n\n      const userState = useUserStore.getState();\n      const progressState = useProgressStore.getState();\n      const CURRENT_USER_ENTRY = {\n        user_id: currentUserId || userState.id || \"current_user\",\n        username: name || userState.name || userState.username || \"You\",\n        handle: userState.handle || username || \"you\",\n        avatar: avatar || userState.avatar || \"avatar_man_lantern\",\n        xp: currentUserXP || progressState.xp || 0,\n        streak: currentUserStreak || progressState.streak || 0,\n        isCurrentUser: true,\n      };\n\n      const dbUsers = (data || []).filter(\n        (u) =>\n          u.user_id !== currentUserId &&\n          u.user_id !== CURRENT_USER_ENTRY.user_id\n      );\n\n      const combined = [THE_DEV_ENTRY, CURRENT_USER_ENTRY, ...dbUsers].sort(\n        (a, b) => b.xp - a.xp\n      );\n\n      setGlobalLeaderboard(combined);\n    } catch (err) {\n      console.log(\"Global leaderboard error:\", err);\n    } finally {\n      setLoadingGlobal(false);\n    }\n  }, [currentUserId, name, avatar, username, currentUserXP, currentUserStreak]);\n\n  useEffect(() => {\n    loadGlobalLeaderboard();\n  }, [loadGlobalLeaderboard]);\n\n  useEffect(() => {\n    const performSearch = async () => {\n      if (searchQuery.trim().length >= 2) {\n        setIsSearching(true);\n        try {\n          const results = await searchUsers(searchQuery.trim());\n          setSearchResults(results);\n        } catch (err) {\n          console.warn(\"Search error:\", err);\n          setSearchResults([]);\n        } finally {\n          setIsSearching(false);\n        }\n      } else {\n        setSearchResults([]);\n      }\n    };\n\n    const debounce = setTimeout(performSearch, 300);\n    return () => clearTimeout(debounce);\n  }, [searchQuery, searchUsers]);\n\n  const friends = getAllFriends();\n  const sentRequests = getSentRequests();\n  const receivedRequests = getReceivedRequests();\n\n  const friendsLeaderboard = friends\n    .map((f) => ({\n      user_id: f.user_id || f.id,\n      username: f.username || f.handle || f.nickname,\n      handle: f.handle || f.username,\n      avatar: f.avatar,\n      xp: f.xp || 0,\n      streak: f.streak || 0,\n    }))\n    .sort((a, b) => b.xp - a.xp);\n\n  const currentUserIdForHighlight =\n    currentUserId || useUserStore.getState().user?.id || useUserStore.getState().id;\n\n  const handleSendRequest = async (userId) => {\n    const result = await sendFriendRequest(userId);\n    if (result.success) {\n      showModal(MODAL_TYPES.SUCCESS, { message: result.message });\n    } else {\n      showModal(MODAL_TYPES.ERROR, { message: result.error });\n    }\n  };\n\n  const handleAcceptRequest = async (requestId) => {\n    const result = await acceptFriendRequest(requestId);\n    if (result.success) {\n      showModal(MODAL_TYPES.SUCCESS, { message: result.message });\n      await loadFriends();\n      await loadPendingRequests();\n    } else {\n      showModal(MODAL_TYPES.ERROR, { message: result.error });\n    }\n  };\n\n  const handleDeclineRequest = async (requestId) => {\n    const result = await declineFriendRequest(requestId);\n    if (result.success) {\n      await loadFriends();\n      await loadPendingRequests();\n    } else {\n      showModal(MODAL_TYPES.ERROR, { message: result.error });\n    }\n  };\n\n  const handleCancelRequest = async (receiverId) => {\n    const result = await cancelSentRequest(receiverId);\n    if (result.success) {\n      showModal(MODAL_TYPES.SUCCESS, { message: result.message });\n    } else {\n      showModal(MODAL_TYPES.ERROR, { message: result.error });\n    }\n  };\n\n  const handleUserClick = (userId) => {\n    if (isFriend(userId)) {\n      navigate(`/friend/${userId}`);\n    }\n  };\n\n  const getButtonState = (userId) => {\n    if (isFriend(userId)) return \"friends\";\n    const friendship = getFriendship(userId);\n    if (friendship?.status === \"sent\") return \"sent\";\n    if (friendship?.status === \"received\") return \"received\";\n    return \"add\";\n  };\n\n  const handleChallengeFriend = (friend) => {\n    const friendUserId = friend.user_id || friend.id;\n    const challengeState = getChallengeStateForFriend(friendUserId);\n    \n    if (challengeState?.type === \"pending_received\") {\n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_RECEIVED, {\n        challenge: challengeState.challenge,\n        senderName: friend.nickname || friend.username || \"Friend\",\n        senderAvatar: friend.avatar,\n        onAccept: async () => {\n          await acceptChallenge(challengeState.challenge.id);\n          navigate(`/challenge/friend/${challengeState.challenge.id}`);\n        },\n        onDecline: async () => {\n          await declineChallenge(challengeState.challenge.id);\n        },\n      });\n      return;\n    }\n    \n    if (challengeState?.type === \"ready_to_play\") {\n      navigate(`/challenge/friend/${challengeState.challenge.id}`);\n      return;\n    }\n    \n    if (challengeState?.type === \"results_ready\") {\n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_RESULTS, {\n        challenge: challengeState.challenge,\n        currentUserId,\n        onChallengeAgain: (modeId) => {\n          const friendLevel = getCurrentLevel(friend.xp);\n          navigate(\"/challenge\", {\n            state: {\n              preselectedFriend: {\n                id: friendUserId,\n                user_id: friendUserId,\n                name: friend.nickname || friend.username,\n                nickname: friend.nickname || friend.username,\n                username: friend.username,\n                avatar: friend.avatar,\n                xp: friend.xp,\n                streak: friend.streak,\n                level: friendLevel.level,\n              },\n            },\n          });\n        },\n      });\n      return;\n    }\n    \n    if (challengeState?.type === \"pending_sent\") {\n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_SENT, {\n        friendName: friend.nickname || friend.username || \"Friend\",\n        modeId: challengeState.challenge.challenge_type,\n      });\n      return;\n    }\n    \n    if (challengeState?.type === \"waiting_for_friend\") {\n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_WAITING, {\n        friendName: friend.nickname || friend.username || \"Friend\",\n        modeId: challengeState.challenge.challenge_type,\n      });\n      return;\n    }\n    \n    const friendLevel = getCurrentLevel(friend.xp);\n    navigate(\"/challenge\", {\n      state: {\n        preselectedFriend: {\n          id: friendUserId,\n          user_id: friendUserId,\n          name: friend.nickname || friend.username,\n          nickname: friend.nickname || friend.username,\n          username: friend.username,\n          avatar: friend.avatar,\n          xp: friend.xp,\n          streak: friend.streak,\n          level: friendLevel.level,\n        },\n      },\n    });\n  };\n\n  const handleQuickMessage = (friend) => {\n    setQuickMessageFriend(friend);\n  };\n\n  const getFriendChallengeState = (friendId) => {\n    return getChallengeStateForFriend(friendId);\n  };\n\n  const yourTurnChallenges = activeChallenges.filter(c => {\n    const isSender = c.sender_id === challengeUserId;\n    const myTurnDone = isSender ? (c.sender_score !== null) : (c.receiver_score !== null);\n    return !myTurnDone;\n  });\n\n  const waitingChallenges = activeChallenges.filter(c => {\n    const isSender = c.sender_id === challengeUserId;\n    const myTurnDone = isSender ? (c.sender_score !== null) : (c.receiver_score !== null);\n    return myTurnDone && c.status !== \"finished\";\n  });\n\n  const totalChallengeActivity = pendingIncoming.length + yourTurnChallenges.length + \n    waitingChallenges.length + resultsToView.length + pendingOutgoing.length;\n\n  const totalRequests = sentRequests.length + receivedRequests.length;\n\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background: \"#0B1E2D\",\n        minHeight: \"100vh\",\n        paddingBottom: \"80px\",\n      }}\n    >\n      <style>{highlightStyle}</style>\n\n      <div\n        style={{\n          background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n          padding: \"20px 20px 0\",\n          borderBottom: \"1px solid rgba(212, 175, 55, 0.2)\",\n        }}\n      >\n        <h1\n          style={{\n            color: \"#D4AF37\",\n            fontSize: \"1.8rem\",\n            fontWeight: \"bold\",\n            textAlign: \"center\",\n            marginBottom: \"20px\",\n          }}\n        >\n          Friends\n        </h1>\n\n        <div\n          style={{\n            display: \"flex\",\n            gap: \"8px\",\n            justifyContent: \"center\",\n          }}\n        >\n          <TabButton\n            active={activeTab === \"friends\"}\n            onClick={() => setActiveTab(\"friends\")}\n            icon={<Users size={18} />}\n            label=\"Friends\"\n            count={friends.length}\n          />\n          <TabButton\n            active={activeTab === \"leaderboard\"}\n            onClick={() => setActiveTab(\"leaderboard\")}\n            icon={<Trophy size={18} />}\n            label=\"Leaderboard\"\n          />\n          <TabButton\n            active={activeTab === \"requests\"}\n            onClick={() => setActiveTab(\"requests\")}\n            icon={<Send size={18} />}\n            label=\"Requests\"\n            count={totalRequests}\n            badge={receivedRequests.length > 0}\n          />\n          <TabButton\n            active={activeTab === \"search\"}\n            onClick={() => setActiveTab(\"search\")}\n            icon={<Search size={18} />}\n            label=\"Search\"\n          />\n        </div>\n      </div>\n\n      <div style={{ padding: \"16px\" }}>\n        <AnimatePresence mode=\"wait\">\n          {activeTab === \"friends\" && (\n            <motion.div\n              key=\"friends\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              onAnimationComplete={() => {\n                console.log(\"[Friends] Rendering friends tab, pendingIncoming:\", pendingIncoming.length);\n              }}\n            >\n              {/* Incoming Challenge Requests Section */}\n              {/* Challenge Activity Section */}\n              {totalChallengeActivity > 0 && (\n                <div style={{ marginBottom: \"20px\" }}>\n                  <div style={{\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: \"8px\",\n                    marginBottom: \"12px\",\n                  }}>\n                    <Swords size={18} color=\"#d4af37\" />\n                    <h3 style={{\n                      color: \"#d4af37\",\n                      fontSize: \"1rem\",\n                      fontWeight: \"600\",\n                      margin: 0,\n                    }}>\n                      Challenge Activity ({totalChallengeActivity})\n                    </h3>\n                  </div>\n                  <div style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: \"10px\",\n                  }}>\n                    {/* Incoming Challenge Requests */}\n                    {pendingIncoming.map((challenge) => {\n                      const sender = friends.find(f => (f.user_id || f.id) === challenge.sender_id);\n                      const senderName = sender?.nickname || sender?.username || \"Friend\";\n                      const senderAvatar = sender?.avatar;\n                      const avatarSrc = getAvatarImage(senderAvatar, { userId: challenge.sender_id, nickname: senderName });\n                      \n                      return (\n                        <motion.div\n                          key={`incoming-${challenge.id}`}\n                          initial={{ opacity: 0, scale: 0.95 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          style={{\n                            background: \"linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(217, 119, 6, 0.1) 100%)\",\n                            border: \"2px solid #f59e0b\",\n                            borderRadius: \"12px\",\n                            padding: \"14px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            gap: \"12px\",\n                          }}\n                        >\n                          <div style={{\n                            width: \"44px\",\n                            height: \"44px\",\n                            borderRadius: \"50%\",\n                            border: \"2px solid #f59e0b\",\n                            overflow: \"hidden\",\n                            flexShrink: 0,\n                          }}>\n                            <img\n                              src={avatarSrc}\n                              alt={senderName}\n                              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n                            />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <p style={{\n                              color: \"#f59e0b\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.75rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                              textTransform: \"uppercase\",\n                              letterSpacing: \"0.5px\",\n                            }}>\n                              Challenge Request\n                            </p>\n                            <p style={{\n                              color: \"#e2e8f0\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.95rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                            }}>\n                              {senderName}\n                            </p>\n                            <p style={{\n                              color: \"#94a3b8\",\n                              fontSize: \"0.8rem\",\n                              margin: 0,\n                            }}>\n                              {getModeIcon(challenge.challenge_type)} {getModeName(challenge.challenge_type)}\n                            </p>\n                          </div>\n                          <div style={{ display: \"flex\", gap: \"8px\" }}>\n                            <button\n                              type=\"button\"\n                              disabled={acceptingChallengeId === challenge.id}\n                              onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                setAcceptingChallengeId(challenge.id);\n                                acceptChallenge(challenge.id).then((result) => {\n                                  setAcceptingChallengeId(null);\n                                  if (result.success) {\n                                    navigate(`/challenge/friend/${challenge.id}`);\n                                  } else {\n                                    alert(result.error || \"Could not accept challenge\");\n                                  }\n                                }).catch((err) => {\n                                  setAcceptingChallengeId(null);\n                                  alert(\"Error: \" + err.message);\n                                });\n                              }}\n                              style={{\n                                padding: \"10px 16px\",\n                                background: acceptingChallengeId === challenge.id ? \"#b45309\" : \"#f59e0b\",\n                                border: \"none\",\n                                borderRadius: \"8px\",\n                                color: \"#fff\",\n                                fontWeight: \"600\",\n                                fontSize: \"0.85rem\",\n                                cursor: acceptingChallengeId === challenge.id ? \"wait\" : \"pointer\",\n                              }}\n                            >\n                              {acceptingChallengeId === challenge.id ? \"...\" : \"Accept\"}\n                            </button>\n                            <motion.button\n                              whileTap={{ scale: 0.95 }}\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                console.log(\"[Friends] Declining challenge:\", challenge.id);\n                                declineChallenge(challenge.id).then((result) => {\n                                  console.log(\"[Friends] Decline result:\", result);\n                                  if (!result.success) {\n                                    alert(result.error || \"Could not decline challenge\");\n                                  }\n                                });\n                              }}\n                              style={{\n                                padding: \"10px 12px\",\n                                background: \"rgba(239, 68, 68, 0.2)\",\n                                border: \"1px solid #ef4444\",\n                                borderRadius: \"8px\",\n                                color: \"#ef4444\",\n                                cursor: \"pointer\",\n                              }}\n                            >\n                              <X size={16} />\n                            </motion.button>\n                          </div>\n                        </motion.div>\n                      );\n                    })}\n\n                    {/* Your Turn - Play Now */}\n                    {yourTurnChallenges.map((challenge) => {\n                      const isSender = challenge.sender_id === challengeUserId;\n                      const friendId = isSender ? challenge.receiver_id : challenge.sender_id;\n                      const friend = friends.find(f => (f.user_id || f.id) === friendId);\n                      const friendName = friend?.nickname || friend?.username || \"Friend\";\n                      const friendAvatar = friend?.avatar;\n                      const avatarSrc = getAvatarImage(friendAvatar, { userId: friendId, nickname: friendName });\n                      \n                      return (\n                        <motion.div\n                          key={`yourturn-${challenge.id}`}\n                          initial={{ opacity: 0, scale: 0.95 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          style={{\n                            background: \"linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%)\",\n                            border: \"2px solid #10b981\",\n                            borderRadius: \"12px\",\n                            padding: \"14px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            gap: \"12px\",\n                            boxShadow: \"0 0 20px rgba(16, 185, 129, 0.2)\",\n                            animation: \"pulseGlow 2s ease-in-out infinite\",\n                          }}\n                        >\n                          <div style={{\n                            width: \"44px\",\n                            height: \"44px\",\n                            borderRadius: \"50%\",\n                            border: \"2px solid #10b981\",\n                            overflow: \"hidden\",\n                            flexShrink: 0,\n                          }}>\n                            <img\n                              src={avatarSrc}\n                              alt={friendName}\n                              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n                            />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <p style={{\n                              color: \"#10b981\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.75rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                              textTransform: \"uppercase\",\n                              letterSpacing: \"0.5px\",\n                            }}>\n                              Your Turn!\n                            </p>\n                            <p style={{\n                              color: \"#e2e8f0\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.95rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                            }}>\n                              vs {friendName}\n                            </p>\n                            <p style={{\n                              color: \"#94a3b8\",\n                              fontSize: \"0.8rem\",\n                              margin: 0,\n                            }}>\n                              {getModeIcon(challenge.challenge_type)} {getModeName(challenge.challenge_type)}\n                            </p>\n                          </div>\n                          <button\n                            onClick={() => navigate(`/challenge/friend/${challenge.id}`)}\n                            style={{\n                              padding: \"10px 20px\",\n                              background: \"#10b981\",\n                              border: \"none\",\n                              borderRadius: \"8px\",\n                              color: \"#fff\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.9rem\",\n                              cursor: \"pointer\",\n                            }}\n                          >\n                            Play Now\n                          </button>\n                        </motion.div>\n                      );\n                    })}\n\n                    {/* Waiting for Friend */}\n                    {waitingChallenges.map((challenge) => {\n                      const isSender = challenge.sender_id === challengeUserId;\n                      const friendId = isSender ? challenge.receiver_id : challenge.sender_id;\n                      const friend = friends.find(f => (f.user_id || f.id) === friendId);\n                      const friendName = friend?.nickname || friend?.username || \"Friend\";\n                      const friendAvatar = friend?.avatar;\n                      const avatarSrc = getAvatarImage(friendAvatar, { userId: friendId, nickname: friendName });\n                      \n                      return (\n                        <motion.div\n                          key={`waiting-${challenge.id}`}\n                          initial={{ opacity: 0, scale: 0.95 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          style={{\n                            background: \"linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%)\",\n                            border: \"1px solid rgba(59, 130, 246, 0.5)\",\n                            borderRadius: \"12px\",\n                            padding: \"14px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            gap: \"12px\",\n                          }}\n                        >\n                          <div style={{\n                            width: \"44px\",\n                            height: \"44px\",\n                            borderRadius: \"50%\",\n                            border: \"2px solid #3b82f6\",\n                            overflow: \"hidden\",\n                            flexShrink: 0,\n                          }}>\n                            <img\n                              src={avatarSrc}\n                              alt={friendName}\n                              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n                            />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <p style={{\n                              color: \"#3b82f6\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.75rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                              textTransform: \"uppercase\",\n                              letterSpacing: \"0.5px\",\n                            }}>\n                              Waiting...\n                            </p>\n                            <p style={{\n                              color: \"#e2e8f0\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.95rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                            }}>\n                              {friendName}'s turn\n                            </p>\n                            <p style={{\n                              color: \"#94a3b8\",\n                              fontSize: \"0.8rem\",\n                              margin: 0,\n                            }}>\n                              {getModeIcon(challenge.challenge_type)} {getModeName(challenge.challenge_type)}\n                            </p>\n                          </div>\n                          <div style={{\n                            padding: \"8px 14px\",\n                            background: \"rgba(59, 130, 246, 0.2)\",\n                            borderRadius: \"8px\",\n                            color: \"#3b82f6\",\n                            fontSize: \"0.8rem\",\n                            fontWeight: \"600\",\n                          }}>\n                            Pending\n                          </div>\n                        </motion.div>\n                      );\n                    })}\n\n                    {/* Results Ready */}\n                    {resultsToView.map((challenge) => {\n                      const isSender = challenge.sender_id === challengeUserId;\n                      const friendId = isSender ? challenge.receiver_id : challenge.sender_id;\n                      const friend = friends.find(f => (f.user_id || f.id) === friendId);\n                      const friendName = friend?.nickname || friend?.username || \"Friend\";\n                      const friendAvatar = friend?.avatar;\n                      const avatarSrc = getAvatarImage(friendAvatar, { userId: friendId, nickname: friendName });\n                      \n                      return (\n                        <motion.div\n                          key={`results-${challenge.id}`}\n                          initial={{ opacity: 0, scale: 0.95 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          style={{\n                            background: \"linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(124, 58, 237, 0.1) 100%)\",\n                            border: \"2px solid #8b5cf6\",\n                            borderRadius: \"12px\",\n                            padding: \"14px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            gap: \"12px\",\n                          }}\n                        >\n                          <div style={{\n                            width: \"44px\",\n                            height: \"44px\",\n                            borderRadius: \"50%\",\n                            border: \"2px solid #8b5cf6\",\n                            overflow: \"hidden\",\n                            flexShrink: 0,\n                          }}>\n                            <img\n                              src={avatarSrc}\n                              alt={friendName}\n                              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n                            />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <p style={{\n                              color: \"#8b5cf6\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.75rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                              textTransform: \"uppercase\",\n                              letterSpacing: \"0.5px\",\n                            }}>\n                              Results Ready!\n                            </p>\n                            <p style={{\n                              color: \"#e2e8f0\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.95rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                            }}>\n                              vs {friendName}\n                            </p>\n                            <p style={{\n                              color: \"#94a3b8\",\n                              fontSize: \"0.8rem\",\n                              margin: 0,\n                            }}>\n                              {getModeIcon(challenge.challenge_type)} {getModeName(challenge.challenge_type)}\n                            </p>\n                          </div>\n                          <button\n                            onClick={() => {\n                              showModal(MODAL_TYPES.FRIEND_CHALLENGE_RESULTS, { \n                                challenge,\n                                currentUserId: challengeUserId,\n                                onChallengeAgain: () => {\n                                  markResultViewed(challenge.id);\n                                  navigate(\"/challenge\", {\n                                    state: {\n                                      preselectedFriend: friend ? {\n                                        id: friendId,\n                                        user_id: friendId,\n                                        name: friendName,\n                                        avatar: friendAvatar,\n                                      } : null,\n                                    },\n                                  });\n                                },\n                                onClose: () => {\n                                  markResultViewed(challenge.id);\n                                },\n                              });\n                            }}\n                            style={{\n                              padding: \"10px 16px\",\n                              background: \"#8b5cf6\",\n                              border: \"none\",\n                              borderRadius: \"8px\",\n                              color: \"#fff\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.85rem\",\n                              cursor: \"pointer\",\n                            }}\n                          >\n                            View Results\n                          </button>\n                        </motion.div>\n                      );\n                    })}\n\n                    {/* Pending Outgoing */}\n                    {pendingOutgoing.map((challenge) => {\n                      const receiver = friends.find(f => (f.user_id || f.id) === challenge.receiver_id);\n                      const receiverName = receiver?.nickname || receiver?.username || \"Friend\";\n                      const receiverAvatar = receiver?.avatar;\n                      const avatarSrc = getAvatarImage(receiverAvatar, { userId: challenge.receiver_id, nickname: receiverName });\n                      \n                      return (\n                        <motion.div\n                          key={`outgoing-${challenge.id}`}\n                          initial={{ opacity: 0, scale: 0.95 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          style={{\n                            background: \"linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(75, 85, 99, 0.05) 100%)\",\n                            border: \"1px solid rgba(107, 114, 128, 0.5)\",\n                            borderRadius: \"12px\",\n                            padding: \"14px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            gap: \"12px\",\n                          }}\n                        >\n                          <div style={{\n                            width: \"44px\",\n                            height: \"44px\",\n                            borderRadius: \"50%\",\n                            border: \"2px solid #6b7280\",\n                            overflow: \"hidden\",\n                            flexShrink: 0,\n                          }}>\n                            <img\n                              src={avatarSrc}\n                              alt={receiverName}\n                              style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }}\n                            />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <p style={{\n                              color: \"#6b7280\",\n                              fontWeight: \"700\",\n                              fontSize: \"0.75rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                              textTransform: \"uppercase\",\n                              letterSpacing: \"0.5px\",\n                            }}>\n                              Challenge Sent\n                            </p>\n                            <p style={{\n                              color: \"#e2e8f0\",\n                              fontWeight: \"600\",\n                              fontSize: \"0.95rem\",\n                              margin: 0,\n                              marginBottom: \"2px\",\n                            }}>\n                              to {receiverName}\n                            </p>\n                            <p style={{\n                              color: \"#94a3b8\",\n                              fontSize: \"0.8rem\",\n                              margin: 0,\n                            }}>\n                              {getModeIcon(challenge.challenge_type)} {getModeName(challenge.challenge_type)}\n                            </p>\n                          </div>\n                          <div style={{\n                            padding: \"8px 14px\",\n                            background: \"rgba(107, 114, 128, 0.2)\",\n                            borderRadius: \"8px\",\n                            color: \"#9ca3af\",\n                            fontSize: \"0.8rem\",\n                            fontWeight: \"600\",\n                          }}>\n                            Awaiting\n                          </div>\n                        </motion.div>\n                      );\n                    })}\n                  </div>\n                  \n                  {/* Divider between challenge activity and friends list */}\n                  {friends.length > 0 && (\n                    <div style={{\n                      height: \"1px\",\n                      background: \"linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent)\",\n                      marginTop: \"20px\",\n                    }} />\n                  )}\n\n                  <style>{`\n                    @keyframes pulseGlow {\n                      0%, 100% { box-shadow: 0 0 15px rgba(16, 185, 129, 0.2); }\n                      50% { box-shadow: 0 0 25px rgba(16, 185, 129, 0.4); }\n                    }\n                  `}</style>\n                </div>\n              )}\n\n              {friends.length === 0 ? (\n                <EmptyState\n                  icon={<Users size={48} />}\n                  title=\"No friends yet\"\n                  message=\"Search for users to add friends\"\n                  action={{\n                    label: \"Search Users\",\n                    onClick: () => setActiveTab(\"search\"),\n                  }}\n                />\n              ) : (\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: \"12px\",\n                  }}\n                >\n                  {friends\n                    .sort((a, b) =>\n                      (a.nickname || a.username || \"\").localeCompare(\n                        b.nickname || b.username || \"\"\n                      )\n                    )\n                    .map((friend) => (\n                      <UserCard\n                        key={friend.user_id || friend.id}\n                        user={friend}\n                        onClick={() => handleUserClick(friend.user_id || friend.id)}\n                        badge=\"Friends\"\n                        badgeColor=\"#10b981\"\n                      />\n                    ))}\n                </div>\n              )}\n            </motion.div>\n          )}\n\n          {activeTab === \"leaderboard\" && (\n            <motion.div\n              key=\"leaderboard\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              <div\n                style={{\n                  display: \"flex\",\n                  gap: \"8px\",\n                  marginBottom: \"20px\",\n                  background: \"rgba(14, 22, 37, 0.6)\",\n                  padding: \"8px\",\n                  borderRadius: \"12px\",\n                }}\n              >\n                <SubTabButton\n                  active={leaderboardTab === \"friends\"}\n                  onClick={() => setLeaderboardTab(\"friends\")}\n                  label=\"Friends\"\n                  icon={<Users size={16} />}\n                />\n                <SubTabButton\n                  active={leaderboardTab === \"global\"}\n                  onClick={() => setLeaderboardTab(\"global\")}\n                  label=\"Global\"\n                  icon={<Globe size={16} />}\n                />\n              </div>\n\n              {leaderboardTab === \"friends\" && (\n                <div>\n                  {friendsLeaderboard.length === 0 ? (\n                    <EmptyState\n                      icon={<Trophy size={48} />}\n                      title=\"No friends to rank\"\n                      message=\"Add friends to see their rankings\"\n                      action={{\n                        label: \"Add Friends\",\n                        onClick: () => setActiveTab(\"search\"),\n                      }}\n                    />\n                  ) : (\n                    <div\n                      style={{\n                        display: \"flex\",\n                        flexDirection: \"column\",\n                        gap: \"10px\",\n                      }}\n                    >\n                      {friendsLeaderboard.map((friend, index) => (\n                        <LeaderboardCard\n                          key={friend.user_id}\n                          user={friend}\n                          rank={index + 1}\n                          isCurrentUser={friend.user_id === currentUserIdForHighlight}\n                          onChallenge={() => handleChallengeFriend(friend)}\n                          onQuickMessage={() => handleQuickMessage(friend)}\n                          challengeState={getFriendChallengeState(friend.user_id)}\n                        />\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {leaderboardTab === \"global\" && (\n                <div>\n                  {loadingGlobal ? (\n                    <div\n                      style={{\n                        textAlign: \"center\",\n                        padding: \"40px\",\n                        color: \"#888\",\n                      }}\n                    >\n                      Loading leaderboard...\n                    </div>\n                  ) : globalLeaderboard.length === 0 ? (\n                    <EmptyState\n                      icon={<Globe size={48} />}\n                      title=\"No users to rank\"\n                      message=\"Global leaderboard is empty\"\n                    />\n                  ) : (\n                    <div\n                      style={{\n                        display: \"flex\",\n                        flexDirection: \"column\",\n                        gap: \"10px\",\n                      }}\n                    >\n                      {globalLeaderboard.map((user, index) => (\n                        <GlobalLeaderboardCard\n                          key={user.user_id}\n                          user={user}\n                          rank={index + 1}\n                          isCurrentUser={\n                            user.isCurrentUser ||\n                            user.user_id === currentUserIdForHighlight\n                          }\n                          isFriend={isFriend(user.user_id)}\n                          onUserClick={() => handleUserClick(user.user_id)}\n                        />\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n            </motion.div>\n          )}\n\n          {activeTab === \"requests\" && (\n            <motion.div\n              key=\"requests\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              {receivedRequests.length > 0 && (\n                <div style={{ marginBottom: \"24px\" }}>\n                  <h3\n                    style={{\n                      color: \"#D4AF37\",\n                      fontSize: \"1rem\",\n                      fontWeight: \"600\",\n                      marginBottom: \"12px\",\n                    }}\n                  >\n                    Received ({receivedRequests.length})\n                  </h3>\n                  <div\n                    style={{\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                      gap: \"12px\",\n                    }}\n                  >\n                    {receivedRequests.map((request) => (\n                      <RequestCard\n                        key={request.requestId || request.id}\n                        user={request}\n                        type=\"received\"\n                        onAccept={() => handleAcceptRequest(request.requestId || request.id)}\n                        onDecline={() => handleDeclineRequest(request.requestId || request.id)}\n                      />\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {sentRequests.length > 0 && (\n                <div>\n                  <h3\n                    style={{\n                      color: \"#D4AF37\",\n                      fontSize: \"1rem\",\n                      fontWeight: \"600\",\n                      marginBottom: \"12px\",\n                    }}\n                  >\n                    Sent ({sentRequests.length})\n                  </h3>\n                  <div\n                    style={{\n                      display: \"flex\",\n                      flexDirection: \"column\",\n                      gap: \"12px\",\n                    }}\n                  >\n                    {sentRequests.map((request) => (\n                      <RequestCard\n                        key={request.requestId || request.id}\n                        user={request}\n                        type=\"sent\"\n                        onCancel={() => handleCancelRequest(request.receiverId)}\n                      />\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {totalRequests === 0 && (\n                <EmptyState\n                  icon={<Send size={48} />}\n                  title=\"No pending requests\"\n                  message=\"Friend requests will appear here\"\n                />\n              )}\n            </motion.div>\n          )}\n\n          {activeTab === \"search\" && (\n            <motion.div\n              key=\"search\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              <div\n                style={{\n                  position: \"relative\",\n                  marginBottom: \"20px\",\n                }}\n              >\n                <input\n                  type=\"text\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"Search by @handle or username...\"\n                  style={{\n                    width: \"100%\",\n                    padding: \"14px 44px 14px 16px\",\n                    borderRadius: \"12px\",\n                    border: \"2px solid rgba(212, 175, 55, 0.3)\",\n                    background: \"rgba(14, 22, 37, 0.6)\",\n                    color: \"white\",\n                    fontSize: \"1rem\",\n                    outline: \"none\",\n                  }}\n                />\n                <Search\n                  size={20}\n                  color=\"#888\"\n                  style={{\n                    position: \"absolute\",\n                    right: \"14px\",\n                    top: \"50%\",\n                    transform: \"translateY(-50%)\",\n                  }}\n                />\n              </div>\n\n              {searchQuery.trim().length < 2 ? (\n                <div\n                  style={{\n                    textAlign: \"center\",\n                    color: \"#888\",\n                    padding: \"40px 20px\",\n                  }}\n                >\n                  <Search\n                    size={48}\n                    color=\"#555\"\n                    style={{ marginBottom: \"16px\" }}\n                  />\n                  <p>Enter at least 2 characters to search</p>\n                </div>\n              ) : isSearching ? (\n                <div\n                  style={{\n                    textAlign: \"center\",\n                    color: \"#888\",\n                    padding: \"40px 20px\",\n                  }}\n                >\n                  Searching...\n                </div>\n              ) : searchResults.length === 0 ? (\n                <EmptyState\n                  icon={<Search size={48} />}\n                  title=\"No users found\"\n                  message={`No results for \"${searchQuery}\"`}\n                />\n              ) : (\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: \"12px\",\n                  }}\n                >\n                  {searchResults.map((user) => {\n                    const buttonState = getButtonState(user.user_id || user.id);\n                    return (\n                      <UserCard\n                        key={user.user_id || user.id}\n                        user={user}\n                        onClick={\n                          buttonState === \"friends\"\n                            ? () => handleUserClick(user.user_id || user.id)\n                            : undefined\n                        }\n                        action={\n                          buttonState === \"add\" ? (\n                            <ActionButton\n                              onClick={() => handleSendRequest(user.user_id || user.id)}\n                              icon={<UserPlus size={16} />}\n                              label=\"Add\"\n                              color=\"#10b981\"\n                            />\n                          ) : buttonState === \"sent\" ? (\n                            <StatusBadge\n                              icon={<Clock size={14} />}\n                              label=\"Pending\"\n                              color=\"#f59e0b\"\n                            />\n                          ) : buttonState === \"friends\" ? (\n                            <StatusBadge\n                              icon={<Check size={14} />}\n                              label=\"Friends\"\n                              color=\"#10b981\"\n                            />\n                          ) : null\n                        }\n                      />\n                    );\n                  })}\n                </div>\n              )}\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n\n      {quickMessageFriend && (\n        <QuickMessageModal\n          friend={quickMessageFriend}\n          onClose={() => setQuickMessageFriend(null)}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction TabButton({ active, onClick, icon, label, count, badge }) {\n  return (\n    <motion.button\n      whileHover={{ scale: 1.05 }}\n      whileTap={{ scale: 0.95 }}\n      onClick={onClick}\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        gap: \"4px\",\n        padding: \"10px 16px\",\n        background: active\n          ? \"rgba(212, 175, 55, 0.2)\"\n          : \"rgba(14, 22, 37, 0.6)\",\n        border: active\n          ? \"1px solid #D4AF37\"\n          : \"1px solid rgba(212, 175, 55, 0.2)\",\n        borderRadius: \"12px 12px 0 0\",\n        color: active ? \"#D4AF37\" : \"#888\",\n        cursor: \"pointer\",\n        position: \"relative\",\n        minWidth: \"70px\",\n      }}\n    >\n      <div style={{ position: \"relative\" }}>\n        {icon}\n        {badge && (\n          <div\n            style={{\n              position: \"absolute\",\n              top: \"-4px\",\n              right: \"-8px\",\n              width: \"10px\",\n              height: \"10px\",\n              background: \"#ef4444\",\n              borderRadius: \"50%\",\n            }}\n          />\n        )}\n      </div>\n      <span style={{ fontSize: \"0.7rem\", fontWeight: \"600\" }}>\n        {label}\n        {count !== undefined && count > 0 && ` (${count})`}\n      </span>\n    </motion.button>\n  );\n}\n\nfunction SubTabButton({ active, onClick, label, icon }) {\n  return (\n    <motion.button\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n      onClick={onClick}\n      style={{\n        flex: 1,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        gap: \"6px\",\n        padding: \"10px\",\n        background: active ? \"rgba(212, 175, 55, 0.2)\" : \"transparent\",\n        border: active ? \"1px solid #D4AF37\" : \"1px solid transparent\",\n        borderRadius: \"8px\",\n        color: active ? \"#D4AF37\" : \"#888\",\n        cursor: \"pointer\",\n        fontSize: \"0.9rem\",\n        fontWeight: \"600\",\n      }}\n    >\n      {icon}\n      {label}\n    </motion.button>\n  );\n}\n\nfunction LeaderboardCard({ user, rank, isCurrentUser, onChallenge, onQuickMessage, challengeState }) {\n  const avatarSrc = getAvatarImage(user.avatar, {\n    userId: user.user_id,\n    nickname: user.username || user.handle,\n  });\n  const displayName = user.username || user.handle || \"Unknown\";\n  const userLevel = getCurrentLevel(user.xp);\n\n  const getRankClass = () => {\n    if (rank === 1) return \"gold\";\n    if (rank === 2) return \"silver\";\n    if (rank === 3) return \"bronze\";\n    return \"\";\n  };\n\n  const rankClass = getRankClass();\n  const borderColor =\n    rankClass === \"gold\"\n      ? \"#d4af37\"\n      : rankClass === \"silver\"\n        ? \"#c0c0c0\"\n        : rankClass === \"bronze\"\n          ? \"#cd7f32\"\n          : \"rgba(212, 175, 55, 0.3)\";\n\n  return (\n    <motion.div\n      className={isCurrentUser ? \"highlight-user\" : \"\"}\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      transition={{ delay: Math.min(rank * 0.03, 0.5) }}\n      style={{\n        background:\n          rankClass === \"gold\"\n            ? \"linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%)\"\n            : rankClass === \"silver\"\n              ? \"linear-gradient(135deg, rgba(192, 192, 192, 0.2) 0%, rgba(169, 169, 169, 0.1) 100%)\"\n              : rankClass === \"bronze\"\n                ? \"linear-gradient(135deg, rgba(205, 127, 50, 0.2) 0%, rgba(184, 115, 51, 0.1) 100%)\"\n                : \"rgba(14, 22, 37, 0.6)\",\n        border: `1px solid ${borderColor}`,\n        borderRadius: \"12px\",\n        padding: \"12px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"12px\",\n        boxShadow:\n          rankClass === \"gold\"\n            ? \"0 0 20px rgba(212, 175, 55, 0.4)\"\n            : rankClass === \"silver\"\n              ? \"0 0 15px rgba(192, 192, 192, 0.3)\"\n              : \"none\",\n      }}\n    >\n      <div\n        style={{\n          minWidth: \"35px\",\n          color: rankClass ? borderColor : \"#94a3b8\",\n          fontSize: \"1rem\",\n          fontWeight: \"700\",\n          textAlign: \"center\",\n        }}\n      >\n        #{rank}\n      </div>\n\n      <div\n        style={{\n          width: \"44px\",\n          height: \"44px\",\n          borderRadius: \"50%\",\n          border: `2px solid ${borderColor}`,\n          overflow: \"hidden\",\n          flexShrink: 0,\n          background: \"#0E1625\",\n        }}\n      >\n        <img\n          src={avatarSrc}\n          alt={displayName}\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            objectFit: \"contain\",\n          }}\n        />\n      </div>\n\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"8px\",\n            marginBottom: \"4px\",\n          }}\n        >\n          <p\n            style={{\n              color: \"#e2e8f0\",\n              fontWeight: \"600\",\n              fontSize: \"0.95rem\",\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\",\n              whiteSpace: \"nowrap\",\n              margin: 0,\n            }}\n          >\n            {displayName}\n          </p>\n          <LevelBadgeCompact level={userLevel} size=\"small\" />\n        </div>\n        {user.handle && (\n          <p\n            style={{\n              color: \"#aaa\",\n              fontSize: \"0.75rem\",\n              margin: 0,\n              marginBottom: \"4px\",\n            }}\n          >\n            @{user.handle}\n          </p>\n        )}\n        <div\n          style={{\n            display: \"flex\",\n            gap: \"12px\",\n            fontSize: \"0.75rem\",\n            color: \"#888\",\n          }}\n        >\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\n            <Trophy size={12} color=\"#D4AF37\" />\n            {user.xp.toLocaleString()}\n          </span>\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\n            <Flame size={12} color=\"#ef4444\" />\n            {user.streak}\n          </span>\n        </div>\n      </div>\n\n      <div style={{ display: \"flex\", gap: \"6px\" }}>\n        <motion.button\n          whileHover={{ scale: 1.1 }}\n          whileTap={{ scale: 0.9 }}\n          onClick={onQuickMessage}\n          style={{\n            padding: \"8px\",\n            background: \"rgba(59, 130, 246, 0.2)\",\n            border: \"1px solid #3b82f6\",\n            borderRadius: \"8px\",\n            color: \"#3b82f6\",\n            cursor: \"pointer\",\n          }}\n        >\n          <MessageCircle size={16} />\n        </motion.button>\n        <motion.button\n          whileHover={{ scale: 1.1 }}\n          whileTap={{ scale: 0.9 }}\n          onClick={onChallenge}\n          style={{\n            padding: \"8px\",\n            background: challengeState?.type === \"pending_received\" \n              ? \"rgba(34, 197, 94, 0.3)\" \n              : challengeState?.type === \"ready_to_play\"\n                ? \"rgba(251, 191, 36, 0.3)\"\n                : \"rgba(239, 68, 68, 0.2)\",\n            border: challengeState?.type === \"pending_received\"\n              ? \"2px solid #22c55e\"\n              : challengeState?.type === \"ready_to_play\"\n                ? \"2px solid #fbbf24\"\n                : \"1px solid #ef4444\",\n            borderRadius: \"8px\",\n            color: challengeState?.type === \"pending_received\"\n              ? \"#22c55e\"\n              : challengeState?.type === \"ready_to_play\"\n                ? \"#fbbf24\"\n                : \"#ef4444\",\n            cursor: \"pointer\",\n            position: \"relative\",\n            animation: challengeState?.type === \"pending_received\" ? \"pulse 1.5s infinite\" : \"none\",\n          }}\n        >\n          <Swords size={16} />\n          {challengeState?.type === \"pending_received\" && (\n            <span style={{\n              position: \"absolute\",\n              top: \"-4px\",\n              right: \"-4px\",\n              width: \"12px\",\n              height: \"12px\",\n              background: \"#22c55e\",\n              borderRadius: \"50%\",\n              border: \"2px solid #0B1E2D\",\n              animation: \"pulse 1.5s infinite\",\n            }} />\n          )}\n          {challengeState?.type === \"ready_to_play\" && (\n            <span style={{\n              position: \"absolute\",\n              top: \"-4px\",\n              right: \"-4px\",\n              width: \"12px\",\n              height: \"12px\",\n              background: \"#fbbf24\",\n              borderRadius: \"50%\",\n              border: \"2px solid #0B1E2D\",\n            }} />\n          )}\n        </motion.button>\n      </div>\n    </motion.div>\n  );\n}\n\nfunction GlobalLeaderboardCard({\n  user,\n  rank,\n  isCurrentUser,\n  isFriend,\n  onUserClick,\n}) {\n  const avatarSrc = getAvatarImage(user.avatar, {\n    userId: user.user_id,\n    nickname: user.username || user.handle,\n  });\n  const displayName = user.username || user.handle || \"Unknown\";\n  const userLevel = getCurrentLevel(user.xp);\n  const isPermanentEntry = user.isPermanent === true;\n\n  const getRankClass = () => {\n    if (rank === 1) return \"gold\";\n    if (rank === 2) return \"silver\";\n    if (rank === 3) return \"bronze\";\n    return \"\";\n  };\n\n  const rankClass = getRankClass();\n  const borderColor =\n    rankClass === \"gold\"\n      ? \"#d4af37\"\n      : rankClass === \"silver\"\n        ? \"#c0c0c0\"\n        : rankClass === \"bronze\"\n          ? \"#cd7f32\"\n          : \"rgba(212, 175, 55, 0.3)\";\n\n  return (\n    <motion.div\n      className={isCurrentUser ? \"highlight-user\" : \"\"}\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      transition={{ delay: Math.min(rank * 0.03, 0.5) }}\n      onClick={!isPermanentEntry && isFriend ? onUserClick : undefined}\n      style={{\n        background:\n          rankClass === \"gold\"\n            ? \"linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%)\"\n            : rankClass === \"silver\"\n              ? \"linear-gradient(135deg, rgba(192, 192, 192, 0.2) 0%, rgba(169, 169, 169, 0.1) 100%)\"\n              : rankClass === \"bronze\"\n                ? \"linear-gradient(135deg, rgba(205, 127, 50, 0.2) 0%, rgba(184, 115, 51, 0.1) 100%)\"\n                : \"rgba(14, 22, 37, 0.6)\",\n        border: `1px solid ${borderColor}`,\n        borderRadius: \"10px\",\n        padding: \"10px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"10px\",\n        cursor: !isPermanentEntry && isFriend ? \"pointer\" : \"default\",\n        boxShadow:\n          rankClass === \"gold\"\n            ? \"0 0 20px rgba(212, 175, 55, 0.4)\"\n            : rankClass === \"silver\"\n              ? \"0 0 15px rgba(192, 192, 192, 0.3)\"\n              : \"none\",\n        opacity: isPermanentEntry ? 0.95 : 1,\n      }}\n    >\n      <div\n        style={{\n          minWidth: \"35px\",\n          color: rankClass ? borderColor : \"#94a3b8\",\n          fontSize: \"0.9rem\",\n          fontWeight: \"600\",\n          textAlign: \"center\",\n        }}\n      >\n        #{rank}\n      </div>\n\n      <div\n        style={{\n          width: \"36px\",\n          height: \"36px\",\n          borderRadius: \"50%\",\n          border: `2px solid ${borderColor}`,\n          overflow: \"hidden\",\n          flexShrink: 0,\n          background: \"#0E1625\",\n        }}\n      >\n        <img\n          src={avatarSrc}\n          alt={displayName}\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            objectFit: \"contain\",\n          }}\n        />\n      </div>\n\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <p\n          className=\"name\"\n          style={{\n            color: \"#e2e8f0\",\n            fontWeight: \"600\",\n            fontSize: \"0.9rem\",\n            overflow: \"hidden\",\n            textOverflow: \"ellipsis\",\n            whiteSpace: \"nowrap\",\n            margin: 0,\n            marginBottom: \"2px\",\n          }}\n        >\n          {displayName}\n        </p>\n        <p\n          className=\"handle\"\n          style={{\n            color: \"#aaa\",\n            fontSize: \"0.75rem\",\n            margin: 0,\n            marginBottom: \"2px\",\n          }}\n        >\n          @{user.handle}\n        </p>\n        <div\n          style={{\n            display: \"flex\",\n            gap: \"8px\",\n            fontSize: \"0.7rem\",\n            color: \"#888\",\n          }}\n        >\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"3px\" }}>\n            <Trophy size={10} color=\"#D4AF37\" />\n            {user.xp.toLocaleString()}\n          </span>\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"3px\" }}>\n            <Flame size={10} color=\"#ef4444\" />\n            {user.streak}\n          </span>\n        </div>\n      </div>\n\n      {isPermanentEntry ? (\n        <div\n          style={{\n            padding: \"4px 8px\",\n            background: \"rgba(139, 92, 246, 0.2)\",\n            border: \"1px solid #8b5cf6\",\n            borderRadius: \"6px\",\n            color: \"#a78bfa\",\n            fontSize: \"0.7rem\",\n            fontWeight: \"600\",\n          }}\n        >\n          Dev\n        </div>\n      ) : isFriend ? (\n        <div\n          style={{\n            padding: \"4px 8px\",\n            background: \"rgba(16, 185, 129, 0.2)\",\n            border: \"1px solid #10b981\",\n            borderRadius: \"6px\",\n            color: \"#10b981\",\n            fontSize: \"0.7rem\",\n            fontWeight: \"600\",\n          }}\n        >\n          Friend\n        </div>\n      ) : null}\n    </motion.div>\n  );\n}\n\nfunction UserCard({ user, onClick, action, badge, badgeColor }) {\n  const avatarSrc = getAvatarImage(user.avatar, {\n    userId: user.user_id || user.id,\n    nickname: user.nickname || user.username,\n  });\n  const userLevel = getCurrentLevel(user.xp);\n  const displayName = user.nickname || user.username || user.handle || \"User\";\n\n  return (\n    <motion.div\n      whileHover={onClick ? { scale: 1.02 } : {}}\n      whileTap={onClick ? { scale: 0.98 } : {}}\n      onClick={onClick}\n      style={{\n        background: \"rgba(14, 22, 37, 0.6)\",\n        border: \"1px solid rgba(212, 175, 55, 0.3)\",\n        borderRadius: \"12px\",\n        padding: \"14px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"12px\",\n        cursor: onClick ? \"pointer\" : \"default\",\n      }}\n    >\n      <div\n        style={{\n          width: \"56px\",\n          height: \"56px\",\n          borderRadius: \"50%\",\n          border: \"2px solid #D4AF37\",\n          overflow: \"hidden\",\n          flexShrink: 0,\n          background: \"#0E1625\",\n        }}\n      >\n        <img\n          src={avatarSrc}\n          alt={displayName}\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            objectFit: \"contain\",\n          }}\n        />\n      </div>\n\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"8px\",\n            marginBottom: \"4px\",\n          }}\n        >\n          <p\n            style={{\n              color: \"white\",\n              fontWeight: \"600\",\n              fontSize: \"1rem\",\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\",\n              whiteSpace: \"nowrap\",\n            }}\n          >\n            {displayName}\n          </p>\n          <LevelBadgeCompact level={userLevel} size=\"small\" />\n        </div>\n        {(user.handle || user.username) && (\n          <p\n            style={{\n              color: \"#aaa\",\n              fontSize: \"0.85rem\",\n              marginBottom: \"6px\",\n            }}\n          >\n            @{user.handle || user.username}\n          </p>\n        )}\n        <div\n          style={{\n            display: \"flex\",\n            gap: \"12px\",\n            fontSize: \"0.8rem\",\n            color: \"#888\",\n          }}\n        >\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\n            <Trophy size={12} color=\"#D4AF37\" />\n            {(user.xp || 0).toLocaleString()}\n          </span>\n          <span style={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}>\n            <Flame size={12} color=\"#ef4444\" />\n            {user.streak || 0}\n          </span>\n        </div>\n      </div>\n\n      {badge ? (\n        <div\n          style={{\n            padding: \"6px 12px\",\n            background: `${badgeColor}22`,\n            border: `1px solid ${badgeColor}`,\n            borderRadius: \"8px\",\n            color: badgeColor,\n            fontSize: \"0.8rem\",\n            fontWeight: \"600\",\n          }}\n        >\n          {badge}\n        </div>\n      ) : (\n        action\n      )}\n    </motion.div>\n  );\n}\n\nfunction RequestCard({ user, type, onAccept, onDecline, onCancel }) {\n  const avatarSrc = getAvatarImage(user.avatar, {\n    userId: user.user_id || user.id,\n    nickname: user.nickname || user.username,\n  });\n  const userLevel = getCurrentLevel(user.xp);\n  const displayName = user.nickname || user.username || user.handle || \"User\";\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      style={{\n        background: \"rgba(14, 22, 37, 0.6)\",\n        border: \"1px solid rgba(212, 175, 55, 0.3)\",\n        borderRadius: \"12px\",\n        padding: \"14px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"12px\",\n      }}\n    >\n      <div\n        style={{\n          width: \"56px\",\n          height: \"56px\",\n          borderRadius: \"50%\",\n          border: \"2px solid #D4AF37\",\n          overflow: \"hidden\",\n          flexShrink: 0,\n          background: \"#0E1625\",\n        }}\n      >\n        <img\n          src={avatarSrc}\n          alt={displayName}\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            objectFit: \"contain\",\n          }}\n        />\n      </div>\n\n      <div style={{ flex: 1, minWidth: 0 }}>\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"8px\",\n            marginBottom: \"4px\",\n          }}\n        >\n          <p\n            style={{\n              color: \"white\",\n              fontWeight: \"600\",\n              fontSize: \"1rem\",\n            }}\n          >\n            {displayName}\n          </p>\n          <LevelBadgeCompact level={userLevel} size=\"small\" />\n        </div>\n        {(user.handle || user.username) && (\n          <p\n            style={{\n              color: \"#aaa\",\n              fontSize: \"0.85rem\",\n            }}\n          >\n            @{user.handle || user.username}\n          </p>\n        )}\n      </div>\n\n      {type === \"received\" ? (\n        <div style={{ display: \"flex\", gap: \"8px\" }}>\n          <motion.button\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            onClick={onAccept}\n            style={{\n              padding: \"8px 12px\",\n              background: \"rgba(16, 185, 129, 0.2)\",\n              border: \"1px solid #10b981\",\n              borderRadius: \"8px\",\n              color: \"#10b981\",\n              cursor: \"pointer\",\n              fontWeight: \"600\",\n              fontSize: \"0.85rem\",\n            }}\n          >\n            <Check size={16} />\n          </motion.button>\n          <motion.button\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            onClick={onDecline}\n            style={{\n              padding: \"8px 12px\",\n              background: \"rgba(239, 68, 68, 0.2)\",\n              border: \"1px solid #ef4444\",\n              borderRadius: \"8px\",\n              color: \"#ef4444\",\n              cursor: \"pointer\",\n              fontWeight: \"600\",\n              fontSize: \"0.85rem\",\n            }}\n          >\n            <X size={16} />\n          </motion.button>\n        </div>\n      ) : (\n        <motion.button\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          onClick={onCancel}\n          style={{\n            padding: \"8px 16px\",\n            background: \"rgba(239, 68, 68, 0.2)\",\n            border: \"1px solid #ef4444\",\n            borderRadius: \"8px\",\n            color: \"#ef4444\",\n            cursor: \"pointer\",\n            fontWeight: \"600\",\n            fontSize: \"0.85rem\",\n          }}\n        >\n          Cancel\n        </motion.button>\n      )}\n    </motion.div>\n  );\n}\n\nfunction ActionButton({ onClick, icon, label, color }) {\n  return (\n    <motion.button\n      whileHover={{ scale: 1.05 }}\n      whileTap={{ scale: 0.95 }}\n      onClick={onClick}\n      style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"6px\",\n        padding: \"8px 16px\",\n        background: `${color}22`,\n        border: `1px solid ${color}`,\n        borderRadius: \"8px\",\n        color,\n        cursor: \"pointer\",\n        fontWeight: \"600\",\n        fontSize: \"0.85rem\",\n      }}\n    >\n      {icon}\n      <span>{label}</span>\n    </motion.button>\n  );\n}\n\nfunction StatusBadge({ icon, label, color }) {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"4px\",\n        padding: \"6px 12px\",\n        background: `${color}22`,\n        border: `1px solid ${color}`,\n        borderRadius: \"8px\",\n        color,\n        fontSize: \"0.8rem\",\n        fontWeight: \"600\",\n      }}\n    >\n      {icon}\n      <span>{label}</span>\n    </div>\n  );\n}\n\nfunction EmptyState({ icon, title, message, action }) {\n  return (\n    <div\n      style={{\n        textAlign: \"center\",\n        padding: \"60px 20px\",\n        color: \"#888\",\n      }}\n    >\n      <div style={{ marginBottom: \"16px\", opacity: 0.5 }}>{icon}</div>\n      <h3\n        style={{\n          color: \"#D4AF37\",\n          fontSize: \"1.2rem\",\n          fontWeight: \"600\",\n          marginBottom: \"8px\",\n        }}\n      >\n        {title}\n      </h3>\n      <p style={{ marginBottom: \"20px\" }}>{message}</p>\n      {action && (\n        <motion.button\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          onClick={action.onClick}\n          style={{\n            padding: \"12px 24px\",\n            background: \"#D4AF37\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            fontWeight: \"600\",\n            fontSize: \"1rem\",\n            cursor: \"pointer\",\n          }}\n        >\n          {action.label}\n        </motion.button>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":75294,"size_tokens":null},"replit.md":{"content":"# Islam Quest - Educational Mobile Web App\n\n## Overview\nIslam Quest is a mobile-first web application designed as a gamified Islamic learning platform. Its core purpose is to provide an interactive and engaging educational experience, guiding users through structured learning paths covering fundamental Islamic beliefs, stories of prophets, and essential knowledge. The project aims to make Islamic education accessible and foster continuous learning and spiritual growth through features like a friendly mascot (Zayd), an achievement system, customizable avatars, quiz-based assessments, and a complete social friends system. The business vision is to make Islamic education engaging and widely accessible, with significant market potential for a gamified, faith-based learning platform.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### UI/UX Decisions\nThe application features a mobile-first responsive design with a bottom navigation pattern, edge-to-edge layouts, and safe-area support. It includes a comprehensive layout refactor, a ScrollToTop component, structured learning paths in a timeline format, and a consistent color palette with CSS variables. GPU-optimized CSS and Framer Motion animations provide smooth transitions, and custom LoadingScreens with shimmer skeleton loaders and eager image preloading enhance the user experience.\n\n### Technical Implementations\nThe frontend is built with React 18.2, Vite, JavaScript, and React Router DOM v7.9. State management uses local React hooks and global Zustand stores (e.g., `progressStore`, `userStore`, `friendsStore`), with LocalStorage for persistence. A sophisticated challenge question engine dynamically selects questions, prevents repetition, scales difficulty, and uses memoization. Performance is optimized with route-based code splitting, Duolingo-style eager image preloading, and `React.memo`. A unified, global modal system features multiple types, dual rendering strategies, and race condition protection. A global back button handler intercepts physical phone back button presses. Arabic honorifics are dynamically added for authenticity.\n\n### Feature Specifications\nThe application offers 14 learning paths with lessons and quizzes sourced from Qur'an and Sahih Hadith. Progression includes XP and coin rewards, a streak system, universal lesson locking, a freemium model, and a 10-level Diamond progression system. A 75% passing threshold applies to quizzes, daily quests, and global events.\nThe premium model offers free tier limits and premium plans (Individual ¬£4.99/month, Family ¬£18/month) for unlimited access, Global Events, and a premium badge. Social features include friend management, a leaderboard, activity feed, and quick messaging. Gamification elements comprise four friend challenge modes, a daily Boss Level, weekly Global Events, Daily Quests, and a Streak Freeze system. The Revise tab features \"Review Mistakes\" and \"Smart Revision\" modes. Customizable avatars (32 selectable, 2 hidden) are available. An Easter Egg awards +1 XP when the mascot is tapped 5 times within 3.5 seconds.\n\n### System Design Choices\n\n**Identity vs Progress Separation**: Identity data (username, avatar, handle) and progress data (xp, coins, streak) are cleanly separated and synced independently to the cloud. Avatars are stored as integer indices.\n\n**Profile Creation Architecture**: Profiles are created only after onboarding completion, ensuring all required fields are present. Startup sequence involves silent authentication, device ID checks, and then either onboarding or loading existing stores.\n\n**Supabase Integration**: Silent account creation on first launch with permanent Supabase UID. Auto-login on app open. `progressStore` automatically syncs to Supabase cloud on state changes with throttling and AES encryption. Cloud data is restored on app start if newer.\n\n**Email/Password Authentication System**: Proper email/password auth with email confirmation support.\n-   **Auth Flow (Rebuilt Dec 2025)**: Bismillah ‚Üí Salaam ‚Üí AuthChoice ‚Üí (Login OR SignUp) ‚Üí CheckEmail ‚Üí Data Preload ‚Üí Home.\n-   **AuthChoiceScreen** (`/onboarding/auth-choice`): Central choice screen with \"Create Account\" and \"I already have an account\" buttons, mascot, and Terms/Privacy footer.\n-   **LoginPage** (`/login`): Email + password fields, Forgot Password link, Sign In button (disabled until valid), link to sign up page.\n-   **SignUpPage** (`/signup`): Consolidated single-page signup with Display Name, Username (handle), Email, Password, and Avatar Picker. All fields on one screen for faster onboarding. Handle uniqueness validation included.\n-   **Email Confirmation**: After signup, users are redirected to `CheckEmailScreen` which polls for email confirmation. Uses `useDataPreloader` hook to preload all data (friends, leaderboard, progress, quests, events, challenges) via Promise.all BEFORE navigating to Home for instant app experience.\n-   **Supabase Auth Methods**: `signUp` for registration, `signInWithPassword` for login, `resetPasswordForEmail` for forgot password (redirects to `/reset-password`), `updateUser` for password reset.\n-   **Password Reset**: `resetPasswordForEmail` sends a reset link, user clicks ‚Üí `/reset-password` page ‚Üí enters new password ‚Üí `updateUser` ‚Üí redirects to login. All user data preserved.\n-   **Onboarding Persistence**: Current step saved in localStorage (`iq_onboarding_step`), app resumes from saved step if closed mid-onboarding.\n-   **Session Handling**: On app start, checks email confirmation status. Unconfirmed users ‚Üí CheckEmail screen. Confirmed users with profile ‚Üí Home.\n-   **Routes**: `/onboarding/auth-choice` (choose login or signup), `/login` (login page), `/signup` (consolidated signup page), `/check-email` (email confirmation), `/reset-password` (password reset after email link).\n-   **Hooks**: `useOnboarding` manages onboarding state and flow, `useDataPreloader` handles instant data loading via Promise.all.\n\n**Challenge System**: The challenge system operates in two modes:\n-   **Solo/Boss Challenges (Local)**: All single-player challenge functionality runs locally without Supabase dependency. `createChallenge()` builds local challenge objects, `submitChallengeAttempt()` generates random opponent results locally, and `saveBossAttempt()` stores Boss Level attempts in localStorage. Questions are pulled from completed lesson pools or a diverse fallback pool.\n-   **Friend Challenges (Supabase-Backed)**: Real-time multiplayer challenges use Supabase for synchronization. `friendChallengesStore.js` manages the full challenge lifecycle with Realtime subscriptions. The `friend_challenges` table stores challenge data, questions (as JSONB), scores, times, and completion status. Both players receive identical question sets for fairness. Four game modes are supported: Mind Battle (untimed), Lightning Round (timed), Sudden Death (chain-based), and Speed Run (speed-based). Winner determination considers score, time, and chain length depending on mode. Rewards are distributed only when both players complete their attempts.\n\n**Friend Data Loading Optimizations (Dec 2025)**: Duolingo-style instant loading for all friend-related flows:\n-   **Parallel DB Queries**: `friendsStore.loadAll()` uses `Promise.all` to fetch friends, sent requests, and received requests simultaneously, then batches all profile lookups into a single query.\n-   **Real-time Subscriptions**: Both `friendsStore` and `friendChallengesStore` have Supabase Realtime subscriptions for the `friends` and `friend_challenges` tables respectively, enabling instant UI updates when friend requests or challenges are sent/received.\n-   **FriendChallengeWaitingModal**: Uses real-time subscription instead of polling for instant status updates when waiting for opponent to complete challenge.\n-   **Orphaned Challenge Cleanup**: Challenges from non-friends are automatically filtered out and deleted in background during load.\n-   **Reduced Polling**: Background polling reduced to 15 seconds as fallback since real-time handles most updates instantly.\n\n**Revision System**: The `reviseStore` stores lightweight data (cardId, lessonId, tracking counts) for weak questions, with full question content looked up at render time. Cloud sync is handled via `revisionSync.js` with specific Supabase table `revision_items`.\n-   **Permanent Unlock**: Once a user makes their first mistake, `reviewMistakesUnlocked` is set to `true` and persisted via `progressStore.saveProgress()`. This flag is never reset to `false`.\n-   **Question Tracking**: Each weak question tracks `reviewedOnce` (true if answered during revision), `firstWrongAt` (timestamp of first mistake), `lastReviewedAt` (null until reviewed), `timesCorrect`, and `timesWrong`.\n-   **Sorting Priority**: Unreviewed questions (`reviewedOnce: false`) appear at the top of revision sessions, followed by reviewed questions sorted by `timesWrong`.\n-   **Empty State**: When unlocked but no mistakes exist, the Review Mistakes card shows a green checkmark with \"No mistakes to review\" message instead of locking.\n\n**Events System**: Global Events load cloud entries on mount. Event quiz submissions pass completion time for tiebreaker rankings.\n\n**In-App Purchase System**: A complete backend-verified IAP system with a single lifetime premium unlock (¬£4.99).\n-   **Architecture**: Uses `iapService.js` (Capacitor for native StoreKit/Google Play), `purchaseVerificationService.js` (Supabase Edge Functions), `premiumStateService.js` (offline caching, device binding), and `deviceService.js` (unique device IDs).\n-   **Backend (Supabase Edge Functions)**: Handles receipt verification (Apple/Google APIs), premium status validation, device registration, and webhook processing for refunds.\n-   **Database Tables**: `users`, `purchases` manage user and purchase data.\n-   **Security**: Nonce for replay attack prevention, hashed device IDs, backend-only premium activation, device limits, and refund webhooks.\n-   **Purchase Flow**: User initiates, native store handles, receipt sent to Supabase Edge Function for verification, which then updates user and purchase records.\n-   **Restore Purchases**: Calls native store's restore API, verifies receipts with backend, and restores premium status.\n-   **Single Product**: `premium_lifetime` (¬£4.99 one-time) - All features unlocked forever.\n\n**Account Deletion System**: A \"Delete My Account\" option in Settings triggers a Supabase Edge Function to delete all user-related data. A \"Goodbye\" screen is shown post-deletion.\n\n**Analytics & Logging System**: An `analytics_events` table stores user events (e.g., purchase, logout, account deletion). An Edge Function (`log-event`) inserts events from the client, with RLS policies restricting read access.\n\n**Styled Notification Modals**: Reusable `NotificationModal.jsx` provides consistent styled popups for feedback, including `DeleteAccountModal.jsx` for account deletion. All modals use consistent styling and Framer Motion animations.\n\nAsset management is centralized via `assets.js` for optimized WebP images, including 16 culturally authentic Islamic mascot characters and 34 avatar options.\n\n## External Dependencies\n\n### Third-Party Services\n-   **Supabase**: Authentication, database, real-time subscriptions, and Edge Functions.\n-   **OneSignal**: Push notifications via `react-onesignal` v2 API, integrated for daily reminders using Supabase Edge Functions.\n\n### Core Libraries\n-   **UI & Animation**: `framer-motion`, `lucide-react`, `react-router-dom`.\n-   **State Management**: `zustand`.\n-   **Build Tool**: `vite`.\n-   **Encryption**: `crypto-js` (AES for cloud sync).\n\n### Asset Dependencies\n-   **Media**: Locally bundled WebP images and an SVG favicon.\n-   **Mascots**: 16 WebP characters used across UI.\n-   **Avatars**: 34 total avatar options.","path":null,"size_bytes":11914,"size_tokens":null},"src/pages/Challenge.jsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { Globe } from \"lucide-react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useChallengeStore, CHALLENGE_MODES, BOSS_LEVEL } from \"../store/challengeStore\";\nimport { useFriendChallengesStore } from \"../store/friendChallengesStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useFriendsStore } from \"../store/friendsStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { useVibration } from \"../hooks/useVibration\";\nimport { getCurrentLevel } from \"../utils/diamondLevels\";\nimport { generateQuestionsForChallenge } from \"../utils/challengeQuestions\";\nimport BossLevelMascot from \"../assets/mascots/mascot_boss.webp\";\nimport mascot_running from \"../assets/mascots/mascot_running.webp\";\nimport mascot_quiz from \"../assets/mascots/mascot_quiz.webp\";\nimport mascot_power from \"../assets/mascots/mascot_power.webp\";\nimport mascot_locked from \"../assets/mascots/mascot_locked.webp\";\n\nexport default function Challenge() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { vibrate } = useVibration();\n  \n  const { xp, premium, premiumStatus } = useProgressStore();\n  const isUserPremium = premium || premiumStatus !== \"free\";\n  const level = getCurrentLevel(xp).level;\n  const getAllFriends = useFriendsStore(state => state.getAllFriends);\n  const { loadFromStorage, loadAllMyChallenges } = useChallengeStore();\n  const { initialize: initFriendChallenges, createChallenge: createFriendChallenge, getActiveWithFriend } = useFriendChallengesStore();\n  const { showModal } = useModalStore();\n\n  const [selectedMode, setSelectedMode] = useState(null);\n  const [selectedFriend, setSelectedFriend] = useState(null);\n  const [showFriendSelector, setShowFriendSelector] = useState(false);\n  const [friends, setFriends] = useState([]);\n  const [bossPlayable, setBossPlayable] = useState(true);\n  const [sendingChallenge, setSendingChallenge] = useState(false);\n  \n  const friendRef = useRef(null);\n\n  useEffect(() => {\n    loadFromStorage();\n    loadAllMyChallenges();\n    \n    initFriendChallenges();\n    \n    setBossPlayable(useChallengeStore.getState().canPlayBossToday());\n    \n    const friendsList = getAllFriends?.() || [];\n    setFriends(friendsList);\n    \n    if (location.state?.preselectedFriend) {\n      console.log('üë• Pre-selected friend detected:', location.state.preselectedFriend);\n      const friend = location.state.preselectedFriend;\n      setSelectedFriend(friend);\n      friendRef.current = friend;\n    }\n  }, [location.state, getAllFriends]);\n\n  const handleModeClick = (modeKey) => {\n    vibrate(50); // Haptic feedback on mode selection\n    const mode = CHALLENGE_MODES[modeKey];\n    setSelectedMode(mode);\n    \n    console.log('üéØ handleModeClick', { modeKey, mode, selectedFriend });\n    \n    // If friend is already pre-selected (from Friends page), skip friend selector\n    if (selectedFriend) {\n      console.log('‚úÖ Friend already selected, going to explainer');\n      \n      // Go straight to explainer - no lesson restrictions\n      showModal(MODAL_TYPES.CHALLENGE_EXPLAINER, {\n        mode: mode,\n        onStart: () => handleStartChallenge(mode),\n        onCancel: handleCancelExplainer\n      });\n    } else {\n      // No pre-selected friend, show friend selector\n      setShowFriendSelector(true);\n    }\n  };\n\n  const handleFriendSelect = (friend) => {\n    vibrate(50); // Haptic feedback on friend selection\n    setSelectedFriend(friend);\n    friendRef.current = friend;\n    setShowFriendSelector(false);\n    \n    // Show explainer immediately - no lesson restrictions\n    showModal(MODAL_TYPES.CHALLENGE_EXPLAINER, {\n      mode: selectedMode,\n      onStart: () => handleStartChallenge(selectedMode),\n      onCancel: handleCancelExplainer\n    });\n  };\n\n  const handleBossClick = () => {\n    vibrate(50); // Haptic feedback on boss click\n    // Check level requirement\n    if (level < BOSS_LEVEL.minLevel) {\n      showModal(MODAL_TYPES.BOSS_LOCKED, {\n        currentLevel: level,\n        requiredLevel: BOSS_LEVEL.minLevel\n      });\n      return;\n    }\n\n    // Check local boss playability\n    if (!bossPlayable) {\n      showModal(MODAL_TYPES.BOSS_PLAYED_TODAY);\n      return;\n    }\n\n    setSelectedMode(BOSS_LEVEL);\n    showModal(MODAL_TYPES.CHALLENGE_EXPLAINER, {\n      mode: BOSS_LEVEL,\n      onStart: () => handleStartChallenge(BOSS_LEVEL),\n      onCancel: handleCancelExplainer\n    });\n  };\n\n  const handleStartChallenge = async (modeOverride = null) => {\n    const currentMode = modeOverride || selectedMode;\n    const currentFriend = friendRef.current || selectedFriend;\n    \n    console.log('üéÆ handleStartChallenge called', { \n      modeOverride, \n      selectedMode, \n      currentMode,\n      selectedFriend,\n      friendRef: friendRef.current,\n      currentFriend\n    });\n    \n    const isBossLevel = currentMode?.id === \"boss_level\" || currentMode?.name === \"Boss Level\";\n    \n    if (isBossLevel) {\n      showModal(MODAL_TYPES.CHALLENGE_COUNTDOWN, {\n        onComplete: () => {\n          navigate(`/challenge/boss`);\n        }\n      });\n      return;\n    }\n    \n    if (!currentFriend) {\n      console.error('‚ùå No currentFriend!', { currentFriend, selectedFriend, friendRef: friendRef.current });\n      alert(\"Please select a friend to challenge.\");\n      return;\n    }\n    \n    const existingChallenge = getActiveWithFriend(currentFriend.user_id || currentFriend.id);\n    if (existingChallenge) {\n      alert(\"You already have an active challenge with this friend!\");\n      return;\n    }\n    \n    setSendingChallenge(true);\n    \n    try {\n      console.log('‚úÖ Creating Supabase friend challenge', { friendId: currentFriend.user_id || currentFriend.id, modeId: currentMode.id });\n      \n      const questions = generateQuestionsForChallenge(currentMode.id);\n      if (questions.length === 0) {\n        alert(\"Unable to generate questions. Please try again.\");\n        setSendingChallenge(false);\n        return;\n      }\n      \n      const result = await createFriendChallenge(\n        currentFriend.user_id || currentFriend.id,\n        currentMode.id,\n        questions\n      );\n      \n      if (result.success) {\n        showModal(MODAL_TYPES.FRIEND_CHALLENGE_SENT, {\n          friendName: currentFriend.nickname || currentFriend.username || currentFriend.display_name || \"Friend\",\n          modeId: currentMode.id,\n          onClose: () => {\n            setSelectedMode(null);\n            setSelectedFriend(null);\n            friendRef.current = null;\n          }\n        });\n      } else {\n        console.error('Challenge creation failed:', result.error);\n        alert(result.error || \"Failed to create challenge. Please try again.\");\n      }\n    } catch (error) {\n      console.error('Challenge creation error:', error);\n      alert(\"Something went wrong. Please try again.\");\n    } finally {\n      setSendingChallenge(false);\n    }\n  };\n\n  const handleCancelExplainer = () => {\n    setSelectedMode(null);\n    setSelectedFriend(null);\n  };\n\n  return (\n    <div className=\"screen no-extra-space\" style={{\n      paddingLeft: 16,\n      paddingRight: 16,\n      paddingTop: 16,\n      background: \"linear-gradient(to bottom, #081426, #0e2340)\",\n      color: \"white\",\n    }}>\n      {/* Header */}\n      <div style={{ textAlign: \"center\", marginTop: 10, marginBottom: 20 }}>\n        <h1 style={{\n          fontSize: \"clamp(1.3rem, 5vw, 1.8rem)\",\n          fontWeight: 800,\n          margin: 0,\n          background: \"linear-gradient(90deg, #FFD700, #FFA500, #FFD700)\",\n          WebkitBackgroundClip: \"text\",\n          WebkitTextFillColor: \"transparent\",\n          backgroundSize: \"200%\",\n          animation: \"shimmer 8s linear infinite\",\n        }}>\n          Challenges Hub\n        </h1>\n        <p style={{ opacity: 0.9, marginTop: 6 }}>\n          Test your knowledge and compete üèÜ\n        </p>\n      </div>\n\n      {/* Global Events Card */}\n      <div onClick={() => {\n        navigate(\"/events\");\n      }} style={{\n        maxWidth: 520,\n        margin: \"0 auto 24px\",\n        background: \"linear-gradient(135deg, rgba(212,175,55,0.25), rgba(16,185,129,0.2))\",\n        border: \"2px solid rgba(212,175,55,0.5)\",\n        borderRadius: 18,\n        padding: 16,\n        boxShadow: \"0 0 30px rgba(212,175,55,0.4)\",\n        cursor: \"pointer\",\n        transition: \"all 0.3s ease\",\n        position: \"relative\",\n      }}>\n        <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: 12 }}>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n            <Globe size={28} style={{ color: \"#D4AF37\" }} />\n            <h2 style={{ color: \"#d4af37\", margin: 0, fontSize: \"1.3rem\", fontWeight: 700 }}>\n              Global Events\n            </h2>\n          </div>\n          <p style={{ color: \"#10b981\", margin: 0, fontSize: \"0.85rem\", fontWeight: 600 }}>\n            üî¥ LIVE NOW\n          </p>\n        </div>\n        <button style={{\n          width: \"100%\",\n          background: \"linear-gradient(135deg, #10b981, #059669)\",\n          border: \"none\",\n          padding: \"12px 18px\",\n          borderRadius: 12,\n          fontWeight: 700,\n          fontSize: \"1rem\",\n          cursor: \"pointer\",\n          color: \"white\",\n          boxShadow: \"0 4px 15px rgba(16,185,129,0.3)\",\n        }} onClick={(e) => { \n          e.stopPropagation(); \n          navigate(\"/events\"); \n        }}>\n          Enter Global Events ‚Üí\n        </button>\n      </div>\n\n      {/* Friend Challenges Section */}\n      <div style={{ maxWidth: 600, margin: \"0 auto 24px\" }}>\n        <h3 style={{ color: \"#d4af37\", fontSize: \"1.2rem\", marginBottom: 12, textAlign: \"center\" }}>\n          üë• Friend Challenges\n        </h3>\n        <p style={{ color: \"#cbd5e1\", fontSize: \"0.85rem\", textAlign: \"center\", marginBottom: 16, opacity: 0.9 }}>\n          Challenge your friends in 4 exciting game modes!\n        </p>\n\n        {/* Challenge Mode Cards - 2x2 Grid */}\n        <div style={{\n          display: \"grid\",\n          gridTemplateColumns: \"repeat(2, 1fr)\",\n          gap: 14,\n          marginBottom: 20\n        }}>\n          {Object.keys(CHALLENGE_MODES).map((modeKey) => {\n            const mode = CHALLENGE_MODES[modeKey];\n            let mascotImage = null;\n            \n            if (mode.id === \"speed_run\") {\n              mascotImage = mascot_running;\n            } else if (mode.id === \"mind_battle\") {\n              mascotImage = mascot_quiz;\n            } else if (mode.id === \"lightning_round\") {\n              mascotImage = mascot_power;\n            } else if (mode.id === \"sudden_death\") {\n              mascotImage = mascot_locked;\n            }\n            \n            return (\n              <div\n                key={mode.id}\n                onClick={() => handleModeClick(modeKey)}\n                style={{\n                  background: mode.gradient,\n                  borderRadius: 16,\n                  padding: \"18px 12px\",\n                  cursor: \"pointer\",\n                  transition: \"all 0.2s ease\",\n                  boxShadow: mode.glow,\n                  minHeight: 220,\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  justifyContent: \"space-between\",\n                  textAlign: \"center\"\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.transform = \"translateY(-4px)\";\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.transform = \"translateY(0)\";\n                }}\n              >\n                <div style={{ fontSize: \"2.5rem\", marginBottom: 8, height: \"100px\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\n                  {mascotImage ? (\n                    <img \n                      src={mascotImage} \n                      alt={mode.name} \n                      style={{ \n                        width: \"auto\", \n                        height: mode.id === \"lightning_round\" ? \"85px\" : \"70px\", \n                        objectFit: \"contain\" \n                      }}\n                    />\n                  ) : (\n                    mode.icon\n                  )}\n                </div>\n                <div style={{ minHeight: \"60px\", display: \"flex\", flexDirection: \"column\", justifyContent: \"flex-start\" }}>\n                  <h4 style={{ color: \"#fff\", margin: \"0 0 6px\", fontSize: \"1.05rem\", fontWeight: 700, lineHeight: 1.2 }}>\n                    {mode.name}\n                  </h4>\n                  <p style={{ color: \"rgba(255,255,255,0.9)\", fontSize: \"0.75rem\", margin: 0, lineHeight: 1.3 }}>\n                    {mode.description}\n                  </p>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Boss Level Card */}\n      <div style={{ maxWidth: 520, margin: \"0 auto 24px\" }}>\n        <div\n          onClick={handleBossClick}\n          style={{\n            background: level >= BOSS_LEVEL.minLevel \n              ? BOSS_LEVEL.gradient \n              : \"linear-gradient(135deg, #374151, #1f2937)\",\n            border: level >= BOSS_LEVEL.minLevel \n              ? \"2px solid rgba(212,175,55,0.5)\"\n              : \"2px solid rgba(107,114,128,0.3)\",\n            borderRadius: 18,\n            padding: \"24px 20px 20px 20px\",\n            boxShadow: level >= BOSS_LEVEL.minLevel \n              ? BOSS_LEVEL.glow \n              : \"0 0 20px rgba(107,114,128,0.3)\",\n            cursor: \"pointer\",\n            transition: \"all 0.3s ease\",\n            position: \"relative\",\n            animation: level >= BOSS_LEVEL.minLevel ? \"bossGlow 2s ease-in-out infinite\" : \"none\"\n          }}\n        >\n          {level < BOSS_LEVEL.minLevel && (\n            <>\n              <div style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n                background: \"linear-gradient(135deg, rgba(55, 65, 81, 0.85), rgba(31, 41, 55, 0.85))\",\n                borderRadius: 18,\n                pointerEvents: \"none\"\n              }} />\n              <div style={{\n                position: \"absolute\",\n                top: 10,\n                right: 10,\n                background: \"rgba(0,0,0,0.7)\",\n                borderRadius: 20,\n                padding: \"4px 12px\",\n                fontSize: \"0.75rem\",\n                fontWeight: 600,\n                color: \"#94a3b8\",\n                zIndex: 2\n              }}>\n                üîí Level {BOSS_LEVEL.minLevel}+ Only\n              </div>\n            </>\n          )}\n\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: 12, marginBottom: 12, marginTop: 8, position: \"relative\", zIndex: 1 }}>\n            <img \n              src={BossLevelMascot} \n              alt=\"Boss Level Mascot\" \n              style={{ \n                width: \"85px\", \n                height: \"85px\",\n                filter: \"drop-shadow(0 0 20px rgba(59, 130, 246, 0.8)) drop-shadow(0 0 40px rgba(59, 130, 246, 0.5))\",\n                animation: \"bossAura 2s ease-in-out infinite\"\n              }} \n            />\n            <div>\n              <h2 style={{ color: level >= BOSS_LEVEL.minLevel ? \"#d4af37\" : \"#94a3b8\", margin: \"0 0 4px\", fontSize: \"1.4rem\", fontWeight: 700 }}>\n                Boss Level: Challenge the Dev\n              </h2>\n              <p style={{ color: level >= BOSS_LEVEL.minLevel ? \"#10b981\" : \"#6b7280\", margin: 0, fontSize: \"0.85rem\", fontWeight: 600 }}>\n                {useChallengeStore.getState().canPlayBossToday() ? \"‚úì Available Today\" : \"‚è∞ Played Today\"}\n              </p>\n            </div>\n          </div>\n\n          <p style={{ opacity: 0.95, lineHeight: 1.5, fontSize: \"0.9rem\", marginBottom: 12, position: \"relative\", zIndex: 1 }}>\n            {BOSS_LEVEL.description}\n          </p>\n\n          <div style={{ \n            background: \"rgba(0,0,0,0.3)\", \n            borderRadius: 10, \n            padding: \"10px 14px\",\n            fontSize: \"0.85rem\",\n            color: level >= BOSS_LEVEL.minLevel ? \"#10b981\" : \"#6b7280\",\n            fontWeight: 600,\n            position: \"relative\",\n            zIndex: 1\n          }}>\n            Rewards: +{BOSS_LEVEL.rewards.win.xp} XP ‚Ä¢ +{BOSS_LEVEL.rewards.win.coins} coins\n          </div>\n        </div>\n      </div>\n\n      {/* Friend Selector Modal (UI-only, not in central modal system) */}\n      {showFriendSelector && (\n        <div className=\"challenge-modal-overlay\" onClick={() => setShowFriendSelector(false)}>\n          <div className=\"challenge-modal\" onClick={(e) => e.stopPropagation()}>\n            <h2 className=\"challenge-modal-title\">Select Friend</h2>\n            <p className=\"challenge-modal-subtitle\">Who do you want to challenge?</p>\n            \n            {friends.length === 0 ? (\n              <p style={{ color: \"#cbd5e1\", textAlign: \"center\", padding: \"20px 0\" }}>\n                You don't have any friends yet. Add friends from the Friends tab!\n              </p>\n            ) : (\n              <div style={{ display: \"flex\", flexDirection: \"column\", gap: 10, maxHeight: 300, overflowY: \"auto\" }}>\n                {friends.map(friend => (\n                  <div\n                    key={friend.id}\n                    onClick={() => handleFriendSelect({\n                      id: friend.id,\n                      name: friend.nickname,\n                      nickname: friend.nickname,\n                      avatar: friend.avatar,\n                      xp: friend.xp,\n                      streak: friend.streak\n                    })}\n                    style={{\n                      background: \"rgba(255,255,255,0.05)\",\n                      border: \"1px solid rgba(255,255,255,0.1)\",\n                      borderRadius: 12,\n                      padding: 12,\n                      cursor: \"pointer\",\n                      transition: \"all 0.2s ease\"\n                    }}\n                    onMouseEnter={(e) => {\n                      e.currentTarget.style.background = \"rgba(255,255,255,0.1)\";\n                    }}\n                    onMouseLeave={(e) => {\n                      e.currentTarget.style.background = \"rgba(255,255,255,0.05)\";\n                    }}\n                  >\n                    <div style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n                      <div style={{\n                        width: 40,\n                        height: 40,\n                        borderRadius: \"50%\",\n                        background: \"#d4af37\",\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        justifyContent: \"center\",\n                        fontSize: \"1.2rem\"\n                      }}>\n                        üë§\n                      </div>\n                      <div>\n                        <div style={{ color: \"#fff\", fontWeight: 600 }}>{friend.nickname}</div>\n                        <div style={{ color: \"#94a3b8\", fontSize: \"0.85rem\" }}>\n                          @{friend.username} ‚Ä¢ {friend.xp.toLocaleString()} XP\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            <button \n              className=\"challenge-btn-secondary\"\n              onClick={() => setShowFriendSelector(false)}\n              style={{ marginTop: 16 }}\n            >\n              Cancel\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Keyframes */}\n      <style>{`\n        @keyframes shimmer {\n          0% { background-position: 0% 50%; }\n          100% { background-position: 200% 50%; }\n        }\n        \n        @keyframes bossGlow {\n          0%, 100% {\n            box-shadow: 0 0 30px rgba(212, 175, 55, 0.5);\n          }\n          50% {\n            box-shadow: 0 0 40px rgba(212, 175, 55, 0.8);\n          }\n        }\n        \n        @keyframes bossAura {\n          0%, 100% {\n            filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.8)) drop-shadow(0 0 40px rgba(59, 130, 246, 0.5));\n          }\n          50% {\n            filter: drop-shadow(0 0 30px rgba(59, 130, 246, 1)) drop-shadow(0 0 50px rgba(59, 130, 246, 0.7));\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n","path":null,"size_bytes":20370,"size_tokens":null},"src/data/lessons/namesOfAllahLessonsFull.js":{"content":"const namesOfAllahLessonsFull = [\n  {\n    id: 1,\n    title: \"Allah\",\n    arabic: \"ÿßŸÑŸÑŸëŸ∞Ÿá\",\n    meaning: \"The One True God\",\n    description: [\n      \"Allah is the only One who deserves all worship. Everything that exists belongs to Him.\",\n      \"He created us, gives us life, and guides us. No one shares His power or His perfection.\",\n      \"When we say Allah, we mean the One who has every beautiful Name and perfect quality.\",\n      \"Remembering Allah keeps our hearts calm and helps us live in the way He loves.\"\n    ],\n    reflection: \"How often do you remember Allah during your day?\",\n    quizId: \"allah_quiz\"\n  },\n  {\n    id: 2,\n    title: \"Ar-Rahmaan\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸÄŸ∞ŸÜ\",\n    meaning: \"The Most Merciful\",\n    description: [\n      \"Ar-Rahmaan means that Allah‚Äôs mercy is vast and covers all creation.\",\n      \"He shows mercy to everyone‚Äîbelievers and non-believers alike.\",\n      \"Every good thing you see around you is from His mercy.\",\n      \"When we are gentle and kind, we are following the example of Allah‚Äôs mercy.\"\n    ],\n    reflection: \"How can you show mercy to someone today?\",\n    quizId: \"ar_rahmaan_quiz\"\n  },\n  {\n    id: 3,\n    title: \"Ar-Raheem\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖ\",\n    meaning: \"The Especially Merciful\",\n    description: [\n      \"Ar-Raheem means Allah gives special mercy to those who believe in Him.\",\n      \"He forgives them, guides them, and rewards them in this life and the next.\",\n      \"Allah‚Äôs mercy never runs out no matter how many times we make mistakes.\",\n      \"We should thank Allah for always being kind and loving towards us.\"\n    ],\n    reflection: \"Who can you forgive to earn Allah‚Äôs mercy?\",\n    quizId: \"ar_raheem_quiz\"\n  },\n  {\n    id: 4,\n    title: \"Al-Malik\",\n    arabic: \"ÿßŸÑŸíŸÖŸéŸÑŸêŸÉ\",\n    meaning: \"The King\",\n    description: [\n      \"Al-Malik means Allah is the true King and Owner of everything.\",\n      \"Nothing happens without His permission and control.\",\n      \"He gives people power in this world, but He alone is the real King.\",\n      \"Knowing Allah is the King reminds us to stay humble and thankful.\"\n    ],\n    reflection: \"How can you show respect to Allah the King today?\",\n    quizId: \"al_malik_quiz\"\n  },\n  {\n    id: 5,\n    title: \"Al-Maalik\",\n    arabic: \"ÿßŸÑŸíŸÖŸéÿßŸÑŸêŸÉ\",\n    meaning: \"The Owner\",\n    description: [\n      \"Al-Maalik means Allah owns everything completely.\",\n      \"He owns the heavens, the earth, and everything between them.\",\n      \"Whatever we have belongs to Him, and He can give or take as He wills.\",\n      \"We should never be proud of what we have, but use it in ways that please Allah.\"\n    ],\n    reflection: \"Do you thank Allah for the things He lets you use?\",\n    quizId: \"al_maalik_quiz\"\n  },\n  {\n    id: 6,\n    title: \"Al-Maleek\",\n    arabic: \"ÿßŸÑŸíŸÖŸéŸÑŸêŸäŸÉ\",\n    meaning: \"The Supreme Sovereign\",\n    description: [\n      \"Al-Maleek means Allah rules with perfect power and justice.\",\n      \"He never forgets, never makes mistakes, and never becomes weak.\",\n      \"All kings and leaders in this world will one day stand before Him.\",\n      \"Remembering that Allah is Al-Maleek helps us make fair and honest choices.\"\n    ],\n    reflection: \"How can you act fairly like Allah loves?\",\n    quizId: \"al_maleek_quiz\"\n  },\n  {\n    id: 7,\n    title: \"Al-Quddoos\",\n    arabic: \"ÿßŸÑŸíŸÇŸèÿØŸèŸëŸàÿ≥\",\n    meaning: \"The Most Pure\",\n    description: [\n      \"Al-Quddoos means Allah is completely pure and perfect.\",\n      \"He is free from any weakness, mistake, or need.\",\n      \"Everything He does is right, wise, and beautiful.\",\n      \"We should try to keep our hearts and actions pure for His sake.\"\n    ],\n    reflection: \"What can you do today to keep your heart pure?\",\n    quizId: \"al_quddoos_quiz\"\n  },\n  {\n    id: 8,\n    title: \"As-Salaam\",\n    arabic: \"ÿßŸÑÿ≥ŸéŸëŸÑŸéÿßŸÖ\",\n    meaning: \"The Source of Peace\",\n    description: [\n      \"As-Salaam means Allah is the One who gives peace and safety.\",\n      \"All comfort and calmness come from Him alone.\",\n      \"In Jannah, the believers will hear Him say 'Peace!' as a greeting.\",\n      \"We can spread peace by being kind and saying 'As-Salaamu  øAlaykum'.\"\n    ],\n    reflection: \"Who can you greet with peace today?\",\n    quizId: \"as_salaam_quiz\"\n  },\n  {\n    id: 9,\n    title: \"Al-Mu'min\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜ\",\n    meaning: \"The Giver of Faith and Security\",\n    description: [\n      \"Al-Mu‚Äômin means Allah gives belief and safety to His servants.\",\n      \"He protects those who trust Him and keeps their hearts firm.\",\n      \"He is the One who guides us to the truth and keeps us safe from harm.\",\n      \"When you feel scared, remember that Allah is the best protector.\"\n    ],\n    reflection: \"When do you feel safest with Allah‚Äôs protection?\",\n    quizId: \"al_mumin_quiz\"\n  },\n  {\n    id: 10,\n    title: \"Al-Muhaymin\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸáŸéŸäŸíŸÖŸêŸÜ\",\n    meaning: \"The Guardian\",\n    description: [\n      \"Al-Muhaymin means Allah watches over everything and everyone.\",\n      \"He knows what we do in secret and in public.\",\n      \"He protects His creation and records all that happens.\",\n      \"Trust that Allah is always near, caring for you and guiding you.\"\n    ],\n    reflection: \"What does it mean to you that Allah is always watching with care?\",\n    quizId: \"al_muhaymin_quiz\"\n  },\n  {\n    id: 11,\n    title: \"Al-Azeez\",\n    arabic: \"ÿßŸÑŸíÿπŸéÿ≤ŸêŸäÿ≤\",\n    meaning: \"The Mighty\",\n    description: [\n      \"Al-Azeez means Allah is strong and nothing can defeat Him.\",\n      \"He gives honour and strength to whom He wills.\",\n      \"He is powerful yet merciful to His servants.\",\n      \"Knowing Allah is Al-Azeez helps us rely on Him in every challenge.\"\n    ],\n    reflection: \"When do you feel Allah‚Äôs strength helping you?\",\n    quizId: \"al_azeez_quiz\"\n  },\n  {\n    id: 12,\n    title: \"Al-Jabbaar\",\n    arabic: \"ÿßŸÑŸíÿ¨Ÿéÿ®ŸéŸëÿßÿ±\",\n    meaning: \"The Compeller\",\n    description: [\n      \"Al-Jabbaar means Allah fixes what is broken and makes things right.\",\n      \"He is strong and able to bring everything under His command.\",\n      \"He heals the hearts of the sad and gives comfort to those who need it.\",\n      \"We should remember that Allah can make every hard situation better.\"\n    ],\n    reflection: \"What do you need Allah to fix in your heart today?\",\n    quizId: \"al_jabbaar_quiz\"\n  },\n  {\n    id: 13,\n    title: \"Al-Mutakabbir\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ™ŸéŸÉŸéÿ®ŸêŸëÿ±\",\n    meaning: \"The Supreme in Greatness\",\n    description: [\n      \"Al-Mutakabbir means Allah is far greater than everything He created.\",\n      \"His greatness is perfect and full of honour, not pride like humans have.\",\n      \"He is above all weakness, need, or comparison.\",\n      \"Knowing Allah is Al-Mutakabbir reminds us to stay humble and never boast.\"\n    ],\n    reflection: \"What can you do today to show humility before Allah?\",\n    quizId: \"al_mutakabbir_quiz\"\n  },\n  {\n    id: 14,\n    title: \"Al-Khaaliq\",\n    arabic: \"ÿßŸÑŸíÿÆŸéÿßŸÑŸêŸÇ\",\n    meaning: \"The Creator\",\n    description: [\n      \"Al-Khaaliq means Allah made everything from nothing.\",\n      \"He planned every detail of the universe perfectly.\",\n      \"Every tree, mountain, and person shows His amazing design.\",\n      \"When we look around, we see signs of the Creator everywhere.\"\n    ],\n    reflection: \"What is one thing in nature that makes you think of Allah?\",\n    quizId: \"al_khaaliq_quiz\"\n  },\n  {\n    id: 15,\n    title: \"Al-Baari'\",\n    arabic: \"ÿßŸÑŸíÿ®Ÿéÿßÿ±Ÿêÿ¶\",\n    meaning: \"The Maker of Order\",\n    description: [\n      \"Al-Baari‚Äô means Allah shapes His creation in the best way.\",\n      \"He gives each creature its right form and purpose.\",\n      \"Nothing in the world is random; Allah made it all fit perfectly together.\",\n      \"This teaches us that Allah‚Äôs wisdom is in every part of His creation.\"\n    ],\n    reflection: \"How does seeing order in the world make you trust Allah?\",\n    quizId: \"al_baari_quiz\"\n  },\n  {\n    id: 16,\n    title: \"Al-Musawwir\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿµŸéŸàŸêŸëÿ±\",\n    meaning: \"The Fashioner\",\n    description: [\n      \"Al-Musawwir means Allah gives everything its special shape and beauty.\",\n      \"Every face, colour, and sound is part of His amazing design.\",\n      \"He made each of us unique so we can recognise His creativity.\",\n      \"Thank Allah for how He made you ‚Äî perfectly for your purpose.\"\n    ],\n    reflection: \"What do you like most about how Allah created you?\",\n    quizId: \"al_musawwir_quiz\"\n  },\n  {\n    id: 17,\n    title: \"Al-Ghaffaar\",\n    arabic: \"ÿßŸÑŸíÿ∫ŸéŸÅŸéŸëÿßÿ±\",\n    meaning: \"The Oft-Forgiving\",\n    description: [\n      \"Al-Ghaffaar means Allah forgives again and again.\",\n      \"No matter how many times we sin, if we turn back sincerely, He forgives.\",\n      \"He hides our mistakes and replaces them with good when we repent.\",\n      \"We should also forgive others easily, just as Allah forgives us.\"\n    ],\n    reflection: \"Who can you forgive today to earn Allah‚Äôs forgiveness?\",\n    quizId: \"al_ghaffaar_quiz\"\n  },\n  {\n    id: 18,\n    title: \"Al-Qahhaar\",\n    arabic: \"ÿßŸÑŸíŸÇŸéŸáŸéŸëÿßÿ±\",\n    meaning: \"The All-Prevailing\",\n    description: [\n      \"Al-Qahhaar means Allah has complete power over everything.\",\n      \"Nothing can escape His will or challenge His rule.\",\n      \"He conquers all injustice and falsehood with His truth.\",\n      \"Remembering Al-Qahhaar gives us strength to resist wrongdoing.\"\n    ],\n    reflection: \"How does knowing Allah controls everything make you feel safe?\",\n    quizId: \"al_qahhaar_quiz\"\n  },\n  {\n    id: 19,\n    title: \"Al-Wahhaab\",\n    arabic: \"ÿßŸÑŸíŸàŸéŸáŸéŸëÿßÿ®\",\n    meaning: \"The Bestower\",\n    description: [\n      \"Al-Wahhaab means Allah gives gifts freely out of His kindness.\",\n      \"He gives life, knowledge, friends, and chances to do good.\",\n      \"Even when we forget to ask, Allah still blesses us.\",\n      \"We should share what we have with others to follow His example.\"\n    ],\n    reflection: \"What blessing can you share with someone today?\",\n    quizId: \"al_wahhaab_quiz\"\n  },\n  {\n    id: 20,\n    title: \"Ar-Razzaaq\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëÿ≤ŸéŸëÿßŸÇ\",\n    meaning: \"The Provider\",\n    description: [\n      \"Ar-Razzaaq means Allah gives every creature the food and help it needs.\",\n      \"He provides rain for plants, homes for animals, and families for people.\",\n      \"Even the birds in the sky depend on Him for every meal.\",\n      \"Trust that your rizq comes only from Allah, not from people.\"\n    ],\n    reflection: \"What has Allah provided for you today?\",\n    quizId: \"ar_razzaaq_quiz\"\n  },\n  {\n    id: 21,\n    title: \"Al-Fattaah\",\n    arabic: \"ÿßŸÑŸíŸÅŸéÿ™ŸéŸëÿßÿ≠\",\n    meaning: \"The Opener\",\n    description: [\n      \"Al-Fattaah means Allah opens the doors of goodness and success.\",\n      \"He helps us find solutions when things seem impossible.\",\n      \"He opens hearts to guidance and minds to understanding.\",\n      \"Ask Al-Fattaah to open your heart to faith and your life to ease.\"\n    ],\n    reflection: \"What do you need Allah to open for you today?\",\n    quizId: \"al_fattaah_quiz\"\n  },\n  {\n    id: 22,\n    title: \"Al- øAleem\",\n    arabic: \"ÿßŸÑŸíÿπŸéŸÑŸêŸäŸÖ\",\n    meaning: \"The All-Knowing\",\n    description: [\n      \"Al- øAleem means Allah knows everything ‚Äî past, present, and future.\",\n      \"He knows our thoughts, dreams, and feelings even when we hide them.\",\n      \"Nothing is forgotten or missed by His knowledge.\",\n      \"Remember that Allah knows best what is good for you.\"\n    ],\n    reflection: \"How does knowing Allah sees and knows you change your actions?\",\n    quizId: \"al_aleem_quiz\"\n  },\n  {\n    id: 23,\n    title: \"Al-Qaabid\",\n    arabic: \"ÿßŸÑŸíŸÇŸéÿßÿ®Ÿêÿ∂\",\n    meaning: \"The Withholder\",\n    description: [\n      \"Al-Qaabid means Allah can hold back something for a good reason.\",\n      \"Sometimes He withholds money, success, or answers to teach patience.\",\n      \"He never withholds out of cruelty ‚Äî only out of wisdom.\",\n      \"Be content knowing that what He delays may protect you from harm.\"\n    ],\n    reflection: \"Can you trust Allah even when you don‚Äôt get what you want?\",\n    quizId: \"al_qaabid_quiz\"\n  },\n  {\n    id: 24,\n    title: \"Al-Baasit\",\n    arabic: \"ÿßŸÑŸíÿ®Ÿéÿßÿ≥Ÿêÿ∑\",\n    meaning: \"The Expander\",\n    description: [\n      \"Al-Baasit means Allah gives freely and spreads His blessings wide.\",\n      \"He opens His hand in generosity to whom He wills.\",\n      \"When life feels full of blessings, it‚Äôs from His kindness.\",\n      \"We should thank Him in times of ease and share with others.\"\n    ],\n    reflection: \"Who can you share your blessings with today?\",\n    quizId: \"al_baasit_quiz\"\n  },\n  {\n    id: 25,\n    title: \"Al-Khaafid\",\n    arabic: \"ÿßŸÑŸíÿÆŸéÿßŸÅŸêÿ∂\",\n    meaning: \"The Abaser\",\n    description: [\n      \"Al-Khaafid means Allah can lower whoever He wills in status or power.\",\n      \"He humbles the proud and reminds them that greatness belongs only to Him.\",\n      \"He lowers people through tests so they turn back to Him with humility.\",\n      \"We should never look down on others, because honour comes only from Allah.\"\n    ],\n    reflection: \"How can you stay humble when Allah gives you success?\",\n    quizId: \"al_khaafid_quiz\"\n  },\n  {\n    id: 26,\n    title: \"Ar-Raafi ø\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëÿßŸÅŸêÿπ\",\n    meaning: \"The Exalter\",\n    description: [\n      \"Ar-Raafi ø means Allah raises up whomever He wills in honour and faith.\",\n      \"He lifts the hearts of believers and gives them respect through good deeds.\",\n      \"He raises people who remember Him and live with honesty and kindness.\",\n      \"Ask Allah to raise you through knowledge, humility, and good character.\"\n    ],\n    reflection: \"What good deed can lift your rank with Allah today?\",\n    quizId: \"ar_raafi_quiz\"\n  },\n  {\n    id: 27,\n    title: \"Al-Mu øizz\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿπŸêÿ≤Ÿë\",\n    meaning: \"The Giver of Honour\",\n    description: [\n      \"Al-Mu øizz means Allah gives respect and strength to whom He wills.\",\n      \"He gives honour to those who obey Him and live with truth.\",\n      \"True honour is not in money or followers but in being close to Allah.\",\n      \"We should seek dignity through faith and helping others.\"\n    ],\n    reflection: \"How can you earn honour with Allah instead of people?\",\n    quizId: \"al_muizz_quiz\"\n  },\n  {\n    id: 28,\n    title: \"Al-Mudhill\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ∞ŸêŸÑŸë\",\n    meaning: \"The Humiliator\",\n    description: [\n      \"Al-Mudhill means Allah lowers those who turn away from Him and do wrong.\",\n      \"He removes pride and false power from those who misuse it.\",\n      \"His justice protects the weak and reminds us that evil never wins.\",\n      \"Fear Allah‚Äôs displeasure and stay gentle and fair with everyone.\"\n    ],\n    reflection: \"How can you avoid pride and stay near to Allah?\",\n    quizId: \"al_mudhill_quiz\"\n  },\n  {\n    id: 29,\n    title: \"As-Samee ø\",\n    arabic: \"ÿßŸÑÿ≥ŸéŸëŸÖŸêŸäÿπ\",\n    meaning: \"The All-Hearing\",\n    description: [\n      \"As-Samee ø means Allah hears every sound and every prayer.\",\n      \"No whisper or cry is hidden from Him, even the voice in your heart.\",\n      \"When you make du øaa, He always hears you, even before you speak.\",\n      \"This Name helps us speak kindly, knowing Allah hears all words.\"\n    ],\n    reflection: \"What do your words sound like to Allah today?\",\n    quizId: \"as_samee_quiz\"\n  },\n  {\n    id: 30,\n    title: \"Al-Baseer\",\n    arabic: \"ÿßŸÑŸíÿ®ŸéÿµŸêŸäÿ±\",\n    meaning: \"The All-Seeing\",\n    description: [\n      \"Al-Baseer means Allah sees everything clearly, no matter how small.\",\n      \"He sees the stars in the sky and the thoughts in our hearts.\",\n      \"Nothing is hidden from His sight, and His watch is full of mercy.\",\n      \"We should remember Allah sees us and try to please Him in private and public.\"\n    ],\n    reflection: \"Would you do the same actions if you remembered Allah is watching?\",\n    quizId: \"al_baseer_quiz\"\n  },\n  {\n    id: 31,\n    title: \"Al-Hakam\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÉŸéŸÖ\",\n    meaning: \"The Judge\",\n    description: [\n      \"Al-Hakam means Allah judges fairly between people.\",\n      \"He knows every fact and never makes a mistake.\",\n      \"His rulings are based on truth and wisdom, not anger or desire.\",\n      \"Trust Allah‚Äôs judgement and be fair when you deal with others.\"\n    ],\n    reflection: \"How can you be fair in your choices today?\",\n    quizId: \"al_hakam_quiz\"\n  },\n  {\n    id: 32,\n    title: \"Al- øAdl\",\n    arabic: \"ÿßŸÑŸíÿπŸéÿØŸíŸÑ\",\n    meaning: \"The Just\",\n    description: [\n      \"Al- øAdl means Allah is perfectly fair in everything He does.\",\n      \"He rewards good and punishes wrong with full justice.\",\n      \"Sometimes we don‚Äôt see justice right away, but Allah never forgets.\",\n      \"We should love justice and avoid cheating or hurting others.\"\n    ],\n    reflection: \"How can you practise fairness in your daily life?\",\n    quizId: \"al_adl_quiz\"\n  },\n  {\n    id: 33,\n    title: \"Al-Lateef\",\n    arabic: \"ÿßŸÑŸÑŸéŸëÿ∑ŸêŸäŸÅ\",\n    meaning: \"The Gentle and Subtle\",\n    description: [\n      \"Al-Lateef means Allah cares for us in ways we don‚Äôt even notice.\",\n      \"He makes things easy and helps us softly without us realising.\",\n      \"His kindness reaches our hearts through small blessings every day.\",\n      \"We should look for Allah‚Äôs gentle care in every situation.\"\n    ],\n    reflection: \"What small blessing showed Allah‚Äôs kindness to you today?\",\n    quizId: \"al_lateef_quiz\"\n  },\n  {\n    id: 34,\n    title: \"Al-Khabeer\",\n    arabic: \"ÿßŸÑŸíÿÆŸéÿ®ŸêŸäÿ±\",\n    meaning: \"The All-Aware\",\n    description: [\n      \"Al-Khabeer means Allah knows everything deeply and fully.\",\n      \"He knows what is hidden in our hearts and what will happen next.\",\n      \"His knowledge helps us see that He always chooses the best for us.\",\n      \"We should trust His wisdom even when we don‚Äôt understand His plans.\"\n    ],\n    reflection: \"When was a time Allah knew what was best for you even if you didn‚Äôt?\",\n    quizId: \"al_khabeer_quiz\"\n  },\n  {\n    id: 35,\n    title: \"Al-Haleem\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÑŸêŸäŸÖ\",\n    meaning: \"The Forbearing\",\n    description: [\n      \"Al-Haleem means Allah is patient and does not punish us right away.\",\n      \"He gives time to people so they can repent and change.\",\n      \"His patience shows mercy even when we make mistakes.\",\n      \"We should also be calm and forgiving with others.\"\n    ],\n    reflection: \"When can you show patience like Allah teaches?\",\n    quizId: \"al_haleem_quiz\"\n  },\n  {\n    id: 36,\n    title: \"Al- øAzeem\",\n    arabic: \"ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖ\",\n    meaning: \"The Magnificent\",\n    description: [\n      \"Al- øAzeem means Allah is truly great and deserves all praise.\",\n      \"His creation, His power, and His mercy all show His greatness.\",\n      \"When we bow in prayer and say 'Subhaana Rabbiyal- øAzeem', we remember this.\",\n      \"Thinking about His greatness keeps our hearts full of awe and love.\"\n    ],\n    reflection: \"What reminds you most of Allah‚Äôs greatness?\",\n    quizId: \"al_azeem_quiz\"\n  },\n  {\n    id: 37,\n    title: \"Al-Ghafoor\",\n    arabic: \"ÿßŸÑŸíÿ∫ŸéŸÅŸèŸàÿ±\",\n    meaning: \"The All-Forgiving\",\n    description: [\n      \"Al-Ghafoor means Allah forgives all sins for those who repent sincerely.\",\n      \"He hides our faults and replaces our bad deeds with good.\",\n      \"His forgiveness never ends, no matter how many times we return to Him.\",\n      \"Remembering Al-Ghafoor helps us stay hopeful and forgiving of others.\"\n    ],\n    reflection: \"Who can you forgive today to please Al-Ghafoor?\",\n    quizId: \"al_ghafoor_quiz\"\n  },\n  {\n    id: 38,\n    title: \"Ash-Shakoor\",\n    arabic: \"ÿßŸÑÿ¥ŸéŸëŸÉŸèŸàÿ±\",\n    meaning: \"The Appreciative\",\n    description: [\n      \"Ash-Shakoor means Allah appreciates every small good deed we do.\",\n      \"He multiplies rewards far more than we deserve.\",\n      \"Even a smile or helping hand can earn His appreciation.\",\n      \"We should also thank people and always thank Allah first.\"\n    ],\n    reflection: \"What can you thank Allah for right now?\",\n    quizId: \"ash_shakoor_quiz\"\n  },\n  {\n    id: 39,\n    title: \"Al- øAliyy\",\n    arabic: \"ÿßŸÑŸíÿπŸéŸÑŸêŸäŸë\",\n    meaning: \"The Most High\",\n    description: [\n      \"Al- øAliyy means Allah is higher than everything in power and honour.\",\n      \"He is above all creation, perfect in every way.\",\n      \"No one can reach His level or compare to His greatness.\",\n      \"We raise our hands in du øaa because He is the Most High.\"\n    ],\n    reflection: \"How does remembering Allah‚Äôs highness make you feel humble?\",\n    quizId: \"al_aliyy_quiz\"\n  },\n  {\n    id: 40,\n    title: \"Al-Kabeer\",\n    arabic: \"ÿßŸÑŸíŸÉŸéÿ®ŸêŸäÿ±\",\n    meaning: \"The Most Great\",\n    description: [\n      \"Al-Kabeer means Allah is greater than anything we can imagine.\",\n      \"Every mountain, planet, and star shows His greatness.\",\n      \"He is not limited by size or place‚ÄîHis greatness has no end.\",\n      \"When we say 'Allahu Akbar', we remember nothing is greater than Him.\"\n    ],\n    reflection: \"What reminds you to say 'Allahu Akbar' each day?\",\n    quizId: \"al_kabeer_quiz\"\n  },\n  {\n    id: 41,\n    title: \"Al-Hafeedh\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÅŸêŸäÿ∏\",\n    meaning: \"The Preserver\",\n    description: [\n      \"Al-Hafeedh means Allah protects and guards everything He created.\",\n      \"He keeps the heavens, the earth, and our hearts safe by His care.\",\n      \"He protects us from harm and keeps our good deeds recorded.\",\n      \"Trust that nothing can harm you unless He allows it for good reason.\"\n    ],\n    reflection: \"When has Allah protected you without you realising?\",\n    quizId: \"al_hafeedh_quiz\"\n  },\n  {\n    id: 42,\n    title: \"Al-Muqeet\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÇŸêŸäÿ™\",\n    meaning: \"The Nourisher\",\n    description: [\n      \"Al-Muqeet means Allah provides strength and nourishment to everything.\",\n      \"He gives food to every creature and power to every heart.\",\n      \"He knows what we need most‚Äîboth food for the body and faith for the soul.\",\n      \"We should say Alhamdulillah for every meal and blessing He sends.\"\n    ],\n    reflection: \"What blessing gives you strength today?\",\n    quizId: \"al_muqeet_quiz\"\n  },\n  {\n    id: 43,\n    title: \"Al-Haseeb\",\n    arabic: \"ÿßŸÑŸíÿ≠Ÿéÿ≥ŸêŸäÿ®\",\n    meaning: \"The Reckoner\",\n    description: [\n      \"Al-Haseeb means Allah knows and keeps account of everything.\",\n      \"He never forgets even the smallest good or bad deed.\",\n      \"He is enough as a witness and judge for us all.\",\n      \"This reminds us to live honestly and depend only on Him.\"\n    ],\n    reflection: \"If Allah took your account today, what good would you hope to show?\",\n    quizId: \"al_haseeb_quiz\"\n  },\n  {\n    id: 44,\n    title: \"Al-Jaleel\",\n    arabic: \"ÿßŸÑŸíÿ¨ŸéŸÑŸêŸäŸÑ\",\n    meaning: \"The Majestic\",\n    description: [\n      \"Al-Jaleel means Allah is full of majesty, honour, and greatness.\",\n      \"Everything in creation shows His beauty and power.\",\n      \"He deserves our deepest respect and love.\",\n      \"Remembering Al-Jaleel fills the heart with awe and gratitude.\"\n    ],\n    reflection: \"How can you show respect to Allah today?\",\n    quizId: \"al_jaleel_quiz\"\n  },\n  {\n    id: 45,\n    title: \"Al-Kareem\",\n    arabic: \"ÿßŸÑŸíŸÉŸéÿ±ŸêŸäŸÖ\",\n    meaning: \"The Generous\",\n    description: [\n      \"Al-Kareem means Allah gives without limit and never stops giving.\",\n      \"He gives us more than we ask for and forgives us when we fail.\",\n      \"His generosity includes guidance, food, and every blessing.\",\n      \"We should be generous with others, just as Allah is with us.\"\n    ],\n    reflection: \"Who can you give something to today?\",\n    quizId: \"al_kareem_quiz\"\n  },\n  {\n    id: 46,\n    title: \"Ar-Raqeeb\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëŸÇŸêŸäÿ®\",\n    meaning: \"The Watchful\",\n    description: [\n      \"Ar-Raqeeb means Allah is always watching over His creation.\",\n      \"He sees every action and intention, whether big or small.\",\n      \"His watchfulness keeps us safe and helps us stay sincere.\",\n      \"Remembering Ar-Raqeeb keeps us honest and mindful.\"\n    ],\n    reflection: \"Would you change anything if you remembered Allah is watching?\",\n    quizId: \"ar_raqeeb_quiz\"\n  },\n  {\n    id: 47,\n    title: \"Al-Mujeeb\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ¨ŸêŸäÿ®\",\n    meaning: \"The Responder\",\n    description: [\n      \"Al-Mujeeb means Allah answers the prayers of those who call on Him.\",\n      \"He listens to every du øaa and responds in the best way and time.\",\n      \"Sometimes the answer is yes, sometimes later, or something better.\",\n      \"Keep asking Him because He loves when we make du øaa often.\"\n    ],\n    reflection: \"What du øaa do you want Allah to answer soon?\",\n    quizId: \"al_mujeeb_quiz\"\n  },\n  {\n    id: 48,\n    title: \"Al-Waasi ø\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿßÿ≥Ÿêÿπ\",\n    meaning: \"The All-Encompassing\",\n    description: [\n      \"Al-Waasi ø means Allah‚Äôs mercy, knowledge, and gifts cover everything.\",\n      \"No one is left out from His care and compassion.\",\n      \"His knowledge fills every place, and His giving never ends.\",\n      \"We should remember that Allah‚Äôs mercy is wider than our worries.\"\n    ],\n    reflection: \"How can you remember Allah‚Äôs mercy is always enough for you?\",\n    quizId: \"al_waasi_quiz\"\n  },\n  {\n    id: 49,\n    title: \"Al-Hakeem\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÉŸêŸäŸÖ\",\n    meaning: \"The All-Wise\",\n    description: [\n      \"Al-Hakeem means Allah does everything with perfect wisdom.\",\n      \"He knows exactly what is best for us, even when we don‚Äôt understand it.\",\n      \"Every rule in the Qur‚Äôan and every event in life has a wise purpose.\",\n      \"Trust that Allah‚Äôs plan is always fair, kind, and full of wisdom.\"\n    ],\n    reflection: \"When was a time you saw Allah‚Äôs wisdom after waiting patiently?\",\n    quizId: \"al_hakeem_quiz\"\n  },\n  {\n    id: 50,\n    title: \"Al-Wadood\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿØŸèŸàÿØ\",\n    meaning: \"The Loving\",\n    description: [\n      \"Al-Wadood means Allah loves His creation and wants good for them.\",\n      \"He shows His love through mercy, forgiveness, and blessings.\",\n      \"He loves when we turn to Him in prayer and follow His guidance.\",\n      \"We can show love by being kind to people and helping those in need.\"\n    ],\n    reflection: \"How can you show love for Allah and His creation today?\",\n    quizId: \"al_wadood_quiz\"\n  },\n  {\n    id: 51,\n    title: \"Al-Majeed\",\n    arabic: \"ÿßŸÑŸíŸÖŸéÿ¨ŸêŸäÿØ\",\n    meaning: \"The Most Glorious\",\n    description: [\n      \"Al-Majeed means Allah is full of glory, honour, and perfection.\",\n      \"His actions are noble, His promises true, and His mercy endless.\",\n      \"He gives dignity to those who remember Him and follow His way.\",\n      \"Praising Al-Majeed fills the heart with gratitude and respect.\"\n    ],\n    reflection: \"What‚Äôs one way you can honour Allah today?\",\n    quizId: \"al_majeed_quiz\"\n  },\n  {\n    id: 52,\n    title: \"Al-Ba øith\",\n    arabic: \"ÿßŸÑŸíÿ®ŸéÿßÿπŸêÿ´\",\n    meaning: \"The Resurrector\",\n    description: [\n      \"Al-Ba øith means Allah will bring everyone back to life after death.\",\n      \"He will judge all people and reward or punish with justice.\",\n      \"He also sends life back to the earth with rain and renewal.\",\n      \"Believing in Al-Ba øith reminds us to prepare for the Day of Judgement.\"\n    ],\n    reflection: \"How does remembering the Day of Judgement affect your actions?\",\n    quizId: \"al_baith_quiz\"\n  },\n  {\n    id: 53,\n    title: \"Ash-Shaheed\",\n    arabic: \"ÿßŸÑÿ¥ŸéŸëŸáŸêŸäÿØ\",\n    meaning: \"The Witness\",\n    description: [\n      \"Ash-Shaheed means Allah sees and witnesses everything that happens.\",\n      \"He is always present, aware of every truth and falsehood.\",\n      \"No one can hide from His sight or change His record.\",\n      \"Knowing Allah is Ash-Shaheed helps us be honest even when alone.\"\n    ],\n    reflection: \"Would you act differently if you remembered Allah is your witness?\",\n    quizId: \"ash_shaheed_quiz\"\n  },\n  {\n    id: 54,\n    title: \"Al-Haqq\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÇŸë\",\n    meaning: \"The Truth\",\n    description: [\n      \"Al-Haqq means Allah is the only true reality.\",\n      \"Everything else will end, but Allah remains forever.\",\n      \"His words, promises, and guidance are all true and never fail.\",\n      \"Following the truth brings peace and honour in this world and the next.\"\n    ],\n    reflection: \"What truth from the Qur‚Äôan inspires you most?\",\n    quizId: \"al_haqq_quiz\"\n  },\n  {\n    id: 55,\n    title: \"Al-Wakeel\",\n    arabic: \"ÿßŸÑŸíŸàŸéŸÉŸêŸäŸÑ\",\n    meaning: \"The Trustee\",\n    description: [\n      \"Al-Wakeel means Allah is the best One to depend on for everything.\",\n      \"He manages all affairs perfectly and never disappoints those who trust Him.\",\n      \"When we say 'HasbunAllahu wa ni ømal Wakeel', we put full trust in Him.\",\n      \"Relying on Allah makes the heart peaceful even in hard times.\"\n    ],\n    reflection: \"What worry can you hand over to Allah today?\",\n    quizId: \"al_wakeel_quiz\"\n  },\n  {\n    id: 56,\n    title: \"Al-Qawiyy\",\n    arabic: \"ÿßŸÑŸíŸÇŸéŸàŸêŸäŸë\",\n    meaning: \"The All-Strong\",\n    description: [\n      \"Al-Qawiyy means Allah has complete strength and power.\",\n      \"Nothing can defeat Him or make Him tired.\",\n      \"He gives strength to those who rely on Him and obey His commands.\",\n      \"Remember that true power belongs only to Allah.\"\n    ],\n    reflection: \"What makes you feel strong when you trust Allah?\",\n    quizId: \"al_qawiyy_quiz\"\n  },\n  {\n    id: 57,\n    title: \"Al-Mateen\",\n    arabic: \"ÿßŸÑŸíŸÖŸéÿ™ŸêŸäŸÜ\",\n    meaning: \"The Firm and Steadfast\",\n    description: [\n      \"Al-Mateen means Allah‚Äôs power is strong and unchanging.\",\n      \"He never weakens, forgets, or gets tired.\",\n      \"His strength holds up the heavens and earth perfectly.\",\n      \"This reminds us to stay firm in faith and rely on Him through every test.\"\n    ],\n    reflection: \"How can you stay firm in your faith this week?\",\n    quizId: \"al_mateen_quiz\"\n  },\n  {\n    id: 58,\n    title: \"Al-Waliyy\",\n    arabic: \"ÿßŸÑŸíŸàŸéŸÑŸêŸäŸë\",\n    meaning: \"The Protecting Friend\",\n    description: [\n      \"Al-Waliyy means Allah is the close friend and protector of the believers.\",\n      \"He helps them in every situation and guides them to what is good.\",\n      \"He never leaves those who love Him without care.\",\n      \"We should make Allah our best friend through prayer and obedience.\"\n    ],\n    reflection: \"What makes you feel close to Allah as your friend?\",\n    quizId: \"al_waliyy_quiz\"\n  },\n  {\n    id: 59,\n    title: \"Al-Hameed\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸÖŸêŸäÿØ\",\n    meaning: \"The Praiseworthy\",\n    description: [\n      \"Al-Hameed means Allah deserves all praise for everything He does.\",\n      \"He is perfect in His actions, generous in His gifts, and just in His rulings.\",\n      \"Every blessing we enjoy is a reason to say 'Alhamdulillah'.\",\n      \"Praising Allah keeps our hearts thankful and happy.\"\n    ],\n    reflection: \"What blessing will you thank Allah for today?\",\n    quizId: \"al_hameed_quiz\"\n  },\n  {\n    id: 60,\n    title: \"Al-Muhsee\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ≠ŸíÿµŸêŸä\",\n    meaning: \"The Counter\",\n    description: [\n      \"Al-Muhsee means Allah counts and records everything in the universe.\",\n      \"He knows the number of stars, grains of sand, and thoughts in every heart.\",\n      \"Nothing is forgotten or lost in His knowledge.\",\n      \"This helps us remember that every action we do is noticed by Allah.\"\n    ],\n    reflection: \"How does knowing Allah counts all deeds affect your choices?\",\n    quizId: \"al_muhsee_quiz\"\n  },\n  {\n    id: 61,\n    title: \"Al-Mubdi ø\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ®ŸíÿØŸêÿ¶\",\n    meaning: \"The Originator\",\n    description: [\n      \"Al-Mubdi ø means Allah begins creation from nothing.\",\n      \"He started the universe, life, and every new moment with perfect design.\",\n      \"Every new idea, birth, and sunrise is a sign of His power to begin.\",\n      \"He alone can start life and bring it back again after death.\"\n    ],\n    reflection: \"What new good habit can you begin for Allah today?\",\n    quizId: \"al_mubdi_quiz\"\n  },\n  {\n    id: 62,\n    title: \"Al-Mu øeed\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿπŸêŸäÿØ\",\n    meaning: \"The Restorer\",\n    description: [\n      \"Al-Mu øeed means Allah brings things back after they are gone.\",\n      \"He will bring every soul back to life for judgement after death.\",\n      \"He can also restore health, hope, or happiness when we lose them.\",\n      \"This Name gives us hope that nothing is ever truly lost with Allah.\"\n    ],\n    reflection: \"What do you want Allah to restore for you?\",\n    quizId: \"al_mueed_quiz\"\n  },\n  {\n    id: 63,\n    title: \"Al-Muhyi\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ≠ŸíŸäŸêŸä\",\n    meaning: \"The Giver of Life\",\n    description: [\n      \"Al-Muhyi means Allah gives life to all living things.\",\n      \"He brings the dead earth to life with rain and gives us breath every day.\",\n      \"He also gives spiritual life to hearts through faith and Qur‚Äôan.\",\n      \"We should thank Him every morning for the gift of life and belief.\"\n    ],\n    reflection: \"What makes your heart feel alive with faith?\",\n    quizId: \"al_muhyi_quiz\"\n  },\n  {\n    id: 64,\n    title: \"Al-Mumeet\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÖŸêŸäÿ™\",\n    meaning: \"The Giver of Death\",\n    description: [\n      \"Al-Mumeet means Allah takes life away when the time is right.\",\n      \"Death is not an end, but a step to the next life He promised.\",\n      \"He gives life and death with wisdom and perfect timing.\",\n      \"Remembering Al-Mumeet helps us live each day with purpose and care.\"\n    ],\n    reflection: \"If today were your last day, what good would you want to do?\",\n    quizId: \"al_mumeet_quiz\"\n  },\n  {\n    id: 65,\n    title: \"Al-Hayy\",\n    arabic: \"ÿßŸÑŸíÿ≠ŸéŸäŸë\",\n    meaning: \"The Ever-Living\",\n    description: [\n      \"Al-Hayy means Allah is alive forever and never dies.\",\n      \"He doesn‚Äôt sleep, forget, or become tired.\",\n      \"All life comes from Him, and He remains while everything else fades.\",\n      \"When we feel weak or afraid, we remember Allah is always living and watching.\"\n    ],\n    reflection: \"How does it comfort you that Allah never dies or forgets?\",\n    quizId: \"al_hayy_quiz\"\n  },\n  {\n    id: 66,\n    title: \"Al-Qayyoom\",\n    arabic: \"ÿßŸÑŸíŸÇŸéŸäŸèŸëŸàŸÖ\",\n    meaning: \"The Self-Sustaining\",\n    description: [\n      \"Al-Qayyoom means Allah takes care of everything without needing help.\",\n      \"He provides for all creation and keeps the universe running perfectly.\",\n      \"Nothing can exist or continue without Him.\",\n      \"We depend on Him for every breath and every blessing.\"\n    ],\n    reflection: \"How can you rely more on Allah each day?\",\n    quizId: \"al_qayyoom_quiz\"\n  },\n  {\n    id: 67,\n    title: \"Al-Waajid\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿßÿ¨ŸêÿØ\",\n    meaning: \"The Perceiver\",\n    description: [\n      \"Al-Waajid means Allah finds and knows everything without searching.\",\n      \"He knows what exists, what is hidden, and what is missing.\",\n      \"He never loses anything and nothing escapes His awareness.\",\n      \"We can always turn to Him when we feel lost or forgotten.\"\n    ],\n    reflection: \"How can you remember that Allah always knows where you are?\",\n    quizId: \"al_waajid_quiz\"\n  },\n  {\n    id: 68,\n    title: \"Al-Maajid\",\n    arabic: \"ÿßŸÑŸíŸÖŸéÿßÿ¨ŸêÿØ\",\n    meaning: \"The Most Noble\",\n    description: [\n      \"Al-Maajid means Allah is full of goodness, generosity, and honour.\",\n      \"His greatness is seen in His kindness to creation and His forgiveness.\",\n      \"He is noble in all He gives and all He does.\",\n      \"We should act nobly and treat others with dignity and respect.\"\n    ],\n    reflection: \"What‚Äôs one noble act you can do today for Allah‚Äôs sake?\",\n    quizId: \"al_maajid_quiz\"\n  },\n  {\n    id: 69,\n    title: \"Al-Waahid\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿßÿ≠ŸêÿØ\",\n    meaning: \"The One\",\n    description: [\n      \"Al-Waahid means Allah is One, with no partner or equal.\",\n      \"Everything in creation shows that there is only one Creator.\",\n      \"He alone deserves our worship and love.\",\n      \"Believing in His oneness keeps our hearts pure from shirk.\"\n    ],\n    reflection: \"How can you show your belief that Allah is One today?\",\n    quizId: \"al_waahid_quiz\"\n  },\n  {\n    id: 70,\n    title: \"As-Samad\",\n    arabic: \"ÿßŸÑÿµŸéŸëŸÖŸéÿØ\",\n    meaning: \"The Eternal Refuge\",\n    description: [\n      \"As-Samad means Allah is the One we turn to for every need.\",\n      \"He does not depend on anyone, but everyone depends on Him.\",\n      \"He is always ready to listen, help, and provide.\",\n      \"When life feels hard, call on As-Samad and trust He will answer.\"\n    ],\n    reflection: \"What do you need from Allah right now?\",\n    quizId: \"as_samad_quiz\"\n  },\n  {\n    id: 71,\n    title: \"Al-Qaadir\",\n    arabic: \"ÿßŸÑŸíŸÇŸéÿßÿØŸêÿ±\",\n    meaning: \"The Able\",\n    description: [\n      \"Al-Qaadir means Allah has full power to do whatever He wills.\",\n      \"Nothing is too easy or too hard for Him.\",\n      \"He can change any situation in a moment.\",\n      \"We should ask Him for anything, because His power has no limit.\"\n    ],\n    reflection: \"What big thing do you need Allah‚Äôs help with?\",\n    quizId: \"al_qaadir_quiz\"\n  },\n  {\n    id: 72,\n    title: \"Al-Muqtadir\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÇŸíÿ™ŸéÿØŸêÿ±\",\n    meaning: \"The All-Powerful\",\n    description: [\n      \"Al-Muqtadir means Allah‚Äôs power controls every part of creation.\",\n      \"He arranges everything with strength, wisdom, and care.\",\n      \"He gives and takes, raises and lowers, as He wills.\",\n      \"Knowing Al-Muqtadir helps us feel safe in Allah‚Äôs perfect plan.\"\n    ],\n    reflection: \"How can you show trust in Allah‚Äôs power this week?\",\n    quizId: \"al_muqtadir_quiz\"\n  },\n  {\n    id: 73,\n    title: \"Al-Muqaddim\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÇŸéÿØŸêŸëŸÖ\",\n    meaning: \"The One Who Brings Forward\",\n    description: [\n      \"Al-Muqaddim means Allah brings things forward at the perfect time.\",\n      \"He gives honour, chances, and success to those He chooses.\",\n      \"He advances His servants through faith, patience, and good deeds.\",\n      \"This reminds us that no one can come forward unless Allah allows it.\"\n    ],\n    reflection: \"What can you do today to move forward closer to Allah?\",\n    quizId: \"al_muqaddim_quiz\"\n  },\n  {\n    id: 74,\n    title: \"Al-Mu‚Äôakhkhir\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ§ŸéÿÆŸêŸëÿ±\",\n    meaning: \"The One Who Delays\",\n    description: [\n      \"Al-Mu‚Äôakhkhir means Allah delays things for wise reasons.\",\n      \"Sometimes He holds back a blessing or answer so we grow in patience.\",\n      \"He never forgets ‚Äî His timing is always perfect.\",\n      \"Trust that every delay has goodness hidden in it.\"\n    ],\n    reflection: \"What delayed thing in your life can you now see was for your good?\",\n    quizId: \"al_muakhkhir_quiz\"\n  },\n  {\n    id: 75,\n    title: \"Al-Awwal\",\n    arabic: \"ÿßŸÑŸíÿ£ŸéŸàŸéŸëŸÑ\",\n    meaning: \"The First\",\n    description: [\n      \"Al-Awwal means Allah existed before everything else.\",\n      \"Nothing came before Him; He was always there and will always be.\",\n      \"All creation began by His command.\",\n      \"When we remember Al-Awwal, we know our lives start and end with Allah.\"\n    ],\n    reflection: \"How can you begin your day by remembering Al-Awwal?\",\n    quizId: \"al_awwal_quiz\"\n  },\n  {\n    id: 76,\n    title: \"Al-Aakhir\",\n    arabic: \"ÿßŸÑŸíÿ¢ÿÆŸêÿ±\",\n    meaning: \"The Last\",\n    description: [\n      \"Al-Aakhir means Allah will remain after everything ends.\",\n      \"Everything else will pass away, but Allah will always exist.\",\n      \"He is the final goal of every heart that seeks truth.\",\n      \"Remembering Al-Aakhir helps us focus on what really lasts ‚Äî the Hereafter.\"\n    ],\n    reflection: \"What lasting good deed can you do today for Allah‚Äôs sake?\",\n    quizId: \"al_aakhir_quiz\"\n  },\n  {\n    id: 77,\n    title: \"Az-Zaahir\",\n    arabic: \"ÿßŸÑÿ∏ŸéŸëÿßŸáŸêÿ±\",\n    meaning: \"The Most High and Apparent\",\n    description: [\n      \"Az-Zaahir means Allah‚Äôs power and signs are clear in everything around us.\",\n      \"His greatness is visible in the sun, stars, and every part of creation.\",\n      \"Nothing is above Him or outside His knowledge.\",\n      \"Seeing His signs makes our faith stronger and hearts more thankful.\"\n    ],\n    reflection: \"What‚Äôs one sign of Allah‚Äôs greatness you can see today?\",\n    quizId: \"az_zaahir_quiz\"\n  },\n  {\n    id: 78,\n    title: \"Al-Baatin\",\n    arabic: \"ÿßŸÑŸíÿ®Ÿéÿßÿ∑ŸêŸÜ\",\n    meaning: \"The Hidden and Near\",\n    description: [\n      \"Al-Baatin means Allah is close and knows what is hidden inside us.\",\n      \"He is near to our hearts even if we cannot see Him.\",\n      \"He helps us secretly in ways we may not notice.\",\n      \"This reminds us to keep our hearts pure, since Allah sees within.\"\n    ],\n    reflection: \"How can you make your heart more sincere today?\",\n    quizId: \"al_baatin_quiz\"\n  },\n  {\n    id: 79,\n    title: \"Al-Waali\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿßŸÑŸêŸä\",\n    meaning: \"The Governor\",\n    description: [\n      \"Al-Waali means Allah manages and takes care of all affairs.\",\n      \"He organises everything in the universe perfectly.\",\n      \"Nothing happens without His will and plan.\",\n      \"Knowing Al-Waali helps us trust that Allah is taking care of our lives.\"\n    ],\n    reflection: \"What worry can you leave in Allah‚Äôs care today?\",\n    quizId: \"al_waali_quiz\"\n  },\n  {\n    id: 80,\n    title: \"Al-Muta øaali\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ™ŸéÿπŸéÿßŸÑŸêŸä\",\n    meaning: \"The Supremely Exalted\",\n    description: [\n      \"Al-Muta øaali means Allah is far above any imperfection or weakness.\",\n      \"He is higher than anything we can imagine or describe.\",\n      \"His greatness cannot be compared to anyone or anything.\",\n      \"Remembering this keeps our hearts full of awe and respect.\"\n    ],\n    reflection: \"How can you show respect for Allah‚Äôs greatness?\",\n    quizId: \"al_mutaali_quiz\"\n  },\n  {\n    id: 81,\n    title: \"Al-Barr\",\n    arabic: \"ÿßŸÑŸíÿ®Ÿéÿ±Ÿë\",\n    meaning: \"The Most Kind and Good\",\n    description: [\n      \"Al-Barr means Allah is kind and gentle with His servants.\",\n      \"He gives us blessings even when we forget to thank Him.\",\n      \"He forgives us, feeds us, and covers our mistakes with mercy.\",\n      \"This Name reminds us to be kind and generous like Allah is.\"\n    ],\n    reflection: \"What kind thing can you do today for someone else?\",\n    quizId: \"al_barr_quiz\"\n  },\n  {\n    id: 82,\n    title: \"At-Tawwaab\",\n    arabic: \"ÿßŸÑÿ™ŸéŸëŸàŸéŸëÿßÿ®\",\n    meaning: \"The Accepter of Repentance\",\n    description: [\n      \"At-Tawwaab means Allah welcomes those who turn back to Him after mistakes.\",\n      \"He loves when we repent sincerely, no matter how many times we fail.\",\n      \"He turns our sins into good deeds when our hearts truly change.\",\n      \"Repenting brings us closer to Allah and fills us with peace.\"\n    ],\n    reflection: \"What do you want to repent to Allah for today?\",\n    quizId: \"at_tawwaab_quiz\"\n  },\n  {\n    id: 83,\n    title: \"Al-Muntaqim\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÜŸíÿ™ŸéŸÇŸêŸÖ\",\n    meaning: \"The Avenger\",\n    description: [\n      \"Al-Muntaqim means Allah gives justice to the wronged and punishes the oppressors.\",\n      \"He delays punishment sometimes to give chances for repentance.\",\n      \"His justice is always fair and based on full knowledge.\",\n      \"This Name helps us forgive others and trust Allah‚Äôs judgement instead of seeking revenge.\"\n    ],\n    reflection: \"How can you let go of anger and trust Allah‚Äôs justice?\",\n    quizId: \"al_muntaqim_quiz\"\n  },\n  {\n    id: 84,\n    title: \"Al- øAfuww\",\n    arabic: \"ÿßŸÑŸíÿπŸéŸÅŸèŸàŸë\",\n    meaning: \"The Pardoner\",\n    description: [\n      \"Al- øAfuww means Allah erases sins completely when we repent.\",\n      \"He doesn‚Äôt just forgive ‚Äî He removes all trace of the sin as if it never happened.\",\n      \"He loves to pardon, especially when we forgive others too.\",\n      \"This Name reminds us to be soft-hearted and let go of grudges.\"\n    ],\n    reflection: \"Who can you forgive completely today?\",\n    quizId: \"al_afuww_quiz\"\n  },\n  {\n    id: 85,\n    title: \"Ar-Ra‚Äôoof\",\n    arabic: \"ÿßŸÑÿ±ŸéŸëÿ§ŸèŸàŸÅ\",\n    meaning: \"The Most Compassionate\",\n    description: [\n      \"Ar-Ra‚Äôoof means Allah is very kind and gentle with His servants.\",\n      \"His compassion reaches us in every blessing, comfort, and act of mercy.\",\n      \"Even when we disobey, He still gives us chances to come back.\",\n      \"This reminds us to treat others with care and gentleness too.\"\n    ],\n    reflection: \"How can you show more kindness like Allah today?\",\n    quizId: \"ar_raoof_quiz\"\n  },\n  {\n    id: 86,\n    title: \"Maalik-ul-Mulk\",\n    arabic: \"ŸÖŸéÿßŸÑŸêŸÉŸè ÿßŸÑŸíŸÖŸèŸÑŸíŸÉ\",\n    meaning: \"Owner of All Dominion\",\n    description: [\n      \"Maalik-ul-Mulk means Allah owns everything in existence.\",\n      \"He gives and takes power, wealth, and honour to whom He wills.\",\n      \"He rules all creation perfectly and with wisdom.\",\n      \"Knowing this helps us stay humble and grateful for what we have.\"\n    ],\n    reflection: \"How can you show gratitude to Allah, the true Owner of all things?\",\n    quizId: \"maalik_ul_mulk_quiz\"\n  },\n  {\n    id: 87,\n    title: \"Dhul-Jalaali wal-Ikraam\",\n    arabic: \"ÿ∞ŸèŸà ÿßŸÑŸíÿ¨ŸéŸÑŸéÿßŸÑŸê ŸàŸéÿßŸÑŸíÿ•ŸêŸÉŸíÿ±ŸéÿßŸÖ\",\n    meaning: \"Lord of Majesty and Honour\",\n    description: [\n      \"Dhul-Jalaali wal-Ikraam means Allah is full of majesty, power, and generosity.\",\n      \"He deserves our deepest respect and love.\",\n      \"His greatness and kindness are beyond our imagination.\",\n      \"We glorify Him in prayer and thank Him for His endless mercy.\"\n    ],\n    reflection: \"How can you honour Allah in your daily actions?\",\n    quizId: \"dhul_jalaali_wal_ikraam_quiz\"\n  },\n  {\n    id: 88,\n    title: \"Al-Muqsit\",\n    arabic: \"ÿßŸÑŸíŸÖŸèŸÇŸíÿ≥Ÿêÿ∑\",\n    meaning: \"The Just and Fair\",\n    description: [\n      \"Al-Muqsit means Allah treats everyone with complete fairness.\",\n      \"He gives everyone what they deserve, perfectly balanced.\",\n      \"He never wrongs anyone and rewards every bit of good we do.\",\n      \"We should try to be fair and never take more than our share.\"\n    ],\n    reflection: \"When can you be more fair or honest today?\",\n    quizId: \"al_muqsit_quiz\"\n  },\n  {\n    id: 89,\n    title: \"Al-Jaami ø\",\n    arabic: \"ÿßŸÑŸíÿ¨ŸéÿßŸÖŸêÿπ\",\n    meaning: \"The Gatherer\",\n    description: [\n      \"Al-Jaami ø means Allah gathers people, hearts, and events together for a purpose.\",\n      \"He will gather everyone on the Day of Judgement with perfect justice.\",\n      \"He brings friends, families, and believers together out of His mercy.\",\n      \"This Name reminds us that Allah unites us through faith.\"\n    ],\n    reflection: \"Who can you bring closer together for Allah‚Äôs sake?\",\n    quizId: \"al_jaami_quiz\"\n  },\n  {\n    id: 90,\n    title: \"Al-Ghaniyy\",\n    arabic: \"ÿßŸÑŸíÿ∫ŸéŸÜŸêŸäŸë\",\n    meaning: \"The Self-Sufficient\",\n    description: [\n      \"Al-Ghaniyy means Allah needs nothing from anyone.\",\n      \"He is perfect and complete, while we depend on Him for everything.\",\n      \"He gives freely without losing anything Himself.\",\n      \"This reminds us to depend on Allah, not people or things.\"\n    ],\n    reflection: \"What can you thank Allah for giving you even though He needs nothing?\",\n    quizId: \"al_ghaniyy_quiz\"\n  },\n  {\n    id: 91,\n    title: \"Al-Mughni\",\n    arabic: \"ÿßŸÑŸíŸÖŸèÿ∫ŸíŸÜŸêŸä\",\n    meaning: \"The Enricher\",\n    description: [\n      \"Al-Mughni means Allah gives wealth, knowledge, and contentment to whom He wills.\",\n      \"He can make a poor person rich in heart or body with ease.\",\n      \"True richness is being happy with what Allah gives.\",\n      \"We should ask Allah to make us rich in faith and good deeds.\"\n    ],\n    reflection: \"What makes you feel truly rich inside?\",\n    quizId: \"al_mughni_quiz\"\n  },\n  {\n    id: 92,\n    title: \"Al-Maani ø\",\n    arabic: \"ÿßŸÑŸíŸÖŸéÿßŸÜŸêÿπ\",\n    meaning: \"The Preventer\",\n    description: [\n      \"Al-Maani ø means Allah protects us by stopping harm or wrong things from happening.\",\n      \"Sometimes we don‚Äôt get what we want because Allah is saving us from it.\",\n      \"He blocks evil and guides us toward what is best.\",\n      \"Be grateful even when things don‚Äôt go your way ‚Äî Allah knows why.\"\n    ],\n    reflection: \"What disappointment might have been Allah‚Äôs protection?\",\n    quizId: \"al_maani_quiz\"\n  },\n  {\n    id: 93,\n    title: \"Ad-Daarr\",\n    arabic: \"ÿßŸÑÿ∂ŸéŸëÿßÿ±Ÿë\",\n    meaning: \"The Bringer of Harm\",\n    description: [\n      \"Ad-Daarr means Allah allows harm or hardship only for a wise reason.\",\n      \"Every pain or test teaches us patience and makes us stronger.\",\n      \"He never harms without mercy or justice.\",\n      \"We should be patient, knowing Allah brings good from every trial.\"\n    ],\n    reflection: \"How have your hard times brought you closer to Allah?\",\n    quizId: \"ad_daarr_quiz\"\n  },\n  {\n    id: 94,\n    title: \"An-Naafi ø\",\n    arabic: \"ÿßŸÑŸÜŸéŸëÿßŸÅŸêÿπ\",\n    meaning: \"The Giver of Benefit\",\n    description: [\n      \"An-Naafi ø means Allah gives all goodness and benefit to His creation.\",\n      \"Every cure, success, and blessing comes only from Him.\",\n      \"He helps His servants in ways they don‚Äôt expect.\",\n      \"We should always ask Him for benefit and protection from harm.\"\n    ],\n    reflection: \"What good thing has Allah brought into your life recently?\",\n    quizId: \"an_naafi_quiz\"\n  },\n  {\n    id: 95,\n    title: \"An-Noor\",\n    arabic: \"ÿßŸÑŸÜŸèŸëŸàÿ±\",\n    meaning: \"The Light\",\n    description: [\n      \"An-Noor means Allah is the light of the heavens and the earth.\",\n      \"He guides people from darkness to truth and gives light to hearts.\",\n      \"His light shows in the Qur‚Äôan, in knowledge, and in goodness.\",\n      \"Ask Allah to fill your life and heart with His light.\"\n    ],\n    reflection: \"How can you bring Allah‚Äôs light into someone‚Äôs day?\",\n    quizId: \"an_noor_quiz\"\n  },\n  {\n    id: 96,\n    title: \"Al-Haadi\",\n    arabic: \"ÿßŸÑŸíŸáŸéÿßÿØŸêŸä\",\n    meaning: \"The Guide\",\n    description: [\n      \"Al-Haadi means Allah guides people to truth and the straight path.\",\n      \"He teaches us through the Qur‚Äôan, the Prophet Ô∑∫, and signs in creation.\",\n      \"He opens the hearts of those who seek His guidance.\",\n      \"We should always ask Al-Haadi to keep us firm on the right path.\"\n    ],\n    reflection: \"What can you do to follow Allah‚Äôs guidance better today?\",\n    quizId: \"al_haadi_quiz\"\n  },\n  {\n    id: 97,\n    title: \"Al-Badee ø\",\n    arabic: \"ÿßŸÑŸíÿ®ŸéÿØŸêŸäÿπ\",\n    meaning: \"The Incomparable Creator\",\n    description: [\n      \"Al-Badee ø means Allah creates in new and perfect ways, unlike anyone else.\",\n      \"He made the universe without any example before it.\",\n      \"Every sunset, leaf, and soul shows His unique creativity.\",\n      \"This Name inspires us to appreciate beauty and think deeply about His creation.\"\n    ],\n    reflection: \"What part of nature reminds you of Allah‚Äôs creativity?\",\n    quizId: \"al_badee_quiz\"\n  },\n  {\n    id: 98,\n    title: \"Al-Baaqi\",\n    arabic: \"ÿßŸÑŸíÿ®ŸéÿßŸÇŸêŸä\",\n    meaning: \"The Everlasting\",\n    description: [\n      \"Al-Baaqi means Allah will never end or fade away.\",\n      \"Everything else in life passes, but Allah remains forever.\",\n      \"This helps us remember to focus on actions that last into the Hereafter.\",\n      \"Say 'Laa ilaaha illa Allah' ‚Äî the lasting words that lead to Jannah.\"\n    ],\n    reflection: \"What good deeds can you do that will last forever?\",\n    quizId: \"al_baaqi_quiz\"\n  },\n  {\n    id: 99,\n    title: \"Al-Waarith\",\n    arabic: \"ÿßŸÑŸíŸàŸéÿßÿ±Ÿêÿ´\",\n    meaning: \"The Inheritor\",\n    description: [\n      \"Al-Waarith means Allah remains after everyone and everything passes away.\",\n      \"He inherits the earth and all that was ever owned.\",\n      \"He gives and takes as He wills, but He never loses anything.\",\n      \"We should live as caretakers, not owners, using blessings wisely.\"\n    ],\n    reflection: \"How can you use what you have in ways that please Allah?\",\n    quizId: \"al_waarith_quiz\"\n  },\n  {\n    id: 100,\n    title: \"Ad-Dayyan\",\n    arabic: \"ÿßŸÑÿØŸäŸëÿßŸÜ\",\n    meaning: \"The Recompenser / The Supreme Judge\",\n    description: [\n      \"Ad-Dayyan is an Islamic name for Allah, meaning 'The Recompenser' or 'The Supreme Judge'. It refers to His role as the ultimate judge who will reward or punish people for their deeds, based on perfect justice.\",\n      \"The name has not appeared in the Qur'an but is mentioned in the Sunnah (sayings and actions of the Prophet Muhammad Ô∑∫).\",\n      \"Allah is the one who will perfectly recompense His servants on the Day of Judgement‚Äîrewarding good deeds and punishing bad ones, or pardoning them according to His will.\",\n      \"This name embodies His perfect justice, meaning He will reward good deeds and punish bad ones according to His will with fairness and wisdom.\"\n    ],\n    reflection: \"How does knowing Allah is Ad-Dayyan inspire you to be more just and accountable in your actions?\",\n    quizId: \"ad_dayyan_quiz\"\n  },\n  {\n    id: 101,\n    title: \"As-Saboor\",\n    arabic: \"ÿßŸÑÿµŸéŸëÿ®ŸèŸàÿ±\",\n    meaning: \"The Patient\",\n    description: [\n      \"As-Saboor means Allah is never in a hurry and gives everyone time to change.\",\n      \"He delays punishment out of mercy and loves those who are patient.\",\n      \"He teaches us to wait calmly for what is best.\",\n      \"Patience shows trust in Allah‚Äôs plan and timing.\"\n    ],\n    reflection: \"What can you be more patient about today?\",\n    quizId: \"as_saboor_quiz\"\n  },\n  {\n    id: 102,\n    title: \"Al-Jaabir\",\n    arabic: \"ÿßŸÑŸíÿ¨Ÿéÿßÿ®Ÿêÿ±\",\n    meaning: \"The Restorer of the Broken\",\n    description: [\n      \"Al-Jaabir means Allah heals hearts and mends what is broken.\",\n      \"He fixes sadness, pain, and loss with His care and love.\",\n      \"He helps those who are hurt find peace again.\",\n      \"When you feel broken, call upon Al-Jaabir ‚Äî He will make you whole.\"\n    ],\n    reflection: \"Whose heart can you help heal today?\",\n    quizId: \"al_jaabir_quiz\"\n  },\n  {\n    id: 103,\n    title: \"Al-Qaadir-ul-Muqtadir\",\n    arabic: \"ÿßŸÑŸíŸÇŸéÿßÿØŸêÿ±Ÿè ÿßŸÑŸíŸÖŸèŸÇŸíÿ™ŸéÿØŸêÿ±\",\n    meaning: \"The All-Powerful, Perfect in Ability\",\n    description: [\n      \"This combined Name shows Allah‚Äôs total control and perfect strength.\",\n      \"He plans, creates, and manages everything with wisdom and ease.\",\n      \"He is never tired or unsure ‚Äî His power is complete.\",\n      \"This reminds us to rely on Allah alone for strength and success.\"\n    ],\n    reflection: \"What situation do you need Allah‚Äôs power to handle?\",\n    quizId: \"al_qaadir_muqtadir_quiz\"\n  },\n  {\n    id: 104,\n    title: \"Al-Mannaan\",\n    arabic: \"ÿßŸÑŸíŸÖŸéŸÜŸéŸëÿßŸÜ\",\n    meaning: \"The Bestower of Favours\",\n    description: [\n      \"Al-Mannaan means Allah gives endless blessings and gifts without being asked.\",\n      \"Every breath, every smile, and every chance to worship is from Him.\",\n      \"He gives without expecting anything back, only our gratitude and obedience.\",\n      \"This reminds us to always say 'Alhamdulillah' for His many favours.\"\n    ],\n    reflection: \"What is one blessing from Allah you‚Äôre thankful for right now?\",\n    quizId: \"al_mannaan_quiz\"\n  }\n  ];\n\n  export default namesOfAllahLessonsFull;","path":null,"size_bytes":55184,"size_tokens":null},"src/data/lessons/wivesLessons.js":{"content":"// Wives of the Prophet Ô∑∫ Learning Path\n// 13 lessons about the Mothers of the Believers\n// Each lesson: 3 paragraphs (18-28 words each), authentic hadith evidence, key lesson\n// Sources: Sahih Bukhari and Sahih Muslim only\n\nconst wivesLessons = [\n  {\n    id: 1,\n    title: \"Khadijah bint Khuwaylid - Part 1\",\n    description: [\n      \"Khadijah was a wealthy businesswoman known for wisdom and honor. She hired Muhammad Ô∑∫ for his trustworthiness. Their marriage began after successful trade journeys together.\",\n      \"She became the first believer when revelation came to Muhammad Ô∑∫. Khadijah comforted and reassured him of Allah's protection during difficult early persecution years.\",\n      \"All the Prophet's Ô∑∫ children except Ibrahim were born to Khadijah. He never forgot her devotion and praised her throughout his life, even after her death.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸéŸäŸíÿ±Ÿè ŸÜŸêÿ≥Ÿéÿßÿ¶ŸêŸáŸéÿß ŸÖŸéÿ±ŸíŸäŸéŸÖŸèÿå ŸàŸéÿÆŸéŸäŸíÿ±Ÿè ŸÜŸêÿ≥Ÿéÿßÿ¶ŸêŸáŸéÿß ÿÆŸéÿØŸêŸäÿ¨Ÿéÿ©Ÿè\",\n      translation: \"The best of women is Maryam, and the best of women is Khadijah.\",\n      source: \"Sahih Bukhari 3815\"\n    },\n    keyLesson: \"Khadijah's unwavering support during Islam's earliest days made her a pillar of faith and strength.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Khadijah bint Khuwaylid - Part 2\",\n    description: [\n      \"The Prophet Ô∑∫ showed tremendous loyalty to Khadijah after her death. He sent meat to her friends and praised her constantly, explaining her unique virtues to others.\",\n      \"During the Year of Sorrow, Khadijah and Abu Talib both died. The Prophet Ô∑∫ grieved deeply, losing his beloved wife and his protective uncle in the same year.\",\n      \"Allah sent greetings to Khadijah through Angel Jibra'il. The angel gave her glad tidings of a palace in Paradise made of pearls, showing her elevated status.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸêŸëŸä ŸÇŸéÿØŸí ÿ±Ÿèÿ≤ŸêŸÇŸíÿ™Ÿè ÿ≠Ÿèÿ®ŸéŸëŸáŸéÿß\",\n      translation: \"I have been granted her love.\",\n      source: \"Sahih Muslim 2435\"\n    },\n    keyLesson: \"The Prophet's Ô∑∫ enduring loyalty to Khadijah teaches us to honor and remember those who supported us.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Sawdah bint Zam'ah\",\n    description: [\n      \"Sawdah was among early Muslims who migrated to Abyssinia. After Khadijah died, the Prophet Ô∑∫ married her. She helped care for his young daughters during this difficult time.\",\n      \"Sawdah was generous and cheerful, often making the Prophet Ô∑∫ laugh. When she grew older, she gave her scheduled night to Aishah to remain his wife.\",\n      \"Her sacrifice showed wisdom and selflessness. She preferred staying married to the Prophet Ô∑∫ over worldly concerns, continuing as a Mother of Believers until her death.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸáŸéÿ®Ÿéÿ™Ÿí ÿ≥ŸéŸàŸíÿØŸéÿ©Ÿè ŸäŸéŸàŸíŸÖŸéŸáŸéÿß ŸÑŸêÿπŸéÿßÿ¶Ÿêÿ¥Ÿéÿ©Ÿé\",\n      translation: \"Sawdah gave her day to Aishah.\",\n      source: \"Sahih Bukhari 5212\"\n    },\n    keyLesson: \"Sawdah's generosity and selflessness teach us to prioritize spiritual rewards over worldly desires.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Aishah bint Abu Bakr - Part 1\",\n    description: [\n      \"Aishah was Abu Bakr's daughter and became the Prophet's Ô∑∫ most beloved wife. The Prophet Ô∑∫ received more revelation in her company than with any other wife.\",\n      \"She was extremely intelligent with remarkable memory. Aishah memorized the Quran and understood it deeply. Senior companions came to her to learn Islamic rulings and hadith.\",\n      \"Aishah and the Prophet Ô∑∫ loved each other deeply. He would race with her and show affection. When asked whom he loved most, he said Aishah.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ∂ŸíŸÑŸè ÿπŸéÿßÿ¶Ÿêÿ¥Ÿéÿ©Ÿé ÿπŸéŸÑŸéŸâ ÿßŸÑŸÜŸêŸëÿ≥Ÿéÿßÿ°Ÿê ŸÉŸéŸÅŸéÿ∂ŸíŸÑŸê ÿßŸÑÿ´ŸéŸëÿ±ŸêŸäÿØŸê ÿπŸéŸÑŸéŸâ ÿ≥Ÿéÿßÿ¶Ÿêÿ±Ÿê ÿßŸÑÿ∑ŸéŸëÿπŸéÿßŸÖŸê\",\n      translation: \"The superiority of Aishah over other women is like the superiority of Tharid over other foods.\",\n      source: \"Sahih Bukhari 3770\"\n    },\n    keyLesson: \"Aishah's exceptional knowledge and closeness to the Prophet Ô∑∫ made her a primary source of Islamic teachings.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Aishah bint Abu Bakr - Part 2\",\n    description: [\n      \"Aishah narrated over two thousand hadiths, teaching companions and the next generation. Her house became a center of learning where students studied Islam from her.\",\n      \"False accusations were spread against Aishah during the incident of Ifk. Allah revealed Quranic verses declaring her innocence, establishing her purity and warning against slander forever.\",\n      \"Angel Jibra'il sent greetings to Aishah through the Prophet Ô∑∫. The Prophet Ô∑∫ passed away in her home, resting in her lap, on her appointed day.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸèÿ∞ŸèŸàÿß ÿ¥Ÿéÿ∑Ÿíÿ±Ÿé ÿØŸêŸäŸÜŸêŸÉŸèŸÖŸí ÿπŸéŸÜŸí ŸáŸéÿ∞ŸêŸáŸê ÿßŸÑŸíÿ≠ŸèŸÖŸéŸäŸíÿ±Ÿéÿßÿ°Ÿê\",\n      translation: \"Take half of your religion from this Humayra (Aishah).\",\n      source: \"Sahih Muslim 2431\"\n    },\n    keyLesson: \"Aishah's vast knowledge and teaching preserved half of our religious understanding for all future generations.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Hafsah bint Umar\",\n    description: [\n      \"Hafsah was Umar ibn al-Khattab's daughter. Her first husband died, leaving her widowed. The Prophet Ô∑∫ married her, strengthening his bond with Umar and honoring her.\",\n      \"Hafsah was known for piety and worship. She frequently fasted and prayed at night. Like Aishah, she was intelligent and learned much from the Prophet Ô∑∫.\",\n      \"After Abu Bakr compiled the Quran, Hafsah safeguarded the original manuscript. Her trustworthiness made her guardian of Islam's most precious written treasure until her death.\"\n    ],\n    evidence: {\n      arabic: \"ŸÉŸéÿßŸÜŸéÿ™Ÿí ÿ≠ŸéŸÅŸíÿµŸéÿ©Ÿè ÿµŸéŸàŸéŸëÿßŸÖŸéÿ©Ÿã ŸÇŸéŸàŸéŸëÿßŸÖŸéÿ©Ÿã\",\n      translation: \"Hafsah used to observe fasting and stand in prayer at night.\",\n      source: \"Sahih Muslim 1479\"\n    },\n    keyLesson: \"Hafsah's trustworthiness and piety made her the guardian of the Quran's original written manuscript.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Zaynab bint Khuzaymah\",\n    description: [\n      \"Zaynab was known as Umm al-Masakin, Mother of the Poor. She dedicated her life to helping the needy and feeding the hungry throughout Arabia.\",\n      \"Her husband was killed at the Battle of Uhud. The Prophet Ô∑∫ married her to honor her sacrifice. She continued her charitable work caring for the poor.\",\n      \"Zaynab lived only eight months after marrying the Prophet Ô∑∫ before passing away. Her legacy of generosity and kindness remained an example. She is buried in Madinah.\"\n    ],\n    evidence: {\n      arabic: \"ÿ™ŸèÿµŸéÿØŸêŸëŸÇŸè ÿ®ŸêŸÉŸèŸÑŸêŸë ŸÖŸéÿß ÿπŸêŸÜŸíÿØŸéŸáŸéÿß\",\n      translation: \"She would give away in charity everything she had.\",\n      source: \"Sahih Muslim 1029\"\n    },\n    keyLesson: \"Zaynab's dedication to serving the poor shows that charity and compassion are marks of true faith.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Umm Salamah\",\n    description: [\n      \"Umm Salamah, named Hind bint Abi Umayyah, was among the earliest Muslims. She migrated to Abyssinia, then Madinah, enduring great hardships. Her husband was martyred at Uhud.\",\n      \"After her waiting period, the Prophet Ô∑∫ proposed marriage. He married her and brought her children into his household, treating them with great kindness and care.\",\n      \"Umm Salamah was wise and eloquent. The Prophet Ô∑∫ consulted her during the Treaty of Hudaybiyyah. Her advice resolved the tense situation among the reluctant companions.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÅŸíÿ∂ŸéŸÑŸè ŸÖŸéÿß ŸäŸèŸÇŸéÿßŸÑŸè ÿπŸêŸÜŸíÿØŸé ÿßŸÑŸíŸÖŸèÿµŸêŸäÿ®Ÿéÿ©Ÿê: ÿ•ŸêŸÜŸéŸëÿß ŸÑŸêŸÑŸéŸëŸáŸê ŸàŸéÿ•ŸêŸÜŸéŸëÿß ÿ•ŸêŸÑŸéŸäŸíŸáŸê ÿ±Ÿéÿßÿ¨ŸêÿπŸèŸàŸÜŸéÿå ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ£Ÿíÿ¨Ÿèÿ±ŸíŸÜŸêŸä ŸÅŸêŸä ŸÖŸèÿµŸêŸäÿ®Ÿéÿ™ŸêŸä ŸàŸéÿ£ŸéÿÆŸíŸÑŸêŸÅŸí ŸÑŸêŸä ÿÆŸéŸäŸíÿ±Ÿãÿß ŸÖŸêŸÜŸíŸáŸéÿß\",\n      translation: \"The best thing to say during calamity: Indeed we belong to Allah and to Him we shall return. O Allah, reward me in my affliction and replace it with something better.\",\n      source: \"Sahih Muslim 918\"\n    },\n    keyLesson: \"Umm Salamah's patience during hardship and wise counsel made her a source of guidance and blessing.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Zaynab bint Jahsh\",\n    description: [\n      \"Zaynab bint Jahsh was the Prophet's Ô∑∫ cousin. Allah arranged her marriage to him through divine revelation after her divorce. Quranic verses abolished pre-Islamic adoption practices.\",\n      \"Zaynab was pious, generous, and skilled in leather crafts. She earned money through her skills and gave everything away in charity, more than all other wives.\",\n      \"The Prophet Ô∑∫ told his wives the longest hand would join him first in death. Zaynab died first, fulfilling this prophecy through her unmatched generosity and charitable giving.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿéÿ∑ŸíŸàŸéŸÑŸèŸÉŸèŸÜŸéŸë ŸäŸéÿØŸãÿß\",\n      translation: \"The one among you with the longest hand.\",\n      source: \"Sahih Muslim 2452\"\n    },\n    keyLesson: \"Zaynab's generosity and devotion to charity showed that giving to others brings us closer to Allah.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Juwayriyyah bint al-Harith\",\n    description: [\n      \"Juwayriyyah was chief al-Harith's daughter. After her tribe's defeat in battle, she became a captive. The Prophet Ô∑∫ offered to pay her freedom and marry her.\",\n      \"When the Prophet Ô∑∫ married Juwayriyyah, Muslims released all captives from her tribe out of respect. This kindness led the entire Banu Mustaliq tribe to embrace Islam.\",\n      \"Juwayriyyah was devoted to worship and remembrance. The Prophet Ô∑∫ found her praying from Fajr until mid-morning. He taught her powerful dhikr equaling her worship hours.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸáŸê ÿπŸéÿØŸéÿØŸé ÿÆŸéŸÑŸíŸÇŸêŸáŸêÿå ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸáŸê ÿ±Ÿêÿ∂Ÿéÿß ŸÜŸéŸÅŸíÿ≥ŸêŸáŸêÿå ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸáŸê ÿ≤ŸêŸÜŸéÿ©Ÿé ÿπŸéÿ±Ÿíÿ¥ŸêŸáŸêÿå ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸáŸê ŸÖŸêÿØŸéÿßÿØŸé ŸÉŸéŸÑŸêŸÖŸéÿßÿ™ŸêŸáŸê\",\n      translation: \"Glory be to Allah equal to the number of His creation, His pleasure, the weight of His Throne, and the ink of His words.\",\n      source: \"Sahih Muslim 2726\"\n    },\n    keyLesson: \"Juwayriyyah's marriage brought an entire tribe to Islam, showing how Allah uses marriages for spreading guidance.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Safiyyah bint Huyayy\",\n    description: [\n      \"Safiyyah descended from Prophet Harun and belonged to the Jewish Banu Nadir tribe. After Khaybar's conquest, the Prophet Ô∑∫ freed her and offered her Islam and marriage.\",\n      \"She chose Islam and married the Prophet Ô∑∫. When companions questioned her background, the Prophet Ô∑∫ defended her honor, reminding her she descends from Prophets.\",\n      \"Safiyyah was noble, dignified, and patient when facing insults. The Prophet Ô∑∫ treated her with kindness. Her marriage showed Islam transcends race and previous faith.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿ£Ÿéÿ®ŸêŸä ŸáŸéÿßÿ±ŸèŸàŸÜŸè ŸàŸéÿ•ŸêŸÜŸéŸë ÿπŸéŸÖŸêŸëŸä ŸÖŸèŸàÿ≥ŸéŸâ\",\n      translation: \"Indeed my father is Harun and my uncle is Musa.\",\n      source: \"Sahih Bukhari 3984\"\n    },\n    keyLesson: \"Safiyyah's noble lineage and graceful patience teach us that honor comes from faith and character.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Umm Habibah\",\n    description: [\n      \"Umm Habibah, named Ramlah bint Abi Sufyan, was Islam's fiercest enemy's daughter. She migrated to Abyssinia where her husband left Islam, but she remained steadfast.\",\n      \"Alone in a foreign land with her daughter, she maintained faith with remarkable strength. The Prophet Ô∑∫ sent a marriage proposal through the Negus of Abyssinia.\",\n      \"Her marriage occurred while Abu Sufyan still opposed Islam. Umm Habibah's unwavering faith despite family pressure exemplified true commitment. She remained devoted to worship throughout life.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ÿµŸéŸÑŸéŸëŸâ ÿßÿ´ŸíŸÜŸéÿ™ŸéŸäŸí ÿπŸéÿ¥Ÿíÿ±Ÿéÿ©Ÿé ÿ±ŸéŸÉŸíÿπŸéÿ©Ÿã ŸÅŸêŸä ŸäŸéŸàŸíŸÖŸç ŸàŸéŸÑŸéŸäŸíŸÑŸéÿ©Ÿç ÿ®ŸèŸÜŸêŸäŸé ŸÑŸéŸáŸè ÿ®ŸêŸáŸêŸÜŸéŸë ÿ®ŸéŸäŸíÿ™Ÿå ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"Whoever prays twelve rak'ahs in a day and night, a house will be built for them in Paradise.\",\n      source: \"Sahih Muslim 728\"\n    },\n    keyLesson: \"Umm Habibah's steadfastness in faith despite family opposition shows that truth must never be compromised.\",\n    quizId: 12\n  },\n\n  {\n    id: 13,\n    title: \"Maymunah bint al-Harith\",\n    description: [\n      \"Maymunah was the last wife the Prophet Ô∑∫ married. She offered herself in marriage, and Allah revealed a verse allowing this privilege. She was known for piety.\",\n      \"Maymunah was Khalid ibn al-Walid's maternal aunt and related to prominent companions. Her marriage strengthened ties between the Prophet Ô∑∫ and important Muslim families.\",\n      \"She was generous and dedicated to worship. Maymunah narrated many hadiths about the Prophet's Ô∑∫ private life. She lived many years after his death, teaching and narrating.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÖŸíÿ±Ÿéÿ£Ÿéÿ©Ÿã ŸÖŸèÿ§ŸíŸÖŸêŸÜŸéÿ©Ÿã ÿ•ŸêŸÜŸí ŸàŸéŸáŸéÿ®Ÿéÿ™Ÿí ŸÜŸéŸÅŸíÿ≥ŸéŸáŸéÿß ŸÑŸêŸÑŸÜŸéŸëÿ®ŸêŸäŸêŸë\",\n      translation: \"And a believing woman if she gives herself to the Prophet.\",\n      source: \"Qur'an 33:50\"\n    },\n    keyLesson: \"Maymunah's devotion and generosity in offering herself in marriage showed complete trust in Allah's plan.\",\n    quizId: 13\n  }\n];\n\nexport default wivesLessons;\n","path":null,"size_bytes":13732,"size_tokens":null},"src/data/lessons/tenPromisedLessons.js":{"content":"// Ten Companions Promised Jannah Learning Path\n// Based on authentic Islamic sources and Sahih hadith\n// 10 lessons covering each of the ten companions promised Paradise\n// Each lesson: 3 paragraphs (~23 words each), authentic evidence, Key Lesson\n// Sources: Qur'an, Sahih Bukhari, Sahih Muslim\n\nconst tenPromisedLessons = [\n  {\n    id: 1,\n    title: \"Abu Bakr as-Siddiq\",\n    description: [\n      \"Abu Bakr was the Prophet's Ô∑∫ closest companion and first adult man to accept Islam. He believed immediately, showing unwavering trust in Allah's message through hardships.\",\n      \"When the Prophet Ô∑∫ described his Night Journey, people mocked him. Abu Bakr believed instantly, earning the title 'As-Siddiq' meaning 'The Truthful One.' He freed enslaved Muslims.\",\n      \"As first Caliph, Abu Bakr united Muslims during crisis. He preserved the Quran and expanded Islam. The Prophet Ô∑∫ said Paradise yearns for Abu Bakr.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸä ÿ¨Ÿéÿßÿ°Ÿé ÿ®ŸêÿßŸÑÿµŸêŸëÿØŸíŸÇŸê ŸàŸéÿµŸéÿØŸéŸëŸÇŸé ÿ®ŸêŸáŸê\",\n      translation: \"And the one who brought the truth and believed in it.\",\n      source: \"Qur'an 39:33\"\n    },\n    keyLesson: \"True friendship means believing, supporting, and sacrificing everything for Allah and His messenger.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Umar ibn al-Khattab\",\n    description: [\n      \"Umar fiercely opposed Islam before accepting it. When he converted, Islam gained strength and Muslims could finally pray openly at the Ka'bah. His conversion transformed early Islam's fortunes.\",\n      \"As second Caliph, Umar expanded the Islamic state across three continents while living in poverty himself. He established justice systems that amazed enemies. Even Shaytan feared encountering him.\",\n      \"Umar wept when reciting Quran and held himself strictly accountable. Once hungry, he put pebbles in his mouth to forget hunger rather than use public funds for the poor.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸÜŸéŸëÿ®ŸêŸäŸèŸë ÿ≠Ÿéÿ≥Ÿíÿ®ŸèŸÉŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéŸÖŸéŸÜŸê ÿßÿ™ŸéŸëÿ®ŸéÿπŸéŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé\",\n      translation: \"O Prophet, sufficient for you is Allah and whoever follows you of the believers.\",\n      source: \"Qur'an 8:64\"\n    },\n    keyLesson: \"True leadership combines strength with justice, and power with humility before Allah.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Uthman ibn Affan\",\n    description: [\n      \"Uthman was known for his modesty, generosity, and shyness. He married two daughters of the Prophet Ô∑∫, earning the title 'Possessor of Two Lights.' Angels felt modest before him.\",\n      \"When Muslims faced hardship, Uthman bought a well and made it free for all Muslims forever. He equipped the entire Army of Hardship when others had nothing to give.\",\n      \"As third Caliph, Uthman compiled the Quran into one standardized text, preserving it perfectly for all generations. He was martyred while reading Quran, blood staining blessed pages.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ÿ¨ŸéŸáŸéŸëÿ≤Ÿé ÿ¨ŸéŸäŸíÿ¥Ÿé ÿßŸÑŸíÿπŸèÿ≥Ÿíÿ±Ÿéÿ©Ÿê ŸÅŸéŸÑŸéŸáŸè ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿè\",\n      translation: \"Whoever equips the Army of Hardship will have Paradise.\",\n      source: \"Sahih Bukhari 2778\"\n    },\n    keyLesson: \"Generosity for Allah's sake and modesty in character are marks of true nobility and faith.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Ali ibn Abi Talib\",\n    description: [\n      \"Ali was the Prophet's Ô∑∫ cousin and among the first children to accept Islam. He was raised in the Prophet's household and learned directly from him since childhood.\",\n      \"On the night of Hijrah when assassins surrounded the Prophet's house, Ali bravely slept in his bed. He risked his life so the Prophet Ô∑∫ could escape safely to Madinah.\",\n      \"The Prophet Ô∑∫ said Ali's position to him was like Harun to Musa. Ali married Fatimah and became fourth Caliph. His knowledge and bravery inspired all believers deeply.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÜÿ™Ÿé ŸÖŸêŸÜŸêŸëŸä ÿ®ŸêŸÖŸéŸÜŸíÿ≤ŸêŸÑŸéÿ©Ÿê ŸáŸéÿßÿ±ŸèŸàŸÜŸé ŸÖŸêŸÜŸí ŸÖŸèŸàÿ≥ŸéŸâ ÿ•ŸêŸÑÿßŸéŸë ÿ£ŸéŸÜŸéŸëŸáŸè ŸÑÿßŸé ŸÜŸéÿ®ŸêŸäŸéŸë ÿ®ŸéÿπŸíÿØŸêŸä\",\n      translation: \"You are to me like Harun was to Musa, except there will be no prophet after me.\",\n      source: \"Sahih Bukhari 4416\"\n    },\n    keyLesson: \"True courage means sacrificing yourself for Allah's cause and protecting those who carry His message.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Talhah ibn Ubaydullah\",\n    description: [\n      \"Talhah accepted Islam early through Abu Bakr's invitation and faced severe torture for his faith. Despite brutal persecution, he remained steadfast and never renounced Islam whatsoever.\",\n      \"At the Battle of Uhud, when enemies surrounded the Prophet Ô∑∫, Talhah used his body as a shield. He received over seventy wounds protecting the beloved Messenger of Allah.\",\n      \"The Prophet Ô∑∫ said, 'Paradise became obligatory for Talhah today.' Known for generosity, Talhah distributed his entire wealth to the poor, keeping nothing for himself despite riches.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸàŸíÿ¨Ÿéÿ®Ÿé ÿ∑ŸéŸÑŸíÿ≠Ÿéÿ©Ÿè\",\n      translation: \"Talhah has become deserving of Paradise.\",\n      source: \"Sahih Bukhari\"\n    },\n    keyLesson: \"Protecting others and sacrificing your comfort for Allah's sake guarantees eternal reward.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Zubayr ibn al-Awwam\",\n    description: [\n      \"Zubayr accepted Islam at age eight. His uncle tortured him by hanging him in smoke-filled mats, trying to force him to renounce Islam. Young Zubayr courageously refused every time.\",\n      \"The Prophet Ô∑∫ called Zubayr his disciple, saying every prophet has a disciple and Zubayr was his. At the Battle of Khandaq, Zubayr volunteered for the most dangerous mission.\",\n      \"Zubayr was the Prophet's cousin and married Asma, Abu Bakr's daughter. He combined physical courage with deep faith. His battlefield bravery was legendary throughout Arabia and beyond.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸêŸÉŸèŸÑŸêŸë ŸÜŸéÿ®ŸêŸäŸçŸë ÿ≠ŸéŸàŸéÿßÿ±ŸêŸäŸåŸë ŸàŸéÿ≠ŸéŸàŸéÿßÿ±ŸêŸäŸéŸë ÿßŸÑÿ≤ŸèŸëÿ®ŸéŸäŸíÿ±Ÿè\",\n      translation: \"Every prophet has a disciple, and my disciple is Zubayr.\",\n      source: \"Sahih Bukhari 3719\"\n    },\n    keyLesson: \"Unwavering faith from childhood and willingness to face any danger for Islam defines true discipleship.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Abd al-Rahman ibn Awf\",\n    description: [\n      \"Abd al-Rahman was a successful merchant who accepted Islam early and endured persecution. When he migrated to Madinah with nothing, he refused charity and requested the marketplace instead.\",\n      \"Through hard work and Allah's blessings, he rebuilt his wealth quickly. He once donated an entire caravan of 700 camels loaded with supplies for the Muslim army without hesitation.\",\n      \"Despite immense wealth, Abd al-Rahman lived simply and gave generously. He supported widows, orphans, and the poor throughout his life. The Prophet Ô∑∫ praised his sincere charitable spending.\"\n    ],\n    evidence: {\n      arabic: \"ŸÜŸêÿπŸíŸÖŸé ÿßŸÑŸíŸÖŸéÿßŸÑŸè ÿßŸÑÿµŸéŸëÿßŸÑŸêÿ≠Ÿè ŸÑŸêŸÑÿ±ŸéŸëÿ¨ŸèŸÑŸê ÿßŸÑÿµŸéŸëÿßŸÑŸêÿ≠Ÿê\",\n      translation: \"How excellent is righteous wealth for a righteous person.\",\n      source: \"Musnad Ahmad\"\n    },\n    keyLesson: \"Wealth is a test, and righteous people use it generously for Allah's cause without attachment or pride.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Saad ibn Abi Waqqas\",\n    description: [\n      \"Saad accepted Islam at age seventeen. When his mother threatened to starve herself unless he renounced Islam, Saad remained firm. He refused to abandon Islam.\",\n      \"Saad was first to shoot an arrow defending Islam and a master archer. At Uhud, the Prophet Ô∑∫ gave him arrows saying, 'May my parents be sacrificed for you!'\",\n      \"The Prophet Ô∑∫ said Saad's supplication was always answered. Once he prayed against someone who insulted companions, and that person immediately went blind. He led Persia's conquest.\"\n    ],\n    evidence: {\n      arabic: \"ÿßÿ±ŸíŸÖŸê ŸÅŸêÿØŸéÿßŸÉŸé ÿ£Ÿéÿ®ŸêŸä ŸàŸéÿ£ŸèŸÖŸêŸëŸä\",\n      translation: \"Shoot! May my father and mother be sacrificed for you.\",\n      source: \"Sahih Bukhari 4055\"\n    },\n    keyLesson: \"Standing firm in faith despite family pressure and defending Islam earns Allah's pleasure and acceptance of your prayers.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Saeed ibn Zayd\",\n    description: [\n      \"Saeed accepted Islam before the Prophet Ô∑∫ even entered Dar al-Arqam to teach secretly. He and his wife Fatimah were among the earliest Muslims, showing incredible courage.\",\n      \"When Umar discovered them reading Quran and struck his sister, their steadfastness helped lead to Umar's conversion to Islam. Saeed participated in all major battles except Badr.\",\n      \"Once falsely accused of stealing land, Saeed made a powerful supplication against the liar. He prayed that if she was lying, Allah would blind her. Both blindness and punishment came exactly as prayed.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéÿ¥Ÿéÿ±Ÿéÿ©Ÿå ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"Ten are in Paradise.\",\n      source: \"Sahih Muslim 2409\"\n    },\n    keyLesson: \"Early acceptance of Islam and unwavering commitment through all trials guarantees eternal success.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Abu Ubaydah ibn al-Jarrah\",\n    description: [\n      \"Abu Ubaydah was known as the 'Trustworthy One of this Ummah.' The Prophet Ô∑∫ said every nation has a trustworthy person, and this nation's is Abu Ubaydah.\",\n      \"At the Battle of Uhud, two rings from the Prophet's helmet pierced his blessed face. Abu Ubaydah removed them with his teeth, losing two front teeth protecting him.\",\n      \"As a military commander, Abu Ubaydah led Syria's conquest with wisdom and justice. When plague struck, he chose to stay with his people rather than escape, dying as a martyr.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸêŸÉŸèŸÑŸêŸë ÿ£ŸèŸÖŸéŸëÿ©Ÿç ÿ£ŸéŸÖŸêŸäŸÜŸå ŸàŸéÿ£ŸéŸÖŸêŸäŸÜŸè ŸáŸéÿ∞ŸêŸáŸê ÿßŸÑÿ£ŸèŸÖŸéŸëÿ©Ÿê ÿ£Ÿéÿ®ŸèŸà ÿπŸèÿ®ŸéŸäŸíÿØŸéÿ©Ÿé ÿ®ŸíŸÜŸè ÿßŸÑŸíÿ¨Ÿéÿ±ŸéŸëÿßÿ≠Ÿê\",\n      translation: \"Every nation has a trustworthy person, and the trustworthy one of this nation is Abu Ubaydah ibn al-Jarrah.\",\n      source: \"Sahih Bukhari 4382\"\n    },\n    keyLesson: \"Trustworthiness and selfless service to the Muslim community are among the highest qualities of a believer.\",\n    quizId: 10\n  }\n];\n\nexport default tenPromisedLessons;\n","path":null,"size_bytes":10588,"size_tokens":null},"src/components/quiz/RewardModal.jsx":{"content":"// src/components/quiz/RewardModal.jsx\n\nimport React, { useEffect } from \"react\";\nimport { useVibration } from \"../../hooks/useVibration\";\nimport xpIcon from \"../../assets/ui/ui_xp.webp\";\nimport coinIcon from \"../../assets/ui/ui_coin.webp\";\n\nconst overlayStyle = {\n  position: \"fixed\",\n  inset: 0,\n  backgroundColor: \"rgba(0,0,0,0.95)\",\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  zIndex: 50,\n};\n\nconst modalStyle = {\n  background: \"#0b132b\",\n  borderRadius: \"24px\",\n  padding: \"24px 20px\",\n  width: \"90%\",\n  maxWidth: \"420px\",\n  textAlign: \"center\",\n  color: \"#ffffff\",\n  boxShadow: \"0 10px 30px rgba(0,0,0,0.5)\",\n  border: \"1px solid #1f2b4d\",\n  position: \"relative\",\n};\n\nconst mascotStyle = {\n  width: \"96px\",\n  height: \"auto\",\n  margin: \"0 auto 16px\",\n  animation: \"iq-bounce 1.4s infinite\",\n};\n\nconst titleStyle = {\n  fontSize: \"22px\",\n  fontWeight: 800,\n  color: \"#ffffff\",\n  textShadow: \"0 0 10px rgba(255,255,255,0.8), 0 0 20px rgba(255,255,255,0.6)\",\n  marginBottom: \"4px\",\n};\n\nconst messageStyle = {\n  fontSize: \"15px\",\n  marginBottom: \"18px\",\n};\n\nconst rewardsRowStyle = {\n  display: \"flex\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n  gap: \"24px\",\n  marginBottom: \"20px\",\n};\n\nconst rewardItemStyle = {\n  display: \"flex\",\n  alignItems: \"center\",\n  gap: \"6px\",\n  fontWeight: 600,\n  color: \"#FACC15\",\n};\n\nconst iconStyle = {\n  width: \"20px\",\n  height: \"20px\",\n};\n\nconst buttonStyle = {\n  backgroundColor: \"#FACC15\",\n  color: \"#111827\",\n  border: \"none\",\n  padding: \"10px 22px\",\n  borderRadius: \"999px\",\n  fontWeight: 600,\n  fontSize: \"15px\",\n  cursor: \"pointer\",\n  transition: \"background-color 0.2s, transform 0.1s\",\n};\n\nconst buttonHoverStyle = {\n  backgroundColor: \"#fde68a\",\n  transform: \"translateY(-1px)\",\n};\n\nfunction RewardModalContent({ score, totalQ, xp, coins, mascotImg, onContinue, onRetry, passed }) {\n  const { vibrate } = useVibration();\n  const [hoverContinue, setHoverContinue] = React.useState(false);\n  const [hoverRetry, setHoverRetry] = React.useState(false);\n\n  // Trigger haptic feedback when modal appears\n  useEffect(() => {\n    if (passed) {\n      vibrate([100, 50, 100, 50, 100]); // Victory pattern\n    } else {\n      vibrate([200, 100, 200]); // Failure pattern\n    }\n  }, [passed, vibrate]);\n\n  return (\n    <>\n      <style>\n        {`\n        @keyframes iq-bounce {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-6px); }\n        }\n      `}\n      </style>\n\n      <div style={overlayStyle}>\n        <div style={modalStyle}>\n          <img src={mascotImg} alt=\"Mascot\" style={mascotStyle} />\n\n          <h2 style={titleStyle}>\n            {passed ? \"masha'Allah!\" : \"Keep trying!\"}\n          </h2>\n\n          <p style={messageStyle}>\n            {passed\n              ? `You scored ${score} out of ${totalQ}. Well done!`\n              : `You scored ${score} out of ${totalQ}. Let's improve!`}\n          </p>\n\n          {passed && (xp > 0 || coins > 0) && (\n            <div style={rewardsRowStyle}>\n              {xp > 0 && (\n                <div style={rewardItemStyle}>\n                  <img src={xpIcon} alt=\"XP\" style={iconStyle} />\n                  <span>+{xp} XP</span>\n                </div>\n              )}\n              {coins > 0 && (\n                <div style={rewardItemStyle}>\n                  <img src={coinIcon} alt=\"Coins\" style={iconStyle} />\n                  <span>+{coins} Coins</span>\n                </div>\n              )}\n            </div>\n          )}\n\n          <div style={{ display: \"flex\", gap: \"10px\", marginTop: \"8px\", justifyContent: \"center\" }}>\n            {!passed && onRetry && (\n              <button\n                style={{\n                  ...buttonStyle,\n                  ...(hoverRetry ? buttonHoverStyle : {}),\n                }}\n                onMouseEnter={() => setHoverRetry(true)}\n                onMouseLeave={() => setHoverRetry(false)}\n                onClick={() => {\n                  vibrate(50);\n                  onRetry();\n                }}\n              >\n                Retry Quiz\n              </button>\n            )}\n            {onContinue && (\n              <button\n                style={{\n                  ...buttonStyle,\n                  ...(hoverContinue ? buttonHoverStyle : {}),\n                }}\n                onMouseEnter={() => setHoverContinue(true)}\n                onMouseLeave={() => setHoverContinue(false)}\n                onClick={() => {\n                  vibrate(50);\n                  onContinue();\n                }}\n              >\n                Continue\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nclass RewardModal extends React.Component {\n  render() {\n    return <RewardModalContent {...this.props} />;\n  }\n}\n\nexport default RewardModal;\n","path":null,"size_bytes":4819,"size_tokens":null},"src/data/lessons/graveLessons.js":{"content":"// The Grave (Barzakh) Learning Path\n// 12 lessons about death and the life of the grave\n// Each lesson: 3 paragraphs (~23 words each), authentic Quranic/hadith evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, Sahih Muslim, Abu Dawud, and Tirmidhi (authentic)\n\nconst graveLessons = [\n  {\n    id: 1,\n    title: \"Death\",\n    description: [\n      \"Every soul will taste death at its appointed time. No one can delay or advance death even by a single moment. Allah alone decides when each person's life will end.\",\n      \"Death is not the end but a transition from this temporary world to the eternal Hereafter. The soul leaves the body and begins a new journey that lasts forever in the next life.\",\n      \"Remembering death frequently keeps our hearts focused on what truly matters. When we remember death often, we prioritize good deeds over worldly pleasures and prepare properly for our inevitable meeting with Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸÉŸèŸÑŸèŸë ŸÜŸéŸÅŸíÿ≥Ÿç ÿ∞Ÿéÿßÿ¶ŸêŸÇŸéÿ©Ÿè ÿßŸÑŸíŸÖŸéŸàŸíÿ™Ÿê\",\n      translation: \"Every soul will taste death.\",\n      source: \"Qur'an 3:185\"\n    },\n    keyLesson: \"Death is certain for everyone, so we must prepare through faith and good deeds while we still have time.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Angels of Death\",\n    description: [\n      \"Allah assigned the Angel of Death and his helpers to take souls when their time comes. These angels know exactly when and where each person will die according to Allah's perfect decree and divine wisdom.\",\n      \"For believers, the angels come with beautiful faces and pleasant fragrance, gently extracting the soul like water flowing from a pitcher. They bring glad tidings of Allah's mercy, Paradise, and eternal peace and happiness.\",\n      \"For disbelievers, the angels come with harsh appearance and take the soul roughly like thorns tearing through wet wool. They bring warnings of Allah's anger, Hellfire, and eternal punishment for their rejection and sins.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ™Ÿéÿ™ŸéŸàŸéŸÅŸéŸëÿßŸáŸèŸÖŸè ÿßŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©Ÿè ÿ∑ŸéŸäŸêŸëÿ®ŸêŸäŸÜŸé €ô ŸäŸéŸÇŸèŸàŸÑŸèŸàŸÜŸé ÿ≥ŸéŸÑŸéÿßŸÖŸå ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸè ÿßÿØŸíÿÆŸèŸÑŸèŸàÿß ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé ÿ®ŸêŸÖŸéÿß ŸÉŸèŸÜÿ™ŸèŸÖŸí ÿ™ŸéÿπŸíŸÖŸéŸÑŸèŸàŸÜŸé\",\n      translation: \"Those whom the angels take in death while they are good, saying, 'Peace be upon you. Enter Paradise for what you used to do.'\",\n      source: \"Qur'an 16:32\"\n    },\n    keyLesson: \"The way angels take our soul depends on how we lived, making righteous living essential for a peaceful death.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Soul's Journey\",\n    description: [\n      \"After death, the believer's soul is taken up through the heavens. At each heaven's gate, the angels welcome it joyfully and open the gates. The soul ascends until it reaches Allah's presence.\",\n      \"The believer's soul is wrapped in fragrant shrouds from Paradise and carried upward by angels. Every angel in the heavens asks whose blessed soul this is, and the angels reply with the person's best name and titles.\",\n      \"The disbeliever's soul is rejected at the first heaven's gate and thrown back down to earth violently. It is returned to the body in the grave to face questioning and punishment for its disbelief and evil deeds.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéÿ∞ŸéŸëÿ®ŸèŸàÿß ÿ®Ÿêÿ¢ŸäŸéÿßÿ™ŸêŸÜŸéÿß ŸàŸéÿßÿ≥Ÿíÿ™ŸéŸÉŸíÿ®Ÿéÿ±ŸèŸàÿß ÿπŸéŸÜŸíŸáŸéÿß ŸÑŸéÿß ÿ™ŸèŸÅŸéÿ™ŸéŸëÿ≠Ÿè ŸÑŸéŸáŸèŸÖŸí ÿ£Ÿéÿ®ŸíŸàŸéÿßÿ®Ÿè ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿê\",\n      translation: \"Indeed, those who deny Our verses and are arrogant toward them - the gates of Heaven will not be opened for them.\",\n      source: \"Qur'an 7:40\"\n    },\n    keyLesson: \"Our deeds determine whether our soul ascends to honor in Heaven or descends to humiliation in the grave.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Questioning (Munkar & Nakƒ´r)\",\n    description: [\n      \"Two angels named Munkar and Nakƒ´r come to question every person in the grave shortly after burial. They ask three critical questions: Who is your Lord? What is your religion? Who is your Prophet?\",\n      \"The believer who lived with sincere faith answers confidently and correctly: My Lord is Allah, my religion is Islam, and my Prophet is Muhammad Ô∑∫. The angels make the grave spacious, comfortable, and filled with light.\",\n      \"The hypocrite and disbeliever struggle to answer, saying they don't know or just followed others blindly. The angels make their grave tight and dark, squeezing them painfully. This is the beginning of their grave's punishment.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸèÿ´Ÿéÿ®ŸêŸëÿ™Ÿè ÿßŸÑŸÑŸéŸëŸáŸè ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿ®ŸêÿßŸÑŸíŸÇŸéŸàŸíŸÑŸê ÿßŸÑÿ´ŸéŸëÿßÿ®Ÿêÿ™Ÿê ŸÅŸêŸä ÿßŸÑŸíÿ≠ŸéŸäŸéÿßÿ©Ÿê ÿßŸÑÿØŸèŸëŸÜŸíŸäŸéÿß ŸàŸéŸÅŸêŸä ÿßŸÑŸíÿ¢ÿÆŸêÿ±Ÿéÿ©Ÿê\",\n      translation: \"Allah keeps firm those who believe, with the firm word, in this worldly life and in the Hereafter.\",\n      source: \"Qur'an 14:27\"\n    },\n    keyLesson: \"We must live our faith sincerely every day so we can answer the grave's questions with complete confidence.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Life of Barzakh\",\n    description: [\n      \"Barzakh is the barrier world between death and the Day of Judgment where souls wait for resurrection. It is neither this life nor the complete Hereafter but a transitional realm where souls experience reward or punishment.\",\n      \"The soul remains aware and conscious in Barzakh, experiencing either comfort or torment based on its earthly deeds. Time passes differently there, and the soul awaits the Day when everyone will be resurrected for final judgment.\",\n      \"No one can return from Barzakh to this world to fix their mistakes or do more good deeds. Once death comes, our record is sealed permanently. This makes using our time wisely before death absolutely essential.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸêŸÜ ŸàŸéÿ±Ÿéÿßÿ¶ŸêŸáŸêŸÖ ÿ®Ÿéÿ±Ÿíÿ≤ŸéÿÆŸå ÿ•ŸêŸÑŸéŸâŸ∞ ŸäŸéŸàŸíŸÖŸê ŸäŸèÿ®ŸíÿπŸéÿ´ŸèŸàŸÜŸé\",\n      translation: \"And before them is a barrier until the Day they are resurrected.\",\n      source: \"Qur'an 23:100\"\n    },\n    keyLesson: \"Barzakh is the waiting period between death and resurrection where our eternal fate becomes clearer each moment.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Punishment of the Grave\",\n    description: [\n      \"The grave punishes those who died in disbelief or with major unrepented sins. The punishment includes tightness squeezing the body, scorching heat or freezing cold, beatings from iron rods, and terrifying visions of Hellfire.\",\n      \"Some people are punished for specific sins like backbiting, lying, not cleaning properly after using the bathroom, or abandoning prayer. The Prophet Muhammad Ô∑∫ saw some of these punishments during his night journey and warned us about them.\",\n      \"This punishment continues until the Day of Judgment for disbelievers. For sinful believers, it may last until their sins are cleansed or until people's prayers and charity reach them. Repenting before death saves us from this torment.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸí ÿπŸéÿ∞Ÿéÿßÿ®Ÿê ÿßŸÑŸíŸÇŸéÿ®Ÿíÿ±Ÿê\",\n      translation: \"O Allah, I seek refuge in You from the punishment of the grave.\",\n      source: \"Sahih Bukhari 1377\"\n    },\n    keyLesson: \"The grave's punishment is real and severe, so we must repent from sins and live righteously before death comes.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Bliss of the Grave\",\n    description: [\n      \"The righteous believer's grave becomes a garden from Paradise's gardens, spacious and comfortable. A window opens to Paradise showing them their future home, filling the grave with beautiful fragrance and refreshing breezes.\",\n      \"Angels visit the believer with glad tidings and companionship, bringing peace and comfort. The grave's earth becomes soft like silk, and a pleasant light shines within. Time passes quickly in this blissful state of anticipation.\",\n      \"The believer's soul visits Paradise, meets other righteous souls, and receives honored treatment. They rest peacefully, eagerly awaiting the Day of Judgment when they will enter Paradise forever. This is the reward for sincere faith.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÇŸéÿßŸÑŸèŸàÿß ÿ±Ÿéÿ®ŸèŸëŸÜŸéÿß ÿßŸÑŸÑŸéŸëŸáŸè ÿ´ŸèŸÖŸéŸë ÿßÿ≥Ÿíÿ™ŸéŸÇŸéÿßŸÖŸèŸàÿß ÿ™Ÿéÿ™ŸéŸÜŸéÿ≤ŸéŸëŸÑŸè ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸè ÿßŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©Ÿè ÿ£ŸéŸÑŸéŸëÿß ÿ™ŸéÿÆŸéÿßŸÅŸèŸàÿß ŸàŸéŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≤ŸéŸÜŸèŸàÿß ŸàŸéÿ£Ÿéÿ®Ÿíÿ¥Ÿêÿ±ŸèŸàÿß ÿ®ŸêÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ÿßŸÑŸéŸëÿ™ŸêŸä ŸÉŸèŸÜÿ™ŸèŸÖŸí ÿ™ŸèŸàÿπŸéÿØŸèŸàŸÜŸé\",\n      translation: \"Indeed, those who have said, 'Our Lord is Allah' and then remained steadfast - the angels will descend upon them, saying, 'Do not fear and do not grieve but receive good tidings of Paradise.'\",\n      source: \"Qur'an 41:30\"\n    },\n    keyLesson: \"The grave becomes Paradise's garden for those who lived with true faith and righteousness in this world.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Souls Meeting\",\n    description: [\n      \"The souls of believers meet each other in Barzakh and recognize one another from their earthly lives. They gather in groups according to their levels of righteousness, discussing their past lives and sharing their experiences of death.\",\n      \"When a righteous person dies, the souls of deceased believers ask about their loved ones still living on earth. They inquire about family and friends, hoping to hear they remained faithful and righteous until their own deaths arrived.\",\n      \"The souls feel joy when learning a loved one died in faith and sorrow when someone died astray. They pray for their living loved ones to die as believers. These meetings continue until everyone is resurrected on Judgment Day.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸíÿ£Ÿéÿ±ŸíŸàŸéÿßÿ≠Ÿè ÿ¨ŸèŸÜŸèŸàÿØŸå ŸÖŸèÿ¨ŸéŸÜŸéŸëÿØŸéÿ©Ÿåÿå ŸÅŸéŸÖŸéÿß ÿ™ŸéÿπŸéÿßÿ±ŸéŸÅŸé ŸÖŸêŸÜŸíŸáŸéÿßÿßÿ¶Ÿíÿ™ŸéŸÑŸéŸÅŸéÿå ŸàŸéŸÖŸéÿß ÿ™ŸéŸÜŸéÿßŸÉŸéÿ±Ÿé ŸÖŸêŸÜŸíŸáŸéÿß ÿßÿÆŸíÿ™ŸéŸÑŸéŸÅŸé\",\n      translation: \"Souls are like armies gathered together; those who knew each other in this world will be close in the next, and those who did not know each other will be apart.\",\n      source: \"Sahih Bukhari 3336\"\n    },\n    keyLesson: \"Righteous souls maintain their bonds of love in Barzakh, reuniting with beloved friends and family who also believed.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Visiting Graves (Adab)\",\n    description: [\n      \"Visiting graves reminds us of death and the Hereafter, softening our hearts and reducing attachment to worldly things. The Prophet Muhammad Ô∑∫ encouraged visiting graves to remember our inevitable end and prepare for it.\",\n      \"When visiting, we greet the deceased with peace: 'Peace be upon you, O inhabitants of the graves, from among the believers and Muslims. We will surely join you. We ask Allah for well-being for us and you.'\",\n      \"We should make sincere prayers for the deceased, asking Allah to forgive them and grant them mercy. Visiting should increase our own good deeds and remind us to prepare for death. We must not wail loudly or act disrespectfully.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≤ŸèŸàÿ±ŸèŸàÿß ÿßŸÑŸíŸÇŸèÿ®ŸèŸàÿ±Ÿé ŸÅŸéÿ•ŸêŸÜŸéŸëŸáŸéÿß ÿ™Ÿèÿ∞ŸéŸÉŸêŸëÿ±ŸèŸÉŸèŸÖŸè ÿßŸÑŸíÿ¢ÿÆŸêÿ±Ÿéÿ©Ÿé\",\n      translation: \"Visit the graves, for they remind you of the Hereafter.\",\n      source: \"Sahih Muslim 976\"\n    },\n    keyLesson: \"Visiting graves with proper manners reminds us of death and motivates us to increase our good deeds.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Protection from Punishment\",\n    description: [\n      \"The Prophet Muhammad Ô∑∫ taught us specific actions that protect from the grave's punishment. These include sincere faith in Allah, dying as a martyr, dying on Friday, dying while guarding Islam's borders, and reciting Surah Al-Mulk regularly.\",\n      \"Seeking refuge from the grave's punishment in every prayer is essential. We should say after every prayer: 'O Allah, I seek refuge in You from the punishment of the grave and the trial of the Dajjal.'\",\n      \"Living righteously protects us from punishment: praying five daily prayers properly, being honest, avoiding backbiting and gossip, cleaning properly after using the bathroom, honoring parents, and maintaining good character throughout life. Good deeds are our best shield.\"\n    ],\n    evidence: {\n      arabic: \"ÿ™Ÿéÿ®Ÿéÿßÿ±ŸéŸÉŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ®ŸêŸäŸéÿØŸêŸáŸê ÿßŸÑŸíŸÖŸèŸÑŸíŸÉŸè\",\n      translation: \"Blessed is He in whose hand is dominion (Surah Al-Mulk protects from grave punishment).\",\n      source: \"Tirmidhi 2891\"\n    },\n    keyLesson: \"We protect ourselves from grave punishment through sincere faith, regular worship, and consistently good character and deeds.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Martyrs in the Grave\",\n    description: [\n      \"Those who die as martyrs fighting in Allah's cause or defending Islam receive special honors. They do not experience the grave's trial or questioning. Their souls go directly to Paradise without waiting in Barzakh.\",\n      \"The martyrs' souls live inside green birds that freely roam Paradise, eating its fruits and drinking from its rivers. They experience Paradise's joys immediately while their bodies rest in their graves without decay or punishment.\",\n      \"Martyrs do not feel the pain of death except like a small pinch. Allah forgives all their sins instantly when the first drop of blood is shed. They wish they could return to earth to be martyred again because of the tremendous honor.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≥Ÿéÿ®ŸéŸÜŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÇŸèÿ™ŸêŸÑŸèŸàÿß ŸÅŸêŸä ÿ≥Ÿéÿ®ŸêŸäŸÑŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéŸÖŸíŸàŸéÿßÿ™Ÿãÿß €ö ÿ®ŸéŸÑŸí ÿ£Ÿéÿ≠ŸíŸäŸéÿßÿ°Ÿå ÿπŸêŸÜÿØŸé ÿ±Ÿéÿ®ŸêŸëŸáŸêŸÖŸí ŸäŸèÿ±Ÿíÿ≤ŸéŸÇŸèŸàŸÜŸé\",\n      translation: \"And do not think of those who have been killed in the cause of Allah as dead. Rather, they are alive with their Lord, receiving provision.\",\n      source: \"Qur'an 3:169\"\n    },\n    keyLesson: \"Martyrs receive special mercy and immediate Paradise, bypassing the grave's normal trials and experiencing instant divine reward.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Hope & Reflection\",\n    description: [\n      \"Although the grave's punishment is real and frightening, Allah's mercy is greater than His punishment. Sincere repentance before death erases sins completely. Even major sinners who died believing will eventually enter Paradise after purification.\",\n      \"Reflecting on death and the grave should motivate us toward good deeds, not paralyze us with fear. We balance hope in Allah's mercy with fear of His punishment. This balance keeps us striving to improve constantly.\",\n      \"Every day is an opportunity to prepare for the grave through prayer, charity, good character, and seeking forgiveness. We should live as if we might die tomorrow but prepare as if we will live long. This mindset leads to the best life.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ŸäŸéÿß ÿπŸêÿ®ŸéÿßÿØŸêŸäŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ£Ÿéÿ≥Ÿíÿ±ŸéŸÅŸèŸàÿß ÿπŸéŸÑŸéŸâŸ∞ ÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸáŸêŸÖŸí ŸÑŸéÿß ÿ™ŸéŸÇŸíŸÜŸéÿ∑ŸèŸàÿß ŸÖŸêŸÜ ÿ±ŸéŸëÿ≠ŸíŸÖŸéÿ©Ÿê ÿßŸÑŸÑŸéŸëŸáŸê €ö ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸäŸéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑÿ∞ŸèŸëŸÜŸèŸàÿ®Ÿé ÿ¨ŸéŸÖŸêŸäÿπŸãÿß\",\n      translation: \"Say, 'O My servants who have transgressed against themselves, do not despair of the mercy of Allah. Indeed, Allah forgives all sins.'\",\n      source: \"Qur'an 39:53\"\n    },\n    keyLesson: \"We balance fear of the grave with hope in Allah's infinite mercy, using both to motivate righteous living.\",\n    quizId: 12\n  }\n];\n\nexport default graveLessons;\n","path":null,"size_bytes":15768,"size_tokens":null},"src/data/quizEngine.js":{"content":"// /src/data/quizEngine.js\n// Handles all quiz data + XP/coin calculation for all learning paths\n\n// ---------------------------------------------------------------------\n//  QUIZ DATA ‚Äì Import from JSON\n// ---------------------------------------------------------------------\n\nimport namesOfAllahQuizzesData from './quizzes/namesOfAllah.json';\nimport foundationsQuizzesData from './quizzes/foundations.json';\nimport prophetsQuizzesData from './quizzes/prophets.json';\nimport prophetLifeQuizzesData from './quizzes/prophetLife.json';\nimport wivesQuizzesData from './quizzes/wivesQuizzes.json';\nimport tenPromisedQuizzesData from './quizzes/tenPromisedQuizzes.json';\nimport greatestWomenQuizzesData from './quizzes/greatestWomenQuizzes.json';\nimport companionsQuizzesData from './quizzes/companionsQuizzes.json';\nimport angelsQuizzesData from './quizzes/angelsQuizzes.json';\nimport endTimesQuizzesData from './quizzes/endTimesQuizzes.json';\nimport graveQuizzesData from './quizzes/graveQuizzes.json';\nimport judgementQuizzesData from './quizzes/judgementQuizzes.json';\nimport hellfireQuizzesData from './quizzes/hellfireQuizzes.json';\nimport paradiseQuizzesData from './quizzes/paradiseQuizzes.json';\n\n// ---------------------------------------------------------------------\n//  FUNCTIONS\n// ---------------------------------------------------------------------\n\n// Fetch quiz for a specific lesson based on pathId and lessonId\nexport const getQuizForLesson = (lessonId, pathId = 1) => {\n  let quizzesData = [];\n  \n  // Load the correct quiz data based on pathId\n  switch (parseInt(pathId)) {\n    case 1:\n      quizzesData = namesOfAllahQuizzesData;\n      break;\n    case 2:\n      quizzesData = foundationsQuizzesData;\n      break;\n    case 3:\n      quizzesData = prophetsQuizzesData;\n      break;\n    case 4:\n      quizzesData = prophetLifeQuizzesData;\n      break;\n    case 5:\n      quizzesData = wivesQuizzesData;\n      break;\n    case 6:\n      quizzesData = tenPromisedQuizzesData;\n      break;\n    case 7:\n      quizzesData = greatestWomenQuizzesData;\n      break;\n    case 8:\n      quizzesData = companionsQuizzesData;\n      break;\n    case 9:\n      quizzesData = angelsQuizzesData;\n      break;\n    case 10:\n      quizzesData = endTimesQuizzesData;\n      break;\n    case 11:\n      quizzesData = graveQuizzesData;\n      break;\n    case 12:\n      quizzesData = judgementQuizzesData;\n      break;\n    case 13:\n      quizzesData = hellfireQuizzesData;\n      break;\n    case 14:\n      quizzesData = paradiseQuizzesData;\n      break;\n    default:\n      quizzesData = namesOfAllahQuizzesData;\n  }\n  \n  const quizData = quizzesData.find(q => q.lessonId === parseInt(lessonId));\n  if (!quizData) return [];\n  \n  // Transform JSON format to component format\n  return quizData.questions.map((q, idx) => ({\n    id: idx + 1,\n    text: q.question,\n    options: q.options,\n    correctIndex: q.answer\n  }));\n};\n\n// Calculate results, XP, and coins\n// Uses 75% passing threshold (changed from hardcoded 3/4)\nexport const calculateResults = (answers) => {\n  const total = answers.length;\n  const correct = answers.filter((a) => a.correct).length;\n  \n  // 75% passing threshold (universal rule)\n  const passingThreshold = total * 0.75;\n  const passed = correct >= passingThreshold;\n\n  // XP / Coins system\n  const baseXP = correct * 20;\n  const bonusXP = passed ? 40 : 0;\n  const perfectXP = correct === total ? 20 : 0;\n  const totalXP = baseXP + bonusXP + perfectXP;\n\n  const baseCoins = correct * 5;\n  const bonusCoins = passed ? 10 : 0;\n  const totalCoins = baseCoins + bonusCoins;\n\n  return {\n    total,\n    correct,\n    passed,\n    xp: totalXP,\n    coins: totalCoins,\n  };\n};\n","path":null,"size_bytes":3670,"size_tokens":null},"src/components/quiz/QuestionCard.jsx":{"content":"import React from \"react\";\nimport { useVibration } from \"../../hooks/useVibration\";\n\nconst QuestionCard = React.memo(({\n  question,\n  selected,\n  onSelect,\n  currentQ,\n  totalQ,\n}) => {\n  const { vibrate } = useVibration();\n  if (!question) return null;\n\n  const wrapper = {\n    width: \"100%\",\n    maxWidth: \"600px\",\n    margin: \"0 auto\",\n    textAlign: \"center\",\n    color: \"#ffffff\",\n    paddingTop: \"20px\",\n  };\n\n  const questionMeta = {\n    fontSize: \"16px\",\n    color: \"#F4C542\",\n    marginBottom: \"4px\",\n  };\n\n  const questionStyle = {\n    fontSize: \"20px\",\n    fontWeight: 600,\n    marginBottom: \"24px\",\n    lineHeight: 1.5,\n  };\n\n  const optionList = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    gap: \"10px\",\n  };\n\n  const baseOption = {\n    padding: \"12px 14px\",\n    borderRadius: \"10px\",\n    border: \"2px solid #F4C542\",\n    background: \"rgba(5,10,20,0.96)\",\n    color: \"#ffffff\",\n    fontSize: \"15px\",\n    fontWeight: 500,\n    textAlign: \"left\",\n    cursor: \"pointer\",\n    transition: \"all 0.25s ease\",\n  };\n\n  return (\n    <div style={wrapper}>\n      <h2 style={questionMeta}>\n        Question {currentQ + 1} of {totalQ}\n      </h2>\n\n      <h3 style={questionStyle}>{question.text}</h3>\n\n      <div style={optionList}>\n        {question.options.map((option, index) => {\n          const isSelected = selected === index;\n          let style = { ...baseOption };\n\n          if (selected !== null) {\n            const isCorrectIndex = question.correctIndex;\n\n            if (index === isCorrectIndex) {\n              style.background = \"#16a34a\";\n              style.border = \"2px solid #16a34a\";\n            } else if (isSelected && index !== isCorrectIndex) {\n              style.background = \"#dc2626\";\n              style.border = \"2px solid #dc2626\";\n            } else {\n              style.opacity = 0.5;\n              style.border = \"2px solid #4b5563\";\n              style.color = \"#9ca3af\";\n            }\n          }\n\n          return (\n            <button\n              key={index}\n              onClick={() => {\n                if (selected === null) {\n                  vibrate(50); // Quick haptic feedback on answer selection\n                  onSelect(index);\n                }\n              }}\n              disabled={selected !== null}\n              style={style}\n            >\n              {option}\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nexport default QuestionCard;\n","path":null,"size_bytes":2448,"size_tokens":null},"src/components/quiz/QuizHeader.jsx":{"content":"import React from \"react\";\nimport { mascotQuizStates } from \"../../data/mascotQuizStates\";\n\nconst QuizHeader = ({ currentQ, totalQ, mascotMood, isQuizDone = false, progressMascot = null }) => {\n  const mascotImg = progressMascot || mascotQuizStates[mascotMood] || mascotQuizStates.start;\n\n  return (\n    <div className=\"flex items-center justify-between px-4 pt-4 pb-3\">\n      <div>\n        <h2 className=\"text-xl font-semibold text-white\">Quiz</h2>\n      </div>\n\n      {!isQuizDone && (\n        <img\n          src={mascotImg}\n          alt=\"Mascot\"\n          className=\"w-14 h-14 object-contain\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default QuizHeader;\n","path":null,"size_bytes":664,"size_tokens":null},"src/data/lessons/judgementLessons.js":{"content":"// Day of Judgement Learning Path\n// 16 lessons about the Day of Judgment and accountability\n// Each lesson: 3 paragraphs (~23 words each), authentic Quranic/hadith evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, Sahih Muslim, Abu Dawud, and Tirmidhi (authentic)\n\nconst judgementLessons = [\n  {\n    id: 1,\n    title: \"Resurrection\",\n    description: [\n      \"After the second trumpet blast, every human who ever lived will be resurrected from their graves. Allah will recreate everyone from a tiny bone at the base of the spine that never decays.\",\n      \"People will emerge barefoot, naked, and uncircumcised, just as they were created the first time. They will be brought back exactly as they were, with nothing missing from their original bodies or forms.\",\n      \"Allah's power to resurrect is easy for Him, just as creating us the first time was easy. He will gather billions of people instantly on a vast plain, awaiting the judgment that will determine their eternal fate.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéŸàŸíŸÖŸé ŸäŸéÿÆŸíÿ±Ÿèÿ¨ŸèŸàŸÜŸé ŸÖŸêŸÜŸé ÿßŸÑŸíÿ£Ÿéÿ¨ŸíÿØŸéÿßÿ´Ÿê ÿ≥Ÿêÿ±ŸéÿßÿπŸãÿß ŸÉŸéÿ£ŸéŸÜŸéŸëŸáŸèŸÖŸí ÿ•ŸêŸÑŸéŸâŸ∞ ŸÜŸèÿµŸèÿ®Ÿç ŸäŸèŸàŸÅŸêÿ∂ŸèŸàŸÜŸé\",\n      translation: \"The Day they will emerge from the graves rapidly as if they were, toward an erected idol, hastening.\",\n      source: \"Qur'an 70:43\"\n    },\n    keyLesson: \"Allah will resurrect every person who ever lived, proving His absolute power and fulfilling His promise of accountability.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"The Gathering\",\n    description: [\n      \"All of humanity will be gathered on a vast, white, leveled plain that stretches endlessly in every direction. No landmarks, buildings, or hiding places will exist there. Everyone will stand together, exposed and visible.\",\n      \"People will be gathered barefoot and uncovered, standing in groups according to their deeds and beliefs. The prophets, martyrs, and righteous will stand near the front, while evildoers will be pushed toward the back in humiliation and fear.\",\n      \"The gathering will last an extremely long time, with people waiting under intense heat from the sun being very close overhead. People will desperately seek shade and relief, but only those whom Allah grants mercy will find comfort on that terrifying Day.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéŸàŸíŸÖŸé ŸÜŸéÿ∑ŸíŸàŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿé ŸÉŸéÿ∑ŸéŸäŸêŸë ÿßŸÑÿ≥ŸêŸëÿ¨ŸêŸÑŸêŸë ŸÑŸêŸÑŸíŸÉŸèÿ™Ÿèÿ®Ÿê €ö ŸÉŸéŸÖŸéÿß ÿ®ŸéÿØŸéÿ£ŸíŸÜŸéÿß ÿ£ŸéŸàŸéŸëŸÑŸé ÿÆŸéŸÑŸíŸÇŸç ŸÜŸèŸëÿπŸêŸäÿØŸèŸáŸè\",\n      translation: \"The Day when We will fold the heaven like the folding of a book. As We began the first creation, We will repeat it.\",\n      source: \"Qur'an 21:104\"\n    },\n    keyLesson: \"Everyone will be gathered together without exception or escape, standing equal before Allah regardless of worldly status or wealth.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Standing Before Allah\",\n    description: [\n      \"People will stand before Allah for a period lasting fifty thousand years according to our time. The length each person stands depends on their deeds‚Äîbelievers pass quickly while wrongdoers suffer longer in terrible anxiety and fear.\",\n      \"The sun will be extremely close, only a mile above people's heads, causing unbearable heat and sweat. People will sweat according to their sins‚Äîsome ankle-deep, others knee-deep, waist-deep, or completely drowning in their own sweat in unbearable torment.\",\n      \"No one can lie, hide, or pretend on that Day. Every secret thought, hidden action, and private deed will be exposed publicly. People will face the complete truth about themselves without any ability to deny or escape their recorded deeds.\"\n    ],\n    evidence: {\n      arabic: \"ÿ™ŸéÿπŸíÿ±Ÿèÿ¨Ÿè ÿßŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©Ÿè ŸàŸéÿßŸÑÿ±ŸèŸëŸàÿ≠Ÿè ÿ•ŸêŸÑŸéŸäŸíŸáŸê ŸÅŸêŸä ŸäŸéŸàŸíŸÖŸç ŸÉŸéÿßŸÜŸé ŸÖŸêŸÇŸíÿØŸéÿßÿ±ŸèŸáŸè ÿÆŸéŸÖŸíÿ≥ŸêŸäŸÜŸé ÿ£ŸéŸÑŸíŸÅŸé ÿ≥ŸéŸÜŸéÿ©Ÿç\",\n      translation: \"The angels and the Spirit will ascend to Him during a Day the extent of which is fifty thousand years.\",\n      source: \"Qur'an 70:4\"\n    },\n    keyLesson: \"Standing before Allah will be the longest and most difficult experience, making every hidden deed visible and every secret known.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"The Records\",\n    description: [\n      \"Every person will receive a book containing every single deed, word, and thought from their entire life. Nothing will be missing‚Äîevery small and large action recorded perfectly by the angels who watched us constantly throughout our lives.\",\n      \"The righteous will receive their book in their right hand, causing them immense joy and relief. They will read it happily, eager to show others their good deeds. They will know immediately that they have passed the test and earned Paradise forever.\",\n      \"The wicked will receive their book in their left hand from behind their back, filling them with horror and despair. They will wish they had never received it, begging for death and annihilation. But there is no escape from facing their evil recorded deeds.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÉŸèŸÑŸéŸë ÿ•ŸêŸÜÿ≥ŸéÿßŸÜŸç ÿ£ŸéŸÑŸíÿ≤ŸéŸÖŸíŸÜŸéÿßŸáŸè ÿ∑Ÿéÿßÿ¶Ÿêÿ±ŸéŸáŸè ŸÅŸêŸä ÿπŸèŸÜŸèŸÇŸêŸáŸê €ñ ŸàŸéŸÜŸèÿÆŸíÿ±Ÿêÿ¨Ÿè ŸÑŸéŸáŸè ŸäŸéŸàŸíŸÖŸé ÿßŸÑŸíŸÇŸêŸäŸéÿßŸÖŸéÿ©Ÿê ŸÉŸêÿ™Ÿéÿßÿ®Ÿãÿß ŸäŸéŸÑŸíŸÇŸéÿßŸáŸè ŸÖŸéŸÜÿ¥ŸèŸàÿ±Ÿãÿß\",\n      translation: \"And every person We have made his fate cling to his neck, and on the Day of Resurrection We will bring out for him a book which he will encounter spread open.\",\n      source: \"Qur'an 17:13\"\n    },\n    keyLesson: \"Our complete life record will be presented to us, containing every action we ever did, proving Allah's perfect knowledge and justice.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"The Scales\",\n    description: [\n      \"Allah will weigh every person's deeds on a massive, precise scale called the Meezan. Good deeds will be placed on one side and bad deeds on the other. The scale is real and physical, and everyone will witness their deeds being weighed publicly.\",\n      \"Even the tiniest good deed, like smiling or removing harm from the road, will appear and have weight. Even the smallest sin, like a harsh word or bad thought, will also appear. Nothing we ever did will be forgotten or overlooked by Allah's perfect justice.\",\n      \"Whoever's good deeds are heavier will succeed and enter Paradise with joy and eternal bliss. Whoever's bad deeds are heavier will fail and face punishment. Some will have exactly equal scales, and Allah will decide their fate with His infinite mercy.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸéÿ∂ŸéÿπŸè ÿßŸÑŸíŸÖŸéŸàŸéÿßÿ≤ŸêŸäŸÜŸé ÿßŸÑŸíŸÇŸêÿ≥Ÿíÿ∑Ÿé ŸÑŸêŸäŸéŸàŸíŸÖŸê ÿßŸÑŸíŸÇŸêŸäŸéÿßŸÖŸéÿ©Ÿê ŸÅŸéŸÑŸéÿß ÿ™Ÿèÿ∏ŸíŸÑŸéŸÖŸè ŸÜŸéŸÅŸíÿ≥Ÿå ÿ¥ŸéŸäŸíÿ¶Ÿãÿß €ñ ŸàŸéÿ•ŸêŸÜ ŸÉŸéÿßŸÜŸé ŸÖŸêÿ´ŸíŸÇŸéÿßŸÑŸé ÿ≠Ÿéÿ®ŸéŸëÿ©Ÿç ŸÖŸêŸëŸÜŸí ÿÆŸéÿ±ŸíÿØŸéŸÑŸç ÿ£Ÿéÿ™ŸéŸäŸíŸÜŸéÿß ÿ®ŸêŸáŸéÿß\",\n      translation: \"And We place the scales of justice for the Day of Resurrection, so no soul will be treated unjustly at all. And if there is even the weight of a mustard seed, We will bring it forth.\",\n      source: \"Qur'an 21:47\"\n    },\n    keyLesson: \"Every deed, no matter how small, will be weighed with perfect accuracy, making every good and bad action count eternally.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Prophet's Intercession\",\n    description: [\n      \"When people can no longer bear the intense heat and long standing, they will desperately search for someone to intercede with Allah to begin the judgment. They will approach Adam, then Noah, then Abraham, then Moses, then Jesus‚Äîbut each will direct them to another.\",\n      \"Finally, people will come to Prophet Muhammad Ô∑∫, and he will accept, saying 'I am the one for this.' He will prostrate under Allah's Throne and praise Allah with words never spoken before. Allah will grant him permission to intercede for his Ummah.\",\n      \"The Prophet Ô∑∫ will intercede multiple times: first to begin the judgment, then to admit people into Paradise, then for those whose good and bad deeds are equal, and finally to remove believers from Hellfire. His intercession will save countless people through Allah's mercy.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéÿ≥ŸéŸâŸ∞ ÿ£ŸéŸÜ ŸäŸéÿ®ŸíÿπŸéÿ´ŸéŸÉŸé ÿ±Ÿéÿ®ŸèŸëŸÉŸé ŸÖŸéŸÇŸéÿßŸÖŸãÿß ŸÖŸéŸëÿ≠ŸíŸÖŸèŸàÿØŸãÿß\",\n      translation: \"It may be that your Lord will raise you to a praised station (the station of intercession).\",\n      source: \"Qur'an 17:79\"\n    },\n    keyLesson: \"The Prophet Muhammad Ô∑∫ will be granted the honored station of intercession, helping his followers through Allah's permission and mercy.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"The Pond (Al-Kawthar)\",\n    description: [\n      \"The Prophet Muhammad Ô∑∫ will have a massive pond called Al-Kawthar on the Day of Judgment. Its water is whiter than milk, sweeter than honey, and more fragrant than musk. Drinking from it once quenches thirst forever.\",\n      \"The pond is vast, with distances between corners taking a month to travel. Cups numbering like the stars in the sky line its edges. The water comes directly from the river in Paradise that Allah gave specifically to the Prophet Ô∑∫.\",\n      \"Only the Prophet's Ô∑∫ true followers will be allowed to drink from it. Those who changed the religion or abandoned Islamic practices after him will be driven away. The Prophet Ô∑∫ will watch sadly as some who claimed to follow him are blocked from drinking.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ÿ£ŸéÿπŸíÿ∑ŸéŸäŸíŸÜŸéÿßŸÉŸé ÿßŸÑŸíŸÉŸéŸàŸíÿ´Ÿéÿ±Ÿé\",\n      translation: \"Indeed, We have granted you Al-Kawthar (a river in Paradise).\",\n      source: \"Qur'an 108:1\"\n    },\n    keyLesson: \"Al-Kawthar is a special gift to the Prophet Ô∑∫ and his sincere followers, providing relief before entering Paradise forever.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"SirƒÅt Bridge\",\n    description: [\n      \"The SirƒÅt is a bridge stretched over Hellfire that every single person must cross to reach Paradise. It is described as thinner than a hair and sharper than a sword, with hooks and thorns grabbing people according to their sins in life.\",\n      \"People will cross at different speeds based on their faith and deeds. Some pass like lightning, others like the wind, some like fast horses, others running, walking, or crawling. The sinful will be grabbed by hooks and fall into the Fire below.\",\n      \"Believers will have light guiding them across, shining according to their good deeds. Some will have light like the sun, others like the moon or stars, and some only tiny light at their feet. Without light, crossing the sharp, dark bridge over roaring Hellfire is impossible.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜ ŸÖŸêŸëŸÜŸÉŸèŸÖŸí ÿ•ŸêŸÑŸéŸëÿß ŸàŸéÿßÿ±ŸêÿØŸèŸáŸéÿß €ö ŸÉŸéÿßŸÜŸé ÿπŸéŸÑŸéŸâŸ∞ ÿ±Ÿéÿ®ŸêŸëŸÉŸé ÿ≠Ÿéÿ™ŸíŸÖŸãÿß ŸÖŸéŸëŸÇŸíÿ∂ŸêŸäŸãŸëÿß ÿ´ŸèŸÖŸéŸë ŸÜŸèŸÜŸéÿ¨ŸêŸëŸä ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿßÿ™ŸéŸëŸÇŸéŸàÿß\",\n      translation: \"And there is none of you except he will come to it. This is upon your Lord an inevitable decree. Then We will save those who feared Allah.\",\n      source: \"Qur'an 19:71-72\"\n    },\n    keyLesson: \"Everyone must cross the SirƒÅt bridge, and only those with faith and good deeds will pass safely to Paradise.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Display of Fire & Garden\",\n    description: [\n      \"Before crossing the bridge, both Hellfire and Paradise will be shown clearly to all of creation. People will see exactly where they are heading based on their deeds. The sight will fill believers with hope and disbelievers with absolute terror and despair.\",\n      \"Hellfire will roar and rage, breathing out flames so hot they can be felt from far away. Its inhabitants will scream and beg, visible to everyone watching. Disbelievers will realize with horror that this is their destination, with no escape or rescue possible.\",\n      \"Paradise will appear beautiful beyond description, with gardens, rivers, palaces, and unimaginable delights. Believers will long desperately to enter, increasing their hope and gratitude. Seeing both destinations makes the reality of eternal consequences completely clear to everyone assembled.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ®Ÿèÿ±ŸêŸëÿ≤Ÿéÿ™Ÿê ÿßŸÑŸíÿ¨Ÿéÿ≠ŸêŸäŸÖŸè ŸÑŸêŸÖŸéŸÜ ŸäŸéÿ±ŸéŸâŸ∞\",\n      translation: \"And Hellfire will be brought forth for all to see.\",\n      source: \"Qur'an 79:36\"\n    },\n    keyLesson: \"Seeing Hellfire and Paradise displayed will make their reality undeniable, filling hearts with fear or hope based on deeds.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Names of the Day of Judgement\",\n    description: [\n      \"The Day of Judgment has many names in the Qur'an, each revealing a different aspect of its terror and reality. It is called Al-Qiyamah (the Resurrection), Al-Haqah (the Inevitable Truth), Al-Waqiah (the Striking Event), and Al-Ghashiyah (the Overwhelming).\",\n      \"Other names include Yawm al-Hisab (Day of Reckoning), Yawm al-Hasrah (Day of Regret), Yawm al-Taghabun (Day of Mutual Loss and Gain), and Al-Qariah (the Striking Calamity). Each name teaches us about the Day's tremendous importance and unstoppable occurrence.\",\n      \"The many names remind us constantly that this Day is absolutely certain and will come suddenly. No one knows when, but everyone will experience it. Reflecting on these names should increase our preparation through sincere worship, good deeds, and constant repentance.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿéÿß ŸàŸéŸÇŸéÿπŸéÿ™Ÿê ÿßŸÑŸíŸàŸéÿßŸÇŸêÿπŸéÿ©Ÿè ŸÑŸéŸäŸíÿ≥Ÿé ŸÑŸêŸàŸéŸÇŸíÿπŸéÿ™ŸêŸáŸéÿß ŸÉŸéÿßÿ∞Ÿêÿ®Ÿéÿ©Ÿå\",\n      translation: \"When the Event (of Judgment) occurs, there is no denying its occurrence.\",\n      source: \"Qur'an 56:1-2\"\n    },\n    keyLesson: \"The many names for Judgment Day in the Qur'an emphasize its certainty, terror, and the absolute truth that awaits.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Shafa øah of Believers\",\n    description: [\n      \"On Judgment Day, Allah will permit certain righteous believers to intercede for family members and other believers who committed sins. Angels, martyrs, scholars, and those who memorized Qur'an will be granted permission to intercede by Allah's infinite mercy and generosity.\",\n      \"Parents who lost young children will have those children intercede for them, taking their hands and leading them into Paradise. Children who died before puberty are automatically in Paradise and will plead with Allah to admit their believing parents with them.\",\n      \"Intercession only works by Allah's permission and only benefits believers who died with faith, not disbelievers. No one can intercede without Allah allowing it. This shows that while Allah is Just, His mercy surpasses His justice for those who believed in Him sincerely.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜ ÿ∞Ÿéÿß ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿ¥ŸíŸÅŸéÿπŸè ÿπŸêŸÜÿØŸéŸáŸè ÿ•ŸêŸÑŸéŸëÿß ÿ®Ÿêÿ•Ÿêÿ∞ŸíŸÜŸêŸáŸê\",\n      translation: \"Who is it that can intercede with Him except by His permission?\",\n      source: \"Qur'an 2:255\"\n    },\n    keyLesson: \"Believers will intercede for others by Allah's permission, showing that His mercy allows loved ones to help each other.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Mercy of Allah\",\n    description: [\n      \"Allah's mercy on Judgment Day will surpass all understanding. He will multiply good deeds by ten to seven hundred times or more, while sins are recorded only once. His generosity and forgiveness will amaze even the angels witnessing His divine judgment.\",\n      \"Allah will privately show believers their sins and then tell them He concealed these sins in the world and now forgives them completely. Believers will enter Paradise not merely by their deeds but by Allah's tremendous mercy overwhelming their shortcomings despite their efforts.\",\n      \"Those who showed mercy to others will receive mercy from Allah. Those who forgave others will be forgiven. Those who helped the needy will find Allah helping them. Every act of kindness and compassion we showed returns to us magnified on that Day through Allah's grace.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿ±Ÿéÿ≠ŸíŸÖŸéÿ™Ÿé ÿßŸÑŸÑŸéŸëŸáŸê ŸÇŸéÿ±ŸêŸäÿ®Ÿå ŸÖŸêŸëŸÜŸé ÿßŸÑŸíŸÖŸèÿ≠Ÿíÿ≥ŸêŸÜŸêŸäŸÜŸé\",\n      translation: \"Indeed, the mercy of Allah is near to the doers of good.\",\n      source: \"Qur'an 7:56\"\n    },\n    keyLesson: \"Allah's mercy will exceed His justice for believers, forgiving sins and multiplying good deeds beyond what we deserve.\",\n    quizId: 12\n  },\n\n  {\n    id: 13,\n    title: \"Hellfire Justice\",\n    description: [\n      \"Hellfire is the place of eternal punishment for those who died rejecting Allah and His messengers. Its heat is seventy times hotter than earthly fire. Its inhabitants will burn continuously, with skin renewed constantly so they feel pain forever without relief or escape.\",\n      \"People will be punished according to their sins and levels of disbelief and oppression. Some will have fire only at their feet, others up to their ankles, knees, or completely covering them. Punishment matches crimes perfectly through Allah's absolute wisdom and perfect justice.\",\n      \"The greatest punishment will be for those who associated partners with Allah, denied His existence, or led others astray from truth. They will dwell in Hellfire's deepest, hottest levels forever. Their punishment is earned through their own choices, not Allah's cruelty or injustice toward them.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸÑŸéÿß ŸäŸéÿ∏ŸíŸÑŸêŸÖŸè ŸÖŸêÿ´ŸíŸÇŸéÿßŸÑŸé ÿ∞Ÿéÿ±ŸéŸëÿ©Ÿç\",\n      translation: \"Indeed, Allah does not do injustice, even as much as an atom's weight.\",\n      source: \"Qur'an 4:40\"\n    },\n    keyLesson: \"Hellfire's punishment is Allah's perfect justice for those who rejected truth, with each person punished exactly according to their deeds.\",\n    quizId: 13\n  },\n\n  {\n    id: 14,\n    title: \"Paradise Rewards\",\n    description: [\n      \"Paradise is the eternal home of peace, joy, and unimaginable beauty for those who believed in Allah and did good deeds. Its delights are beyond human imagination‚Äîwhatever the heart desires and pleases the eye will be granted instantly without effort or delay.\",\n      \"Gardens flow with rivers of pure water, milk that never spoils, honey that never changes, and wine that doesn't intoxicate or harm. Fruits hang low within easy reach. Palaces are made of gold, silver, and precious stones. Beautiful companions provide perfect company forever.\",\n      \"The greatest pleasure in Paradise is seeing Allah's magnificent Face, which will illuminate everything with divine light. This vision brings joy surpassing all other pleasures combined. Believers will worship Allah in Paradise purely from love, not obligation, experiencing perfect eternal contentment.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÑŸéÿß ÿ™ŸéÿπŸíŸÑŸéŸÖŸè ŸÜŸéŸÅŸíÿ≥Ÿå ŸÖŸéŸëÿß ÿ£ŸèÿÆŸíŸÅŸêŸäŸé ŸÑŸéŸáŸèŸÖ ŸÖŸêŸëŸÜ ŸÇŸèÿ±ŸéŸëÿ©Ÿê ÿ£ŸéÿπŸíŸäŸèŸÜŸç ÿ¨Ÿéÿ≤Ÿéÿßÿ°Ÿã ÿ®ŸêŸÖŸéÿß ŸÉŸéÿßŸÜŸèŸàÿß ŸäŸéÿπŸíŸÖŸéŸÑŸèŸàŸÜŸé\",\n      translation: \"And no soul knows what has been hidden for them of comfort for eyes as reward for what they used to do.\",\n      source: \"Qur'an 32:17\"\n    },\n    keyLesson: \"Paradise offers eternal, unimaginable rewards that surpass all worldly pleasures, with Allah's vision being the greatest joy of all.\",\n    quizId: 14\n  },\n\n  {\n    id: 15,\n    title: \"Final Judgement\",\n    description: [\n      \"After all accounts are settled, deeds weighed, and records examined, Allah will pronounce the final judgment on each person. The righteous will be told to enter Paradise from whichever gate they choose. The wicked will be driven toward Hellfire in chains and disgrace.\",\n      \"Angels will escort believers to Paradise's gates, which will open wide in welcome and honor. They will enter with joy, peace, and gratitude, greeted by angels saying 'Peace be upon you; you have become pure, so enter it to abide eternally therein.'\",\n      \"Disbelievers will be dragged toward Hellfire by harsh angels. The gates will slam shut behind them forever. They will realize too late that they wasted their chance in the worldly life. Their regret will be eternal, but regret after death brings no benefit or second chance.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ≥ŸêŸäŸÇŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿßÿ™ŸéŸëŸÇŸéŸàŸíÿß ÿ±Ÿéÿ®ŸéŸëŸáŸèŸÖŸí ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ÿ≤ŸèŸÖŸéÿ±Ÿãÿß\",\n      translation: \"And those who feared their Lord will be led to Paradise in groups.\",\n      source: \"Qur'an 39:73\"\n    },\n    keyLesson: \"The final judgment separates humanity forever into Paradise or Hellfire based on faith and deeds, with no further chances.\",\n    quizId: 15\n  },\n\n  {\n    id: 16,\n    title: \"Reflection & Accountability\",\n    description: [\n      \"The Day of Judgment reminds us that this life is a test and every action matters eternally. We will stand alone before Allah, without wealth, status, or family to help us. Only our faith and righteous deeds will benefit us on that tremendous, frightening Day.\",\n      \"Knowing about Judgment Day should change how we live today. We should pray sincerely, treat others kindly, avoid sins, seek forgiveness constantly, and remember death often. Every day is an opportunity to prepare our record and increase our good deeds before time runs out forever.\",\n      \"We must balance hope in Allah's mercy with fear of His punishment. Neither extreme despair nor false security is correct. The wise believer works hard doing good deeds while hoping for Allah's mercy, knowing that Paradise is earned through both personal effort and divine grace combined.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÖŸéŸÜ ŸäŸéÿπŸíŸÖŸéŸÑŸí ŸÖŸêÿ´ŸíŸÇŸéÿßŸÑŸé ÿ∞Ÿéÿ±ŸéŸëÿ©Ÿç ÿÆŸéŸäŸíÿ±Ÿãÿß ŸäŸéÿ±ŸéŸáŸè ŸàŸéŸÖŸéŸÜ ŸäŸéÿπŸíŸÖŸéŸÑŸí ŸÖŸêÿ´ŸíŸÇŸéÿßŸÑŸé ÿ∞Ÿéÿ±ŸéŸëÿ©Ÿç ÿ¥Ÿéÿ±ŸãŸëÿß ŸäŸéÿ±ŸéŸáŸè\",\n      translation: \"So whoever does an atom's weight of good will see it, and whoever does an atom's weight of evil will see it.\",\n      source: \"Qur'an 99:7-8\"\n    },\n    keyLesson: \"Reflecting on accountability motivates us to live righteously today, preparing carefully for the eternal consequences of every choice we make.\",\n    quizId: 16\n  }\n];\n\nexport default judgementLessons;\n","path":null,"size_bytes":22270,"size_tokens":null},"src/data/lessons/foundationsLessons.js":{"content":"// Foundations of Islam Learning Path\n// 17 lessons divided into 3 sections\n// Each lesson: 4 paragraphs of ~30 words each\n\nconst foundationsLessons = [\n  // ============================================================\n  // SECTION 1: The Five Pillars of Islam (Lessons 1-5)\n  // ============================================================\n  \n  {\n    id: 1,\n    title: \"Shahadah\",\n    arabic: \"ÿßŸÑÿ¥ŸéŸëŸáŸéÿßÿØŸéÿ©\",\n    meaning: \"The Declaration of Faith\",\n    description: [\n      \"The Shahadah is Islam's foundation. When we declare 'There is no god but Allah, and Muhammad Ô∑∫ is His Messenger,' we testify Allah alone deserves worship. This opens the door to Islam.\",\n      \"The declaration requires belief in the heart, understanding of meaning, and sincere action. We reject all false gods and obey Allah's commands. Without this belief, worship has no meaning.\",\n      \"The Prophet Ô∑∫ taught that whoever sincerely says the Shahadah and dies upon it will enter Paradise. It purifies the heart, gives life purpose, and frees us from slavery to creation.\",\n      \"Every Muslim should renew their Shahadah daily, reflecting on its deep meaning. From morning until night, this declaration defines who we are as believers and guides our entire lives.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ŸÇŸéÿßŸÑŸé ŸÑŸéÿß ÿ•ŸêŸÑŸéŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéŸÖŸéÿßÿ™Ÿé ÿπŸéŸÑŸéŸâ ÿ∞ŸéŸÑŸêŸÉŸé ÿØŸéÿÆŸéŸÑŸé ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé\",\n      translation: \"Whoever says 'There is no god but Allah' and dies upon that will enter Paradise.\",\n      source: \"Sahih Bukhari\"\n    },\n    reflection: \"How does knowing the deep meaning of the Shahadah strengthen your daily worship?\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Salah\",\n    arabic: \"ÿßŸÑÿµŸéŸëŸÑÿßÿ©\",\n    meaning: \"The Five Daily Prayers\",\n    description: [\n      \"Salah is Islam's second pillar. Muslims pray five times daily: Fajr, Dhuhr, Asr, Maghrib, and Isha. These prayers are intimate conversations with Allah, moments of submission, gratitude, and humility.\",\n      \"Prayer is the first thing questioned on Judgment Day. If our prayers are sound, our deeds are sound. Salah cleanses minor sins like bathing five times daily cleanses the body.\",\n      \"When we pray, we leave worldly distractions behind. We bow in humility, prostrate in submission. This physical worship trains us to obey Allah in all aspects of life with discipline and patience.\",\n      \"Salah brings peace to anxious hearts and strength to face challenges. Through prayer, we ask forgiveness, guidance, and blessings. These daily appointments reconnect our hearts and recharge our faith throughout each day.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÇŸêŸÖŸê ÿßŸÑÿµŸéŸëŸÑŸéÿßÿ©Ÿé ŸÑŸêÿ∞ŸêŸÉŸíÿ±ŸêŸä\",\n      translation: \"Establish prayer for My remembrance.\",\n      source: \"Qur'an 20:14\"\n    },\n    reflection: \"How can you improve the quality and presence of heart in your daily prayers?\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Zakah\",\n    arabic: \"ÿßŸÑÿ≤ŸéŸëŸÉŸéÿßÿ©\",\n    meaning: \"Purifying Wealth Through Charity\",\n    description: [\n      \"Zakah is Islam's third pillar. Muslims give 2.5% of their wealth yearly to help the poor and needy. It's mandatory charity that purifies wealth and hearts from greed. Everything we own is Allah's trust.\",\n      \"Zakah purifies us from spiritual corruption. When we refuse to share, hearts become hard. When we give for Allah's sake, hearts soften with compassion. Rich and poor are equal before Allah.\",\n      \"The Prophet Ô∑∫ taught that charity never decreases wealth but increases it. When we give sincerely, Allah blesses what remains and multiplies our reward in the Hereafter beyond imagination.\",\n      \"Zakah purifies hearts from materialism and trains us to be generous. It reduces poverty and builds community through mercy and support. On Judgment Day, charity waits as treasure in Paradise for those who gave.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸèÿ∞Ÿí ŸÖŸêŸÜŸí ÿ£ŸéŸÖŸíŸàŸéÿßŸÑŸêŸáŸêŸÖŸí ÿµŸéÿØŸéŸÇŸéÿ©Ÿã ÿ™Ÿèÿ∑ŸéŸáŸêŸëÿ±ŸèŸáŸèŸÖŸí ŸàŸéÿ™Ÿèÿ≤ŸéŸÉŸêŸëŸäŸáŸêŸÖ ÿ®ŸêŸáŸéÿß\",\n      translation: \"Take from their wealth a charity to purify them and sanctify them with it.\",\n      source: \"Qur'an 9:103\"\n    },\n    reflection: \"How does giving Zakah change your relationship with wealth and those in need?\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Sawm\",\n    arabic: \"ÿßŸÑÿµŸéŸëŸàŸíŸÖ\",\n    meaning: \"Fasting in Ramadan\",\n    description: [\n      \"Sawm means fasting during Ramadan. From dawn to sunset, Muslims abstain from food, drink, and desires. Fasting is spiritual training that teaches self-control, patience, gratitude, and God-consciousness called taqwa.\",\n      \"Allah prescribed fasting to make us righteous. It's not just avoiding food, but training ourselves to obey Allah completely. We fast with eyes, tongues, and hearts from everything forbidden and corrupt.\",\n      \"Ramadan is blessed with Qur'an recitation, night prayers, charity, and repentance. Paradise gates open, Hell gates close, devils are chained. Laylatul Qadr is better than a thousand months of worship.\",\n      \"The Prophet Ô∑∫ said whoever fasts Ramadan with faith and hope has all previous sins forgiven. Fasting purifies body and soul, teaches empathy for the hungry, and reminds us our deepest need is Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ŸÉŸèÿ™Ÿêÿ®Ÿé ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸè ÿßŸÑÿµŸêŸëŸäŸéÿßŸÖŸè ŸÉŸéŸÖŸéÿß ŸÉŸèÿ™Ÿêÿ®Ÿé ÿπŸéŸÑŸéŸâ ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸÉŸèŸÖŸí ŸÑŸéÿπŸéŸÑŸéŸëŸÉŸèŸÖŸí ÿ™Ÿéÿ™ŸéŸëŸÇŸèŸàŸÜŸé\",\n      translation: \"O you who believe, fasting is prescribed for you as it was prescribed for those before you, that you may become righteous.\",\n      source: \"Qur'an 2:183\"\n    },\n    reflection: \"What spiritual benefits have you gained or hope to gain from fasting?\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Hajj\",\n    arabic: \"ÿßŸÑÿ≠Ÿéÿ¨Ÿë\",\n    meaning: \"The Pilgrimage to Makkah\",\n    description: [\n      \"Hajj is Islam's fifth pillar, the sacred journey to Makkah. Muslims perform rituals established by Prophet Ibrahim and completed by Prophet Muhammad Ô∑∫. Every able Muslim must perform Hajj once in life.\",\n      \"Pilgrims wear simple white Ihram clothing. There are no distinctions of wealth, status, race, or nationality. Kings and beggars stand equal before Allah. This experience teaches humility and breaks down pride and arrogance.\",\n      \"Hajj rituals include circling the Kaaba seven times, standing at Mount Arafat in prayer, walking between Safa and Marwah, and stoning pillars representing Shaytan. Every step connects us to our prophets' legacy.\",\n      \"The Prophet Ô∑∫ taught that sincere Hajj returns pilgrims pure as newborns. This transformative journey offers a complete spiritual reset. Pilgrims return home with changed hearts, strengthened faith, and deeper love for Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£Ÿéÿ∞ŸêŸëŸÜ ŸÅŸêŸä ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê ÿ®ŸêÿßŸÑŸíÿ≠Ÿéÿ¨ŸêŸë ŸäŸéÿ£Ÿíÿ™ŸèŸàŸÉŸé ÿ±Ÿêÿ¨ŸéÿßŸÑŸãÿß ŸàŸéÿπŸéŸÑŸéŸâŸ∞ ŸÉŸèŸÑŸêŸë ÿ∂ŸéÿßŸÖŸêÿ±Ÿç ŸäŸéÿ£Ÿíÿ™ŸêŸäŸÜŸé ŸÖŸêŸÜ ŸÉŸèŸÑŸêŸë ŸÅŸéÿ¨ŸçŸë ÿπŸéŸÖŸêŸäŸÇŸç\",\n      translation: \"And proclaim to the people the Hajj; they will come to you on foot and on every lean camel from every distant pass.\",\n      source: \"Qur'an 22:27\"\n    },\n    reflection: \"How does the unity shown in Hajj inspire you to live with humility and respect?\",\n    quizId: 5\n  },\n\n  // ============================================================\n  // SECTION 2: The Six Pillars of Belief (ƒ™mƒÅn) (Lessons 6-11)\n  // ============================================================\n\n  {\n    id: 6,\n    title: \"Belief in Allah\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑŸÑŸëŸ∞Ÿá\",\n    meaning: \"The First Pillar of Faith\",\n    description: [\n      \"Belief in Allah is the foundation of Islamic faith. We believe Allah is absolutely One, with no partners or equals. He created everything and is completely self-sufficient while all creation needs Him.\",\n      \"We believe in Allah's beautiful names and perfect attributes. He is Ar-Rahman, Al-Hakim, Al-Qawiyy, and Al-Aleem. He hears every word, sees every action, and knows what's hidden in hearts. Nothing resembles Him.\",\n      \"Worshipping Allah alone means we don't bow to idols, money, fame, or creation. We direct all worship to Allah alone. This is Tawheed, the core message of every prophet throughout history.\",\n      \"The Prophet Ô∑∫ taught Allah has ninety-nine beautiful names. Learning them helps us understand His mercy, justice, and wisdom. Belief in Allah fills hearts with peace, gratitude, hope, strength, and contentment in all situations.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ŸáŸèŸàŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ£Ÿéÿ≠ŸéÿØŸå €ù ÿßŸÑŸÑŸéŸëŸáŸè ÿßŸÑÿµŸéŸëŸÖŸéÿØŸè €ù ŸÑŸéŸÖŸí ŸäŸéŸÑŸêÿØŸí ŸàŸéŸÑŸéŸÖŸí ŸäŸèŸàŸÑŸéÿØŸí €ù ŸàŸéŸÑŸéŸÖŸí ŸäŸéŸÉŸèŸÜ ŸÑŸéŸëŸáŸè ŸÉŸèŸÅŸèŸàŸãÿß ÿ£Ÿéÿ≠ŸéÿØŸå\",\n      translation: \"Say, He is Allah, the One. Allah, the Eternal Refuge. He neither begets nor is born, nor is there to Him any equivalent.\",\n      source: \"Qur'an 112:1-4\"\n    },\n    reflection: \"Which of Allah's names brings you the most comfort and why?\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Belief in Angels\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©\",\n    meaning: \"The Noble Servants of Allah\",\n    description: [\n      \"Angels are noble beings created from light. Unlike humans, they never disobey Allah. They worship constantly without tiring, sleeping, or resting. Angels don't eat, drink, marry, or have children. Their numbers are beyond counting.\",\n      \"Well-known angels include Jibra'il who brought revelation, Mikail who controls rain and provision, Israfil who will blow the trumpet, and the Angel of Death. Angels of mercy pray for believers while angels of punishment execute justice.\",\n      \"Two angels sit on our shoulders recording every deed. Raqib writes good deeds, Atid writes bad deeds. They record everything we do, say, and intend. On Judgment Day, we'll see our complete record presented.\",\n      \"Angels surround gatherings of remembrance and Qur'an study. The Prophet Ô∑∫ said angels lower their wings for knowledge seekers. Believing in angels reminds us we're never alone and helps us be more conscious of Allah.\"\n    ],\n    evidence: {\n      arabic: \"ÿ¢ŸÖŸéŸÜŸé ÿßŸÑÿ±ŸéŸëÿ≥ŸèŸàŸÑŸè ÿ®ŸêŸÖŸéÿß ÿ£ŸèŸÜÿ≤ŸêŸÑŸé ÿ•ŸêŸÑŸéŸäŸíŸáŸê ŸÖŸêŸÜ ÿ±ŸéŸëÿ®ŸêŸëŸáŸê ŸàŸéÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸèŸàŸÜŸé €ö ŸÉŸèŸÑŸåŸë ÿ¢ŸÖŸéŸÜŸé ÿ®ŸêÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ™ŸêŸáŸê ŸàŸéŸÉŸèÿ™Ÿèÿ®ŸêŸáŸê ŸàŸéÿ±Ÿèÿ≥ŸèŸÑŸêŸáŸê\",\n      translation: \"The Messenger has believed in what was revealed to him from his Lord, and so have the believers. All of them believe in Allah, His angels, His books, and His messengers.\",\n      source: \"Qur'an 2:285\"\n    },\n    reflection: \"How does knowing angels record your deeds change your daily actions?\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Belief in the Revealed Books\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑŸíŸÉŸèÿ™Ÿèÿ®\",\n    meaning: \"The Divine Scriptures\",\n    description: [\n      \"Allah sent divine books throughout history to guide humanity. Major books include the Tawrah to Musa, Zabur to Dawud, Injil to Isa, and Qur'an to Muhammad Ô∑∫. All originally shared one message: worship One God.\",\n      \"The Qur'an is Allah's final, complete revelation. Revealed over twenty-three years through angel Jibra'il, it contains guidance for all life aspects. Unlike previous scriptures, the Qur'an is universal and timeless for all people.\",\n      \"The Qur'an has been perfectly preserved in Arabic for over fourteen hundred years without change. Allah promises to protect it until Judgment Day. Muslims worldwide recite the exact same Qur'an. Millions have memorized it entirely.\",\n      \"The Prophet Ô∑∫ said the best are those who learn and teach Qur'an. It's not just a book on shelves but a living guide to read, understand, memorize, and live by faithfully every single day.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ŸÜŸéÿ≠ŸíŸÜŸè ŸÜŸéÿ≤ŸéŸëŸÑŸíŸÜŸéÿß ÿßŸÑÿ∞ŸêŸëŸÉŸíÿ±Ÿé ŸàŸéÿ•ŸêŸÜŸéŸëÿß ŸÑŸéŸáŸè ŸÑŸéÿ≠ŸéÿßŸÅŸêÿ∏ŸèŸàŸÜŸé\",\n      translation: \"Indeed, it is We who sent down the Qur'an, and indeed, We will be its guardian.\",\n      source: \"Qur'an 15:9\"\n    },\n    reflection: \"How often do you read and reflect on the Qur'an?\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Belief in the Prophets\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑÿ±ŸèŸëÿ≥ŸèŸÑ\",\n    meaning: \"The Messengers of Allah\",\n    description: [\n      \"Throughout history, Allah sent prophets to every nation teaching Tawheed. These chosen men were the best of humanity, known for honesty, trustworthiness, and strong character. They faced persecution but remained patient and steadfast.\",\n      \"Known prophets include Adam, Nuh, Ibrahim, Musa, Isa, and Muhammad Ô∑∫. Thousands more existed whose names we don't know. All taught the same core message: worship Allah alone, live righteously, and prepare for Judgment.\",\n      \"Prophet Muhammad Ô∑∫ is the final messenger. No prophet will come after him. He's called the Seal of Prophets. His message is universal for all people and times. Loving and following him is a sign of true faith.\",\n      \"Belief in prophets means respecting all equally without rejection or worship. Prophets were human but were the best examples of righteous living. Studying their lives teaches us patience, courage, honesty, and devotion to Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸëÿß ŸÉŸéÿßŸÜŸé ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸå ÿ£Ÿéÿ®Ÿéÿß ÿ£Ÿéÿ≠ŸéÿØŸç ŸÖŸêŸëŸÜ ÿ±ŸêŸëÿ¨ŸéÿßŸÑŸêŸÉŸèŸÖŸí ŸàŸéŸÑŸéŸ∞ŸÉŸêŸÜ ÿ±ŸéŸëÿ≥ŸèŸàŸÑŸé ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿÆŸéÿßÿ™ŸéŸÖŸé ÿßŸÑŸÜŸéŸëÿ®ŸêŸäŸêŸëŸäŸÜŸé\",\n      translation: \"Muhammad Ô∑∫ is not the father of any of your men, but he is the Messenger of Allah and the Seal of the Prophets.\",\n      source: \"Qur'an 33:40\"\n    },\n    reflection: \"How can you follow the example of the Prophet Ô∑∫ in your daily life?\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Belief in the Day of Judgement\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑŸíŸäŸéŸàŸíŸÖŸê ÿßŸÑÿ¢ÿÆŸêÿ±\",\n    meaning: \"The Final Accountability\",\n    description: [\n      \"This world will end when Israfil blows the trumpet. Everything will die instantly. The sun will darken, stars fall, mountains crumble, and oceans boil. Everything will be destroyed. Then Allah will resurrect everyone for judgment.\",\n      \"Each person stands alone before Allah. Our books of deeds will open. Nothing is hidden. Every word, action, and intention will be exposed. Our bodies will testify. The scales will weigh our deeds with perfect precision. Allah will judge with perfect justice.\",\n      \"Those who believed and did good receive records in their right hand and enter Paradise eternally. Those who rejected Allah receive records in their left hand and are thrown into Hellfire eternally. No escaping fate.\",\n      \"Belief in Judgment Day impacts how we live today. Every action has consequences. It motivates good deeds and warns against evil. It gives hope to the oppressed and warns wrongdoers to repent before it's too late.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜŸéŸë ÿßŸÑÿØŸêŸëŸäŸÜŸé ŸÑŸéŸàŸéÿßŸÇŸêÿπŸå\",\n      translation: \"And indeed, the Day of Recompense is to occur.\",\n      source: \"Qur'an 51:6\"\n    },\n    reflection: \"How does remembering Judgment Day affect your daily choices?\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Belief in Divine Decree (Qadr)\",\n    arabic: \"ÿßŸÑÿ•ŸêŸäŸÖŸéÿßŸÜŸè ÿ®ŸêÿßŸÑŸíŸÇŸéÿØŸéÿ±\",\n    meaning: \"Trusting Allah's Perfect Plan\",\n    description: [\n      \"Qadr means Allah knows everything that will happen. Before creating the universe, He wrote everything in the Preserved Tablet. Nothing occurs without Allah's knowledge and will. This doesn't remove our free will or responsibility for choices.\",\n      \"Belief in Qadr brings peace and contentment. When good happens, we thank Allah. When difficulty comes, we remain patient, trusting His wisdom. The Prophet Ô∑∫ said the believer's affair is amazing‚Äîgrateful in ease, patient in hardship.\",\n      \"Qadr doesn't mean sitting passively. We must work hard, plan wisely, and strive with effort. After doing our best, we trust Allah with results. Sometimes what seems bad is good. Only Allah sees the full picture clearly.\",\n      \"Understanding Qadr protects us from arrogance and despair. When we succeed, we don't become proud because everything is from Allah. When we fail, we don't lose hope because Allah has a wise reason. We trust His perfect plan completely.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ŸÉŸèŸÑŸéŸë ÿ¥ŸéŸäŸíÿ°Ÿç ÿÆŸéŸÑŸéŸÇŸíŸÜŸéÿßŸáŸè ÿ®ŸêŸÇŸéÿØŸéÿ±Ÿç\",\n      translation: \"Indeed, We have created everything in precise measure.\",\n      source: \"Qur'an 54:49\"\n    },\n    reflection: \"How does trusting Allah's plan help you through difficult times?\",\n    quizId: 11\n  },\n\n  // ============================================================\n  // SECTION 3: Living Islam (Lessons 12-17)\n  // ============================================================\n\n  {\n    id: 12,\n    title: \"Sincerity (Ikhlas)\",\n    arabic: \"ÿßŸÑÿ•ŸêÿÆŸíŸÑŸéÿßÿµ\",\n    meaning: \"Doing Everything for Allah Alone\",\n    description: [\n      \"Ikhlas means performing actions purely for Allah's sake, not seeking praise or recognition from people. The Prophet Ô∑∫ taught that actions are judged by intentions. Without sincerity, even great deeds are worthless in Allah's sight.\",\n      \"Many perform good deeds publicly to impress others or gain fame. If that's the intention, reward is lost. True sincerity means doing what's right whether people see or not, seeking only Allah's pleasure, not human approval.\",\n      \"Maintaining sincerity is difficult because Shaytan whispers, 'What will people think?' These thoughts destroy reward and turn worship into showing off. Constantly check intentions: Am I doing this for Allah or to impress others?\",\n      \"With Ikhlas, even small actions become great in Allah's sight. A sincere smile can outweigh large public acts done for show. Sincerity purifies hearts from pride and brings blessing to everything we do. Seek only Allah's pleasure.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ÿ£ŸèŸÖŸêÿ±ŸèŸàÿß ÿ•ŸêŸÑŸéŸëÿß ŸÑŸêŸäŸéÿπŸíÿ®ŸèÿØŸèŸàÿß ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸèÿÆŸíŸÑŸêÿµŸêŸäŸÜŸé ŸÑŸéŸáŸè ÿßŸÑÿØŸêŸëŸäŸÜŸé\",\n      translation: \"And they were not commanded except to worship Allah, being sincere to Him in religion.\",\n      source: \"Qur'an 98:5\"\n    },\n    reflection: \"Are your good deeds done for Allah or to impress others?\",\n    quizId: 12\n  },\n\n  {\n    id: 13,\n    title: \"Good Manners (Akhlaq)\",\n    arabic: \"ÿßŸÑÿ£ŸéÿÆŸíŸÑŸéÿßŸÇ\",\n    meaning: \"The Character of a Muslim\",\n    description: [\n      \"Akhlaq means good character and manners. Islam is not just about praying and fasting, but how we treat people with kindness, respect, and dignity. The Prophet Ô∑∫ said believers with the most complete faith have the best character.\",\n      \"Good manners include truthfulness, kindness, charity, forgiveness, and modesty. It means speaking gently, smiling warmly, helping others without expecting return, and controlling anger. The Prophet Ô∑∫ exemplified perfect character. He's our model in everything.\",\n      \"Bad manners destroy good deeds. A person may pray all night but if they're rude or dishonest, their worship means little. The Prophet Ô∑∫ warned some people's fasting is only hunger because they don't change bad behavior.\",\n      \"Improving Akhlaq is a lifelong journey. We must always strive to be more patient, forgiving, compassionate, and humble. When we make mistakes, we apologize and try again. Good character is the heaviest thing on the scale of deeds.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ŸÖŸêŸÜŸí ÿ£Ÿéÿ≠Ÿéÿ®ŸêŸëŸÉŸèŸÖŸí ÿ•ŸêŸÑŸéŸäŸéŸë ŸàŸéÿ£ŸéŸÇŸíÿ±Ÿéÿ®ŸêŸÉŸèŸÖŸí ŸÖŸêŸÜŸêŸëŸä ŸÖŸéÿ¨ŸíŸÑŸêÿ≥Ÿãÿß ŸäŸéŸàŸíŸÖŸé ÿßŸÑŸíŸÇŸêŸäŸéÿßŸÖŸéÿ©Ÿê ÿ£Ÿéÿ≠Ÿéÿßÿ≥ŸêŸÜŸèŸÉŸèŸÖŸí ÿ£ŸéÿÆŸíŸÑŸéÿßŸÇŸãÿß\",\n      translation: \"The most beloved of you to me and the closest to me on the Day of Resurrection are those with the best character.\",\n      source: \"Jami' at-Tirmidhi\"\n    },\n    reflection: \"What is one aspect of your character you can improve this week?\",\n    quizId: 13\n  },\n\n  {\n    id: 14,\n    title: \"Intention (Niyyah)\",\n    arabic: \"ÿßŸÑŸÜŸêŸëŸäŸéŸëÿ©\",\n    meaning: \"The Purpose Behind Every Action\",\n    description: [\n      \"Niyyah is the intention in our hearts before any action. The Prophet Ô∑∫ taught that actions are judged by intentions. Two people can do the same deed, but one is rewarded while the other receives nothing due to different intentions.\",\n      \"Every worship requires sincere intention. With the right intention, everyday actions become worship. Eating to gain strength for worship becomes worship. Working to earn halal income becomes worship. Smiling to please Allah becomes worship.\",\n      \"Intention is not said aloud. It's what we feel in our hearts. Simply saying 'I intend to pray' without meaning it doesn't count. The heart must align with the action. Pure intention purifies deeds and multiplies reward.\",\n      \"Renew intention frequently throughout the day. Before studying, intend to gain knowledge for Allah. Before helping someone, intend to earn His pleasure. With right intention, every moment becomes worship and brings immense reward from Allah.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸÖŸéÿß ÿßŸÑŸíÿ£ŸéÿπŸíŸÖŸéÿßŸÑŸè ÿ®ŸêÿßŸÑŸÜŸêŸëŸäŸéŸëÿßÿ™Ÿê ŸàŸéÿ•ŸêŸÜŸéŸëŸÖŸéÿß ŸÑŸêŸÉŸèŸÑŸêŸë ÿßŸÖŸíÿ±Ÿêÿ¶Ÿç ŸÖŸéÿß ŸÜŸéŸàŸéŸâ\",\n      translation: \"Actions are judged by intentions, and every person will be rewarded according to what they intended.\",\n      source: \"Sahih Bukhari & Muslim\"\n    },\n    reflection: \"How can you turn your daily routine into acts of worship through intention?\",\n    quizId: 14\n  },\n\n  {\n    id: 15,\n    title: \"Gratitude (Shukr)\",\n    arabic: \"ÿßŸÑÿ¥ŸèŸëŸÉŸíÿ±\",\n    meaning: \"Being Thankful to Allah\",\n    description: [\n      \"Shukr means thanking Allah for countless blessings. We have health, family, food, water, and faith. Yet we often take these for granted and forget to thank the One who gave them. We complain about what we lack instead of being grateful.\",\n      \"Gratitude is shown through three ways: recognizing blessings in the heart, praising Allah with the tongue, and using blessings to obey Him. It's not enough to feel grateful‚Äîwe must express it through words and actions.\",\n      \"Allah promises that if we are grateful, He will increase our blessings. If we are ungrateful, His punishment is severe. Gratitude attracts more blessings. Complaining pushes them away. The more we thank Allah, the more He gives us.\",\n      \"Every night before sleep, reflect on the day's blessings. Say Alhamdulillah for everything‚Äîgood health, food, family, a bed to sleep in. Gratitude transforms our perspective. Even in hardship, we find blessings. Grateful hearts are happy hearts always.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿ¶ŸêŸÜ ÿ¥ŸéŸÉŸéÿ±Ÿíÿ™ŸèŸÖŸí ŸÑŸéÿ£Ÿéÿ≤ŸêŸäÿØŸéŸÜŸéŸëŸÉŸèŸÖŸí €ñ ŸàŸéŸÑŸéÿ¶ŸêŸÜ ŸÉŸéŸÅŸéÿ±Ÿíÿ™ŸèŸÖŸí ÿ•ŸêŸÜŸéŸë ÿπŸéÿ∞Ÿéÿßÿ®ŸêŸä ŸÑŸéÿ¥ŸéÿØŸêŸäÿØŸå\",\n      translation: \"If you are grateful, I will surely increase you in favor; but if you deny, indeed, My punishment is severe.\",\n      source: \"Qur'an 14:7\"\n    },\n    reflection: \"What are three blessings you often take for granted?\",\n    quizId: 15\n  },\n\n  {\n    id: 16,\n    title: \"Consistency (Istiqamah)\",\n    arabic: \"ÿßŸÑÿßŸêÿ≥Ÿíÿ™ŸêŸÇŸéÿßŸÖŸéÿ©\",\n    meaning: \"Staying Steadfast on the Straight Path\",\n    description: [\n      \"Istiqamah means steadfastness‚Äîstaying firm on the straight path in all circumstances. The Prophet Ô∑∫ said the most beloved deeds to Allah are those done consistently, even if small. Small, regular deeds are better than large, sporadic ones.\",\n      \"Many people worship enthusiastically in Ramadan but neglect worship afterward. This inconsistency displeases Allah. True faith is shown through consistent worship throughout the year in good times and bad, when easy and when difficult.\",\n      \"Consistency builds discipline and strengthens our relationship with Allah over time. Praying the same voluntary prayers daily becomes strong habit. Reading one page of Qur'an daily finishes it in a year. Small actions compound into mountains of reward.\",\n      \"To stay consistent, start small and build slowly. Don't take on more than you can handle long-term. If you can read one verse daily, do that consistently. Consistency is about commitment, not intensity. Make worship a lifestyle, not a sprint.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿéÿ≠Ÿéÿ®ŸèŸë ÿßŸÑŸíÿ£ŸéÿπŸíŸÖŸéÿßŸÑŸê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéÿØŸíŸàŸéŸÖŸèŸáŸéÿß ŸàŸéÿ•ŸêŸÜŸí ŸÇŸéŸÑŸéŸë\",\n      translation: \"The most beloved of deeds to Allah are those that are most consistent, even if they are small.\",\n      source: \"Sahih Bukhari & Muslim\"\n    },\n    reflection: \"What is one small act of worship you can commit to doing daily?\",\n    quizId: 16\n  },\n\n  {\n    id: 17,\n    title: \"Love for Allah and His Messenger Ô∑∫\",\n    arabic: \"ÿßŸÑŸÖŸéÿ≠Ÿéÿ®ŸéŸëÿ©\",\n    meaning: \"The Foundation of True Faith\",\n    description: [\n      \"Love for Allah and His Messenger Ô∑∫ is the foundation of true faith. It's not enough to just believe or say we're Muslim. We must love Allah deeply with our hearts more than anything else‚Äîparents, children, wealth, or even our own lives.\",\n      \"How do we know if we truly love Allah? By how much we obey Him. Love is proven through obedience, not just feelings. If we love Allah, we follow His commands, avoid prohibitions, and seek to please Him over our own desires.\",\n      \"Love for the Prophet Ô∑∫ means following his example in everything: how he prayed, spoke, ate, treated others, and handled hardship. When we love him, we make his Sunnah a living part of our daily lives. True love means sincere imitation.\",\n      \"This love requires action and commitment. It means putting Allah's pleasure above our desires and the Hereafter above this world. When love for Allah fills the heart, everything falls into place. Life becomes full of purpose, peace, and joy.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ÿ•ŸêŸÜ ŸÉŸèŸÜÿ™ŸèŸÖŸí ÿ™Ÿèÿ≠Ÿêÿ®ŸèŸëŸàŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸé ŸÅŸéÿßÿ™ŸéŸëÿ®ŸêÿπŸèŸàŸÜŸêŸä ŸäŸèÿ≠Ÿíÿ®Ÿêÿ®ŸíŸÉŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸè\",\n      translation: \"Say, if you truly love Allah, then follow me; Allah will love you.\",\n      source: \"Qur'an 3:31\"\n    },\n    reflection: \"How can you show your love for Allah through your daily actions?\",\n    quizId: 17\n  }\n];\n\nexport default foundationsLessons;\n","path":null,"size_bytes":26629,"size_tokens":null},"src/data/lessons/angelsLessons.js":{"content":"// Angels ‚Äì Messengers of Light Learning Path\n// 11 lessons about Angels in Islam\n// Each lesson: 3 paragraphs (~30 words each), authentic evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, and Sahih Muslim\n\nconst angelsLessons = [\n  {\n    id: 1,\n    title: \"Jibra'il (Gabriel)\",\n    description: [\n      \"Jibra'il is the greatest angel, responsible for delivering Allah's revelation to all the prophets throughout history. He brought the Qur'an to Prophet Muhammad Ô∑∫ over twenty-three years, teaching him word by word with perfect accuracy and divine wisdom.\",\n      \"The Prophet Ô∑∫ saw Jibra'il in his true angelic form twice, with six hundred wings covering the horizon. He described Jibra'il's magnificent appearance as filling the entire sky, demonstrating the immense power and glory Allah gave to His chosen messenger angel.\",\n      \"Jibra'il also descended to earth in human form to teach the companions about Islam. He asked the Prophet Ô∑∫ about faith, Islam, and excellence while the companions listened, teaching them their religion's foundations through questions and answers directly from Allah's messenger.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéŸÑŸéŸëŸÖŸéŸáŸè ÿ¥ŸéÿØŸêŸäÿØŸè ÿßŸÑŸíŸÇŸèŸàŸéŸâŸ∞ ÿ∞ŸèŸà ŸÖŸêÿ±ŸéŸëÿ©Ÿç ŸÅŸéÿßÿ≥Ÿíÿ™ŸéŸàŸéŸâŸ∞\",\n      translation: \"Taught to him by one intense in strength - one of soundness. And he rose to his true form.\",\n      source: \"Qur'an 53:5-6\"\n    },\n    keyLesson: \"Jibra'il brought Allah's guidance to humanity, making him the bridge between the Divine and mankind through revelation.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Mƒ´kƒÅ'ƒ´l (Michael)\",\n    description: [\n      \"Mƒ´kƒÅ'ƒ´l is the angel responsible for distributing rain and provisions to all of Allah's creation. He controls the winds and clouds, sending rain to every corner of the earth exactly according to Allah's perfect wisdom and divine decree for sustaining life.\",\n      \"Allah created Mƒ´kƒÅ'ƒ´l to manage the natural world's sustenance, ensuring every creature receives exactly what Allah has decreed for them. He oversees the growth of crops, the flowing of rivers, and the distribution of resources throughout the earth with perfect precision.\",\n      \"The Prophet Ô∑∫ taught us to seek Allah's protection by mentioning Mƒ´kƒÅ'ƒ´l along with Jibra'il. This shows Mƒ´kƒÅ'ƒ´l's high rank among the angels and his crucial role in Allah's creation, maintaining the balance and provision that sustains all living things on earth.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜ ŸÉŸéÿßŸÜŸé ÿπŸéÿØŸèŸàŸãŸëÿß ŸÑŸêŸëŸÑŸéŸëŸáŸê ŸàŸéŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ™ŸêŸáŸê ŸàŸéÿ±Ÿèÿ≥ŸèŸÑŸêŸáŸê ŸàŸéÿ¨Ÿêÿ®Ÿíÿ±ŸêŸäŸÑŸé ŸàŸéŸÖŸêŸäŸÉŸéÿßŸÑŸé ŸÅŸéÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ÿπŸéÿØŸèŸàŸåŸë ŸÑŸêŸëŸÑŸíŸÉŸéÿßŸÅŸêÿ±ŸêŸäŸÜŸé\",\n      translation: \"Whoever is an enemy to Allah and His angels and His messengers and Gabriel and Michael - then indeed, Allah is an enemy to the disbelievers.\",\n      source: \"Qur'an 2:98\"\n    },\n    keyLesson: \"Mƒ´kƒÅ'ƒ´l reminds us that every drop of rain and bite of food comes from Allah's mercy and provision.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"IsrƒÅfƒ´l\",\n    description: [\n      \"IsrƒÅfƒ´l is the angel tasked with blowing the trumpet that signals the Day of Judgment. He stands ready, waiting for Allah's command, with the trumpet at his lips, prepared to blow it the instant Allah orders him to announce the end of time.\",\n      \"When IsrƒÅfƒ´l blows the trumpet the first time, every living thing in the heavens and earth will die instantly, except those Allah wills. The second blow will resurrect all of creation, bringing everyone back to life for judgment and eternal accountability.\",\n      \"The Prophet Ô∑∫ said IsrƒÅfƒ´l has been ready since creation, never taking his eyes off the Throne, waiting for the command. This teaches us that the Hour could come at any moment, and we must always be prepared with good deeds and sincere faith.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸèŸÅŸêÿÆŸé ŸÅŸêŸä ÿßŸÑÿµŸèŸëŸàÿ±Ÿê ŸÅŸéÿµŸéÿπŸêŸÇŸé ŸÖŸéŸÜ ŸÅŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéŸÖŸéŸÜ ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ÿ•ŸêŸÑŸéŸëÿß ŸÖŸéŸÜ ÿ¥Ÿéÿßÿ°Ÿé ÿßŸÑŸÑŸéŸëŸáŸè €ñ ÿ´ŸèŸÖŸéŸë ŸÜŸèŸÅŸêÿÆŸé ŸÅŸêŸäŸáŸê ÿ£ŸèÿÆŸíÿ±ŸéŸâŸ∞ ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ŸáŸèŸÖŸí ŸÇŸêŸäŸéÿßŸÖŸå ŸäŸéŸÜÿ∏Ÿèÿ±ŸèŸàŸÜŸé\",\n      translation: \"And the Horn will be blown, and whoever is in the heavens and whoever is on the earth will fall dead except whom Allah wills. Then it will be blown again, and at once they will be standing, looking on.\",\n      source: \"Qur'an 39:68\"\n    },\n    keyLesson: \"IsrƒÅfƒ´l's constant readiness reminds us that death and judgment are certain, and we must prepare every single day.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Malak al-Mawt (Angel of Death)\",\n    description: [\n      \"The Angel of Death, often called Azrael, is responsible for taking the souls of every living creature when their appointed time arrives. He extracts souls with gentleness for the believers and with difficulty for the disbelievers, according to Allah's perfect justice and decree.\",\n      \"Allah gave this angel helpers who assist in taking souls throughout the earth. When a believer's soul is taken, it is received with joy by other angels who welcome it with peace and glad tidings of Paradise, while disbelievers' souls face harshness and warnings of punishment.\",\n      \"The Prophet Ô∑∫ taught us that the Angel of Death will be the last to die, after every other creation has perished. Then Allah alone will remain, demonstrating His eternal nature. Finally, Allah will resurrect all creation for the Day of Judgment and eternal accountability.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ŸäŸéÿ™ŸéŸàŸéŸÅŸéŸëÿßŸÉŸèŸÖ ŸÖŸéŸëŸÑŸéŸÉŸè ÿßŸÑŸíŸÖŸéŸàŸíÿ™Ÿê ÿßŸÑŸéŸëÿ∞ŸêŸä ŸàŸèŸÉŸêŸëŸÑŸé ÿ®ŸêŸÉŸèŸÖŸí ÿ´ŸèŸÖŸéŸë ÿ•ŸêŸÑŸéŸâŸ∞ ÿ±Ÿéÿ®ŸêŸëŸÉŸèŸÖŸí ÿ™Ÿèÿ±Ÿíÿ¨ŸéÿπŸèŸàŸÜŸé\",\n      translation: \"Say, 'The angel of death will take you who has been entrusted with you. Then to your Lord you will be returned.'\",\n      source: \"Qur'an 32:11\"\n    },\n    keyLesson: \"Death is certain for every soul, and our deeds determine whether our soul is taken gently or harshly.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Munkar and Nakir\",\n    description: [\n      \"Munkar and Nakir are two angels who question every person in their grave after burial. They ask three critical questions: Who is your Lord? What is your religion? Who is your Prophet? These questions test what we truly believed and practiced during our lives on earth.\",\n      \"The believer who lived with sincere faith answers confidently: My Lord is Allah, my religion is Islam, and my Prophet is Muhammad Ô∑∫. The angels then make the grave spacious and comfortable, filling it with light and pleasant fragrance until the Day of Resurrection arrives.\",\n      \"The hypocrite and disbeliever cannot answer correctly, saying they don't know or they followed what others said. The angels make their grave tight and dark, filled with punishment and torment. The Prophet Ô∑∫ taught us to seek Allah's protection from the punishment and trial of the grave.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸí ÿπŸéÿ∞Ÿéÿßÿ®Ÿê ÿßŸÑŸíŸÇŸéÿ®Ÿíÿ±Ÿê\",\n      translation: \"O Allah, I seek refuge in You from the punishment of the grave.\",\n      source: \"Sahih Bukhari 1377\"\n    },\n    keyLesson: \"We must live our faith sincerely every day so we can answer Munkar and Nakir's questions with confidence.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Guardian Angels (Mu'aqqibat)\",\n    description: [\n      \"Allah has assigned guardian angels to every person, protecting them from harm and dangers that we never even see or know about. These angels guard us from the front and behind, shielding us from countless accidents and evils according to Allah's divine decree and mercy.\",\n      \"The angels protect us until our decreed time of death arrives, when nothing can prevent what Allah has written. They work tirelessly, never resting, watching over us during sleep and wakefulness, ensuring our safety according to Allah's perfect wisdom and predetermined plan for each soul.\",\n      \"When we remember Allah and maintain good character, these guardian angels draw closer and increase their protection. When we sin and forget Allah, we push away their blessings and protection. The Prophet Ô∑∫ taught us to always maintain awareness of Allah to keep these blessed angels close.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸáŸè ŸÖŸèÿπŸéŸÇŸêŸëÿ®Ÿéÿßÿ™Ÿå ŸÖŸêŸëŸÜ ÿ®ŸéŸäŸíŸÜŸê ŸäŸéÿØŸéŸäŸíŸáŸê ŸàŸéŸÖŸêŸÜŸí ÿÆŸéŸÑŸíŸÅŸêŸáŸê ŸäŸéÿ≠ŸíŸÅŸéÿ∏ŸèŸàŸÜŸéŸáŸè ŸÖŸêŸÜŸí ÿ£ŸéŸÖŸíÿ±Ÿê ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"For him are successive angels before and behind him, who protect him by the command of Allah.\",\n      source: \"Qur'an 13:11\"\n    },\n    keyLesson: \"Allah's guardian angels protect us constantly, reminding us of His continuous care and mercy in our lives.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Recording Angels (KirƒÅman KƒÅtibƒ´n)\",\n    description: [\n      \"Two noble angels sit with every person, one on the right shoulder recording good deeds, and one on the left recording bad deeds. They write down everything we do, say, and even think, creating a complete and perfect record that we will face on Judgment Day without any possibility of denial.\",\n      \"The angel on the right records good deeds immediately and multiplies them by ten or more based on intention and sincerity. The angel on the left waits before recording sins, giving us time to repent and seek forgiveness. If we repent sincerely, Allah erases the sin completely from our record.\",\n      \"These angels never sleep, make mistakes, or forget anything. They witness our private and public actions, accompanying us everywhere we go. The Prophet Ô∑∫ said even a casual word we speak carelessly is recorded, teaching us to guard our tongues and actions carefully at all times.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéÿß ŸäŸéŸÑŸíŸÅŸêÿ∏Ÿè ŸÖŸêŸÜ ŸÇŸéŸàŸíŸÑŸç ÿ•ŸêŸÑŸéŸëÿß ŸÑŸéÿØŸéŸäŸíŸáŸê ÿ±ŸéŸÇŸêŸäÿ®Ÿå ÿπŸéÿ™ŸêŸäÿØŸå\",\n      translation: \"He does not utter any word except that with him is an observer prepared to record.\",\n      source: \"Qur'an 50:18\"\n    },\n    keyLesson: \"Every word and deed is permanently recorded by angels, making us accountable for everything we do throughout life.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"MƒÅlik\",\n    description: [\n      \"MƒÅlik is the angel appointed as the gatekeeper of Hellfire, commanding the nineteen chief angels who guard and manage the punishment of its inhabitants. He never smiles, remaining stern and serious, reflecting the terrible reality of the punishment he oversees by Allah's command and perfect justice.\",\n      \"When the people of Hellfire cry out to MƒÅlik begging for death to escape their torment, he responds that they will remain there forever. His answer reminds them that they rejected truth during their lives, so now they face the eternal consequences of their choices and disbelief in Allah's messengers.\",\n      \"The Prophet Ô∑∫ taught us to seek protection from Hellfire in every prayer. MƒÅlik carries out Allah's justice without mercy for those who died in disbelief and oppression. This teaches us to fear Allah's punishment and strive to obey Him and avoid sins in this temporary worldly life.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸéÿßÿØŸéŸàŸíÿß ŸäŸéÿß ŸÖŸéÿßŸÑŸêŸÉŸè ŸÑŸêŸäŸéŸÇŸíÿ∂Ÿê ÿπŸéŸÑŸéŸäŸíŸÜŸéÿß ÿ±Ÿéÿ®ŸèŸëŸÉŸé €ñ ŸÇŸéÿßŸÑŸé ÿ•ŸêŸÜŸéŸëŸÉŸèŸÖ ŸÖŸéŸëÿßŸÉŸêÿ´ŸèŸàŸÜŸé\",\n      translation: \"And they will call, 'O Malik, let your Lord put an end to us!' He will say, 'Indeed, you will remain.'\",\n      source: \"Qur'an 43:77\"\n    },\n    keyLesson: \"MƒÅlik's role reminds us that Hellfire is real and eternal, motivating us to seek Allah's forgiveness and mercy.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"RidwƒÅn\",\n    description: [\n      \"RidwƒÅn is the angel who serves as the gatekeeper of Paradise, welcoming the believers who enter with peace and joy. When the righteous arrive at Paradise's gates after crossing the bridge over Hellfire, RidwƒÅn greets them with beautiful words of welcome and congratulations for their faith.\",\n      \"The angels under RidwƒÅn's command open Paradise's gates wide for believers, saying 'Peace be upon you, you have done well, so enter it to abide eternally.' This warm welcome contrasts completely with the harsh reception disbelievers receive at Hellfire's gates, showing Allah's justice and mercy to the faithful.\",\n      \"RidwƒÅn oversees the distribution of Paradise's levels according to each person's deeds and faith. The highest level, Firdaws, is reserved for those who strived hardest in worship and good deeds. The Prophet Ô∑∫ taught us to always ask Allah specifically for Firdaws, the best and highest part of Paradise.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ≥ŸêŸäŸÇŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿßÿ™ŸéŸëŸÇŸéŸàŸíÿß ÿ±Ÿéÿ®ŸéŸëŸáŸèŸÖŸí ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ÿ≤ŸèŸÖŸéÿ±Ÿãÿß €ñ ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ÿ•Ÿêÿ∞Ÿéÿß ÿ¨Ÿéÿßÿ°ŸèŸàŸáŸéÿß ŸàŸéŸÅŸèÿ™Ÿêÿ≠Ÿéÿ™Ÿí ÿ£Ÿéÿ®ŸíŸàŸéÿßÿ®ŸèŸáŸéÿß ŸàŸéŸÇŸéÿßŸÑŸé ŸÑŸéŸáŸèŸÖŸí ÿÆŸéÿ≤ŸéŸÜŸéÿ™ŸèŸáŸéÿß ÿ≥ŸéŸÑŸéÿßŸÖŸå ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸí ÿ∑Ÿêÿ®Ÿíÿ™ŸèŸÖŸí ŸÅŸéÿßÿØŸíÿÆŸèŸÑŸèŸàŸáŸéÿß ÿÆŸéÿßŸÑŸêÿØŸêŸäŸÜŸé\",\n      translation: \"And those who feared their Lord will be driven to Paradise in groups until, when they reach it while its gates have been opened and its keepers say, 'Peace be upon you; you have become pure; so enter it to abide eternally.'\",\n      source: \"Qur'an 39:73\"\n    },\n    keyLesson: \"RidwƒÅn welcomes believers to eternal happiness, making Paradise the ultimate goal worth every sacrifice and good deed.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Angel of the Mountains\",\n    description: [\n      \"During the Prophet's Ô∑∫ difficult journey to Taif, the people rejected him brutally, throwing stones until he bled and forcing him to leave their city. In his pain and sadness, Allah sent Jibra'il accompanied by the Angel of the Mountains to offer help and support to His beloved messenger.\",\n      \"The Angel of the Mountains asked permission to crush the people of Taif between two mountains as punishment for their cruelty and rejection of Allah's messenger. This powerful angel had the strength to destroy entire cities, waiting only for the Prophet's Ô∑∫ command to bring down Allah's wrath upon the disbelievers.\",\n      \"The Prophet Ô∑∫ refused, choosing mercy over revenge. He said perhaps Allah would bring forth from their descendants people who would worship Allah alone. This beautiful response showed his compassion and hope, and indeed, many from Taif later accepted Islam and became devoted believers and companions.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÇŸéÿßŸÑŸé ŸÖŸéŸÑŸéŸÉŸè ÿßŸÑŸíÿ¨Ÿêÿ®ŸéÿßŸÑŸê ÿ•ŸêŸÜŸí ÿ¥Ÿêÿ¶Ÿíÿ™Ÿé ÿ£ŸéŸÜŸí ÿ£Ÿèÿ∑Ÿíÿ®ŸêŸÇŸé ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸè ÿßŸÑŸíÿ£ŸéÿÆŸíÿ¥Ÿéÿ®ŸéŸäŸíŸÜŸê ŸÅŸéŸÇŸéÿßŸÑŸé ÿßŸÑŸÜŸéŸëÿ®ŸêŸäŸèŸë ÿµŸÑŸâ ÿßŸÑŸÑŸá ÿπŸÑŸäŸá Ÿàÿ≥ŸÑŸÖ ÿ®ŸéŸÑŸí ÿ£Ÿéÿ±Ÿíÿ¨ŸèŸà ÿ£ŸéŸÜŸí ŸäŸèÿÆŸíÿ±Ÿêÿ¨Ÿé ÿßŸÑŸÑŸéŸëŸáŸè ŸÖŸêŸÜŸí ÿ£ŸéÿµŸíŸÑÿßŸéÿ®ŸêŸáŸêŸÖŸí ŸÖŸéŸÜŸí ŸäŸéÿπŸíÿ®ŸèÿØŸè ÿßŸÑŸÑŸéŸëŸáŸé ŸàŸéÿ≠ŸíÿØŸéŸáŸè\",\n      translation: \"The Angel of the Mountains said, 'If you wish, I will bring together the two mountains upon them.' But the Prophet Ô∑∫ said, 'No, for I hope that Allah will bring forth from their descendants people who will worship Allah alone.'\",\n      source: \"Sahih Bukhari 3231\"\n    },\n    keyLesson: \"Even powerful angels obey the Prophet's Ô∑∫ wisdom and mercy, teaching us to choose forgiveness over revenge.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Angels in Constant Worship\",\n    description: [\n      \"The heavens are filled with angels in constant worship, never resting or tiring for even a single moment. The Prophet Ô∑∫ said the heavens creak from the weight of angels standing in prayer, and there is not a hand's width of space without an angel in bowing or prostration before Allah.\",\n      \"These countless angels glorify Allah day and night without stop, never disobeying any command He gives them. They perform exactly what they are ordered, whether worshipping, carrying the Throne, or managing the affairs of creation. Their perfect obedience sets the standard for all of Allah's creation to follow with devotion.\",\n      \"The Prophet Ô∑∫ said he saw what we cannot see, hearing the heavens creaking from the tremendous number of angels worshipping upon them. This teaches us that worship of Allah fills the universe, and we should join this eternal glorification with our own sincere prayers, remembrance, and devotion to our Creator.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸêŸëŸä ÿ£Ÿéÿ±ŸéŸâ ŸÖŸéÿß ŸÑÿßŸé ÿ™Ÿéÿ±ŸéŸàŸíŸÜŸé ŸàŸéÿ£Ÿéÿ≥ŸíŸÖŸéÿπŸè ŸÖŸéÿß ŸÑÿßŸé ÿ™Ÿéÿ≥ŸíŸÖŸéÿπŸèŸàŸÜŸé ÿ£Ÿéÿ∑ŸéŸëÿ™Ÿê ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿè ŸàŸéÿ≠ŸèŸÇŸéŸë ŸÑŸéŸáŸéÿß ÿ£ŸéŸÜŸí ÿ™Ÿéÿ¶Ÿêÿ∑ŸéŸë ŸÖŸéÿß ŸÅŸêŸäŸáŸéÿß ŸÖŸéŸàŸíÿ∂ŸêÿπŸè ÿ£Ÿéÿ±Ÿíÿ®ŸéÿπŸê ÿ£ŸéÿµŸéÿßÿ®ŸêÿπŸé ÿ•ŸêŸÑÿßŸéŸë ŸàŸéŸÖŸéŸÑŸéŸÉŸå ŸàŸéÿßÿ∂ŸêÿπŸå ÿ¨Ÿéÿ®ŸíŸáŸéÿ™ŸéŸáŸè ÿ≥Ÿéÿßÿ¨ŸêÿØŸãÿß ŸÑŸêŸÑŸéŸëŸáŸê\",\n      translation: \"Indeed, I see what you do not see and hear what you do not hear. The heaven has creaked, and it has the right to creak. There is not a space of four fingers in it except that an angel is placing his forehead in prostration to Allah.\",\n      source: \"Sahih Muslim 2785\"\n    },\n    keyLesson: \"Angels worship Allah constantly without rest, inspiring us to dedicate our own lives to remembrance and obedience.\",\n    quizId: 11\n  }\n];\n\nexport default angelsLessons;\n","path":null,"size_bytes":17463,"size_tokens":null},"src/data/mascotQuizStates.js":{"content":"import mascot_sitting from '../assets/mascots/mascot_sitting.webp';\nimport mascot_congratulation from '../assets/mascots/mascot_congratulation.webp';\nimport mascot_sitting_v2 from '../assets/mascots/mascot_sitting_v2.webp';\n\nexport const mascotQuizStates = {\n  start: mascot_sitting,\n  thinking: mascot_sitting,\n  correct: mascot_sitting,\n  incorrect: mascot_sitting,\n  pass: mascot_congratulation,\n  fail: mascot_sitting_v2,\n};\n","path":null,"size_bytes":429,"size_tokens":null},"src/data/lessons/prophetsLessons.js":{"content":"// Stories of the Prophets Learning Path\n// 24 prophets in chronological order from Qasas al-Anbiya\n// 47 total lessons: 23 prophets √ó 2 parts + Prophet Idris (1 part)\n// Each lesson: 4 paragraphs of ~30 words each\n// Sources: Qur'an and Sahih Hadith only\n\nconst prophetsLessons = [\n  // ============================================================\n  // SECTION 1: Early Prophets\n  // ============================================================\n\n  // Prophet Adam (1 of 2)\n  {\n    id: 1,\n    title: \"Prophet Adam ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"The First Human\",\n    description: [\n      \"Allah created Adam from clay and breathed life into him. Angels were commanded to prostrate to Adam. All obeyed except Iblis, who refused out of pride and arrogance.\",\n      \"Allah taught Adam the names of all things, knowledge the angels didn't possess. This showed Adam's unique position as Allah's khalifah on earth, entrusted with responsibility and free will.\",\n      \"Adam lived in Paradise with his wife Hawwa. They enjoyed blessings but were warned not to approach one tree. Iblis whispered lies, deceiving them into eating from the forbidden tree.\",\n      \"When they disobeyed, they felt shame and sought Allah's forgiveness. Allah taught them words of repentance. He accepted their sincere tawbah and promised to send guidance to their descendants.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ∞Ÿí ŸÇŸéÿßŸÑŸé ÿ±Ÿéÿ®ŸèŸëŸÉŸé ŸÑŸêŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©Ÿê ÿ•ŸêŸÜŸêŸëŸä ÿ¨ŸéÿßÿπŸêŸÑŸå ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ÿÆŸéŸÑŸêŸäŸÅŸéÿ©Ÿã\",\n      translation: \"And when your Lord said to the angels, 'Indeed, I will make upon the earth a successive authority.'\",\n      source: \"Qur'an 2:30\"\n    },\n    reflection: \"What does Adam's story teach us about repentance and Allah's mercy?\",\n    quizId: 1\n  },\n\n  // Prophet Adam (2 of 2)\n  {\n    id: 2,\n    title: \"Prophet Adam ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"The First Human\",\n    description: [\n      \"Adam and Hawwa descended to earth to begin humanity's journey. They were told that guidance would come from Allah. Those who follow it would have no fear or grief.\",\n      \"Adam became the first prophet, teaching his children to worship Allah alone. His sons Habil and Qabil both offered sacrifices. Allah accepted Habil's sincere offering but not Qabil's insincere one.\",\n      \"Out of jealousy, Qabil killed his brother Habil, committing the first murder on earth. He didn't know what to do with the body until a crow showed him how to bury it.\",\n      \"Adam grieved deeply for Habil and warned his descendants against envy and violence. His life teaches us that mistakes don't define us‚Äîsincere repentance and obedience to Allah's guidance do.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ™ŸéŸÑŸéŸÇŸéŸëŸâŸ∞ ÿ¢ÿØŸéŸÖŸè ŸÖŸêŸÜ ÿ±ŸéŸëÿ®ŸêŸëŸáŸê ŸÉŸéŸÑŸêŸÖŸéÿßÿ™Ÿç ŸÅŸéÿ™Ÿéÿßÿ®Ÿé ÿπŸéŸÑŸéŸäŸíŸáŸê\",\n      translation: \"Then Adam received from his Lord words, and He accepted his repentance.\",\n      source: \"Qur'an 2:37\"\n    },\n    reflection: \"How can we apply the lesson of Habil's sincerity in our own worship?\",\n    quizId: 2\n  },\n\n  // Prophet Idris (1 of 1)\n  {\n    id: 3,\n    title: \"Prophet Idris ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\",\n    meaning: \"The Elevated Prophet\",\n    description: [\n      \"Idris was a righteous prophet who came after Adam. He was known for his patience, truthfulness, and devotion. Allah raised him to a high station because of his purity and worship.\",\n      \"Idris was the first to write with a pen and teach humans the art of writing. He studied the movements of stars and understood the heavens, using knowledge to worship Allah better.\",\n      \"He called his people to worship Allah alone and abandon false gods. He taught them justice, honesty, and righteous living. Many followed his guidance and left their sinful ways behind.\",\n      \"Allah honored Idris by elevating him to a high place in the heavens. He is remembered for his wisdom, knowledge, and unwavering commitment to truth and righteousness throughout his blessed life.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ±ŸéŸÅŸéÿπŸíŸÜŸéÿßŸáŸè ŸÖŸéŸÉŸéÿßŸÜŸãÿß ÿπŸéŸÑŸêŸäŸãŸëÿß\",\n      translation: \"And We raised him to a high station.\",\n      source: \"Qur'an 19:57\"\n    },\n    reflection: \"How can we use knowledge and learning to draw closer to Allah like Idris did?\",\n    quizId: 3\n  },\n\n  // Prophet Nuh (1 of 2)\n  {\n    id: 4,\n    title: \"Prophet Nuh ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Noah\",\n    description: [\n      \"Nuh was sent to a people who worshipped idols named Wadd, Suwa, Yaghuth, Ya'uq, and Nasr. They had abandoned the worship of Allah, following the ways of their misguided forefathers.\",\n      \"For 950 years, Nuh called them to Allah day and night, publicly and privately. He warned them of punishment and promised them Paradise. But they mocked him and refused to listen.\",\n      \"The leaders rejected Nuh because only the poor and weak followed him. They said a prophet should bring wealth and power, not warnings. Their pride and arrogance blinded them to truth.\",\n      \"Nuh never gave up despite constant rejection. He patiently repeated his message, hoping even one more person would believe. His perseverance teaches us to continue doing good even when results seem hopeless.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéŸÇŸéÿØŸí ÿ£Ÿéÿ±Ÿíÿ≥ŸéŸÑŸíŸÜŸéÿß ŸÜŸèŸàÿ≠Ÿãÿß ÿ•ŸêŸÑŸéŸâŸ∞ ŸÇŸéŸàŸíŸÖŸêŸáŸê ŸÅŸéŸÑŸéÿ®Ÿêÿ´Ÿé ŸÅŸêŸäŸáŸêŸÖŸí ÿ£ŸéŸÑŸíŸÅŸé ÿ≥ŸéŸÜŸéÿ©Ÿç ÿ•ŸêŸÑŸéŸëÿß ÿÆŸéŸÖŸíÿ≥ŸêŸäŸÜŸé ÿπŸéÿßŸÖŸãÿß\",\n      translation: \"And We certainly sent Noah to his people, and he remained among them a thousand years minus fifty years.\",\n      source: \"Qur'an 29:14\"\n    },\n    reflection: \"What can we learn from Nuh's 950 years of patient calling to Allah?\",\n    quizId: 4\n  },\n\n  // Prophet Nuh (2 of 2)\n  {\n    id: 5,\n    title: \"Prophet Nuh ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Noah\",\n    description: [\n      \"Allah commanded Nuh to build a massive ark because a great flood was coming. People mocked him for building a ship on dry land. Nuh obeyed Allah's command without questioning or delay.\",\n      \"When the flood came, water burst from the earth and poured from the sky. Nuh boarded the ark with believers and pairs of every animal. His own son refused and drowned with the disbelievers.\",\n      \"The flood destroyed everyone who rejected Allah's message. The ark sailed on towering waves until Allah commanded the earth to swallow the water. The ark rested on Mount Judi.\",\n      \"Only a handful of believers survived with Nuh. This shows that truth isn't measured by numbers. Nuh's patience and obedience saved him while the arrogant majority faced destruction and regret.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ£ŸéŸÜÿ¨ŸéŸäŸíŸÜŸéÿßŸáŸè ŸàŸéÿ£ŸéÿµŸíÿ≠Ÿéÿßÿ®Ÿé ÿßŸÑÿ≥ŸéŸëŸÅŸêŸäŸÜŸéÿ©Ÿê ŸàŸéÿ¨ŸéÿπŸéŸÑŸíŸÜŸéÿßŸáŸéÿß ÿ¢ŸäŸéÿ©Ÿã ŸÑŸêŸëŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"But We saved him and the companions of the ship, and We made it a sign for the worlds.\",\n      source: \"Qur'an 29:15\"\n    },\n    reflection: \"How does Nuh's obedience in building the ark inspire us to trust Allah's commands?\",\n    quizId: 5\n  },\n\n  // Prophet Hud (1 of 2)\n  {\n    id: 6,\n    title: \"Prophet Hud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"The Prophet of 'Ad\",\n    description: [\n      \"Hud was sent to the people of 'Ad who lived in the region of Ahqaf. They were powerful, wealthy, and built massive structures and lofty towers showing their strength and pride.\",\n      \"Despite their blessings, they worshipped idols and rejected Allah. Hud called them to worship Allah alone and warned them against arrogance. He reminded them everything they had came from Allah.\",\n      \"They mocked Hud and said their gods would punish him. They relied on their physical strength and wealth, thinking nothing could destroy them. Their pride made them blind to truth and warnings.\",\n      \"Hud warned them that their power and possessions wouldn't save them from Allah's punishment. He called them to repent sincerely and return to Allah before it was too late. Most refused stubbornly.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÑŸéŸâŸ∞ ÿπŸéÿßÿØŸç ÿ£ŸéÿÆŸéÿßŸáŸèŸÖŸí ŸáŸèŸàÿØŸãÿß €ó ŸÇŸéÿßŸÑŸé ŸäŸéÿß ŸÇŸéŸàŸíŸÖŸê ÿßÿπŸíÿ®ŸèÿØŸèŸàÿß ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿß ŸÑŸéŸÉŸèŸÖ ŸÖŸêŸëŸÜŸí ÿ•ŸêŸÑŸéŸ∞ŸáŸç ÿ∫ŸéŸäŸíÿ±ŸèŸáŸè\",\n      translation: \"And to 'Ad We sent their brother Hud. He said, 'O my people, worship Allah; you have no deity other than Him.'\",\n      source: \"Qur'an 7:65\"\n    },\n    reflection: \"How does the story of 'Ad warn us against arrogance in times of success?\",\n    quizId: 6\n  },\n\n  // Prophet Hud (2 of 2)\n  {\n    id: 7,\n    title: \"Prophet Hud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"The Prophet of 'Ad\",\n    description: [\n      \"The people of 'Ad demanded Hud bring the punishment if he was truthful. Allah sent them three years of drought first, testing them and giving them time to repent and change.\",\n      \"Instead of turning to Allah, they grew more stubborn. Finally, Allah sent a fierce wind that howled for seven nights and eight days without stopping, destroying everything in its path completely.\",\n      \"The wind tore apart their mighty buildings and threw their strong bodies like hollow palm trunks. Their strength and towers couldn't protect them. Only Hud and the few believers were saved miraculously.\",\n      \"Their entire civilization vanished, leaving only ruins and lessons. Their story warns us that wealth, power, and intelligence mean nothing without gratitude, humility, and obedience to Allah's guidance.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ£ŸéŸÜÿ¨ŸéŸäŸíŸÜŸéÿßŸáŸè ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÖŸéÿπŸéŸáŸè ÿ®Ÿêÿ±Ÿéÿ≠ŸíŸÖŸéÿ©Ÿç ŸÖŸêŸëŸÜŸéŸëÿß\",\n      translation: \"But We saved him and those with him by mercy from Us.\",\n      source: \"Qur'an 7:72\"\n    },\n    reflection: \"What does the destruction of 'Ad teach us about true strength and security?\",\n    quizId: 7\n  },\n\n  // Prophet Salih (1 of 2)\n  {\n    id: 8,\n    title: \"Prophet Salih ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"The Prophet of Thamud\",\n    description: [\n      \"Salih was sent to the people of Thamud who lived in a place called Al-Hijr. They carved beautiful homes into mountains, feeling secure and boasting about their skills and intelligence.\",\n      \"Like 'Ad before them, they worshipped idols and rejected Allah. Salih called them to worship Allah alone and warned them about the fate of 'Ad. They demanded a miraculous sign to prove him.\",\n      \"Allah sent a magnificent she-camel as a sign‚Äîshe would drink from their well one day, and they would drink the next. This was a clear test of their obedience and faith.\",\n      \"The she-camel was a blessing and a test. If they harmed her, severe punishment would follow. Salih warned them repeatedly not to touch her with evil intentions or disrespect.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÑŸéŸâŸ∞ ÿ´ŸéŸÖŸèŸàÿØŸé ÿ£ŸéÿÆŸéÿßŸáŸèŸÖŸí ÿµŸéÿßŸÑŸêÿ≠Ÿãÿß €ó ŸÇŸéÿßŸÑŸé ŸäŸéÿß ŸÇŸéŸàŸíŸÖŸê ÿßÿπŸíÿ®ŸèÿØŸèŸàÿß ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿß ŸÑŸéŸÉŸèŸÖ ŸÖŸêŸëŸÜŸí ÿ•ŸêŸÑŸéŸ∞ŸáŸç ÿ∫ŸéŸäŸíÿ±ŸèŸáŸè\",\n      translation: \"And to Thamud We sent their brother Salih. He said, 'O my people, worship Allah; you have no deity other than Him.'\",\n      source: \"Qur'an 7:73\"\n    },\n    reflection: \"Why do you think Allah tested Thamud with something as simple as a camel?\",\n    quizId: 8\n  },\n\n  // Prophet Salih (2 of 2)\n  {\n    id: 9,\n    title: \"Prophet Salih ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"The Prophet of Thamud\",\n    description: [\n      \"The she-camel lived peacefully among them for some time. But the arrogant leaders grew jealous of her and plotted to kill her despite Salih's clear warnings about the consequences.\",\n      \"One day, a group of wicked men slaughtered the she-camel brutally. They thought they were powerful enough to escape Allah's punishment. Salih gave them three days to repent sincerely before punishment arrived.\",\n      \"They mocked Salih and challenged him to bring the punishment. On the third day, a terrible earthquake shook the earth and a loud blast struck them dead instantly in their homes.\",\n      \"Their carved houses couldn't save them. They were destroyed while sitting in their comfort and pride. Only Salih and the believers were saved. Their ruins remain as a warning to travelers passing by.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿπŸéŸÇŸéÿ±ŸèŸàÿß ÿßŸÑŸÜŸéŸëÿßŸÇŸéÿ©Ÿé ŸàŸéÿπŸéÿ™ŸéŸàŸíÿß ÿπŸéŸÜŸí ÿ£ŸéŸÖŸíÿ±Ÿê ÿ±Ÿéÿ®ŸêŸëŸáŸêŸÖŸí\",\n      translation: \"But they hamstrung the she-camel and were insolent toward the command of their Lord.\",\n      source: \"Qur'an 7:77\"\n    },\n    reflection: \"How does the story of Thamud show us the consequences of defying Allah's signs?\",\n    quizId: 9\n  },\n\n  // Prophet Ibrahim (1 of 2)\n  {\n    id: 10,\n    title: \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Abraham\",\n    description: [\n      \"Ibrahim grew up in a land where everyone worshipped idols. His own father Azar was an idol-maker. Even as a youth, Ibrahim questioned why people worshipped powerless statues made by human hands.\",\n      \"Ibrahim reflected on the sun, moon, and stars, rejecting each as they set and changed. He declared his worship only to Allah, the Creator of the heavens and earth who never changes.\",\n      \"To prove idols were powerless, Ibrahim broke them all except the largest one. When questioned, he said perhaps the big idol did it. This exposed the foolishness of worshipping helpless objects.\",\n      \"The people were furious and threw Ibrahim into a massive fire. Allah commanded the fire to be cool and safe for Ibrahim. He emerged unharmed, showing Allah's complete power and protection.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸíŸÜŸéÿß ŸäŸéÿß ŸÜŸéÿßÿ±Ÿè ŸÉŸèŸàŸÜŸêŸä ÿ®Ÿéÿ±ŸíÿØŸãÿß ŸàŸéÿ≥ŸéŸÑŸéÿßŸÖŸãÿß ÿπŸéŸÑŸéŸâŸ∞ ÿ•Ÿêÿ®Ÿíÿ±ŸéÿßŸáŸêŸäŸÖŸé\",\n      translation: \"We said, 'O fire, be coolness and safety upon Ibrahim.'\",\n      source: \"Qur'an 21:69\"\n    },\n    reflection: \"What does Ibrahim's courage in breaking the idols teach us about standing for truth?\",\n    quizId: 10\n  },\n\n  // Prophet Ibrahim (2 of 2)\n  {\n    id: 11,\n    title: \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Abraham\",\n    description: [\n      \"Allah commanded Ibrahim to leave his homeland and travel to new lands. He was tested repeatedly: leaving his family, settling his wife Hajar and baby Ismail in an empty desert valley.\",\n      \"Ibrahim left Hajar and Ismail in the barren valley of Makkah, trusting Allah completely. When Ismail cried from thirst, Hajar ran between Safa and Marwah seeking water. Allah sent the Zamzam spring miraculously.\",\n      \"When Ismail grew older, Ibrahim dreamed of sacrificing his beloved son. Both understood this was Allah's command. Ismail submitted willingly, showing perfect obedience and trust in Allah's wisdom.\",\n      \"As Ibrahim prepared to sacrifice Ismail, Allah sent a ram to sacrifice instead. This test showed their complete submission. Ibrahim's legacy of Tawhid and surrender to Allah remains for all generations.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÅŸéÿØŸéŸäŸíŸÜŸéÿßŸáŸè ÿ®Ÿêÿ∞Ÿêÿ®Ÿíÿ≠Ÿç ÿπŸéÿ∏ŸêŸäŸÖŸç\",\n      translation: \"And We ransomed him with a great sacrifice.\",\n      source: \"Qur'an 37:107\"\n    },\n    reflection: \"How can we develop the level of trust in Allah that Ibrahim and Ismail showed?\",\n    quizId: 11\n  },\n\n  // Prophet Lut (1 of 2)\n  {\n    id: 12,\n    title: \"Prophet Lut ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Lot\",\n    description: [\n      \"Lut was sent to a people who committed shameful acts that no other nation had done before. They openly practiced immoral behavior and cut off travelers, engaging in wickedness publicly without shame.\",\n      \"Lut called them to abandon their evil ways and worship Allah. He warned them that their actions would bring Allah's punishment. They ignored him and instead mocked his warnings and teachings.\",\n      \"The people became so bold in their sins that they threatened to expel Lut from the city for speaking against them. They preferred their shameful desires over guidance, truth, and righteousness.\",\n      \"Lut felt helpless against their stubbornness and corruption. He prayed to Allah for help and protection. He continued calling them to righteousness despite their threats, mockery, and increasing hostility toward him.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿéÿ™Ÿéÿ£Ÿíÿ™ŸèŸàŸÜŸé ÿßŸÑŸíŸÅŸéÿßÿ≠Ÿêÿ¥Ÿéÿ©Ÿé ŸÖŸéÿß ÿ≥Ÿéÿ®ŸéŸÇŸéŸÉŸèŸÖ ÿ®ŸêŸáŸéÿß ŸÖŸêŸÜŸí ÿ£Ÿéÿ≠ŸéÿØŸç ŸÖŸêŸëŸÜŸé ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"Do you commit such immorality as no one has preceded you with from among the worlds?\",\n      source: \"Qur'an 7:80\"\n    },\n    reflection: \"What does Lut's persistence teach us about speaking truth in difficult environments?\",\n    quizId: 12\n  },\n\n  // Prophet Lut (2 of 2)\n  {\n    id: 13,\n    title: \"Prophet Lut ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Lot\",\n    description: [\n      \"Angels came to Lut in the form of handsome young men. When the townspeople heard of the guests, they rushed to Lut's house with evil intentions. Lut felt distressed and powerless.\",\n      \"Lut tried desperately to protect his guests, even offering his daughters in marriage to the men to show them the lawful way. But they were determined to commit their shameful acts regardless.\",\n      \"The angels revealed their true nature and told Lut to leave the city with his family at night. They warned him not to look back. His wife, who sympathized with the people, would be left behind.\",\n      \"At dawn, Allah destroyed the entire city. The ground was flipped upside down, and stones of baked clay rained upon them. Only Lut and his believing daughters were saved from total destruction.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÑŸéŸÖŸéŸëÿß ÿ¨Ÿéÿßÿ°Ÿé ÿ£ŸéŸÖŸíÿ±ŸèŸÜŸéÿß ÿ¨ŸéÿπŸéŸÑŸíŸÜŸéÿß ÿπŸéÿßŸÑŸêŸäŸéŸáŸéÿß ÿ≥ŸéÿßŸÅŸêŸÑŸéŸáŸéÿß ŸàŸéÿ£ŸéŸÖŸíÿ∑Ÿéÿ±ŸíŸÜŸéÿß ÿπŸéŸÑŸéŸäŸíŸáŸéÿß ÿ≠Ÿêÿ¨Ÿéÿßÿ±Ÿéÿ©Ÿã ŸÖŸêŸëŸÜ ÿ≥Ÿêÿ¨ŸêŸëŸäŸÑŸç\",\n      translation: \"So when Our command came, We made the highest part of it the lowest and rained upon it stones of layered hard clay.\",\n      source: \"Qur'an 11:82\"\n    },\n    reflection: \"How does the story of Lut's people warn us about the dangers of shameless sin?\",\n    quizId: 13\n  },\n\n  // Prophet Ismail (1 of 2)\n  {\n    id: 14,\n    title: \"Prophet Ismail ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Ishmael\",\n    description: [\n      \"Ismail was the first son of Prophet Ibrahim. As a baby, he was left with his mother Hajar in the empty desert of Makkah. Allah's wisdom placed them there to establish His sacred house.\",\n      \"When baby Ismail cried from thirst, Hajar ran between Safa and Marwah seven times searching for water or help. Allah sent the angel Jibra'il who struck the ground, and Zamzam water gushed forth miraculously.\",\n      \"Ismail grew up in Makkah as the Jurhum tribe settled near the blessed water. He learned their language and married from among them. He was patient, obedient, and loved by all who knew him.\",\n      \"As a young man, Ismail was tested with the ultimate sacrifice when his father Ibrahim saw a dream to sacrifice him. Ismail's response showed perfect submission: 'Father, do what you are commanded.'\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÑŸéŸÖŸéŸëÿß ÿ®ŸéŸÑŸéÿ∫Ÿé ŸÖŸéÿπŸéŸáŸè ÿßŸÑÿ≥ŸéŸëÿπŸíŸäŸé ŸÇŸéÿßŸÑŸé ŸäŸéÿß ÿ®ŸèŸÜŸéŸäŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£Ÿéÿ±ŸéŸâŸ∞ ŸÅŸêŸä ÿßŸÑŸíŸÖŸéŸÜŸéÿßŸÖŸê ÿ£ŸéŸÜŸêŸëŸä ÿ£Ÿéÿ∞Ÿíÿ®Ÿéÿ≠ŸèŸÉŸé ŸÅŸéÿßŸÜÿ∏Ÿèÿ±Ÿí ŸÖŸéÿßÿ∞Ÿéÿß ÿ™Ÿéÿ±ŸéŸâŸ∞ €ö ŸÇŸéÿßŸÑŸé ŸäŸéÿß ÿ£Ÿéÿ®Ÿéÿ™Ÿê ÿßŸÅŸíÿπŸéŸÑŸí ŸÖŸéÿß ÿ™Ÿèÿ§ŸíŸÖŸéÿ±Ÿè\",\n      translation: \"When he reached the age to work with him, he said, 'O my son, I have seen in a dream that I sacrifice you. See what you think.' He said, 'O my father, do as you are commanded.'\",\n      source: \"Qur'an 37:102\"\n    },\n    reflection: \"What can we learn from Ismail's response when facing such a difficult test?\",\n    quizId: 14\n  },\n\n  // Prophet Ismail (2 of 2)\n  {\n    id: 15,\n    title: \"Prophet Ismail ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Ishmael\",\n    description: [\n      \"After Allah ransomed Ismail with a ram, father and son worked together to rebuild the Ka'bah, the house of worship established by Adam and renewed by Ibrahim for all humanity.\",\n      \"As they raised the walls, Ibrahim and Ismail made beautiful du'a asking Allah to accept their work, make them submissive to Him, and raise from their descendants a nation of believers and a prophet.\",\n      \"Ismail became a prophet who called people to worship Allah alone. He is honored in the Qur'an as truthful to his promise, encouraging his family to pray and give charity throughout his life.\",\n      \"His descendants included the Prophet Muhammad Ô∑∫, fulfilling Ibrahim's prayer. Ismail's patience during trials, submission to Allah's will, and dedication to worship make him a role model for all believers.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßÿ∞ŸíŸÉŸèÿ±Ÿí ŸÅŸêŸä ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿê ÿ•Ÿêÿ≥ŸíŸÖŸéÿßÿπŸêŸäŸÑŸé €ö ÿ•ŸêŸÜŸéŸëŸáŸè ŸÉŸéÿßŸÜŸé ÿµŸéÿßÿØŸêŸÇŸé ÿßŸÑŸíŸàŸéÿπŸíÿØŸê ŸàŸéŸÉŸéÿßŸÜŸé ÿ±Ÿéÿ≥ŸèŸàŸÑŸãÿß ŸÜŸéŸëÿ®ŸêŸäŸãŸëÿß\",\n      translation: \"And mention in the Book, Ismail. Indeed, he was true to his promise, and he was a messenger and a prophet.\",\n      source: \"Qur'an 19:54\"\n    },\n    reflection: \"How did Ismail's upbringing in hardship prepare him for his blessed role?\",\n    quizId: 15\n  },\n\n  // Prophet Ishaq (1 of 2)\n  {\n    id: 16,\n    title: \"Prophet Ishaq ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Isaac\",\n    description: [\n      \"Ishaq was given to Ibrahim and Sarah in their old age as a miracle after Sarah had been barren for many years. Angels gave her glad tidings of a son who would be righteous.\",\n      \"Sarah laughed in amazement when told she would have a child in her old age while her husband was elderly. The angels assured her that nothing is impossible for Allah who gives life.\",\n      \"Ishaq was born as a gift from Allah and grew up under Ibrahim's guidance in the way of Tawhid. He learned from his father's patience, trust in Allah, and unwavering commitment to calling people.\",\n      \"Ishaq became a prophet continuing Ibrahim's mission in the Blessed Land. He called people to worship Allah alone and guided them with wisdom, patience, and the knowledge his father had taught him.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ®Ÿéÿ¥ŸéŸëÿ±ŸíŸÜŸéÿßŸáŸéÿß ÿ®Ÿêÿ•Ÿêÿ≥Ÿíÿ≠ŸéÿßŸÇŸé ŸàŸéŸÖŸêŸÜ ŸàŸéÿ±Ÿéÿßÿ°Ÿê ÿ•Ÿêÿ≥Ÿíÿ≠ŸéÿßŸÇŸé ŸäŸéÿπŸíŸÇŸèŸàÿ®Ÿé\",\n      translation: \"So We gave her good tidings of Ishaq and after Ishaq, Ya'qub.\",\n      source: \"Qur'an 11:71\"\n    },\n    reflection: \"How does Ishaq's birth remind us that Allah's timing is always perfect?\",\n    quizId: 16\n  },\n\n  // Prophet Ishaq (2 of 2)\n  {\n    id: 17,\n    title: \"Prophet Ishaq ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Isaac\",\n    description: [\n      \"Ishaq continued the legacy of prophethood, maintaining the pure message of Tawhid in his land. He taught his people to worship Allah alone without partners or intermediaries between them and their Creator.\",\n      \"Allah blessed Ishaq with a son named Ya'qub who would also become a prophet. The glad tidings given to Sarah included not just a son but also a grandson, continuing the blessed lineage of prophets.\",\n      \"Ishaq faced trials with patience just like his father Ibrahim. He remained steadfast in calling people to the straight path despite opposition, following the example of submission and trust he had witnessed.\",\n      \"His life shows how prophethood was passed through Ibrahim's family, each generation teaching the next. Ishaq's story reminds us that Allah chooses whom He wills and blesses families who remain faithful to His message.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸàŸéŸáŸéÿ®ŸíŸÜŸéÿß ŸÑŸéŸáŸè ÿ•Ÿêÿ≥Ÿíÿ≠ŸéÿßŸÇŸé ŸàŸéŸäŸéÿπŸíŸÇŸèŸàÿ®Ÿé ŸÜŸéÿßŸÅŸêŸÑŸéÿ©Ÿã €ñ ŸàŸéŸÉŸèŸÑŸãŸëÿß ÿ¨ŸéÿπŸéŸÑŸíŸÜŸéÿß ÿµŸéÿßŸÑŸêÿ≠ŸêŸäŸÜŸé\",\n      translation: \"And We gave to him Ishaq and Ya'qub in addition, and all of them We made righteous.\",\n      source: \"Qur'an 21:72\"\n    },\n    reflection: \"What can we learn from how the message was preserved across Ibrahim's descendants?\",\n    quizId: 17\n  },\n\n  // ============================================================\n  // SECTION 2: Prophets of Bani Isra'il\n  // ============================================================\n\n  // Prophet Ya'qub (1 of 2)\n  {\n    id: 18,\n    title: \"Prophet Ya'qub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Jacob/Israel\",\n    description: [\n      \"Ya'qub was the son of Ishaq and grandson of Ibrahim. He was also called Isra'il and became a prophet continuing the legacy of Tawhid. His twelve sons became the fathers of the twelve tribes.\",\n      \"Ya'qub had a special love for his son Yusuf and his younger brother. His other sons grew jealous of the attention Yusuf received. This jealousy would lead to trials that tested Ya'qub's faith deeply.\",\n      \"When Yusuf's brothers took him away, they returned with a blood-stained shirt claiming a wolf had eaten him. Ya'qub didn't believe them but responded with beautiful patience: 'Patience is most fitting.'\",\n      \"For years Ya'qub grieved for Yusuf, crying so much he lost his sight. Yet he never complained against Allah. He held onto hope, saying, 'I only complain of my suffering to Allah.'\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸéÿßŸÑŸé ÿ®ŸéŸÑŸí ÿ≥ŸéŸàŸéŸëŸÑŸéÿ™Ÿí ŸÑŸéŸÉŸèŸÖŸí ÿ£ŸéŸÜŸÅŸèÿ≥ŸèŸÉŸèŸÖŸí ÿ£ŸéŸÖŸíÿ±Ÿãÿß €ñ ŸÅŸéÿµŸéÿ®Ÿíÿ±Ÿå ÿ¨ŸéŸÖŸêŸäŸÑŸå\",\n      translation: \"He said, 'Rather, your souls have enticed you to something, so patience is most fitting.'\",\n      source: \"Qur'an 12:18\"\n    },\n    reflection: \"How did Ya'qub maintain hope in Allah despite losing his beloved son?\",\n    quizId: 18\n  },\n\n  // Prophet Ya'qub (2 of 2)\n  {\n    id: 19,\n    title: \"Prophet Ya'qub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Jacob/Israel\",\n    description: [\n      \"Ya'qub never gave up hope that Yusuf was alive. When his sons went to Egypt, he told them to search for Yusuf and his brother. His trust in Allah remained unshaken despite years of separation.\",\n      \"When the shirt of Yusuf was brought back from Egypt and placed over Ya'qub's face, his sight returned miraculously. His years of patient trust were finally rewarded as he was reunited with his beloved son.\",\n      \"Ya'qub traveled to Egypt where Yusuf had become a powerful minister. Yusuf seated his parents on the throne, and Ya'qub's old dream was fulfilled. He praised Allah for His mercy and perfect plan.\",\n      \"Ya'qub's life teaches us about sabr, trusting Allah's wisdom when we don't understand, and maintaining hope even in darkest times. His patience through loss and his gratitude during reunion are exemplary for believers.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸÖŸéÿß ÿ£Ÿéÿ¥ŸíŸÉŸèŸà ÿ®Ÿéÿ´ŸêŸëŸä ŸàŸéÿ≠Ÿèÿ≤ŸíŸÜŸêŸä ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"I only complain of my suffering and my grief to Allah.\",\n      source: \"Qur'an 12:86\"\n    },\n    reflection: \"What does Ya'qub's reunion with Yusuf teach us about trusting Allah's timing?\",\n    quizId: 19\n  },\n\n  // Prophet Yusuf (1 of 2)\n  {\n    id: 20,\n    title: \"Prophet Yusuf ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Joseph\",\n    description: [\n      \"Yusuf was beloved by his father Ya'qub. As a young boy, he saw a dream where eleven stars, the sun, and moon prostrated to him. Ya'qub knew this meant great things ahead.\",\n      \"Yusuf's jealous brothers plotted to get rid of him. They threw him into a dark well and told their father a wolf had eaten him. Travelers found Yusuf and sold him as a slave in Egypt.\",\n      \"Yusuf was bought by the Aziz of Egypt and grew up in his house. The Aziz's wife tried to seduce Yusuf, but he refused firmly, saying, 'Allah forbid! He is my master who has been good to me.'\",\n      \"When Yusuf tried to flee, she tore his shirt from behind. Her husband saw the torn shirt and knew Yusuf was innocent. Yet Yusuf was still imprisoned to protect the Aziz's reputation and honor.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸéÿßŸÑŸé ŸÖŸéÿπŸéÿßÿ∞Ÿé ÿßŸÑŸÑŸéŸëŸáŸê €ñ ÿ•ŸêŸÜŸéŸëŸáŸè ÿ±Ÿéÿ®ŸêŸëŸä ÿ£Ÿéÿ≠Ÿíÿ≥ŸéŸÜŸé ŸÖŸéÿ´ŸíŸàŸéÿßŸäŸé\",\n      translation: \"He said, 'Allah forbid! Indeed, my master has made good my residence.'\",\n      source: \"Qur'an 12:23\"\n    },\n    reflection: \"How did Yusuf maintain his honor and integrity despite temptation and injustice?\",\n    quizId: 20\n  },\n\n  // Prophet Yusuf (2 of 2)\n  {\n    id: 21,\n    title: \"Prophet Yusuf ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Joseph\",\n    description: [\n      \"In prison, Yusuf interpreted dreams through Allah's knowledge. When the king had a troubling dream, Yusuf explained it: seven years of plenty followed by seven years of famine. The king freed him.\",\n      \"The king made Yusuf treasurer of Egypt. Yusuf stored grain during the good years. When famine struck, people came from everywhere for food, including his brothers who didn't recognize him at first.\",\n      \"Yusuf tested his brothers to see if they had changed. When he finally revealed his identity, he forgave them completely saying, 'No blame on you today. May Allah forgive you. He is the Most Merciful.'\",\n      \"Yusuf's family reunited in Egypt. His childhood dream came true as his parents and brothers bowed before him in honor. From slavery to prison to power‚ÄîYusuf's trust in Allah never wavered, and Allah raised him.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿß ÿ™Ÿéÿ´Ÿíÿ±ŸêŸäÿ®Ÿé ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸè ÿßŸÑŸíŸäŸéŸàŸíŸÖŸé €ñ ŸäŸéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéŸÉŸèŸÖŸí\",\n      translation: \"No blame will there be upon you today. Allah will forgive you.\",\n      source: \"Qur'an 12:92\"\n    },\n    reflection: \"What does Yusuf's forgiveness of his brothers teach us about true nobility of character?\",\n    quizId: 21\n  },\n\n  // Prophet Ayyub (1 of 2)\n  {\n    id: 22,\n    title: \"Prophet Ayyub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Job\",\n    description: [\n      \"Ayyub was a wealthy, healthy prophet blessed with family, land, and livestock. He was grateful to Allah, worshipped sincerely, and helped the poor. He lived a life of righteousness and devotion.\",\n      \"Allah tested Ayyub by allowing him to lose his wealth, his children, and his health. Ayyub developed painful sores all over his body. People abandoned him except his loyal wife who stayed by him.\",\n      \"Despite losing everything, Ayyub never complained about Allah. He remained patient and continued worshipping Allah, knowing that everything belongs to Allah and He can take what He gives whenever He wills.\",\n      \"People who once respected him now mocked and avoided him. His suffering continued for years. Yet Ayyub's faith never wavered. He accepted Allah's decree with beautiful patience, never questioning Allah's wisdom or justice.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ŸàŸéÿ¨ŸéÿØŸíŸÜŸéÿßŸáŸè ÿµŸéÿßÿ®Ÿêÿ±Ÿãÿß €ö ŸÜŸêŸëÿπŸíŸÖŸé ÿßŸÑŸíÿπŸéÿ®ŸíÿØŸè €ñ ÿ•ŸêŸÜŸéŸëŸáŸè ÿ£ŸéŸàŸéŸëÿßÿ®Ÿå\",\n      translation: \"Indeed, We found him patient, an excellent servant. Indeed, he was one repeatedly turning back to Allah.\",\n      source: \"Qur'an 38:44\"\n    },\n    reflection: \"How can Ayyub's patience during extreme hardship strengthen our faith during trials?\",\n    quizId: 22\n  },\n\n  // Prophet Ayyub (2 of 2)\n  {\n    id: 23,\n    title: \"Prophet Ayyub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Job\",\n    description: [\n      \"After many years of suffering, Ayyub finally called upon Allah: 'Indeed, adversity has touched me, and You are the Most Merciful of the merciful.' This wasn't a complaint but a humble plea.\",\n      \"Allah immediately responded to Ayyub's du'a. Allah commanded him to strike his foot on the ground. A spring of water gushed out. He bathed in it and drank from it, and his health was completely restored.\",\n      \"Allah returned Ayyub's wealth and family to him, giving him double what he had before. His beautiful patience and trust during the darkest trial earned him Allah's immense reward in this life and the Hereafter.\",\n      \"Ayyub's story is a powerful reminder that trials test our faith and purify our hearts. No matter how difficult life becomes, turning to Allah with patience and du'a always brings relief and blessings.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÜŸêŸëŸä ŸÖŸéÿ≥ŸéŸëŸÜŸêŸäŸé ÿßŸÑÿ∂ŸèŸëÿ±ŸèŸë ŸàŸéÿ£ŸéŸÜÿ™Ÿé ÿ£Ÿéÿ±Ÿíÿ≠ŸéŸÖŸè ÿßŸÑÿ±ŸéŸëÿßÿ≠ŸêŸÖŸêŸäŸÜŸé\",\n      translation: \"Indeed, adversity has touched me, and You are the Most Merciful of the merciful.\",\n      source: \"Qur'an 21:83\"\n    },\n    reflection: \"What does Ayyub's du'a teach us about how to call upon Allah during hardship?\",\n    quizId: 23\n  },\n\n  // Prophet Shu'ayb (1 of 2)\n  {\n    id: 24,\n    title: \"Prophet Shu'ayb ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"The Prophet of Madyan\",\n    description: [\n      \"Shu'ayb was sent to the people of Madyan who were dishonest in their business dealings. They cheated in weights and measures, giving less and taking more. They ambushed travelers and stole from them.\",\n      \"Shu'ayb called them to worship Allah alone and to be fair and honest in their transactions. He warned them that cheating and corruption would bring Allah's punishment upon them and their society.\",\n      \"The people mocked Shu'ayb because he spoke about honesty and fairness. They said his prayers made him foolish. They threatened to stone him and drive him out unless he stopped preaching about justice and righteousness.\",\n      \"Shu'ayb reminded them how Allah had blessed them with wealth and safety. He warned them not to repeat the mistakes of earlier nations who were destroyed for their arrogance, corruption, and rejection of messengers.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÑŸéŸâŸ∞ ŸÖŸéÿØŸíŸäŸéŸÜŸé ÿ£ŸéÿÆŸéÿßŸáŸèŸÖŸí ÿ¥ŸèÿπŸéŸäŸíÿ®Ÿãÿß €ó ŸÇŸéÿßŸÑŸé ŸäŸéÿß ŸÇŸéŸàŸíŸÖŸê ÿßÿπŸíÿ®ŸèÿØŸèŸàÿß ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿß ŸÑŸéŸÉŸèŸÖ ŸÖŸêŸëŸÜŸí ÿ•ŸêŸÑŸéŸ∞ŸáŸç ÿ∫ŸéŸäŸíÿ±ŸèŸáŸè €ñ ŸàŸéŸÑŸéÿß ÿ™ŸéŸÜŸÇŸèÿµŸèŸàÿß ÿßŸÑŸíŸÖŸêŸÉŸíŸäŸéÿßŸÑŸé ŸàŸéÿßŸÑŸíŸÖŸêŸäÿ≤ŸéÿßŸÜŸé\",\n      translation: \"And to Madyan We sent their brother Shu'ayb. He said, 'O my people, worship Allah; you have no deity other than Him. And do not decrease from the measure and the scale.'\",\n      source: \"Qur'an 7:85\"\n    },\n    reflection: \"How does Shu'ayb's message connect worship of Allah to honesty in daily transactions?\",\n    quizId: 24\n  },\n\n  // Prophet Shu'ayb (2 of 2)\n  {\n    id: 25,\n    title: \"Prophet Shu'ayb ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"The Prophet of Madyan\",\n    description: [\n      \"The people of Madyan refused to listen to Shu'ayb. They continued cheating, stealing, and worshipping false gods. They challenged him to bring Allah's punishment if he was truly a prophet sent by Allah.\",\n      \"Allah sent a punishment that seized them suddenly. A terrible earthquake shook the earth and they were found lying dead in their homes. Their wealth and dishonest dealings couldn't save them from destruction.\",\n      \"Shu'ayb and the believers who followed him were saved from the punishment. They left the destroyed city and continued their journey of faith, trusting in Allah's justice and mercy for the righteous.\",\n      \"The story of Shu'ayb teaches us that honesty isn't just good character‚Äîit's part of faith. Cheating and corruption destroy societies. True success comes from worshipping Allah and treating others with fairness and integrity.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ£ŸéÿÆŸéÿ∞Ÿéÿ™ŸíŸáŸèŸÖŸè ÿßŸÑÿ±ŸéŸëÿ¨ŸíŸÅŸéÿ©Ÿè ŸÅŸéÿ£ŸéÿµŸíÿ®Ÿéÿ≠ŸèŸàÿß ŸÅŸêŸä ÿØŸéÿßÿ±ŸêŸáŸêŸÖŸí ÿ¨Ÿéÿßÿ´ŸêŸÖŸêŸäŸÜŸé\",\n      translation: \"So the earthquake seized them, and they became within their home corpses fallen prone.\",\n      source: \"Qur'an 7:91\"\n    },\n    reflection: \"What does the destruction of Madyan teach us about the importance of justice in society?\",\n    quizId: 25\n  },\n\n  // Prophet Musa (1 of 2)\n  {\n    id: 26,\n    title: \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Moses\",\n    description: [\n      \"Musa was born in Egypt when Fir'awn (Pharaoh) was killing all newborn Israelite boys. Allah inspired Musa's mother to place him in a basket and let it float down the river to save him.\",\n      \"Fir'awn's wife found baby Musa and convinced Fir'awn to keep him. By Allah's plan, Musa's own mother was brought to nurse him. He grew up in Fir'awn's palace, protected and raised among the oppressors.\",\n      \"As a young man, Musa intervened in a fight between an Egyptian and an Israelite. He accidentally killed the Egyptian and fled Egypt in fear. He traveled to Madyan where he helped two women water their flocks.\",\n      \"One of the women's father, Prophet Shu'ayb, offered Musa work and marriage to his daughter in return for eight years of service. Musa accepted and lived peacefully in Madyan for years, far from Egypt.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéŸàŸíÿ≠ŸéŸäŸíŸÜŸéÿß ÿ•ŸêŸÑŸéŸâŸ∞ ÿ£ŸèŸÖŸêŸë ŸÖŸèŸàÿ≥ŸéŸâŸ∞ ÿ£ŸéŸÜŸí ÿ£Ÿéÿ±Ÿíÿ∂ŸêÿπŸêŸäŸáŸê €ñ ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ÿÆŸêŸÅŸíÿ™Ÿê ÿπŸéŸÑŸéŸäŸíŸáŸê ŸÅŸéÿ£ŸéŸÑŸíŸÇŸêŸäŸáŸê ŸÅŸêŸä ÿßŸÑŸíŸäŸéŸÖŸêŸë\",\n      translation: \"And We inspired to the mother of Musa, 'Suckle him; but when you fear for him, cast him into the river.'\",\n      source: \"Qur'an 28:7\"\n    },\n    reflection: \"How does Allah's protection of baby Musa show His perfect planning and care?\",\n    quizId: 26\n  },\n\n  // Prophet Musa (2 of 2)\n  {\n    id: 27,\n    title: \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Moses\",\n    description: [\n      \"While traveling with his family, Musa saw a fire on Mount Tur. When he approached it, Allah spoke to him directly: 'Indeed, I am your Lord, so remove your sandals. You are in the sacred valley.'\",\n      \"Allah commanded Musa to go to Fir'awn and call him to worship Allah alone. Musa was afraid and asked Allah to send his brother Harun with him for support. Allah granted his request.\",\n      \"Musa performed miracles before Fir'awn: his staff turned into a serpent, and his hand glowed white. Fir'awn refused to believe and accused Musa of magic. He challenged Musa to a contest with his magicians.\",\n      \"The magicians threw their ropes and staffs which appeared to be moving serpents. Musa threw his staff, and it swallowed all their magic. The magicians recognized truth and prostrated, believing in Allah despite Fir'awn's threats.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéŸÜŸéÿß ÿ±Ÿéÿ®ŸèŸëŸÉŸé ŸÅŸéÿßÿÆŸíŸÑŸéÿπŸí ŸÜŸéÿπŸíŸÑŸéŸäŸíŸÉŸé €ñ ÿ•ŸêŸÜŸéŸëŸÉŸé ÿ®ŸêÿßŸÑŸíŸàŸéÿßÿØŸê ÿßŸÑŸíŸÖŸèŸÇŸéÿØŸéŸëÿ≥Ÿê ÿ∑ŸèŸàŸãŸâ\",\n      translation: \"Indeed, I am your Lord, so remove your sandals. Indeed, you are in the sacred valley of Tuwa.\",\n      source: \"Qur'an 20:12\"\n    },\n    reflection: \"What can we learn from Musa's fear and how Allah strengthened him for his mission?\",\n    quizId: 27\n  },\n\n  // Prophet Harun (1 of 2)\n  {\n    id: 28,\n    title: \"Prophet Harun ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Aaron\",\n    description: [\n      \"Harun was Musa's older brother and was appointed by Allah to support Musa in his mission to Fir'awn. Musa prayed for Harun to be his helper, and Allah granted this request mercifully.\",\n      \"Harun was known for his eloquence and gentleness in speech. He stood beside Musa when they confronted Fir'awn and called him to worship Allah alone. Together they showed strength in brotherhood and faith.\",\n      \"When Musa went to Mount Tur to receive the Torah, he left Harun in charge of the Children of Israel. Harun was responsible for guiding them and keeping them on the straight path during Musa's absence.\",\n      \"A man named Samiri led some people astray, creating a golden calf for them to worship. Harun tried to stop them and warned them they were being tested, but many refused to listen to him.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßÿ¨ŸíÿπŸéŸÑ ŸÑŸêŸëŸä ŸàŸéÿ≤ŸêŸäÿ±Ÿãÿß ŸÖŸêŸëŸÜŸí ÿ£ŸéŸáŸíŸÑŸêŸä - ŸáŸéÿßÿ±ŸèŸàŸÜŸé ÿ£ŸéÿÆŸêŸä\",\n      translation: \"And appoint for me a minister from my family‚ÄîHarun, my brother.\",\n      source: \"Qur'an 20:29-30\"\n    },\n    reflection: \"How does Harun's role as Musa's supporter teach us about the importance of helping others?\",\n    quizId: 28\n  },\n\n  // Prophet Harun (2 of 2)\n  {\n    id: 29,\n    title: \"Prophet Harun ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Aaron\",\n    description: [\n      \"When Musa returned and saw his people worshipping the calf, he was furious. He grabbed Harun's beard in anger. Harun explained that he tried to stop them but feared causing division among the believers.\",\n      \"Harun's gentle approach and wisdom prevented the situation from becoming worse. He chose to hold the believers together rather than force them, waiting for Musa's return to handle the crisis with authority and strength.\",\n      \"After the calf incident, Harun continued supporting Musa in leading the Children of Israel. Together they endured the people's complaints and stubbornness during their desert wanderings for forty years, calling them to patience.\",\n      \"Harun passed away before entering the Promised Land. He is remembered for his patience, loyalty to his brother, and dedication to Allah's message. His legacy shows the importance of supporting righteous leadership with wisdom and mercy.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸéÿßŸÑŸé ŸäŸéÿß ÿßÿ®ŸíŸÜŸé ÿ£ŸèŸÖŸéŸë ŸÑŸéÿß ÿ™Ÿéÿ£ŸíÿÆŸèÿ∞Ÿí ÿ®ŸêŸÑŸêÿ≠ŸíŸäŸéÿ™ŸêŸä ŸàŸéŸÑŸéÿß ÿ®Ÿêÿ±Ÿéÿ£Ÿíÿ≥ŸêŸä €ñ ÿ•ŸêŸÜŸêŸëŸä ÿÆŸéÿ¥ŸêŸäÿ™Ÿè ÿ£ŸéŸÜ ÿ™ŸéŸÇŸèŸàŸÑŸé ŸÅŸéÿ±ŸéŸëŸÇŸíÿ™Ÿé ÿ®ŸéŸäŸíŸÜŸé ÿ®ŸéŸÜŸêŸä ÿ•Ÿêÿ≥Ÿíÿ±Ÿéÿßÿ¶ŸêŸäŸÑŸé\",\n      translation: \"He said, 'O son of my mother, do not seize me by my beard or by my head. Indeed, I feared that you would say, You caused division among the Children of Israel.'\",\n      source: \"Qur'an 20:94\"\n    },\n    reflection: \"What does Harun's patience with the difficult people teach us about leadership?\",\n    quizId: 29\n  },\n\n  // Prophet Dhul-Kifl (1 of 2)\n  {\n    id: 30,\n    title: \"Prophet Dhul-Kifl ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"The Patient Prophet\",\n    description: [\n      \"Dhul-Kifl was a righteous prophet known for his patience and commitment to justice. He is mentioned in the Qur'an among the patient prophets who remained steadfast in their worship and calling to truth.\",\n      \"His name means 'the one who guaranteed' or 'the one who took responsibility.' He took upon himself the duty of guiding his people and judging fairly between them with wisdom and understanding every single day.\",\n      \"Dhul-Kifl spent his life teaching people to worship Allah and resolving their disputes with fairness and justice. He never tired of his duties and never let personal comfort stop him from serving his community faithfully.\",\n      \"Shaytaan tried to test Dhul-Kifl's patience by sending people to disturb him during his rest. But Dhul-Kifl remained calm and patient, not allowing anything to disturb his peace or his commitment to his people.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ≥ŸíŸÖŸéÿßÿπŸêŸäŸÑŸé ŸàŸéÿ•ŸêÿØŸíÿ±ŸêŸäÿ≥Ÿé ŸàŸéÿ∞Ÿéÿß ÿßŸÑŸíŸÉŸêŸÅŸíŸÑŸê €ñ ŸÉŸèŸÑŸåŸë ŸÖŸêŸëŸÜŸé ÿßŸÑÿµŸéŸëÿßÿ®Ÿêÿ±ŸêŸäŸÜŸé\",\n      translation: \"And mention Ismail, Idris, and Dhul-Kifl; all were of the patient.\",\n      source: \"Qur'an 21:85\"\n    },\n    reflection: \"How can Dhul-Kifl's dedication to justice inspire us in our daily responsibilities?\",\n    quizId: 30\n  },\n\n  // Prophet Dhul-Kifl (2 of 2)\n  {\n    id: 31,\n    title: \"Prophet Dhul-Kifl ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"The Patient Prophet\",\n    description: [\n      \"Despite tests and trials, Dhul-Kifl never became angry or gave up his duties. His patience became legendary, and he remained committed to helping people and calling them to Allah's path every day.\",\n      \"He fulfilled every promise he made and never broke his commitments to his people or to Allah. His reliability and trustworthiness made him a respected leader among his community and a beloved servant of Allah.\",\n      \"Allah honored Dhul-Kifl by mentioning him in the Qur'an alongside other patient prophets. This shows that patience and keeping promises are qualities Allah loves and rewards generously both in this life and the next.\",\n      \"Dhul-Kifl's story teaches us that true patience isn't just enduring hardship quietly‚Äîit's remaining committed to doing good, serving others, and worshipping Allah no matter what obstacles or distractions come our way.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéÿØŸíÿÆŸéŸÑŸíŸÜŸéÿßŸáŸèŸÖŸí ŸÅŸêŸä ÿ±Ÿéÿ≠ŸíŸÖŸéÿ™ŸêŸÜŸéÿß €ñ ÿ•ŸêŸÜŸéŸëŸáŸèŸÖ ŸÖŸêŸëŸÜŸé ÿßŸÑÿµŸéŸëÿßŸÑŸêÿ≠ŸêŸäŸÜŸé\",\n      translation: \"And We admitted them into Our mercy. Indeed, they were of the righteous.\",\n      source: \"Qur'an 21:86\"\n    },\n    reflection: \"What daily commitments can we make and keep to develop patience like Dhul-Kifl?\",\n    quizId: 31\n  },\n\n  // Prophet Dawud (1 of 2)\n  {\n    id: 32,\n    title: \"Prophet Dawud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"David\",\n    description: [\n      \"Dawud was a young shepherd when the Children of Israel faced the giant warrior Jalut (Goliath) and his massive army. King Talut's army was afraid to fight the terrifying giant and his forces.\",\n      \"Young Dawud stepped forward with faith, saying he would fight Jalut. He relied completely on Allah, not on weapons or armor. With a sling and stone, Dawud struck Jalut and killed him, bringing victory to the believers.\",\n      \"After this victory, Dawud became king and prophet. Allah gave him wisdom, strength, and a beautiful voice for reciting scripture. When Dawud recited the Zabur (Psalms), even birds and mountains would glorify Allah with him.\",\n      \"Dawud was a just ruler who judged fairly between people. Allah gave him knowledge to judge with wisdom. He spent his days worshipping Allah, fasting frequently, and standing in night prayer with complete devotion.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸáŸéÿ≤ŸéŸÖŸèŸàŸáŸèŸÖ ÿ®Ÿêÿ•Ÿêÿ∞ŸíŸÜŸê ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéŸÇŸéÿ™ŸéŸÑŸé ÿØŸéÿßŸàŸèŸàÿØŸè ÿ¨ŸéÿßŸÑŸèŸàÿ™Ÿé ŸàŸéÿ¢ÿ™ŸéÿßŸáŸè ÿßŸÑŸÑŸéŸëŸáŸè ÿßŸÑŸíŸÖŸèŸÑŸíŸÉŸé ŸàŸéÿßŸÑŸíÿ≠ŸêŸÉŸíŸÖŸéÿ©Ÿé\",\n      translation: \"So they defeated them by permission of Allah, and Dawud killed Jalut, and Allah gave him kingship and wisdom.\",\n      source: \"Qur'an 2:251\"\n    },\n    reflection: \"How did Dawud's trust in Allah help him defeat an enemy much stronger than him?\",\n    quizId: 32\n  },\n\n  // Prophet Dawud (2 of 2)\n  {\n    id: 33,\n    title: \"Prophet Dawud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"David\",\n    description: [\n      \"Allah gave Dawud a special gift: iron became soft in his hands like clay. He made armor and shields to protect people in battle. He worked with his own hands, never relying only on his position as king.\",\n      \"Once, two men came to Dawud with a dispute. One had ninety-nine sheep and wanted to take his neighbor's single sheep. Dawud immediately judged in favor of the oppressed man with perfect fairness and justice.\",\n      \"This case was actually a test for Dawud himself about a matter. He realized his mistake, fell in prostration, and asked Allah for forgiveness. Allah forgave him, showing that even prophets seek forgiveness and remain humble.\",\n      \"Dawud's story teaches us that power and position don't excuse injustice. True leadership means working hard, judging fairly, and remaining humble before Allah. When we err, we must seek forgiveness immediately like Dawud did.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéŸÑŸéŸÜŸéŸëÿß ŸÑŸéŸáŸè ÿßŸÑŸíÿ≠ŸéÿØŸêŸäÿØŸé\",\n      translation: \"And We made the iron soft for him.\",\n      source: \"Qur'an 34:10\"\n    },\n    reflection: \"What does Dawud's humility in seeking forgiveness teach us about true greatness?\",\n    quizId: 33\n  },\n\n  // Prophet Sulayman (1 of 2)\n  {\n    id: 34,\n    title: \"Prophet Sulayman ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Solomon\",\n    description: [\n      \"Sulayman was the son of Prophet Dawud. He inherited prophethood and kingship from his father. Allah granted Sulayman a kingdom unlike any before or after, with powers over winds, jinn, animals, and more.\",\n      \"Sulayman could understand the speech of birds and animals. Once, an ant warned other ants about Sulayman's approaching army. Sulayman heard her, smiled, and thanked Allah for this amazing gift of understanding.\",\n      \"The jinn, humans, and birds all worked under Sulayman's command by Allah's permission. He used these blessings not for luxury but to establish justice, spread truth, and build places of worship for Allah alone.\",\n      \"Every morning, Sulayman would inspect his army of horses. Once, he became so absorbed in checking them that he missed the afternoon prayer. He immediately sacrificed them, choosing Allah's pleasure over worldly possessions.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸàŸéÿ±Ÿêÿ´Ÿé ÿ≥ŸèŸÑŸéŸäŸíŸÖŸéÿßŸÜŸè ÿØŸéÿßŸàŸèŸàÿØŸé €ñ ŸàŸéŸÇŸéÿßŸÑŸé ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿè ÿπŸèŸÑŸêŸëŸÖŸíŸÜŸéÿß ŸÖŸéŸÜÿ∑ŸêŸÇŸé ÿßŸÑÿ∑ŸéŸëŸäŸíÿ±Ÿê\",\n      translation: \"And Sulayman inherited Dawud. He said, 'O people, we have been taught the language of birds.'\",\n      source: \"Qur'an 27:16\"\n    },\n    reflection: \"How did Sulayman use his extraordinary powers to serve Allah rather than himself?\",\n    quizId: 34\n  },\n\n  // Prophet Sulayman (2 of 2)\n  {\n    id: 35,\n    title: \"Prophet Sulayman ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Solomon\",\n    description: [\n      \"Sulayman learned that the Queen of Sheba and her people worshipped the sun instead of Allah. He sent a letter inviting her to worship Allah alone and abandon the false worship of created things.\",\n      \"The queen was wise and decided to visit Sulayman herself. Before she arrived, Sulayman asked who could bring her throne to him. A knowledgeable jinn brought it in seconds, demonstrating the power Allah gave Sulayman.\",\n      \"When the queen arrived and saw her throne and Sulayman's magnificent kingdom, she realized this was power from Allah alone. She abandoned sun worship and declared, 'I submit with Sulayman to Allah, Lord of all worlds.'\",\n      \"Despite his vast kingdom, Sulayman remained humble and grateful. He knew everything came from Allah's mercy. His life shows that true success is using blessings to spread Allah's message, not for personal glory or pride.\"\n    ],\n    evidence: {\n      arabic: \"ÿ±Ÿéÿ®ŸêŸë ÿ£ŸéŸàŸíÿ≤ŸêÿπŸíŸÜŸêŸä ÿ£ŸéŸÜŸí ÿ£Ÿéÿ¥ŸíŸÉŸèÿ±Ÿé ŸÜŸêÿπŸíŸÖŸéÿ™ŸéŸÉŸé ÿßŸÑŸéŸëÿ™ŸêŸä ÿ£ŸéŸÜŸíÿπŸéŸÖŸíÿ™Ÿé ÿπŸéŸÑŸéŸäŸéŸë ŸàŸéÿπŸéŸÑŸéŸâŸ∞ ŸàŸéÿßŸÑŸêÿØŸéŸäŸéŸë\",\n      translation: \"My Lord, enable me to be grateful for Your favor which You have bestowed upon me and upon my parents.\",\n      source: \"Qur'an 27:19\"\n    },\n    reflection: \"What does Sulayman's prayer teach us about how to respond to Allah's blessings?\",\n    quizId: 35\n  },\n\n  // Prophet Ilyas (1 of 2)\n  {\n    id: 36,\n    title: \"Prophet Ilyas ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Elijah\",\n    description: [\n      \"Ilyas was sent to the people of Israel when they had turned away from worshipping Allah. They worshipped an idol called Ba'al and abandoned the pure teachings that Musa had brought to them.\",\n      \"King Ahab and his wife Jezebel led the people in idol worship and persecution of true believers. They built temples for Ba'al and forced people to bow to false gods, threatening those who refused.\",\n      \"Ilyas stood alone, calling people back to Tawhid. He warned them that worshipping creation instead of the Creator would bring punishment. He performed miracles by Allah's permission to show them the truth clearly.\",\n      \"The king and queen sought to kill Ilyas for opposing their false religion. The people rejected his message and continued their idol worship. Ilyas felt isolated but never stopped calling them to worship Allah alone faithfully.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜŸéŸë ÿ•ŸêŸÑŸíŸäŸéÿßÿ≥Ÿé ŸÑŸéŸÖŸêŸÜŸé ÿßŸÑŸíŸÖŸèÿ±Ÿíÿ≥ŸéŸÑŸêŸäŸÜŸé\",\n      translation: \"And indeed, Ilyas was from among the messengers.\",\n      source: \"Qur'an 37:123\"\n    },\n    reflection: \"How can Ilyas's courage in standing alone for truth inspire us today?\",\n    quizId: 36\n  },\n\n  // Prophet Ilyas (2 of 2)\n  {\n    id: 37,\n    title: \"Prophet Ilyas ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Elijah\",\n    description: [\n      \"Ilyas challenged the priests of Ba'al to a test: they would call upon their god, and he would call upon Allah. Whichever god answered with fire was the true God worth worshipping.\",\n      \"The priests of Ba'al called upon their idol from morning till afternoon, but nothing happened. Then Ilyas called upon Allah, and immediately fire came down from heaven, proving Allah's power and the idols' worthlessness.\",\n      \"Many people believed after witnessing this clear miracle. But the queen Jezebel became more furious and intensified her persecution. Ilyas had to flee for his life and hide in caves, continuing his mission from there.\",\n      \"Despite persecution and rejection, Ilyas never gave up calling to Tawhid. Allah honored him and mentioned him among the messengers. His story reminds us that standing for truth may be lonely, but Allah is always with the believers.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿí ŸÇŸéÿßŸÑŸé ŸÑŸêŸÇŸéŸàŸíŸÖŸêŸáŸê ÿ£ŸéŸÑŸéÿß ÿ™Ÿéÿ™ŸéŸëŸÇŸèŸàŸÜŸé - ÿ£Ÿéÿ™ŸéÿØŸíÿπŸèŸàŸÜŸé ÿ®ŸéÿπŸíŸÑŸãÿß ŸàŸéÿ™Ÿéÿ∞Ÿéÿ±ŸèŸàŸÜŸé ÿ£Ÿéÿ≠Ÿíÿ≥ŸéŸÜŸé ÿßŸÑŸíÿÆŸéÿßŸÑŸêŸÇŸêŸäŸÜŸé\",\n      translation: \"When he said to his people, 'Will you not fear Allah? Do you call upon Ba'al and leave the best of creators?'\",\n      source: \"Qur'an 37:124-125\"\n    },\n    reflection: \"What does Ilyas's test with the priests teach us about proving truth through Allah's help?\",\n    quizId: 37\n  },\n\n  // Prophet Al-Yasa' (1 of 2)\n  {\n    id: 38,\n    title: \"Prophet Al-Yasa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ' - Part 1\",\n    meaning: \"Elisha\",\n    description: [\n      \"Al-Yasa' was a prophet who succeeded Ilyas in calling the Children of Israel back to the worship of Allah alone. He continued the mission of fighting idol worship and establishing Tawhid among his people.\",\n      \"Like Ilyas before him, Al-Yasa' faced a stubborn people who had been led astray by corrupt kings and false priests. They preferred their idols and worldly pleasures over following Allah's commands and guidance.\",\n      \"Al-Yasa' performed miracles by Allah's permission to show people the truth. He healed the sick, brought blessings to the poor, and demonstrated Allah's power. Yet most people remained ungrateful and stubborn in their disbelief.\",\n      \"Despite the difficulties, Al-Yasa' remained patient and continued his mission with determination. He never gave up on his people, always hoping that more would turn back to Allah and abandon their false worship of idols.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ≥ŸíŸÖŸéÿßÿπŸêŸäŸÑŸé ŸàŸéÿßŸÑŸíŸäŸéÿ≥ŸéÿπŸé ŸàŸéŸäŸèŸàŸÜŸèÿ≥Ÿé ŸàŸéŸÑŸèŸàÿ∑Ÿãÿß €ö ŸàŸéŸÉŸèŸÑŸãŸëÿß ŸÅŸéÿ∂ŸéŸëŸÑŸíŸÜŸéÿß ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"And Ismail and Al-Yasa' and Yunus and Lut. And all of them We preferred over the worlds.\",\n      source: \"Qur'an 6:86\"\n    },\n    reflection: \"What can we learn from Al-Yasa's persistence despite people's rejection?\",\n    quizId: 38\n  },\n\n  // Prophet Al-Yasa' (2 of 2)\n  {\n    id: 39,\n    title: \"Prophet Al-Yasa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ' - Part 2\",\n    meaning: \"Elisha\",\n    description: [\n      \"Al-Yasa' taught his people through both words and actions. He lived a simple, pious life, showing them that true wealth is in faith and closeness to Allah, not in material possessions or power.\",\n      \"He gathered a small group of sincere followers who believed in his message. He taught them the scripture, the laws that Musa had brought, and the importance of worshipping Allah with complete devotion and sincerity.\",\n      \"The kings and corrupt priests opposed Al-Yasa', but Allah protected him and gave him strength to continue. He reminded his people of their covenant with Allah and warned them of the punishment that befell earlier nations.\",\n      \"Al-Yasa' is remembered as one of the righteous prophets who dedicated his life to calling people to Allah. Though his name is mentioned briefly in the Qur'an, his legacy of patience and perseverance lives on.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßÿ∞ŸíŸÉŸèÿ±Ÿí ÿ•Ÿêÿ≥ŸíŸÖŸéÿßÿπŸêŸäŸÑŸé ŸàŸéÿßŸÑŸíŸäŸéÿ≥ŸéÿπŸé ŸàŸéÿ∞Ÿéÿß ÿßŸÑŸíŸÉŸêŸÅŸíŸÑŸê €ñ ŸàŸéŸÉŸèŸÑŸåŸë ŸÖŸêŸëŸÜŸé ÿßŸÑŸíÿ£ŸéÿÆŸíŸäŸéÿßÿ±Ÿê\",\n      translation: \"And remember Ismail, Al-Yasa', and Dhul-Kifl. And all are among the outstanding.\",\n      source: \"Qur'an 38:48\"\n    },\n    reflection: \"How does Al-Yasa's dedication to teaching remind us of our duty to share knowledge?\",\n    quizId: 39\n  },\n\n  // Prophet Yunus (1 of 2)\n  {\n    id: 40,\n    title: \"Prophet Yunus ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Jonah\",\n    description: [\n      \"Yunus was sent to the people of Nineveh (in modern-day Iraq) to call them to worship Allah. He preached to them for years, but they stubbornly rejected his message and continued their disbelief and sins.\",\n      \"Frustrated by their rejection, Yunus left the city without Allah's permission, thinking his mission had failed. He boarded a ship heading to another land, trying to escape from the burden of his people's stubbornness.\",\n      \"During the voyage, a violent storm struck the ship. The crew believed someone on board was the cause and cast lots to find out who. The lot fell on Yunus, who admitted the truth.\",\n      \"Yunus threw himself into the raging sea, and Allah sent a huge whale to swallow him. He wasn't harmed but was trapped in the belly of the whale, surrounded by three layers of darkness: night, sea, and whale.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿßŸÑŸíÿ™ŸéŸÇŸéŸÖŸéŸáŸè ÿßŸÑŸíÿ≠ŸèŸàÿ™Ÿè ŸàŸéŸáŸèŸàŸé ŸÖŸèŸÑŸêŸäŸÖŸå\",\n      translation: \"Then the whale swallowed him, while he was blameworthy.\",\n      source: \"Qur'an 37:142\"\n    },\n    reflection: \"What does Yunus's story teach us about leaving our responsibilities without Allah's permission?\",\n    quizId: 40\n  },\n\n  // Prophet Yunus (2 of 2)\n  {\n    id: 41,\n    title: \"Prophet Yunus ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Jonah\",\n    description: [\n      \"In the darkness of the whale's belly, Yunus realized his mistake. He turned to Allah in sincere repentance, declaring: 'There is no god except You; exalted are You. Indeed, I have been of the wrongdoers.'\",\n      \"This beautiful du'a, made with complete humility and sincere regret, was answered immediately. Allah commanded the whale to cast Yunus onto the shore. He was weak and exhausted but alive and forgiven.\",\n      \"Allah caused a plant to grow over Yunus to shade and comfort him as he recovered. Meanwhile, back in Nineveh, the people saw signs of approaching punishment and finally believed, repenting sincerely to Allah.\",\n      \"Allah accepted the people's repentance and removed the punishment. Yunus returned to them and found them all believers. His story shows Allah's mercy: He forgives those who repent sincerely, no matter their past mistakes or sins.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸëÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜÿ™Ÿé ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸéŸÉŸé ÿ•ŸêŸÜŸêŸëŸä ŸÉŸèŸÜÿ™Ÿè ŸÖŸêŸÜŸé ÿßŸÑÿ∏ŸéŸëÿßŸÑŸêŸÖŸêŸäŸÜŸé\",\n      translation: \"There is no deity except You; exalted are You. Indeed, I have been of the wrongdoers.\",\n      source: \"Qur'an 21:87\"\n    },\n    reflection: \"How can we use Yunus's du'a when we face difficulties caused by our own mistakes?\",\n    quizId: 41\n  },\n\n  // ============================================================\n  // SECTION 3: Prophets Before 'ƒ™sƒÅ\n  // ============================================================\n\n  // Prophet Zakariyya (1 of 2)\n  {\n    id: 42,\n    title: \"Prophet Zakariyya ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Zechariah\",\n    description: [\n      \"Zakariyya was a righteous prophet and guardian of Maryam (Mary). He was very old, and his wife was barren. He had no children and worried there would be no one to continue his mission after him.\",\n      \"Every time Zakariyya entered Maryam's prayer chamber, he found fresh fruits with her‚Äîsummer fruits in winter, winter fruits in summer. When he asked where they came from, she said, 'From Allah. Allah provides without limit.'\",\n      \"Seeing this miracle, Zakariyya realized that Allah can provide anything He wills, even the impossible. He made a private du'a asking Allah for a righteous child despite his old age and his wife's inability to bear children.\",\n      \"Zakariyya's du'a was sincere and humble. He prayed, 'My Lord, do not leave me alone, and You are the best of inheritors.' He asked not for worldly glory but for someone to carry on his message.\"\n    ],\n    evidence: {\n      arabic: \"ÿ±Ÿéÿ®ŸêŸë ŸÑŸéÿß ÿ™Ÿéÿ∞Ÿéÿ±ŸíŸÜŸêŸä ŸÅŸéÿ±ŸíÿØŸãÿß ŸàŸéÿ£ŸéŸÜÿ™Ÿé ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑŸíŸàŸéÿßÿ±Ÿêÿ´ŸêŸäŸÜŸé\",\n      translation: \"My Lord, do not leave me alone, and You are the best of inheritors.\",\n      source: \"Qur'an 21:89\"\n    },\n    reflection: \"How did witnessing Maryam's miracles strengthen Zakariyya's faith and inspire his du'a?\",\n    quizId: 42\n  },\n\n  // Prophet Zakariyya (2 of 2)\n  {\n    id: 43,\n    title: \"Prophet Zakariyya ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Zechariah\",\n    description: [\n      \"While Zakariyya was praying in the temple, angels gave him glad tidings: 'Allah gives you good news of Yahya, confirming a word from Allah, honorable, chaste, and a prophet from among the righteous.'\",\n      \"Zakariyya was amazed and asked, 'How can I have a son when I am old and my wife is barren?' The angels replied, 'Thus Allah does what He wills. Nothing is impossible for Him.'\",\n      \"As a sign, Allah made Zakariyya unable to speak to people for three days, though he could still glorify Allah. He praised Allah day and night, his heart filled with gratitude for this miraculous blessing.\",\n      \"Zakariyya's story teaches us that age, circumstances, or apparent impossibilities don't limit Allah's power. When we make du'a with sincerity and trust, Allah can answer in ways beyond our imagination and understanding completely.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸéÿßŸÑŸé ÿ±Ÿéÿ®ŸêŸë ÿ£ŸéŸÜŸéŸëŸâŸ∞ ŸäŸéŸÉŸèŸàŸÜŸè ŸÑŸêŸä ÿ∫ŸèŸÑŸéÿßŸÖŸå ŸàŸéŸÇŸéÿØŸí ÿ®ŸéŸÑŸéÿ∫ŸéŸÜŸêŸäŸé ÿßŸÑŸíŸÉŸêÿ®Ÿéÿ±Ÿè ŸàŸéÿßŸÖŸíÿ±Ÿéÿ£Ÿéÿ™ŸêŸä ÿπŸéÿßŸÇŸêÿ±Ÿå €ñ ŸÇŸéÿßŸÑŸé ŸÉŸéÿ∞ŸéŸ∞ŸÑŸêŸÉŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸäŸéŸÅŸíÿπŸéŸÑŸè ŸÖŸéÿß ŸäŸéÿ¥Ÿéÿßÿ°Ÿè\",\n      translation: \"He said, 'My Lord, how will I have a boy when I have reached old age and my wife is barren?' He said, 'Such is Allah; He does what He wills.'\",\n      source: \"Qur'an 3:40\"\n    },\n    reflection: \"What does Zakariyya's response to Allah's answer teach us about accepting Allah's will?\",\n    quizId: 43\n  },\n\n  // Prophet Yahya (1 of 2)\n  {\n    id: 44,\n    title: \"Prophet Yahya ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"John the Baptist\",\n    description: [\n      \"Yahya was born to Zakariyya and his wife in their old age, a miracle from Allah. His name means 'he lives,' as he brought new life to his parents' hopes and to the message of truth.\",\n      \"From childhood, Yahya was wise, pious, and serious about worship. Allah says, 'We gave him wisdom even as a child.' He understood scripture deeply and lived by it with complete dedication and devotion.\",\n      \"Yahya was known for his purity and chastity. He stayed away from worldly pleasures and focused entirely on worship and calling people to Allah. He never married, dedicating his whole life to serving Allah alone.\",\n      \"He was extremely kind and respectful to his parents. The Qur'an describes him as 'dutiful to his parents and neither arrogant nor disobedient.' His manners and character were absolutely beautiful and exemplary for all believers.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ¢ÿ™ŸéŸäŸíŸÜŸéÿßŸáŸè ÿßŸÑŸíÿ≠ŸèŸÉŸíŸÖŸé ÿµŸéÿ®ŸêŸäŸãŸëÿß\",\n      translation: \"And We gave him wisdom even as a child.\",\n      source: \"Qur'an 19:12\"\n    },\n    reflection: \"What can we learn from Yahya about staying focused on Allah despite worldly distractions?\",\n    quizId: 44\n  },\n\n  // Prophet Yahya (2 of 2)\n  {\n    id: 45,\n    title: \"Prophet Yahya ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"John the Baptist\",\n    description: [\n      \"Yahya called the Children of Israel to return to pure worship of Allah. He spoke boldly against sin and corruption, even when it meant confronting powerful kings and leaders with the truth fearlessly.\",\n      \"He baptized people in the Jordan River as a symbol of spiritual purification and repentance. He prepared the way for the coming of Prophet 'Isa, calling people to reform their hearts and lives before his arrival.\",\n      \"Yahya was martyred for speaking truth to power. He condemned the king's immoral marriage, and the king's wife plotted his death. Yahya died as a martyr, never compromising truth for safety or comfort.\",\n      \"Yahya's life shows us that true piety means complete dedication to Allah and His commands. He lived purely, spoke truthfully, and died honorably. His legacy is one of unwavering integrity and fearless commitment to righteousness.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ®Ÿéÿ±ŸãŸëÿß ÿ®ŸêŸàŸéÿßŸÑŸêÿØŸéŸäŸíŸáŸê ŸàŸéŸÑŸéŸÖŸí ŸäŸéŸÉŸèŸÜ ÿ¨Ÿéÿ®ŸéŸëÿßÿ±Ÿãÿß ÿπŸéÿµŸêŸäŸãŸëÿß\",\n      translation: \"And dutiful to his parents, and he was not a disobedient tyrant.\",\n      source: \"Qur'an 19:14\"\n    },\n    reflection: \"How does Yahya's courage in speaking truth inspire us to stand for what is right?\",\n    quizId: 45\n  },\n\n  // Prophet 'Isa (1 of 2)\n  {\n    id: 46,\n    title: \"Prophet 'Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 1\",\n    meaning: \"Jesus\",\n    description: [\n      \"'Isa was born to Maryam (Mary) miraculously without a father, as a sign of Allah's power. Angels told her she was chosen above all women and would give birth to a blessed prophet and messenger.\",\n      \"When Maryam's people saw her with a baby, they accused her of wrongdoing. But baby 'Isa spoke from the cradle, declaring: 'I am the servant of Allah. He has given me the Scripture and made me a prophet.'\",\n      \"As 'Isa grew, Allah taught him the Torah and the Gospel. He performed miracles by Allah's permission: healing the blind, curing lepers, and even bringing the dead back to life to prove his message was from Allah.\",\n      \"'Isa called the Children of Israel to worship Allah alone, to be just and kind, and to follow the law that Musa had brought. He taught pure Tawhid, saying, 'Allah is my Lord and your Lord, so worship Him.'\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸéÿßŸÑŸé ÿ•ŸêŸÜŸêŸëŸä ÿπŸéÿ®ŸíÿØŸè ÿßŸÑŸÑŸéŸëŸáŸê ÿ¢ÿ™ŸéÿßŸÜŸêŸäŸé ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿé ŸàŸéÿ¨ŸéÿπŸéŸÑŸéŸÜŸêŸä ŸÜŸéÿ®ŸêŸäŸãŸëÿß\",\n      translation: \"He said, 'Indeed, I am the servant of Allah. He has given me the Scripture and made me a prophet.'\",\n      source: \"Qur'an 19:30\"\n    },\n    reflection: \"What does 'Isa speaking from the cradle teach us about Allah's power over all things?\",\n    quizId: 46\n  },\n\n  // Prophet 'Isa (2 of 2)\n  {\n    id: 47,\n    title: \"Prophet 'Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ - Part 2\",\n    meaning: \"Jesus\",\n    description: [\n      \"Some of the Children of Israel believed in 'Isa, but many rejected him. The corrupt priests and leaders plotted to kill him because he exposed their hypocrisy and called them back to true worship.\",\n      \"When they came to arrest him, Allah saved 'Isa by raising him to the heavens. Someone else was made to look like him, and that person was crucified instead. 'Isa was never killed nor crucified.\",\n      \"'Isa remains alive in the heavens and will return before the Day of Judgment. He will come back to establish justice, defeat the false messiah, and call all people to worship Allah alone.\",\n      \"'Isa's story teaches us that he was a noble prophet and servant of Allah, not divine. He never claimed to be Allah's son or god. He preached pure Tawhid and will testify on Judgment Day that he called people only to Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ŸÇŸéÿ™ŸéŸÑŸèŸàŸáŸè ŸàŸéŸÖŸéÿß ÿµŸéŸÑŸéÿ®ŸèŸàŸáŸè ŸàŸéŸÑŸéŸ∞ŸÉŸêŸÜ ÿ¥Ÿèÿ®ŸêŸëŸáŸé ŸÑŸéŸáŸèŸÖŸí\",\n      translation: \"And they did not kill him, nor did they crucify him; but another was made to resemble him to them.\",\n      source: \"Qur'an 4:157\"\n    },\n    reflection: \"How does understanding 'Isa's true message help us appreciate the final message of Islam?\",\n    quizId: 47\n  }\n];\n\nexport default prophetsLessons;\n","path":null,"size_bytes":68265,"size_tokens":null},"src/data/lessonLoader.js":{"content":"// src/data/lessonLoader.js\nimport namesOfAllahLessonsFull from \"./lessons/namesOfAllahLessonsFull.js\";\nimport foundationsLessons from \"./lessons/foundationsLessons.js\";\nimport prophetsLessons from \"./lessons/prophetsLessons.js\";\nimport prophetLifeLessons from \"./lessons/prophetLifeLessons.js\";\nimport wivesLessons from \"./lessons/wivesLessons.js\";\nimport tenPromisedLessons from \"./lessons/tenPromisedLessons.js\";\nimport fourWomenLessons from \"./lessons/fourWomenLessons.js\";\nimport companionsLessons from \"./lessons/companionsLessons.js\";\nimport angelsLessons from \"./lessons/angelsLessons.js\";\nimport endTimesLessons from \"./lessons/endTimesLessons.js\";\nimport graveLessons from \"./lessons/graveLessons.js\";\nimport judgementLessons from \"./lessons/judgementLessons.js\";\nimport { hellfireLessons } from \"./lessons/hellfireLessons.js\";\nimport { paradiseLessons } from \"./lessons/paradiseLessons.js\";\n\nimport { useProgressStore } from \"../store/progressStore\";\n\n/**\n * üîí Get lessons for a specific path.\n * Handles initial unlock and premium flagging.\n */\nexport function getLessonsForPath(pathId) {\n  const numericId = Number(pathId);\n  let lessons = [];\n\n  switch (numericId) {\n    case 1:\n      lessons = namesOfAllahLessonsFull;\n      break;\n    case 2:\n      lessons = foundationsLessons;\n      break;\n    case 3:\n      lessons = prophetsLessons;\n      break;\n    case 4:\n      lessons = prophetLifeLessons;\n      break;\n    case 5:\n      lessons = wivesLessons;\n      break;\n    case 6:\n      lessons = tenPromisedLessons;\n      break;\n    case 7:\n      lessons = fourWomenLessons;\n      break;\n    case 8:\n      lessons = companionsLessons;\n      break;\n    case 9:\n      lessons = angelsLessons;\n      break;\n    case 10:\n      lessons = endTimesLessons;\n      break;\n    case 11:\n      lessons = graveLessons;\n      break;\n    case 12:\n      lessons = judgementLessons;\n      break;\n    case 13:\n      lessons = hellfireLessons;\n      break;\n    case 14:\n      lessons = paradiseLessons;\n      break;\n    default:\n      lessons = [];\n  }\n\n  // ‚úÖ Add lesson metadata\n  return lessons.map((lesson, index) => ({\n    ...lesson,\n    id: index + 1,\n    unlocked: index === 0, // first lesson always unlocked\n    premium: numericId === 1 && index + 1 > 10, // Names of Allah premium flag (lesson 11+)\n  }));\n}\n\n/**\n * Short list helper for cards or summaries\n */\nexport function getShortLessonList(pathId) {\n  const fullLessons = getLessonsForPath(pathId);\n  return fullLessons.map((lesson) => ({\n    id: lesson.id,\n    title: lesson.title,\n    meaning: lesson.meaning,\n    quizId: lesson.quizId,\n    unlocked: lesson.unlocked,\n    premium: lesson.premium,\n  }));\n}\n","path":null,"size_bytes":2674,"size_tokens":null},"src/data/lessons/endTimesLessons.js":{"content":"// Major Signs of the End Times Learning Path\n// 13 lessons about the final events before the Day of Judgment\n// Each lesson: 3 paragraphs (~23 words each), authentic Quranic/hadith evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, Sahih Muslim, Abu Dawud, and Tirmidhi (authentic)\n\nconst endTimesLessons = [\n  {\n    id: 1,\n    title: \"Introduction to Major Signs\",\n    description: [\n      \"The Prophet Ô∑∫ taught us about major signs that will appear before the Day of Judgment. These signs are clear warnings that the Hour is near and time is ending.\",\n      \"The major signs are extraordinary events that have never happened before. When they begin appearing, they will come quickly one after another like beads falling from a broken necklace.\",\n      \"Learning these signs helps us prepare for the Hereafter. We must increase our good deeds and strengthen our faith before these tremendous events begin to unfold across the world.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÇŸíÿ™Ÿéÿ±Ÿéÿ®Ÿéÿ™Ÿê ÿßŸÑÿ≥ŸéŸëÿßÿπŸéÿ©Ÿè ŸàŸéÿßŸÜÿ¥ŸéŸÇŸéŸë ÿßŸÑŸíŸÇŸéŸÖŸéÿ±Ÿè\",\n      translation: \"The Hour has come near, and the moon has split in two.\",\n      source: \"Qur'an 54:1\"\n    },\n    keyLesson: \"The major signs warn us that the Day of Judgment is approaching, so we must prepare through faith and righteous deeds.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Imam Mahdi\",\n    description: [\n      \"The Mahdi will be a righteous leader from the Prophet's Ô∑∫ family who appears during a time of great oppression and injustice. His name will be Muhammad Ô∑∫ ibn Abdullah like the Prophet Ô∑∫.\",\n      \"He will unite the Muslims and establish justice throughout the earth. People will live in peace and prosperity under his leadership. Wealth will be distributed fairly and no one will be in need.\",\n      \"The Mahdi will rule for seven years according to authentic hadith. During his time, Prophet  øƒ™sƒÅ will descend from Heaven and they will pray together, with  øƒ™sƒÅ praying behind the Mahdi.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸàŸí ŸÑŸéŸÖŸí ŸäŸéÿ®ŸíŸÇŸé ŸÖŸêŸÜŸé ÿßŸÑÿØŸèŸëŸÜŸíŸäŸéÿß ÿ•ŸêŸÑÿßŸéŸë ŸäŸéŸàŸíŸÖŸå ŸÑŸéÿ∑ŸéŸàŸéŸëŸÑŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ∞ŸéŸÑŸêŸÉŸé ÿßŸÑŸíŸäŸéŸàŸíŸÖŸé ÿ≠Ÿéÿ™ŸéŸëŸâ ŸäŸéÿ®ŸíÿπŸéÿ´Ÿé ŸÅŸêŸäŸáŸê ÿ±Ÿéÿ¨ŸèŸÑÿßŸã ŸÖŸêŸÜŸêŸëŸä ÿ£ŸéŸàŸí ŸÖŸêŸÜŸí ÿ£ŸéŸáŸíŸÑŸê ÿ®ŸéŸäŸíÿ™ŸêŸä ŸäŸèŸàŸéÿßÿ∑Ÿêÿ¶Ÿè ÿßÿ≥ŸíŸÖŸèŸáŸè ÿßÿ≥ŸíŸÖŸêŸä ŸàŸéÿßÿ≥ŸíŸÖŸè ÿ£Ÿéÿ®ŸêŸäŸáŸê ÿßÿ≥ŸíŸÖŸé ÿ£Ÿéÿ®ŸêŸä\",\n      translation: \"If only one day remained for the world, Allah would lengthen that day until He sends a man from me or from my household whose name matches my name and whose father's name matches my father's name.\",\n      source: \"Abu Dawud 4282\"\n    },\n    keyLesson: \"The Mahdi will restore justice when the world is filled with oppression, showing Allah's mercy and plan for humanity.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"DajjƒÅl (The False Messiah)\",\n    description: [\n      \"The DajjƒÅl is the greatest trial humanity will ever face. He will claim to be God and deceive many people with false miracles and lies. He is blind in the right eye with the word 'disbeliever' written on his forehead.\",\n      \"The DajjƒÅl will travel the entire earth in forty days, bringing what looks like Paradise and Hell. What he calls Paradise will actually be Hell, and what he calls Hell will be Paradise, testing people's faith.\",\n      \"The Prophet Ô∑∫ warned about the DajjƒÅl more than any other trial. He taught us to seek Allah's protection from the DajjƒÅl in every prayer. Memorizing Surah Al-Kahf's opening verses protects us from his deception.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéÿß ÿ®ŸéŸäŸíŸÜŸé ÿÆŸéŸÑŸíŸÇŸê ÿ¢ÿØŸéŸÖŸé ÿ•ŸêŸÑŸéŸâ ŸÇŸêŸäŸéÿßŸÖŸê ÿßŸÑÿ≥ŸéŸëÿßÿπŸéÿ©Ÿê ÿ£ŸéŸÖŸíÿ±Ÿå ÿ£ŸéŸÉŸíÿ®Ÿéÿ±Ÿè ŸÖŸêŸÜŸé ÿßŸÑÿØŸéŸëÿ¨ŸéŸëÿßŸÑŸê\",\n      translation: \"From the creation of Adam until the establishment of the Hour, there is no matter greater than the DajjƒÅl.\",\n      source: \"Sahih Muslim 2946\"\n    },\n    keyLesson: \"The DajjƒÅl will be the ultimate test of faith, so we must strengthen our belief and seek Allah's protection daily.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \" øƒ™sƒÅ ibn Maryam (Jesus)\",\n    description: [\n      \"Prophet  øƒ™sƒÅ will descend from Heaven to a white minaret in Damascus while wearing two yellow garments. He will place his hands on angels' wings and descend during the time of Fajr prayer.\",\n      \" øƒ™sƒÅ will pursue the DajjƒÅl and kill him at the gate of Lud in Palestine. When the DajjƒÅl sees  øƒ™sƒÅ, he will melt like salt dissolves in water, but  øƒ™sƒÅ will kill him with his spear.\",\n      \"After defeating the DajjƒÅl,  øƒ™sƒÅ will rule with justice according to Islamic law. He will break the cross, abolish the jizyah tax, and refuse all wealth. Peace and prosperity will spread across the earth.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜŸéŸëŸáŸè ŸÑŸéÿπŸêŸÑŸíŸÖŸå ŸÑŸêŸëŸÑÿ≥ŸéŸëÿßÿπŸéÿ©Ÿê ŸÅŸéŸÑŸéÿß ÿ™ŸéŸÖŸíÿ™Ÿéÿ±ŸèŸÜŸéŸë ÿ®ŸêŸáŸéÿß\",\n      translation: \"And indeed,  øƒ™sƒÅ will be a sign for the Hour, so be not in doubt of it.\",\n      source: \"Qur'an 43:61\"\n    },\n    keyLesson: \" øƒ™sƒÅ's return proves Allah's power and the truth of resurrection, bringing justice and defeating the greatest deception.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"YƒÅ æj≈´j & MƒÅj≈´j (Gog and Magog)\",\n    description: [\n      \"YƒÅ æj≈´j and MƒÅj≈´j are two massive tribes trapped behind a barrier built by Dhul-Qarnayn long ago. Every day they dig through the barrier but cannot break through until Allah permits their release.\",\n      \"When Allah allows them to emerge, they will spread across the earth drinking rivers dry and causing destruction. They will be so numerous that their first group drinks a lake completely while their last group finds it empty.\",\n      \" øƒ™sƒÅ and the believers will seek refuge on Mount Tur, making du øƒÅ æ to Allah for protection. Allah will send worms that will kill all of YƒÅ æj≈´j and MƒÅj≈´j overnight, filling the earth with their bodies and stench.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ÿ•Ÿêÿ∞Ÿéÿß ŸÅŸèÿ™Ÿêÿ≠Ÿéÿ™Ÿí ŸäŸéÿ£Ÿíÿ¨ŸèŸàÿ¨Ÿè ŸàŸéŸÖŸéÿ£Ÿíÿ¨ŸèŸàÿ¨Ÿè ŸàŸéŸáŸèŸÖ ŸÖŸêŸëŸÜ ŸÉŸèŸÑŸêŸë ÿ≠ŸéÿØŸéÿ®Ÿç ŸäŸéŸÜÿ≥ŸêŸÑŸèŸàŸÜŸé\",\n      translation: \"Until when YƒÅ æj≈´j and MƒÅj≈´j are opened and they, from every elevation, descend.\",\n      source: \"Qur'an 21:96\"\n    },\n    keyLesson: \"No matter how powerful destruction seems, only Allah controls all events and protects the believers through His mercy.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Beast of the Earth\",\n    description: [\n      \"A massive beast will emerge from the earth in Makkah near Mount Safa when people have corrupted the religion and rejected Allah's signs. This beast will be unlike any creature seen before.\",\n      \"The beast will speak to people in clear words, telling them that mankind did not believe with certainty in Allah's revelations. It will mark every person on their face showing who is a believer and who is a disbeliever.\",\n      \"The beast carries the staff of Prophet Musa and the seal of Prophet Sulayman. It will mark believers with the staff making their faces bright and mark disbelievers with the seal making their faces dark.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ∞Ÿéÿß ŸàŸéŸÇŸéÿπŸé ÿßŸÑŸíŸÇŸéŸàŸíŸÑŸè ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸí ÿ£ŸéÿÆŸíÿ±Ÿéÿ¨ŸíŸÜŸéÿß ŸÑŸéŸáŸèŸÖŸí ÿØŸéÿßÿ®ŸéŸëÿ©Ÿã ŸÖŸêŸëŸÜŸé ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ÿ™ŸèŸÉŸéŸÑŸêŸëŸÖŸèŸáŸèŸÖŸí ÿ£ŸéŸÜŸéŸë ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé ŸÉŸéÿßŸÜŸèŸàÿß ÿ®Ÿêÿ¢ŸäŸéÿßÿ™ŸêŸÜŸéÿß ŸÑŸéÿß ŸäŸèŸàŸÇŸêŸÜŸèŸàŸÜŸé\",\n      translation: \"And when the word befalls them, We will bring forth for them a creature from the earth speaking to them that the people were not certain of Our verses.\",\n      source: \"Qur'an 27:82\"\n    },\n    keyLesson: \"The beast will expose everyone's true faith publicly, making belief and disbelief visible for all to see clearly.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"The Smoke\",\n    description: [\n      \"A thick smoke will cover the entire earth for forty days. This smoke will be so dense and widespread that it blocks out the sky and affects every person on the planet.\",\n      \"The smoke will cause believers to experience something like a common cold with discomfort and difficulty. But it will severely torture disbelievers, entering their ears, noses, and throats causing them extreme pain and suffering.\",\n      \"People will cry out to Allah begging for the smoke to be removed. Allah will lift the smoke temporarily, but most people will return to their disbelief and sins instead of repenting sincerely and permanently.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿßÿ±Ÿíÿ™ŸéŸÇŸêÿ®Ÿí ŸäŸéŸàŸíŸÖŸé ÿ™Ÿéÿ£Ÿíÿ™ŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿè ÿ®ŸêÿØŸèÿÆŸéÿßŸÜŸç ŸÖŸèŸëÿ®ŸêŸäŸÜŸç ŸäŸéÿ∫Ÿíÿ¥ŸéŸâ ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé €ñ ŸáŸéŸ∞ÿ∞Ÿéÿß ÿπŸéÿ∞Ÿéÿßÿ®Ÿå ÿ£ŸéŸÑŸêŸäŸÖŸå\",\n      translation: \"Then watch for the Day when the sky will bring a visible smoke covering the people; this is a painful punishment.\",\n      source: \"Qur'an 44:10-11\"\n    },\n    keyLesson: \"The smoke will test humanity one final time, but most will still refuse to believe despite clear signs.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Sun Rising from the West\",\n    description: [\n      \"One day the sun will rise from the west instead of the east. On that morning, the door of repentance will close forever and no new faith or repentance will be accepted.\",\n      \"When people see the sun rising from the west, every person will believe in Allah. But this belief will not benefit anyone who did not believe before that moment or earn good deeds through their faith.\",\n      \"After the sun rises from the west, it will set again in the east. For three days the sun will continue rising from the west, then it will return to rising from the east as normal until the end of time.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿß ÿ™ŸéŸÇŸèŸàŸÖŸè ÿßŸÑÿ≥ŸéŸëÿßÿπŸéÿ©Ÿè ÿ≠Ÿéÿ™ŸéŸëŸâ ÿ™Ÿéÿ∑ŸíŸÑŸèÿπŸé ÿßŸÑÿ¥ŸéŸëŸÖŸíÿ≥Ÿè ŸÖŸêŸÜŸí ŸÖŸéÿ∫Ÿíÿ±Ÿêÿ®ŸêŸáŸéÿßÿå ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ÿ∑ŸéŸÑŸéÿπŸéÿ™Ÿí ŸÅŸéÿ±Ÿéÿ¢ŸáŸéÿß ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿè ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿ£Ÿéÿ¨ŸíŸÖŸéÿπŸèŸàŸÜŸéÿå ŸÅŸéÿ∞ŸéŸÑŸêŸÉŸé ÿ≠ŸêŸäŸÜŸé ŸÑŸéÿß ŸäŸéŸÜŸíŸÅŸéÿπŸè ŸÜŸéŸÅŸíÿ≥Ÿãÿß ÿ•ŸêŸäŸÖŸéÿßŸÜŸèŸáŸéÿß ŸÑŸéŸÖŸí ÿ™ŸéŸÉŸèŸÜŸí ÿ¢ŸÖŸéŸÜŸéÿ™Ÿí ŸÖŸêŸÜŸí ŸÇŸéÿ®ŸíŸÑŸè\",\n      translation: \"The Hour will not be established until the sun rises from the west. When it rises and people see it, they will all believe, but that is when faith will not benefit a soul that had not believed before.\",\n      source: \"Sahih Bukhari 4636\"\n    },\n    keyLesson: \"We must believe and do good deeds now because the time will come when repentance is no longer accepted.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Three Landslides\",\n    description: [\n      \"Three massive landslides will occur in different parts of the earth: one in the east, one in the west, and one in the Arabian Peninsula. These will be catastrophic natural disasters swallowing cities.\",\n      \"These landslides will cause entire regions to sink into the ground as punishment for the widespread evil, immorality, and rejection of Allah's guidance that will fill the earth at that time.\",\n      \"The Prophet Ô∑∫ described these events as part of the final signs. They will happen after other major signs have appeared, showing that the end is extremely near and the Day of Judgment approaches rapidly.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿß ÿ™ŸéŸÇŸèŸàŸÖŸè ÿßŸÑÿ≥ŸéŸëÿßÿπŸéÿ©Ÿè ÿ≠Ÿéÿ™ŸéŸëŸâ ŸäŸèŸÇŸíÿ®Ÿéÿ∂Ÿé ÿßŸÑŸíÿπŸêŸÑŸíŸÖŸèÿå ŸàŸéÿ™ŸéŸÉŸíÿ´Ÿèÿ±Ÿé ÿßŸÑÿ≤ŸéŸëŸÑŸéÿßÿ≤ŸêŸÑŸèÿå ŸàŸéŸäŸéÿ™ŸéŸÇŸéÿßÿ±Ÿéÿ®Ÿé ÿßŸÑÿ≤ŸéŸëŸÖŸéÿßŸÜŸè... ŸàŸéÿ≠Ÿéÿ™ŸéŸëŸâ ŸäŸéŸÉŸèŸàŸÜŸé ÿßŸÑŸíÿÆŸéÿ≥ŸíŸÅŸè: ÿÆŸéÿ≥ŸíŸÅŸå ÿ®ŸêÿßŸÑŸíŸÖŸéÿ¥Ÿíÿ±ŸêŸÇŸêÿå ŸàŸéÿÆŸéÿ≥ŸíŸÅŸå ÿ®ŸêÿßŸÑŸíŸÖŸéÿ∫Ÿíÿ±Ÿêÿ®Ÿêÿå ŸàŸéÿÆŸéÿ≥ŸíŸÅŸå ÿ®Ÿêÿ¨Ÿéÿ≤ŸêŸäÿ±Ÿéÿ©Ÿê ÿßŸÑŸíÿπŸéÿ±Ÿéÿ®Ÿê\",\n      translation: \"The Hour will not be established until knowledge is taken away, earthquakes increase, time passes quickly... and there are three landslides: one in the east, one in the west, and one in the Arabian Peninsula.\",\n      source: \"Sahih Bukhari 7121\"\n    },\n    keyLesson: \"The earth itself will testify against the evil of disbelievers by swallowing them in three different regions.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Fire from Yemen\",\n    description: [\n      \"A massive fire will emerge from Yemen or from the direction of Aden. This fire will be so huge and powerful that it will drive all remaining people toward the place of final gathering.\",\n      \"The fire will travel slowly, allowing people to flee ahead of it. It will stop when they stop to rest and continue when they continue their journey. It will gather all of humanity to one location.\",\n      \"This fire will be the last sign before the Day of Judgment itself begins. After this fire gathers everyone, the Hour will be established and all of creation will face their final reckoning before Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ¢ÿÆŸêÿ±Ÿè ÿ∞ŸéŸÑŸêŸÉŸé ŸÜŸéÿßÿ±Ÿå ÿ™ŸéÿÆŸíÿ±Ÿèÿ¨Ÿè ŸÖŸêŸÜŸé ÿßŸÑŸíŸäŸéŸÖŸéŸÜŸê ÿ™Ÿéÿ∑Ÿíÿ±ŸèÿØŸè ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé ÿ•ŸêŸÑŸéŸâ ŸÖŸéÿ≠Ÿíÿ¥Ÿéÿ±ŸêŸáŸêŸÖŸí\",\n      translation: \"And the last of that will be a fire which will emerge from Yemen and drive the people to their place of gathering.\",\n      source: \"Sahih Muslim 2901\"\n    },\n    keyLesson: \"The fire from Yemen will gather all remaining people to one place, marking the absolute end of worldly life.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"First Trumpet (Blown by IsrƒÅfƒ´l)\",\n    description: [\n      \"Angel IsrƒÅfƒ´l stands ready with the trumpet at his lips, waiting for Allah's command. When Allah orders him, he will blow the trumpet and every living soul will die instantly except those Allah wills.\",\n      \"The sound of the trumpet will be terrifying and overwhelming. Mountains will crumble into dust, the earth will shake violently, and all creatures in the heavens and earth will fall dead in a single moment.\",\n      \"After everything dies and time passes, IsrƒÅfƒ´l will blow the trumpet a second time. At that moment, all of creation will be resurrected and brought back to life for the Day of Judgment and accountability.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸèŸÅŸêÿÆŸé ŸÅŸêŸä ÿßŸÑÿµŸèŸëŸàÿ±Ÿê ŸÅŸéÿµŸéÿπŸêŸÇŸé ŸÖŸéŸÜ ŸÅŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéŸÖŸéŸÜ ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ÿ•ŸêŸÑŸéŸëÿß ŸÖŸéŸÜ ÿ¥Ÿéÿßÿ°Ÿé ÿßŸÑŸÑŸéŸëŸáŸè\",\n      translation: \"And the Horn will be blown, and whoever is in the heavens and whoever is on the earth will fall dead except whom Allah wills.\",\n      source: \"Qur'an 39:68\"\n    },\n    keyLesson: \"The first trumpet marks the end of all life, reminding us that only Allah is eternal and everything else will perish.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Resurrection\",\n    description: [\n      \"After the first trumpet kills all creation, Allah will send rain from beneath the Throne. This rain will cause bodies to grow from the earth like plants grow from seeds in the ground.\",\n      \"When the second trumpet is blown, all souls will return to their bodies and everyone will rise from their graves. People will emerge confused and frightened, looking around at the transformed world.\",\n      \"Everyone who ever lived will be resurrected: prophets, believers, disbelievers, and even animals. We will be resurrected barefoot, naked, and uncircumcised, focused only on our fate and standing before Allah for judgment.\"\n    ],\n    evidence: {\n      arabic: \"ÿ´ŸèŸÖŸéŸë ŸÜŸèŸÅŸêÿÆŸé ŸÅŸêŸäŸáŸê ÿ£ŸèÿÆŸíÿ±ŸéŸâŸ∞ ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ŸáŸèŸÖŸí ŸÇŸêŸäŸéÿßŸÖŸå ŸäŸéŸÜÿ∏Ÿèÿ±ŸèŸàŸÜŸé\",\n      translation: \"Then it will be blown again, and at once they will be standing, looking on.\",\n      source: \"Qur'an 39:68\"\n    },\n    keyLesson: \"Resurrection proves that Allah who created us the first time can easily recreate us for judgment and accountability.\",\n    quizId: 12\n  },\n\n  {\n    id: 13,\n    title: \"Standing Before Allah\",\n    description: [\n      \"All of creation will stand before Allah on the Day of Judgment. The sun will be brought extremely close, causing people to sweat according to their deeds. This standing will last fifty thousand years.\",\n      \"Everyone will be questioned about their life: what they did with their time, how they earned and spent their wealth, how they used their knowledge, and how they treated their body. No deed will be forgotten.\",\n      \"The scales will be set up and deeds will be weighed. Books of deeds will be distributed‚Äîrighteous people receiving theirs in their right hand and evildoers receiving theirs in their left hand behind their back.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéŸàŸíŸÖŸé ŸäŸéŸÇŸèŸàŸÖŸè ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿè ŸÑŸêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"The Day when mankind will stand before the Lord of the worlds.\",\n      source: \"Qur'an 83:6\"\n    },\n    keyLesson: \"We will all stand before Allah and be questioned about every moment of our lives, so we must prepare with good deeds now.\",\n    quizId: 13\n  }\n];\n\nexport default endTimesLessons;\n","path":null,"size_bytes":16907,"size_tokens":null},"src/data/lessons/companionsLessons.js":{"content":"// Companions of the Prophet Ô∑∫ Learning Path\n// 32 lessons about the noble Companions\n// Each lesson: 4 paragraphs (~30 words each), authentic evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, and Sahih Muslim\n\nconst companionsLessons = [\n  {\n    id: 1,\n    title: \"Abu Bakr as-Siddiq\",\n    description: [\n      \"Abu Bakr was the Prophet's Ô∑∫ closest friend and the first adult man to accept Islam. He believed immediately without hesitation when the Prophet Ô∑∫ shared the message. His instant faith earned him the title As-Siddiq, meaning The Truthful Believer.\",\n      \"When the Prophet Ô∑∫ described his night journey to Jerusalem and ascension to Heaven, the disbelievers mocked him. Abu Bakr declared that if Muhammad Ô∑∫ said it, then it must be true. His unwavering trust demonstrated perfect faith and loyalty to Allah's Messenger.\",\n      \"Abu Bakr spent his entire wealth supporting Islam and freeing tortured Muslim slaves like Bilal. He accompanied the Prophet Ô∑∫ during the dangerous migration to Madinah, risking his life. In the cave, he comforted the Prophet Ô∑∫ when enemies surrounded them, showing complete courage and trust.\",\n      \"After the Prophet's Ô∑∫ death, Abu Bakr became the first Caliph and united the Muslims during crisis. He fought against apostasy and compiled the Qur'an. The Prophet Ô∑∫ said Abu Bakr's faith outweighed the entire community's faith. He died beloved by Allah and His Messenger.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ≥ŸéŸäŸèÿ¨ŸéŸÜŸéŸëÿ®ŸèŸáŸéÿß ÿßŸÑŸíÿ£Ÿéÿ™ŸíŸÇŸéŸâ ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸèÿ§Ÿíÿ™ŸêŸä ŸÖŸéÿßŸÑŸéŸáŸè ŸäŸéÿ™Ÿéÿ≤ŸéŸÉŸéŸëŸâŸ∞\",\n      translation: \"But the righteous one will be removed from it - the one who gives his wealth to purify himself.\",\n      source: \"Qur'an 92:17-18\"\n    },\n    keyLesson: \"Immediate belief and unwavering support for truth, even when others doubt, earns eternal honor and Allah's pleasure.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Umar ibn al-Khattab\",\n    description: [\n      \"Umar was initially one of Islam's fiercest enemies, known for his strength and harsh temperament. He set out to kill the Prophet Ô∑∫ but first discovered his own sister had secretly accepted Islam. When he heard Qur'an recitation, his heart softened immediately and completely.\",\n      \"Umar went directly to the Prophet Ô∑∫ and accepted Islam. His conversion strengthened the Muslims so much they could finally pray openly at the Ka'bah. The Prophet Ô∑∫ had prayed for either Umar or Abu Jahl to accept Islam, and Allah answered by guiding Umar to the truth.\",\n      \"As the second Caliph, Umar expanded the Islamic state tremendously while maintaining justice and simplicity. He would patrol Madinah at night checking on the poor and needy. Once he carried a flour sack for a struggling widow, refusing to let anyone else help her instead.\",\n      \"Umar feared Allah intensely despite his strength and authority. He would weep when reciting Qur'an and had marks on his face from constant tears. The Prophet Ô∑∫ said if there were a prophet after him, it would be Umar. He died as a shaheed, martyred while leading prayer.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ£ŸéÿπŸêÿ≤ŸéŸë ÿßŸÑŸíÿ•Ÿêÿ≥ŸíŸÑŸéÿßŸÖŸé ÿ®Ÿêÿ£Ÿéÿ≠Ÿéÿ®ŸêŸë ŸáŸéÿ∞ŸéŸäŸíŸÜŸê ÿßŸÑÿ±ŸéŸëÿ¨ŸèŸÑŸéŸäŸíŸÜŸê ÿ•ŸêŸÑŸéŸäŸíŸÉŸé ÿ®Ÿêÿ£Ÿéÿ®ŸêŸä ÿ¨ŸéŸáŸíŸÑŸç ÿ£ŸéŸàŸí ÿ®ŸêÿπŸèŸÖŸéÿ±Ÿé ÿ®ŸíŸÜŸê ÿßŸÑŸíÿÆŸéÿ∑ŸéŸëÿßÿ®Ÿê\",\n      translation: \"O Allah, strengthen Islam with whichever of these two men is more beloved to You: Abu Jahl or Umar ibn al-Khattab.\",\n      source: \"Sahih Muslim 2393\"\n    },\n    keyLesson: \"Allah can transform the hardest hearts into the most devoted believers who serve Islam with unmatched strength and justice.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Uthman ibn Affan\",\n    description: [\n      \"Uthman was known for his modesty, generosity, and beautiful character. When he accepted Islam through Abu Bakr's invitation, his uncle punished him severely by tying him up. Despite torture, Uthman remained patient and steadfast, refusing to renounce his faith in Allah and His Messenger.\",\n      \"Uthman was so modest that even angels felt shy in his presence. The Prophet Ô∑∫ said the angels showed modesty before Uthman. He was married to the Prophet's Ô∑∫ daughter Ruqayyah, and after her death, he married another daughter, Umm Kulthum. This earned him the title Dhun-Nurayn, possessor of two lights.\",\n      \"When Muslims needed funds for the Tabuk expedition, Uthman provided one-third of the entire army's equipment and supplies. He purchased the well of Rumah and made it free for all Muslims. The Prophet Ô∑∫ said nothing Uthman did after that day would harm him, guaranteeing his place in Paradise.\",\n      \"As the third Caliph, Uthman standardized the Qur'an into one official manuscript to preserve its authenticity. He was killed while reading Qur'an during his fast, dying as a shaheed and martyr. His blood dripped onto the verse 'Allah will suffice you against them,' showing his complete trust in Allah.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéÿß ÿ∂Ÿéÿ±ŸéŸë ÿπŸèÿ´ŸíŸÖŸéÿßŸÜŸé ŸÖŸéÿß ÿπŸéŸÖŸêŸÑŸé ÿ®ŸéÿπŸíÿØŸé ÿßŸÑŸäŸéŸàŸíŸÖŸê\",\n      translation: \"Nothing will harm Uthman after what he did today.\",\n      source: \"Sahih Bukhari 3695\"\n    },\n    keyLesson: \"Generosity for Allah's cause and modesty in character earn special status in Paradise and protection from Allah's punishment.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Ali ibn Abi Talib\",\n    description: [\n      \"Ali was the Prophet's Ô∑∫ cousin, raised in his household from childhood. He accepted Islam at age ten, becoming the first young boy to believe. His early acceptance and upbringing in the Prophet's Ô∑∫ home gave him deep knowledge and understanding of Islam's teachings from the very beginning.\",\n      \"On the night of Hijrah when enemies surrounded the Prophet's Ô∑∫ house planning to kill him, Ali volunteered to sleep in his bed. This brave act risked his life to protect the Prophet Ô∑∫ and deceive the assassins. His courage and willingness to sacrifice himself demonstrated his complete devotion and fearlessness.\",\n      \"Ali married the Prophet's Ô∑∫ beloved daughter Fatimah, and their sons Hassan and Hussain were the grandsons the Prophet Ô∑∫ loved dearly. The Prophet Ô∑∫ said Ali was from him and he was from Ali. Their relationship represented the closest bonds of faith, family, and brotherhood in Islam.\",\n      \"Known for his knowledge, bravery, and justice, Ali became the fourth Caliph during difficult times. He was a warrior in every battle except Tabuk, when the Prophet Ô∑∫ left him in Madinah. The Prophet Ô∑∫ told him he was to Muhammad Ô∑∫ as Harun was to Musa, showing his high status and importance.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÜÿ™Ÿé ŸÖŸêŸÜŸêŸëŸä ÿ®ŸêŸÖŸéŸÜÿ≤ŸêŸÑŸéÿ©Ÿê ŸáŸéÿßÿ±ŸèŸàŸÜŸé ŸÖŸêŸÜ ŸÖŸèŸàÿ≥ŸéŸâ ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜŸéŸëŸáŸè ŸÑÿß ŸÜŸéÿ®ŸêŸäŸéŸë ÿ®ŸéÿπŸíÿØŸêŸä\",\n      translation: \"You are to me like Harun was to Musa, except there is no prophet after me.\",\n      source: \"Sahih Bukhari 3706\"\n    },\n    keyLesson: \"Sacrificing personal safety to protect the Prophet Ô∑∫ and Islam demonstrates the highest level of faith and devotion.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Bilal ibn Rabah\",\n    description: [\n      \"Bilal was an Ethiopian slave who accepted Islam in its earliest days. His master Umayyah brutally tortured him under the scorching desert sun, placing heavy rocks on his chest. Despite unbearable pain, Bilal refused to renounce Islam, repeatedly declaring 'Ahad, Ahad' meaning 'One, One,' affirming Allah's absolute oneness.\",\n      \"Abu Bakr witnessed Bilal's torture and purchased him from his master, immediately setting him free for Allah's sake. This liberation showed how Islam valued faith over worldly status. Bilal's freedom marked a new beginning where his devotion could flourish without the chains of slavery holding him back from worship.\",\n      \"The Prophet Ô∑∫ chose Bilal to be Islam's first muezzin, calling believers to prayer with his beautiful, powerful voice. When he called the first adhan from atop the Ka'bah after Makkah's conquest, it symbolized Islam's triumph. The former slave now stood above his former oppressors, proclaiming Allah's greatness to all.\",\n      \"Bilal's love for the Prophet Ô∑∫ was so deep that after his death, Bilal could barely continue calling the adhan without weeping. He moved to Syria and lived there until his death. The Prophet Ô∑∫ said he heard Bilal's footsteps in Paradise, confirming his eternal reward for patience during torture.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸêŸëŸä ÿ≥ŸéŸÖŸêÿπŸíÿ™Ÿè ÿØŸéŸÅŸéŸë ŸÜŸéÿπŸíŸÑŸéŸäŸíŸÉŸé ÿ®ŸéŸäŸíŸÜŸé ŸäŸéÿØŸéŸäŸéŸë ŸÅŸêŸä ÿßŸÑÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"I heard the sound of your footsteps in front of me in Paradise.\",\n      source: \"Sahih Bukhari 3697\"\n    },\n    keyLesson: \"Remaining steadfast through torture for Allah's sake earns Paradise and eternal honor, regardless of worldly status or origin.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Salman al-Farisi\",\n    description: [\n      \"Salman was born in Persia into a wealthy Zoroastrian family. His sincere search for truth led him to Christianity, then he traveled seeking knowledge from various monks. Each dying monk directed him to another teacher, until the final one prophesied a coming prophet in Arabia who would accept gifts but refuse charity.\",\n      \"Salman was captured, enslaved, and sold until he reached Madinah. When he heard about the Prophet Ô∑∫, he tested him with the monk's signs by offering food. The Prophet Ô∑∫ refused charity but accepted gifts, confirming the prophecy. Salman immediately recognized him as the awaited final messenger and accepted Islam with complete certainty.\",\n      \"During the Battle of the Trench, Salman suggested digging a defensive trench around Madinah, a Persian military strategy unknown to Arabs. This brilliant tactical advice saved the Muslim community from certain destruction. His unique knowledge and experience became invaluable to Islam's survival and success against overwhelming enemy forces.\",\n      \"The Prophet Ô∑∫ declared Salman as part of his household, saying 'Salman is from us, Ahl al-Bayt.' Despite being Persian, not Arab, his faith and devotion made him family to the Prophet Ô∑∫. This showed Islam's transcendence of race and nationality, valuing only righteousness and sincere belief in Allah alone.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≥ŸéŸÑŸíŸÖŸéÿßŸÜŸè ŸÖŸêŸÜŸéŸëÿß ÿ£ŸéŸáŸíŸÑŸé ÿßŸÑŸíÿ®ŸéŸäŸíÿ™Ÿê\",\n      translation: \"Salman is from us, the People of the Household.\",\n      source: \"Sahih Muslim 2546\"\n    },\n    keyLesson: \"Sincere seeking of truth through all obstacles leads to Allah's guidance, and faith makes all believers a single family.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Ammar ibn Yasir\",\n    description: [\n      \"Ammar and his parents Yasir and Sumayyah were among the first to accept Islam. They had no tribal protection, making them easy targets for Quraysh's brutal persecution. The Prophet Ô∑∫ would pass by them during their torture and say, 'Patience, O family of Yasir, for Paradise is your promised destination.'\",\n      \"Abu Jahl murdered Ammar's mother Sumayyah with a spear, making her Islam's first shaheedah and martyr. His father Yasir was also tortured to death. Ammar witnessed his beloved parents killed for faith, yet his belief never wavered. Their family's sacrifice became a symbol of unshakeable conviction despite the ultimate price.\",\n      \"The torture became so severe that Ammar once spoke words of disbelief while his heart remained full of faith. Allah revealed verses allowing this concession when under extreme duress. This showed Allah's mercy and understanding of human weakness under unbearable torture, while emphasizing that the heart's true faith matters most.\",\n      \"Ammar participated in every major battle alongside the Prophet Ô∑∫, fighting bravely for Islam's cause. The Prophet Ô∑∫ said a rebellious group would kill Ammar, and this prophecy came true at the Battle of Siffin. He died as a shaheed at ninety-three, calling people to Paradise while his killers called to Hellfire.\"\n    ],\n    evidence: {\n      arabic: \"ÿµŸéÿ®Ÿíÿ±Ÿãÿß ÿ¢ŸÑŸé ŸäŸéÿßÿ≥Ÿêÿ±Ÿç ŸÅŸéÿ•ŸêŸÜŸéŸë ŸÖŸéŸàŸíÿπŸêÿØŸéŸÉŸèŸÖŸè ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿè\",\n      translation: \"Patience, O family of Yasir, for indeed your promised meeting place is Paradise.\",\n      source: \"Sahih Bukhari 3857\"\n    },\n    keyLesson: \"Enduring persecution for faith with patience guarantees Paradise, and forced words under torture don't nullify sincere belief.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Abdullah ibn Mas'ud\",\n    description: [\n      \"Abdullah ibn Mas'ud was short and thin with very skinny legs that people sometimes mocked. One day the wind blew and exposed his thin legs while he climbed a tree. Companions laughed but the Prophet Ô∑∫ defended him, saying Abdullah's legs would weigh heavier than Mount Uhud on the Day of Judgment because of his righteous deeds.\",\n      \"He was one of the earliest Muslims and among the first to publicly recite Qur'an at the Ka'bah despite danger. The Quraysh beat him severely for his bold recitation. His courage in proclaiming truth publicly, despite his physical weakness, demonstrated that faith gives strength beyond any bodily power or human intimidation.\",\n      \"The Prophet Ô∑∫ gave Abdullah special permission to enter his private quarters anytime, showing complete trust and closeness. He learned Qur'an directly from the Prophet's Ô∑∫ mouth and became one of the greatest Qur'an reciters. The Prophet Ô∑∫ loved to hear him recite because his recitation was beautifully emotional and sincere.\",\n      \"Abdullah possessed deep knowledge of Qur'anic interpretation and Islamic jurisprudence. Umar ibn al-Khattab called him a treasure filled with knowledge. The Prophet Ô∑∫ recommended learning Qur'an from four people, and Abdullah was among them. His scholarship and teaching preserved essential Islamic knowledge for all future generations of Muslims worldwide.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸèÿ∞ŸèŸàÿß ÿßŸÑŸíŸÇŸèÿ±Ÿíÿ¢ŸÜŸé ŸÖŸêŸÜŸí ÿ£Ÿéÿ±Ÿíÿ®ŸéÿπŸéÿ©Ÿç ŸÖŸêŸÜŸí ÿπŸéÿ®ŸíÿØŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ®ŸíŸÜŸê ŸÖŸéÿ≥ŸíÿπŸèŸàÿØŸç\",\n      translation: \"Learn the Qur'an from four, and he mentioned Abdullah ibn Mas'ud first.\",\n      source: \"Sahih Bukhari 3760\"\n    },\n    keyLesson: \"Physical appearance means nothing in Allah's sight; knowledge, faith, and righteous deeds determine true worth and eternal weight.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Abu Hurayrah\",\n    description: [\n      \"Abu Hurayrah accepted Islam during the Khaybar campaign and stayed constantly with the Prophet Ô∑∫ afterward, never leaving his side. While other companions engaged in trade and business, Abu Hurayrah devoted every moment to learning. His stomach was often empty from hunger because he chose knowledge over earning worldly provisions.\",\n      \"He narrated more hadiths than any other companion, preserving over five thousand narrations. The Prophet Ô∑∫ made a special supplication for Abu Hurayrah's memory never to forget anything he learned. This blessed prayer was answered, and Abu Hurayrah could recall every word and action he witnessed with perfect accuracy throughout his long life.\",\n      \"Abu Hurayrah would worship all night, then wake his wife who would worship, then she would wake their daughter who would worship until dawn. Their entire household dedicated nights to prayer and devotion. Despite his poverty, he chose spiritual wealth over worldly comfort, finding richness in remembrance of Allah and knowledge of the Prophet's Ô∑∫ teachings.\",\n      \"His dedication to preserving the Prophet's Ô∑∫ words benefited all Muslims forever. Every hadith we read today about daily actions, manners, and worship likely comes from Abu Hurayrah. The Prophet Ô∑∫ said whoever spreads knowledge after him will be rewarded. Abu Hurayrah continues receiving infinite rewards as millions benefit from his narrations daily until today.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ≠Ÿéÿ®ŸêŸëÿ®Ÿí ÿπŸèÿ®ŸéŸäŸíÿØŸéŸÉŸé ŸáŸéÿ∞Ÿéÿß ŸàŸéÿ£ŸèŸÖŸéŸëŸáŸè ÿ•ŸêŸÑŸéŸâ ÿπŸêÿ®ŸéÿßÿØŸêŸÉŸé ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ŸàŸéÿ≠Ÿéÿ®ŸêŸëÿ®Ÿí ÿ•ŸêŸÑŸéŸäŸíŸáŸêŸÖŸè ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé\",\n      translation: \"O Allah, make Your servant and his mother beloved to the believing servants, and make the believers beloved to them.\",\n      source: \"Sahih Muslim 2491\"\n    },\n    keyLesson: \"Dedicating life to learning and teaching Prophet's Ô∑∫ knowledge creates lasting benefit and continuous rewards long after death.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Hudhayfah ibn al-Yaman\",\n    description: [\n      \"Hudhayfah was known as the Keeper of Secrets because the Prophet Ô∑∫ specifically confided in him about future hypocrites in the community. This tremendous trust showed Hudhayfah's wisdom and reliability. He never revealed these names, carrying this heavy knowledge with complete discretion and responsibility until his death, protecting the community's unity.\",\n      \"His father Yaman was accidentally killed by Muslims during the Battle of Uhud in the confusion of combat. When Hudhayfah realized what happened, he immediately forgave them and asked Allah to forgive them too. He donated his father's blood money to charity. This incredible forgiveness during devastating grief demonstrated his profound faith and selflessness.\",\n      \"Hudhayfah possessed deep knowledge about the signs of hypocrisy and the trials that would afflict the Muslim community. He could identify false believers by their characteristics and actions. After the Prophet's Ô∑∫ death, even Umar ibn al-Khattab would ask Hudhayfah to confirm he wasn't among the hypocrites, showing Hudhayfah's unique knowledge and Umar's deep humility.\",\n      \"The Prophet Ô∑∫ taught Hudhayfah special supplications to protect against trials and tribulations. He understood that knowing evil helps avoid it, while knowing good helps achieve it. His knowledge of both truth and falsehood made him invaluable for guiding Muslims away from deviation and toward righteousness and sincere faith in times of confusion.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸíŸÖŸèŸÜŸéÿßŸÅŸêŸÇŸêŸäŸÜŸé ŸäŸèÿÆŸéÿßÿØŸêÿπŸèŸàŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸé ŸàŸéŸáŸèŸàŸé ÿÆŸéÿßÿØŸêÿπŸèŸáŸèŸÖŸí\",\n      translation: \"Indeed, the hypocrites think they deceive Allah, but He is deceiving them.\",\n      source: \"Qur'an 4:142\"\n    },\n    keyLesson: \"Knowledge of both truth and falsehood protects the community, and keeping secrets with wisdom preserves unity and trust.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Khalid ibn al-Walid\",\n    description: [\n      \"Khalid was initially one of Islam's fiercest enemies and a military genius. He led Quraysh cavalry at Uhud, turning Muslim victory into defeat. After years fighting against Muslims, he recognized the truth of Islam and traveled to Madinah. The Prophet Ô∑∫ welcomed him warmly, showing that past enmity is forgiven when someone sincerely accepts Islam.\",\n      \"The Prophet Ô∑∫ gave Khalid the title 'Saifullah' meaning 'Sword of Allah.' This honored name reflected his unmatched military brilliance now dedicated to Islam's cause. Khalid never lost a single battle throughout his entire military career, whether commanding armies or fighting in frontline combat, demonstrating Allah's support for those who fight sincerely for truth.\",\n      \"During the Battle of Mu'tah, when three appointed commanders died as shaheeds, Khalid took command and brilliantly saved the outnumbered Muslim army from annihilation. He executed a tactical retreat so masterful that Muslims praised his genius. The Prophet Ô∑∫ said Khalid was a sword Allah unsheathed against the disbelievers, confirming his divine role.\",\n      \"Khalid led the conquest of Arabia, Iraq, and Syria with extraordinary success. He fought in over one hundred battles, his body covered with scars and wounds. Despite his legendary military career, he died peacefully in bed, which saddened him. He wished for shaheedah on the battlefield, showing his deep love for martyrdom in Allah's cause despite his tremendous achievements.\"\n    ],\n    evidence: {\n      arabic: \"ŸÜŸêÿπŸíŸÖŸé ÿπŸéÿ®ŸíÿØŸè ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿ£ŸéÿÆŸèŸà ÿßŸÑŸíÿπŸéÿ¥ŸêŸäÿ±Ÿéÿ©Ÿê ÿÆŸéÿßŸÑŸêÿØŸè ÿ®ŸíŸÜŸè ÿßŸÑŸíŸàŸéŸÑŸêŸäÿØŸê ÿ≥ŸéŸäŸíŸÅŸå ŸÖŸêŸÜŸí ÿ≥ŸèŸäŸèŸàŸÅŸê ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"How excellent a servant of Allah and brother of the tribe is Khalid ibn al-Walid, a sword from the swords of Allah.\",\n      source: \"Sahih Muslim 2307\"\n    },\n    keyLesson: \"Sincere repentance transforms past sins into future glory, and dedicating talents to Allah's cause brings unmatched success.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Abu Ubaydah ibn al-Jarrah\",\n    description: [\n      \"Abu Ubaydah was known for his trustworthiness, humility, and selflessness. The Prophet Ô∑∫ called him 'Amin al-Ummah' meaning the Trustworthy One of this nation. This title placed him among the most reliable and honest companions. People trusted him completely with wealth, secrets, and responsibilities because his integrity was absolutely beyond question.\",\n      \"During the Battle of Uhud, two metal rings from the Prophet's Ô∑∫ helmet became embedded in his blessed face from an enemy strike. Abu Ubaydah removed them with his own teeth, losing two of his front teeth in the process. He prioritized the Prophet's Ô∑∫ wellbeing over his own, demonstrating ultimate love and sacrifice for Allah's Messenger despite personal pain and permanent injury.\",\n      \"Abu Ubaydah was so humble that when Umar appointed him as commander, he tried to decline the position. He lived simply despite his high rank and military achievements. He avoided seeking leadership, preferring to serve quietly. This humility made him even more beloved and respected by all who knew him and witnessed his sincerity.\",\n      \"He led the Muslim conquest of Syria and became its governor. When plague struck, Umar ordered him to leave the infected area, but Abu Ubaydah refused to abandon his people. He died in the plague as a shaheed and martyr. The Prophet Ô∑∫ had prophesied that every prophet has a trustworthy disciple, and Abu Ubaydah was his, showing his exceptional status.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸêŸÉŸèŸÑŸêŸë ÿ£ŸèŸÖŸéŸëÿ©Ÿç ÿ£ŸéŸÖŸêŸäŸÜŸå ŸàŸéÿ£ŸéŸÖŸêŸäŸÜŸè ŸáŸéÿ∞ŸêŸáŸê ÿßŸÑÿ£ŸèŸÖŸéŸëÿ©Ÿê ÿ£Ÿéÿ®ŸèŸà ÿπŸèÿ®ŸéŸäŸíÿØŸéÿ©Ÿé ÿ®ŸíŸÜŸè ÿßŸÑŸíÿ¨Ÿéÿ±ŸéŸëÿßÿ≠Ÿê\",\n      translation: \"Every nation has a trustworthy guardian, and the trustworthy guardian of this nation is Abu Ubaydah ibn al-Jarrah.\",\n      source: \"Sahih Bukhari 3744\"\n    },\n    keyLesson: \"Trustworthiness and humility in character make one beloved to Allah, His Messenger, and all people of faith.\",\n    quizId: 12\n  },\n\n  {\n    id: 13,\n    title: \"Sa'd ibn Abi Waqqas\",\n    description: [\n      \"Sa'd was one of the earliest Muslims, accepting Islam at age seventeen. When his mother discovered his faith, she vowed to stop eating and drinking until he renounced Islam. Despite his deep love for her, Sa'd refused to abandon truth. He told her even if she had a hundred souls and they left one by one, he would never leave Islam, demonstrating that obeying Allah comes before even parental wishes.\",\n      \"Allah revealed verses about Sa'd's situation, teaching that parents must be treated kindly but not obeyed in shirk or disbelief. This established an eternal principle in Islam. Sa'd's steadfastness during this emotional trial helped clarify how believers should balance family love with absolute devotion to Allah alone, providing guidance for all future Muslims facing similar tests.\",\n      \"The Prophet Ô∑∫ said Sa'd's supplications were always answered by Allah. During battles, the Prophet Ô∑∫ would urge Sa'd to shoot arrows, saying 'Shoot! May my father and mother be sacrificed for you!' This was the only companion for whom the Prophet Ô∑∫ made this special expression, showing exceptional love and trust in Sa'd's abilities and faith.\",\n      \"Sa'd was the commander at the Battle of Qadisiyyah, which defeated the Persian Empire and opened Iraq to Islam. He was promised Paradise while still alive, being one of the ten companions given this guarantee. Despite his military achievements and guaranteed Paradise, he remained humble and devoted to worship until his death at age eighty-eight.\"\n    ],\n    evidence: {\n      arabic: \"ÿßÿ±ŸíŸÖŸê ÿ≥ŸéÿπŸíÿØŸè ŸÅŸêÿØŸéÿßŸÉŸé ÿ£Ÿéÿ®ŸêŸä ŸàŸéÿ£ŸèŸÖŸêŸëŸä\",\n      translation: \"Shoot, Sa'd! May my father and mother be sacrificed for you!\",\n      source: \"Sahih Bukhari 3724\"\n    },\n    keyLesson: \"Obeying Allah takes precedence over pleasing anyone else, even beloved parents, and answered prayers come from true devotion.\",\n    quizId: 13\n  },\n\n  {\n    id: 14,\n    title: \"Talha ibn Ubaydullah\",\n    description: [\n      \"Talha was absent during the Battle of Badr but insisted on giving his share of the war spoils to those who fought. This showed his selflessness and desire to support the cause even when he couldn't participate directly. The Prophet Ô∑∫ still gave him a full reward as if he had fought, recognizing his sincere intention and generosity toward his fellow Muslims.\",\n      \"During the Battle of Uhud, Talha shielded the Prophet Ô∑∫ with his own body when enemies surrounded him. Arrows struck Talha repeatedly as he used his hand to protect the Prophet's Ô∑∫ face. His hand became paralyzed from defending Allah's Messenger. This ultimate sacrifice of his own body demonstrated his willingness to die protecting the Prophet Ô∑∫ at all costs.\",\n      \"The Prophet Ô∑∫ said that whoever wants to see a walking martyr should look at Talha, because of his tremendous sacrifice at Uhud. He was promised Paradise while still alive, being among the ten companions given this guarantee. Despite his wealth, he lived generously, constantly giving to the poor and supporting those in need without hesitation.\",\n      \"Talha earned enormous wealth through trade but never hoarded it. He would distribute his entire income regularly to the poor and needy. Once he received seventy thousand gold coins and couldn't sleep until he had distributed every single coin to the deserving. His generosity and sacrifice made him a walking example of how wealth should be used for Allah's pleasure alone.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ÿ£Ÿéÿ≠Ÿéÿ®ŸéŸë ÿ£ŸéŸÜŸí ŸäŸéŸÜŸíÿ∏Ÿèÿ±Ÿé ÿ•ŸêŸÑŸéŸâ ÿ¥ŸéŸáŸêŸäÿØŸç ŸäŸéŸÖŸíÿ¥ŸêŸä ÿπŸéŸÑŸéŸâ ŸàŸéÿ¨ŸíŸáŸê ÿßŸÑÿ£Ÿéÿ±Ÿíÿ∂Ÿê ŸÅŸéŸÑŸíŸäŸéŸÜŸíÿ∏Ÿèÿ±Ÿí ÿ•ŸêŸÑŸéŸâ ÿ∑ŸéŸÑŸíÿ≠Ÿéÿ©Ÿé\",\n      translation: \"Whoever wishes to see a martyr walking on the face of the earth, let him look at Talha.\",\n      source: \"Sahih Bukhari 3739\"\n    },\n    keyLesson: \"Sacrificing wealth and body to protect the Prophet Ô∑∫ and help others earns the status of a living martyr.\",\n    quizId: 14\n  },\n\n  {\n    id: 15,\n    title: \"Zubayr ibn al-Awwam\",\n    description: [\n      \"Zubayr was the Prophet's Ô∑∫ cousin and one of the earliest Muslims, accepting Islam at age sixteen. His uncle tortured him by hanging him in smoke to force him to renounce Islam. Despite the pain and his young age, Zubayr refused to abandon his faith. His early steadfastness showed courage beyond his years and unshakeable belief in Allah and His Messenger.\",\n      \"At the Battle of Badr when only fourteen years old, Zubayr fought with exceptional bravery. The Prophet Ô∑∫ said every prophet had a special disciple, and his disciple was Zubayr. This special designation showed Zubayr's closeness to the Prophet Ô∑∫ and his vital role in defending Islam during its most vulnerable early period of establishment.\",\n      \"Zubayr was extremely brave in battle, always fighting in the frontlines. At the Battle of Yarmouk, he charged alone through enemy lines repeatedly to inspire his troops. His body was covered with battle scars and wounds. The Prophet Ô∑∫ promised him Paradise while he was still alive, making him one of the ten blessed companions guaranteed eternal reward.\",\n      \"Despite his military career, Zubayr was also a successful merchant and farmer. He earned his wealth through honest hard work and trade. He employed his earnings to support his family and give charity generously. His son Abdullah later described how Zubayr's body had scars from every major battle, showing his continuous sacrifice and devotion to defending Islam throughout his entire life.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ŸÑŸêŸÉŸèŸÑŸêŸë ŸÜŸéÿ®ŸêŸäŸçŸë ÿ≠ŸéŸàŸéÿßÿ±ŸêŸäŸãŸëÿß ŸàŸéÿ•ŸêŸÜŸéŸë ÿ≠ŸéŸàŸéÿßÿ±ŸêŸäŸéŸë ÿßŸÑÿ≤ŸèŸëÿ®ŸéŸäŸíÿ±Ÿè\",\n      translation: \"Indeed, every prophet has a disciple, and my disciple is Zubayr.\",\n      source: \"Sahih Bukhari 3719\"\n    },\n    keyLesson: \"Bravery in defending Islam from youth, combined with honest earnings and generosity, earns guaranteed Paradise and eternal honor.\",\n    quizId: 15\n  },\n\n  {\n    id: 16,\n    title: \"Anas ibn Malik\",\n    description: [\n      \"Anas's mother brought him to the Prophet Ô∑∫ when he was ten years old, offering him as a servant. The Prophet Ô∑∫ accepted him and made a special supplication for him. Anas served the Prophet Ô∑∫ for ten years, accompanying him everywhere. He witnessed the Prophet's Ô∑∫ daily life, manners, and habits more closely than almost anyone else in the Muslim community.\",\n      \"The Prophet Ô∑∫ prayed for Anas to have abundant wealth, many children, and long life. All three prayers were completely answered. Anas lived over one hundred years, had numerous children and grandchildren, and owned vast orchards that produced fruit twice yearly. This showed how the Prophet's Ô∑∫ blessed supplications always came true in beautiful and miraculous ways.\",\n      \"Anas narrated thousands of hadiths, preserving details about the Prophet's Ô∑∫ daily life, appearance, and character. His narrations teach us how the Prophet Ô∑∫ ate, dressed, slept, and interacted with family and companions. This intimate knowledge makes him one of the most important sources for understanding the Prophet's Ô∑∫ beautiful example and applying it in our daily lives.\",\n      \"Despite serving the Prophet Ô∑∫ for ten years, Anas said the Prophet Ô∑∫ never scolded him or said 'Why did you do that?' even once. This demonstrated the Prophet's Ô∑∫ perfect patience and kindness. Anas lived through the era of the Rightly Guided Caliphs and witnessed Islam's expansion, dying as one of the last surviving companions to see the Prophet Ô∑∫ personally.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ£ŸéŸÉŸíÿ´Ÿêÿ±Ÿí ŸÖŸéÿßŸÑŸéŸáŸè ŸàŸéŸàŸéŸÑŸéÿØŸéŸáŸè ŸàŸéÿ®Ÿéÿßÿ±ŸêŸÉŸí ŸÑŸéŸáŸè ŸÅŸêŸäŸÖŸéÿß ÿ£ŸéÿπŸíÿ∑ŸéŸäŸíÿ™ŸéŸáŸè\",\n      translation: \"O Allah, increase his wealth and children and bless him in what You have given him.\",\n      source: \"Sahih Bukhari 6334\"\n    },\n    keyLesson: \"Serving the Prophet Ô∑∫ with dedication brings blessed supplications that manifest throughout a long, prosperous, and beneficial life.\",\n    quizId: 16\n  },\n\n  {\n    id: 17,\n    title: \"Abdullah ibn Umar\",\n    description: [\n      \"Abdullah was the son of Umar ibn al-Khattab and one of the most knowledgeable companions. He meticulously followed the Prophet's Ô∑∫ every action, even copying small habits like where the Prophet Ô∑∫ stopped during travels. His extreme dedication to following the Sunnah made him a perfect example of how to imitate the Prophet Ô∑∫ in all aspects of daily life.\",\n      \"He was known for his incredible piety and fear of Allah. Abdullah would fast frequently, pray most of the night, and weep during Qur'an recitation. He constantly gave charity and treated his family and servants with exceptional kindness. Despite his father being the powerful Caliph, Abdullah avoided worldly positions and leadership, preferring worship and teaching over authority and power.\",\n      \"Abdullah narrated thousands of hadiths with careful accuracy, becoming one of the major sources of prophetic knowledge. Students traveled from distant lands to learn from him. He lived simply despite inheriting wealth from his father, spending most of his money on freeing slaves and helping the poor. His life embodied complete devotion to Islam's teachings in every detail.\",\n      \"The Prophet Ô∑∫ praised Abdullah's righteousness and piety. Even though he was too young to fight in Badr and Uhud, he participated in all later battles with bravery. He lived a very long life, dying at age eighty-seven, continuing to teach and guide Muslims for decades after the Prophet's Ô∑∫ death, preserving precious knowledge for all future generations of believers worldwide.\"\n    ],\n    evidence: {\n      arabic: \"ŸÜŸêÿπŸíŸÖŸé ÿßŸÑÿ±ŸéŸëÿ¨ŸèŸÑŸè ÿπŸéÿ®ŸíÿØŸè ÿßŸÑŸÑŸéŸëŸáŸê ŸÑŸéŸàŸí ŸÉŸéÿßŸÜŸé ŸäŸèÿµŸéŸÑŸêŸëŸä ŸÖŸêŸÜŸé ÿßŸÑŸÑŸéŸëŸäŸíŸÑŸê\",\n      translation: \"Abdullah is an excellent man; if only he would pray at night.\",\n      source: \"Sahih Bukhari 1122\"\n    },\n    keyLesson: \"Meticulously following the Prophet's Ô∑∫ example in all matters, combined with knowledge and piety, creates a blessed, impactful life.\",\n    quizId: 17\n  },\n\n  {\n    id: 18,\n    title: \"Umm Sulaym\",\n    description: [\n      \"Umm Sulaym was one of the earliest women to accept Islam in Madinah. When her husband Abu Anas refused Islam, she divorced him for Allah's sake, showing that faith comes before worldly relationships. Later, she married Abu Talhah after he accepted Islam. Her dowry was his conversion to Islam, demonstrating that the greatest gift is guidance to truth and righteousness.\",\n      \"She was known for her intelligence, strength, and dedication to Islam. During battles, she would carry water to wounded soldiers and help defend the Muslims. At the Battle of Uhud, she was pregnant yet insisted on participating to support the Muslim army. Her bravery and commitment showed that women contributed significantly to Islam's defense and spread.\",\n      \"Umm Sulaym's son Anas served the Prophet Ô∑∫ for ten years because she offered him for this blessed service. The Prophet Ô∑∫ would often visit their home and sometimes rest there. He praised her household and made special supplications for her family. Her home became a place of barakah and blessing due to her hospitality and devotion to Allah's Messenger.\",\n      \"When her young son died, Umm Sulaym showed remarkable patience. She prepared the body, told no one, and waited for her husband Abu Talhah to return. After he ate and rested, she gently broke the news using wisdom and patience. The Prophet Ô∑∫ praised her incredible patience and self-control, making dua that Allah bless their marriage. Soon after, Allah blessed them with another righteous son.\"\n    ],\n    evidence: {\n      arabic: \"ÿ®Ÿéÿßÿ±ŸéŸÉŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéŸÉŸèŸÖŸéÿß ŸÅŸêŸä ŸÑŸéŸäŸíŸÑŸéÿ™ŸêŸÉŸèŸÖŸéÿß\",\n      translation: \"May Allah bless you both in your night.\",\n      source: \"Sahih Bukhari 6336\"\n    },\n    keyLesson: \"Patience during tragedy, prioritizing faith over comfort, and serving Islam with intelligence earns Allah's blessings and special honor.\",\n    quizId: 18\n  },\n\n  {\n    id: 19,\n    title: \"Abu Darda\",\n    description: [\n      \"Abu Darda was a successful merchant in Madinah before accepting Islam. When he believed, he immediately gave up his profitable trade business to dedicate himself entirely to worship and seeking knowledge. He said worldly trade distracted him from remembering Allah and gaining beneficial knowledge. His sacrifice showed that he valued eternal success over temporary worldly gains and material wealth.\",\n      \"He became one of the most knowledgeable companions in Qur'anic recitation, interpretation, and Islamic jurisprudence. The Prophet Ô∑∫ said Abu Darda was one of the wisest of his nation. People traveled from distant lands to study under him. He would teach in the Damascus mosque, where hundreds of students formed circles around him seeking knowledge and wisdom from his deep understanding.\",\n      \"Abu Darda lived extremely simply despite having opportunities for wealth. He wore simple clothes and ate basic food, preferring spiritual richness over material comfort. He would say that fearing Allah is the head of all wisdom. His constant focus on the Hereafter rather than worldly pleasures made him detached from everything except pleasing Allah through worship, knowledge, and righteous actions.\",\n      \"His wife Umm Darda narrated that he would spend most nights in prayer and Qur'an recitation. When people praised his knowledge and piety, he remained humble, attributing everything to Allah's mercy. He died as the governor of Damascus but lived like the poorest person. His legacy of knowledge, wisdom, and detachment from worldly life continues inspiring Muslims to prioritize eternal success over temporary pleasures.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿéÿ®ŸèŸà ÿßŸÑÿØŸéŸëÿ±ŸíÿØŸéÿßÿ°Ÿê ÿ≠ŸéŸÉŸêŸäŸÖŸè ŸáŸéÿ∞ŸêŸáŸê ÿßŸÑŸíÿ£ŸèŸÖŸéŸëÿ©Ÿê\",\n      translation: \"Abu Darda is the wise one of this nation.\",\n      source: \"Sahih Muslim 2448\"\n    },\n    keyLesson: \"Abandoning worldly success to pursue knowledge and worship demonstrates true wisdom and brings eternal benefit to oneself and others.\",\n    quizId: 19\n  },\n\n  {\n    id: 20,\n    title: \"Abu Ayyub al-Ansari\",\n    description: [\n      \"When the Prophet Ô∑∫ first arrived in Madinah during the Hijrah, everyone wanted the honor of hosting him. The Prophet Ô∑∫ let his camel walk freely, saying it was commanded by Allah. It stopped at Abu Ayyub's house. Abu Ayyub considered this the greatest blessing and honor of his entire life, feeling overwhelming joy and gratitude for hosting Allah's beloved Messenger.\",\n      \"Abu Ayyub insisted the Prophet Ô∑∫ stay on the ground floor while he and his wife stayed upstairs. One night, they accidentally broke a water jug upstairs and used their only blanket to soak up the water, fearing even a drop might disturb the Prophet Ô∑∫ sleeping below. This showed his extreme reverence, love, and care for the Prophet's Ô∑∫ comfort and wellbeing.\",\n      \"The Prophet Ô∑∫ lived in Abu Ayyub's home for seven months until the Prophet's Ô∑∫ mosque and homes were built. During this time, Abu Ayyub learned directly from the Prophet Ô∑∫ and developed deep knowledge. He narrated many important hadiths. The blessing of hosting the Prophet Ô∑∫ made his house a symbol of honor and his name eternally remembered with love and respect.\",\n      \"Abu Ayyub remained a warrior for Islam even in old age. He participated in the campaign to conquer Constantinople at age eighty, despite his advanced years and frail health. He died during this expedition and was buried at the city's walls. His grave became a blessed site. His lifelong dedication to jihad and serving Islam showed faith doesn't retire or weaken with age.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸéŸäŸíÿ±ŸèŸÉŸèŸÖŸí ŸÖŸéŸÜŸí ÿ™ŸéÿπŸéŸÑŸéŸëŸÖŸé ÿßŸÑŸíŸÇŸèÿ±Ÿíÿ¢ŸÜŸé ŸàŸéÿπŸéŸÑŸéŸëŸÖŸéŸáŸè\",\n      translation: \"The best of you are those who learn the Qur'an and teach it.\",\n      source: \"Sahih Bukhari 5027\"\n    },\n    keyLesson: \"Honoring the Prophet Ô∑∫ with sincere love and dedicating your entire life to serving Islam earns eternal blessings.\",\n    quizId: 20\n  },\n\n  {\n    id: 21,\n    title: \"Mu'adh ibn Jabal\",\n    description: [\n      \"Mu'adh was one of the youngest companions but possessed exceptional knowledge and understanding of Islam. The Prophet Ô∑∫ said Mu'adh was the most knowledgeable of his nation concerning halal and haram matters. Despite his youth, scholars and older companions would ask him religious questions. His deep understanding came from constant learning and devotion to studying with the Prophet Ô∑∫ directly.\",\n      \"The Prophet Ô∑∫ sent Mu'adh as a governor and teacher to Yemen. Before he left, the Prophet Ô∑∫ taught him how to judge between people using Qur'an first, then Sunnah, then ijtihad. This established the fundamental methodology for Islamic jurisprudence. Mu'adh's mission to Yemen spread Islam and knowledge successfully, showing his skills in both teaching and governance despite being very young.\",\n      \"Mu'adh loved the Prophet Ô∑∫ deeply. When saying goodbye before the Yemen trip, he walked alongside the Prophet's Ô∑∫ riding animal, not wanting to separate. The Prophet Ô∑∫ told him they might never meet again in this world, and Mu'adh wept intensely. This emotional farewell showed the profound love and connection between the Prophet Ô∑∫ and his devoted companions who treasured every moment together.\",\n      \"The Prophet Ô∑∫ said that on the Day of Judgment, scholars will be brought forward, and Mu'adh will be ahead of them by a stone's throw distance because of his superior knowledge. Despite this guaranteed status, Mu'adh remained humble and focused on teaching others. He died young in a plague, achieving martyrdom. His legacy of knowledge continues benefiting Muslims seeking to understand halal, haram, and proper Islamic jurisprudence.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéÿπŸíŸÑŸéŸÖŸè ÿ£ŸèŸÖŸéŸëÿ™ŸêŸä ÿ®ŸêÿßŸÑŸíÿ≠ŸéŸÑŸéÿßŸÑŸê ŸàŸéÿßŸÑŸíÿ≠Ÿéÿ±ŸéÿßŸÖŸê ŸÖŸèÿπŸéÿßÿ∞Ÿè ÿ®ŸíŸÜŸè ÿ¨Ÿéÿ®ŸéŸÑŸç\",\n      translation: \"The most knowledgeable of my nation concerning halal and haram is Mu'adh ibn Jabal.\",\n      source: \"Sahih Muslim 2450\"\n    },\n    keyLesson: \"Deep knowledge of Islam combined with youth and humility makes one a leader in understanding and teaching Allah's religion.\",\n    quizId: 21\n  },\n\n  {\n    id: 22,\n    title: \"Abd al-Rahman ibn Awf\",\n    description: [\n      \"Abd al-Rahman was one of the earliest Muslims and extremely wealthy. When he migrated to Madinah, he left everything behind in Makkah. An Ansari brother offered to share his wealth and even divorce one wife so Abd al-Rahman could marry her. Abd al-Rahman refused, asking only to be shown the marketplace to earn his own living through honest trade and hard work.\",\n      \"Through Allah's blessings and his own efforts, Abd al-Rahman rebuilt his fortune in Madinah and became one of the richest companions. Despite his enormous wealth, he remained humble and incredibly generous. He donated entire caravans of supplies to the Muslim army. Once he gave seven hundred camels loaded with grain and goods for Allah's cause, demonstrating that wealth means nothing compared to pleasing Allah.\",\n      \"The Prophet Ô∑∫ promised Abd al-Rahman Paradise while he was still alive, making him one of the ten companions given this ultimate guarantee. Despite this assurance, he continued striving in worship, charity, and good deeds. He never became complacent or lazy, showing that certainty of Paradise increases devotion rather than decreasing effort to please Allah through continuous righteous actions.\",\n      \"Abd al-Rahman wept when eating fine food, remembering how the Prophet Ô∑∫ and early companions suffered hunger. He felt guilty enjoying luxury while they had struggled. This showed his deep love for the Prophet Ô∑∫ and sensitivity to inequality. He gave massive amounts in charity, constantly feeding the poor and freeing slaves. His wealth became a tool for tremendous good, benefiting the entire Muslim community endlessly.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéÿ®ŸíÿØŸè ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸÜŸê ÿ®ŸíŸÜŸè ÿπŸéŸàŸíŸÅŸç ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"Abd al-Rahman ibn Awf is in Paradise.\",\n      source: \"Sahih Bukhari 3679\"\n    },\n    keyLesson: \"Using wealth generously for Allah's cause while remaining humble and remembering those less fortunate guarantees eternal success.\",\n    quizId: 22\n  },\n\n  {\n    id: 23,\n    title: \"Khalid ibn Sa'id\",\n    description: [\n      \"Khalid ibn Sa'id was among the earliest Muslims, accepting Islam shortly after Abu Bakr. When his father discovered his faith, he beat him severely and expelled him from the family home. Khalid endured homelessness and persecution, sleeping outdoors and suffering hunger. Despite losing his family and comfort, he never wavered in his belief, showing remarkable courage and steadfastness at a young age.\",\n      \"He migrated to Abyssinia during the first migration to escape persecution. He lived there for many years in exile from his homeland. When the Muslims migrated to Madinah, Khalid and his wife eventually joined them there. His willingness to leave everything familiar and live in foreign lands showed his prioritization of religious freedom over worldly comfort and material security.\",\n      \"Khalid participated in the early battles and conquests after returning from Abyssinia. He was known for his bravery and commitment to jihad. Despite years of exile, he remained dedicated to defending Islam when needed. His sacrifices during the early difficult period of persecution helped establish Islam when Muslims were weak, poor, and few in number, facing constant danger from powerful enemies.\",\n      \"He was martyred at the Battle of Marj al-Saffar in Syria, fighting bravely against the Byzantine Romans. He died as a shaheed, achieving the highest honor of dying in Allah's path. His life of early sacrifice, exile, patience, and final martyrdom showed complete devotion. From accepting Islam early to dying in battle, he dedicated his entire existence to defending and spreading the truth of Islam.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≥Ÿéÿ®ŸéŸÜŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÇŸèÿ™ŸêŸÑŸèŸàÿß ŸÅŸêŸä ÿ≥Ÿéÿ®ŸêŸäŸÑŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéŸÖŸíŸàŸéÿßÿ™Ÿãÿß €ö ÿ®ŸéŸÑŸí ÿ£Ÿéÿ≠ŸíŸäŸéÿßÿ°Ÿå ÿπŸêŸÜÿØŸé ÿ±Ÿéÿ®ŸêŸëŸáŸêŸÖŸí ŸäŸèÿ±Ÿíÿ≤ŸéŸÇŸèŸàŸÜŸé\",\n      translation: \"And never think of those who have been killed in the cause of Allah as dead. Rather, they are alive with their Lord, receiving provision.\",\n      source: \"Qur'an 3:169\"\n    },\n    keyLesson: \"Enduring persecution, exile, and ultimately martyrdom for faith demonstrates complete devotion and earns eternal life with Allah.\",\n    quizId: 23\n  },\n\n  {\n    id: 24,\n    title: \"Abu Dujanah\",\n    description: [\n      \"Abu Dujanah was known for his exceptional bravery in battle. At the Battle of Uhud, the Prophet Ô∑∫ held a sword and asked who would take it with its right. Many companions reached for it, but the Prophet Ô∑∫ gave it to Abu Dujanah, who promised to use it until it bent from fighting. This special honor showed the Prophet's Ô∑∫ trust in Abu Dujanah's courage and fighting skills.\",\n      \"Abu Dujanah had a red headband he wore only in battle. When companions saw this headband, they knew he would fight with extraordinary courage and fierceness. He would walk between the battle lines with a distinctive strut, showing confidence and fearlessness. The Prophet Ô∑∫ said this walking style was detestable except in this specific situation, showing that confidence in battle for Allah's cause is praiseworthy.\",\n      \"During Uhud, Abu Dujanah used his own body as a shield to protect the Prophet Ô∑∫ from arrows. Arrows struck his back repeatedly as he covered the Prophet Ô∑∫ with his body. He felt no pain because his only concern was protecting Allah's Messenger. This ultimate sacrifice showed his complete willingness to die defending the Prophet Ô∑∫ without hesitation or fear of injury.\",\n      \"Abu Dujanah continued fighting in many battles after Uhud, always demonstrating exceptional bravery and skill. He was eventually martyred at the Battle of Yamamah fighting false prophets who caused apostasy. His death as a shaheed crowned a life of courage and sacrifice. The red headband became a symbol of his legendary bravery, inspiring Muslims to fight courageously when defending truth and justice.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ŸäŸéÿ£ŸíÿÆŸèÿ∞Ÿè ŸáŸéÿ∞Ÿéÿß ÿßŸÑÿ≥ŸéŸëŸäŸíŸÅŸé ÿ®Ÿêÿ≠ŸéŸÇŸêŸëŸáŸê\",\n      translation: \"Who will take this sword with its right?\",\n      source: \"Sahih Muslim 2470\"\n    },\n    keyLesson: \"Bravery in defending Islam and shielding the Prophet Ô∑∫ with your own body earns martyrdom and eternal honor.\",\n    quizId: 24\n  },\n\n  {\n    id: 25,\n    title: \"Usama ibn Zayd\",\n    description: [\n      \"Usama was the son of Zayd ibn Harithah, the Prophet's Ô∑∫ adopted son and beloved companion. The Prophet Ô∑∫ loved both father and son deeply, calling them his most beloved people. Usama grew up in the Prophet's Ô∑∫ household, learning directly from him. This close upbringing gave Usama special knowledge and a unique understanding of the Prophet's Ô∑∫ personal character and daily habits.\",\n      \"Despite being only eighteen years old, the Prophet Ô∑∫ appointed Usama as the commander of a major military expedition that included senior companions like Abu Bakr and Umar. Some questioned this appointment due to his youth, but the Prophet Ô∑∫ defended it firmly. This showed that leadership in Islam is based on ability and wisdom, not age or seniority alone.\",\n      \"Usama's father Zayd was martyred at the Battle of Mu'tah, dying as a shaheed while carrying the Muslim banner. This tremendous loss deeply affected Usama, but he remained patient and continued serving Islam faithfully. The Prophet Ô∑∫ comforted him and continued showing him special love and care, helping him through grief while preparing him for future leadership responsibilities despite his young age.\",\n      \"The expedition Usama was to lead was the last military campaign the Prophet Ô∑∫ organized before his death. After the Prophet Ô∑∫ passed away, Abu Bakr insisted on sending Usama's army despite the difficult situation, honoring the Prophet's Ô∑∫ final command. Usama successfully completed the mission, demonstrating his competence and justifying the Prophet's Ô∑∫ trust in his abilities despite his youth and the controversial appointment that some had questioned.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿèÿ≥ŸéÿßŸÖŸéÿ©Ÿè ÿ®ŸíŸÜŸè ÿ≤ŸéŸäŸíÿØŸç ÿ£Ÿéÿ≠Ÿéÿ®ŸèŸë ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê ÿ•ŸêŸÑŸéŸäŸéŸë\",\n      translation: \"Usama ibn Zayd is the most beloved of people to me.\",\n      source: \"Sahih Bukhari 3730\"\n    },\n    keyLesson: \"Youth combined with capability and the Prophet's Ô∑∫ training makes one qualified for leadership regardless of age or experience.\",\n    quizId: 25\n  },\n\n  {\n    id: 26,\n    title: \"Zayd ibn Thabit\",\n    description: [\n      \"Zayd was only eleven years old when the Prophet Ô∑∫ migrated to Madinah. He was too young to fight in Badr but desperately wanted to join the Muslims. Instead, the Prophet Ô∑∫ encouraged him to study and learn. Zayd dedicated himself to education, becoming one of the most knowledgeable companions. His disappointment at being too young for battle transformed into blessing through knowledge acquisition instead.\",\n      \"Zayd mastered numerous languages including Hebrew and Syriac within a remarkably short time. The Prophet Ô∑∫ asked him to learn these languages to read and write correspondence with non-Arabs. Zayd learned Hebrew in just fifteen days, showing his exceptional intelligence and dedication. His linguistic abilities made him the Prophet's Ô∑∫ personal translator and scribe for diplomatic communications with foreign leaders.\",\n      \"The Prophet Ô∑∫ chose Zayd as one of his primary scribes to write down the Qur'anic revelations. Zayd would write the verses on various materials like parchment, leather, and stones. After the Prophet's Ô∑∫ death, Abu Bakr tasked Zayd with collecting the Qur'an into one written volume. Later, Uthman chose him to lead the committee that standardized the official Qur'anic manuscript, showing universal trust in Zayd's accuracy and knowledge.\",\n      \"Zayd was also a brilliant scholar of Islamic inheritance laws, which are mathematically complex. He became the primary reference for inheritance questions. His combination of Qur'anic knowledge, linguistic skills, and legal expertise made him invaluable. The Prophet Ô∑∫ said Zayd was the most knowledgeable of his nation in inheritance laws. His contributions to preserving the Qur'an benefit every Muslim who reads it until the Day of Judgment.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÅŸíÿ±Ÿéÿ∂ŸèŸÉŸèŸÖŸí ÿ≤ŸéŸäŸíÿØŸè ÿ®ŸíŸÜŸè ÿ´Ÿéÿßÿ®Ÿêÿ™Ÿç\",\n      translation: \"The most knowledgeable of you in inheritance laws is Zayd ibn Thabit.\",\n      source: \"Sahih Bukhari 3756\"\n    },\n    keyLesson: \"Dedicating youth to learning languages and knowledge creates lasting benefit, especially in preserving and spreading Allah's revelation.\",\n    quizId: 26\n  },\n\n  {\n    id: 27,\n    title: \"Hafsa bint Umar\",\n    description: [\n      \"Hafsa was the daughter of Umar ibn al-Khattab and wife of the Prophet Ô∑∫. She was married young but became a widow when her first husband died from battle wounds. Her father Umar worried about her future. The Prophet Ô∑∫ married her, honoring Umar and giving Hafsa the blessing of being a Mother of the Believers, a title of tremendous honor and respect forever.\",\n      \"Hafsa was known for her piety, knowledge, and devotion to worship. She would fast frequently and spend long nights in prayer. Like her father, she had a strong personality and deep fear of Allah. The Prophet Ô∑∫ appreciated her intelligence and trusted her completely. She learned directly from him about Islamic rulings, especially those related to women's specific concerns and questions.\",\n      \"After the Prophet's Ô∑∫ death, the official written copy of the Qur'an was entrusted to Hafsa for safekeeping. This tremendous responsibility showed the companions' complete trust in her reliability and carefulness. She guarded the precious manuscript with utmost care. When Uthman needed to make official copies, he borrowed it from Hafsa, and she preserved it until her death, fulfilling this critical duty perfectly.\",\n      \"Hafsa narrated numerous hadiths, teaching Islamic knowledge to many women and men. Her narrations provide valuable guidance about the Prophet's Ô∑∫ private life and household rulings. She lived thirty-four years after the Prophet's Ô∑∫ death, continuing to teach and guide Muslims. Her father Umar would consult her on various matters, showing respect for her opinions and knowledge despite being the powerful Caliph who ruled justly.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸÜŸéŸëÿ®ŸêŸäŸèŸë ÿ£ŸéŸàŸíŸÑŸéŸâŸ∞ ÿ®ŸêÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ŸÖŸêŸÜŸí ÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸáŸêŸÖŸí €ñ ŸàŸéÿ£Ÿéÿ≤ŸíŸàŸéÿßÿ¨ŸèŸáŸè ÿ£ŸèŸÖŸéŸëŸáŸéÿßÿ™ŸèŸáŸèŸÖŸí\",\n      translation: \"The Prophet Ô∑∫ is more worthy of the believers than themselves, and his wives are their mothers.\",\n      source: \"Qur'an 33:6\"\n    },\n    keyLesson: \"Being entrusted with preserving Allah's revelation and teaching it demonstrates ultimate trust, honor, and eternal responsibility.\",\n    quizId: 27\n  },\n\n  {\n    id: 28,\n    title: \"Zayd ibn Harithah\",\n    description: [\n      \"Zayd was captured as a child and sold into slavery. He eventually became the Prophet's Ô∑∫ servant. When Zayd's father finally found him years later and came to take him home, the Prophet Ô∑∫ gave Zayd the choice. Zayd chose to stay with Muhammad Ô∑∫ rather than return to his biological family. This decision showed the Prophet's Ô∑∫ exceptional character that made people love him more than their own families.\",\n      \"The Prophet Ô∑∫ was so moved by Zayd's loyalty that he adopted him as his son before adoption was prohibited. Zayd became known as Zayd ibn Muhammad Ô∑∫, the son of Muhammad Ô∑∫. When Islam later prohibited adoption giving the adopted person the adopter's name, Allah revealed verses about this. Zayd's name returned to Zayd ibn Harithah, but the Prophet's Ô∑∫ love for him never decreased even slightly.\",\n      \"Allah mentioned Zayd by name in the Qur'an when discussing the marriage to Zayd's ex-wife. He is the only companion named directly in the Qur'an. This unique honor elevated Zayd's status tremendously. Despite being a former slave, his faith and closeness to the Prophet Ô∑∫ made him more honorable than nobility and wealth could ever achieve, showing Islam's true values and priorities.\",\n      \"The Prophet Ô∑∫ called Zayd the most beloved person to him. He appointed Zayd as commander of several important military expeditions, showing complete trust in his abilities. At the Battle of Mu'tah, Zayd carried the Muslim banner and was martyred while holding it. He died as a shaheed, and the Prophet Ô∑∫ wept for him. Zayd's son Usama continued his legacy, also becoming beloved to the Prophet Ô∑∫ deeply.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÑŸéŸÖŸéŸëÿß ŸÇŸéÿ∂ŸéŸâŸ∞ ÿ≤ŸéŸäŸíÿØŸå ŸÖŸêŸëŸÜŸíŸáŸéÿß ŸàŸéÿ∑Ÿéÿ±Ÿãÿß ÿ≤ŸéŸàŸéŸëÿ¨ŸíŸÜŸéÿßŸÉŸéŸáŸéÿß\",\n      translation: \"So when Zayd had no longer any need for her, We married her to you.\",\n      source: \"Qur'an 33:37\"\n    },\n    keyLesson: \"Love for the Prophet Ô∑∫ surpassing family ties and being named in the Qur'an shows unmatched honor.\",\n    quizId: 28\n  },\n\n  {\n    id: 29,\n    title: \"Abu Darda - The Worshipper\",\n    description: [\n      \"Abu Darda was appointed as a judge in Damascus, one of the most important positions in the expanding Muslim empire. Despite this high status, he lived in a small, simple house and wore plain clothes. When visitors came expecting luxury befitting a judge, they found only simplicity. He taught that this world is temporary and worldly positions shouldn't change how believers live and worship Allah constantly.\",\n      \"He was famous for his night prayers and constant worship. His wife Umm Darda said he would pray most of the night, barely sleeping. When she suggested he rest more, he replied that the long sleep is ahead in the grave. This perspective made him maximize his time in worship and good deeds before death, knowing life is short and the Hereafter is eternal.\",\n      \"Abu Darda had a beautiful horse that he loved. One day he sold it, explaining that he didn't want anything to distract his heart from Allah. When people questioned why he gave up something permissible, he said he feared becoming attached to worldly things. This showed his deep understanding that even halal things can distract from worship if we're not careful about our hearts' attachments.\",\n      \"Near the end of his life, he became ill but remained patient and content with Allah's decree. He continued teaching students until his final days, never wasting time. When he was dying, he smiled and said he was eager to meet Allah and see His generous rewards. His life and death exemplified complete devotion, detachment from worldly distractions, and eagerness for the eternal meeting with the Creator.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ÿÆŸéÿßŸÅŸé ÿ£ŸéÿØŸíŸÑŸéÿ¨Ÿé ŸàŸéŸÖŸéŸÜŸí ÿ£ŸéÿØŸíŸÑŸéÿ¨Ÿé ÿ®ŸéŸÑŸéÿ∫Ÿé ÿßŸÑŸíŸÖŸéŸÜŸíÿ≤ŸêŸÑŸé\",\n      translation: \"Whoever fears will travel during the night, and whoever travels during the night will reach the destination.\",\n      source: \"Sahih Muslim 2450\"\n    },\n    keyLesson: \"Detaching from worldly distractions and dedicating life to worship prepares the soul for meeting Allah with eagerness and joy.\",\n    quizId: 29\n  },\n\n  {\n    id: 30,\n    title: \"Jafar ibn Abi Talib\",\n    description: [\n      \"Jafar was the cousin of the Prophet Ô∑∫ and the older brother of Ali ibn Abi Talib. He accepted Islam early and faced severe persecution in Makkah. He led the first migration to Abyssinia, taking responsibility for protecting weak Muslims seeking refuge. When Quraysh sent delegates demanding their return, Jafar defended Islam eloquently before the Christian king, explaining its beautiful teachings with wisdom and passion.\",\n      \"Jafar recited Surah Maryam to the Abyssinian king, describing how Islam honors Isa and Maryam. The king wept, recognizing truth in the Qur'an's words. He refused to hand over the Muslims, granting them safety and protection. Jafar's wise diplomacy and clear explanation of Islam saved the refugees and created friendly relations between Muslims and the Christian kingdom, showing the power of wisdom in da'wah.\",\n      \"The Prophet Ô∑∫ loved Jafar dearly and said he resembled the Prophet Ô∑∫ in both appearance and character. When Jafar returned from Abyssinia after years of separation, the Prophet Ô∑∫ was so happy he kissed Jafar between his eyes. The Prophet Ô∑∫ said he didn't know which brought more joy: the conquest of Khaybar or Jafar's return, showing his deep love and how much he missed his cousin during the long separation.\",\n      \"Jafar was martyred at the Battle of Mu'tah, fighting incredibly bravely. When his right hand was cut off, he held the banner with his left. When that was cut, he held it with both arms until he was martyred. The Prophet Ô∑∫ said Allah gave Jafar two wings to fly with in Paradise, earning him the title Jafar at-Tayyar, Jafar the Flier. His courage and sacrifice earned him eternal honor and the ability to soar through Paradise.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿéÿ¥Ÿíÿ®ŸéŸáŸíÿ™Ÿé ÿÆŸéŸÑŸíŸÇŸêŸä ŸàŸéÿÆŸèŸÑŸèŸÇŸêŸä\",\n      translation: \"You resemble me in appearance and character.\",\n      source: \"Sahih Bukhari 3708\"\n    },\n    keyLesson: \"Wisdom in spreading Islam and ultimate sacrifice in battle earn special blessings like flying through Paradise with angels.\",\n    quizId: 30\n  },\n\n  {\n    id: 31,\n    title: \"Nusaybah bint Ka'b (Umm Amarah)\",\n    description: [\n      \"Nusaybah was a brave woman who participated in the Battle of Uhud. When many Muslims retreated during the battle's difficult moments, she stayed firm, defending the Prophet Ô∑∫ alongside a few loyal companions. She fought with a sword and bow, receiving over a dozen wounds on her body. Her courage in protecting the Prophet Ô∑∫ when others fled demonstrated faith and bravery exceeding most men on that day.\",\n      \"The Prophet Ô∑∫ witnessed her fighting and said that wherever he turned during Uhud's chaos, he saw Nusaybah defending him. He made special dua for her and her entire household. She threw herself between the Prophet Ô∑∫ and an enemy sword, taking a deep shoulder wound that troubled her for the rest of her life. She prioritized his safety over her own without hesitation or fear.\",\n      \"During the Battle of Yamamah against the false prophet Musaylimah, Nusaybah's hand was cut off while fighting, and she received eleven other wounds. Her son was killed in front of her, but she continued fighting bravely despite her grief and injuries. Her unmatched courage made her one of the most celebrated female warriors in Islamic history, inspiring Muslim women with her strength and sacrifice.\",\n      \"Nusaybah came to the Prophet Ô∑∫ concerned that only men were mentioned in the Qur'an. Shortly after, Allah revealed verses addressing both believing men and believing women equally. Her question led to the revelation of important verses that recognized women's equal spiritual status and rewards. Her legacy combines bravery in battle and intellectual engagement with revelation, showing women's vital contributions to preserving and defending Islam courageously.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸíŸÖŸèÿ≥ŸíŸÑŸêŸÖŸêŸäŸÜŸé ŸàŸéÿßŸÑŸíŸÖŸèÿ≥ŸíŸÑŸêŸÖŸéÿßÿ™Ÿê ŸàŸéÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ŸàŸéÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸéÿßÿ™Ÿê\",\n      translation: \"Indeed, the Muslim men and Muslim women, the believing men and believing women...\",\n      source: \"Qur'an 33:35\"\n    },\n    keyLesson: \"Women's bravery in defending Islam and questioning to seek knowledge earn eternal honor and Qur'anic recognition.\",\n    quizId: 31\n  },\n\n  {\n    id: 32,\n    title: \"Abu Sufyan ibn Harb\",\n    description: [\n      \"Abu Sufyan was Islam's greatest enemy for years, leading Quraysh against Muslims in multiple battles. He organized the massive coalition at the Battle of the Trench trying to destroy Islam completely. As a wealthy, powerful leader, he had everything to lose by accepting Islam. His opposition was fierce, strategic, and persistent, making him the Prophet's Ô∑∫ most formidable and dangerous adversary for many years.\",\n      \"When Makkah was about to be conquered, Abu Sufyan finally recognized the truth and accepted Islam. Despite years of enmity, the Prophet Ô∑∫ welcomed him and honored him by declaring that whoever entered Abu Sufyan's house would be safe. This generous treatment showed the Prophet's Ô∑∫ mercy and wisdom, turning a former arch-enemy into a sincere Muslim who would defend Islam courageously in future battles.\",\n      \"Abu Sufyan fought bravely at the Battle of Hunayn after his conversion, losing an eye during the fighting. At the Battle of Ta'if, he lost his other eye, becoming completely blind while defending Islam with courage. His transformation from Islam's fiercest enemy to a warrior who sacrificed his sight for Allah's cause showed that sincere repentance transforms people completely, erasing past sins through genuine change.\",\n      \"His children included Mu'awiyah, who became a companion and later the Caliph, and his daughter Umm Habibah, who married the Prophet Ô∑∫ and became a Mother of the Believers. Abu Sufyan's family went from leading opposition to leading the Muslim nation. His story shows Allah's mercy accepts anyone who sincerely repents, and past sins don't prevent future greatness when someone genuinely turns to Allah with a truthful heart.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑ ŸÑŸêŸëŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéŸÅŸéÿ±ŸèŸàÿß ÿ•ŸêŸÜ ŸäŸéŸÜÿ™ŸéŸáŸèŸàÿß ŸäŸèÿ∫ŸíŸÅŸéÿ±Ÿí ŸÑŸéŸáŸèŸÖ ŸÖŸéŸëÿß ŸÇŸéÿØŸí ÿ≥ŸéŸÑŸéŸÅŸé\",\n      translation: \"Say to those who have disbelieved, if they cease, what has previously occurred will be forgiven for them.\",\n      source: \"Qur'an 8:38\"\n    },\n    keyLesson: \"Even the greatest enemies of Islam can become sincere believers, and Allah forgives all past sins upon genuine repentance.\",\n    quizId: 32\n  }\n];\n\nexport default companionsLessons;\n","path":null,"size_bytes":65526,"size_tokens":null},"src/data/lessons/hellfireLessons.js":{"content":"export const hellfireLessons = [\n  {\n    id: 1,\n    title: \"Introduction to Hellfire\",\n    quizId: 1,\n    description: [\n      \"Hellfire is a real place created by Allah to punish those who reject Him and His messengers. It's eternal for disbelievers.\",\n      \n      \"The Qur'an describes Hellfire vividly so we understand our choices' seriousness. Everyone will see it on Judgment Day before entering Paradise or Hell.\",\n      \n      \"Learning about Hellfire motivates us toward righteousness and repentance, not just fear. Allah warns us from mercy so we can change our lives while alive.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßÿ™ŸéŸëŸÇŸèŸàÿß ÿßŸÑŸÜŸéŸëÿßÿ±Ÿé ÿßŸÑŸéŸëÿ™ŸêŸä ÿ£ŸèÿπŸêÿØŸéŸëÿ™Ÿí ŸÑŸêŸÑŸíŸÉŸéÿßŸÅŸêÿ±ŸêŸäŸÜŸé\",\n      translation: \"And fear the Fire, which has been prepared for the disbelievers. (Qur'an 3:131)\",\n      source: \"Qur'an 3:131\"\n    },\n    keyLesson: \"Hellfire is real and eternal for disbelievers. Allah warns us about it out of mercy so we can turn to Him in repentance and obedience before it's too late.\"\n  },\n  {\n    id: 2,\n    title: \"Names of Jahannam\",\n    quizId: 2,\n    description: [\n      \"Hellfire has many Qur'anic names. Jahannam means deep pit. An-NƒÅr means 'The Fire.' Each name reveals different aspects of its horror.\",\n      \n      \"Other names include Al-Jaheem (blazing fire), Saqar (scorching fire), Al-Hutamah (the crusher), and Al-Hawiyah (the abyss). Each teaches about Hellfire's devastating effects.\",\n      \n      \"Allah uses different names to emphasize various punishment qualities. Knowing these names increases fear of Allah and motivates obedience to His commands.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸáŸéÿß ŸÑŸéÿ•Ÿêÿ≠ŸíÿØŸéŸâ ÿßŸÑŸíŸÉŸèÿ®Ÿéÿ±Ÿê €ù ŸÜŸéÿ∞ŸêŸäÿ±Ÿãÿß ŸÑŸêŸëŸÑŸíÿ®Ÿéÿ¥Ÿéÿ±Ÿê\",\n      translation: \"Indeed, it (Saqar) is one of the greatest (afflictions), a warning to humanity. (Qur'an 74:35-36)\",\n      source: \"Qur'an 74:35-36\"\n    },\n    keyLesson: \"The many names of Hellfire reveal different aspects of its horror. Each name teaches us to take Allah's warnings seriously and strive to avoid this eternal punishment.\"\n  },\n  {\n    id: 3,\n    title: \"Creation of Hellfire\",\n    quizId: 3,\n    description: [\n      \"Allah created Hellfire before humanity, preparing it for those who would reject Him. It exists now, burning and waiting for Judgment Day.\",\n      \n      \"Allah gave Hellfire permission to 'breathe' twice yearly, producing summer's extreme heat and winter's extreme cold. One breath affects Earth's entire climate.\",\n      \n      \"Hellfire's fuel is stones and disbelievers' bodies. Its fire is seventy times hotter than any worldly fire. This demonstrates Allah's power and judgment.\"\n    ],\n    evidence: {\n      arabic: \"ÿßÿ¥Ÿíÿ™ŸéŸÉŸéÿ™Ÿê ÿßŸÑŸÜŸéŸëÿßÿ±Ÿè ÿ•ŸêŸÑŸéŸâ ÿ±Ÿéÿ®ŸêŸëŸáŸéÿß ŸÅŸéŸÇŸéÿßŸÑŸéÿ™Ÿí ÿ±Ÿéÿ®ŸêŸë ÿ£ŸéŸÉŸéŸÑŸé ÿ®ŸéÿπŸíÿ∂ŸêŸä ÿ®ŸéÿπŸíÿ∂Ÿãÿß ŸÅŸéÿ£Ÿéÿ∞ŸêŸÜŸé ŸÑŸéŸáŸéÿß ÿ®ŸêŸÜŸéŸÅŸéÿ≥ŸéŸäŸíŸÜŸê ŸÜŸéŸÅŸéÿ≥Ÿç ŸÅŸêŸä ÿßŸÑÿ¥ŸêŸëÿ™Ÿéÿßÿ°Ÿê ŸàŸéŸÜŸéŸÅŸéÿ≥Ÿç ŸÅŸêŸä ÿßŸÑÿµŸéŸëŸäŸíŸÅŸê\",\n      translation: \"The Fire complained to its Lord saying, 'O Lord! My parts are eating each other.' So Allah allowed it two breaths: one in winter and one in summer. (Sahih Bukhari 537)\",\n      source: \"Sahih Bukhari 537\"\n    },\n    keyLesson: \"Hellfire already exists and is so hot that even one breath from it creates extreme temperatures on Earth. This reality should humble us before Allah's power and judgment.\"\n  },\n  {\n    id: 4,\n    title: \"The Keepers of Hellfire\",\n    quizId: 4,\n    description: [\n      \"Nineteen mighty angels guard Hellfire, never disobeying Allah's commands. Their leader is MƒÅlik. They show no mercy to condemned souls.\",\n      \n      \"They're called Zabaniyah meaning 'the violent ones.' They drag disbelievers in, throw them into punishment, and ensure they receive full recompense for their sins.\",\n      \n      \"People beg MƒÅlik to ask Allah to end their lives. He responds they'll remain forever. The keepers prove there's no escaping Hellfire once inside.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéŸÑŸéŸäŸíŸáŸéÿß ÿ™Ÿêÿ≥ŸíÿπŸéÿ©Ÿé ÿπŸéÿ¥Ÿéÿ±Ÿé\",\n      translation: \"Over it are nineteen (angels). (Qur'an 74:30)\",\n      source: \"Qur'an 74:30\"\n    },\n    keyLesson: \"Nineteen powerful angels guard Hellfire and carry out Allah's punishment without mercy. They will never free anyone Allah has condemned, showing the permanence of His judgment.\"\n  },\n  {\n    id: 5,\n    title: \"The Gates of Hellfire\",\n    quizId: 5,\n    description: [\n      \"Hellfire has seven gates for different sinner groups based on disbelief and sin levels. The lowest gate is for hypocrites suffering worst punishment.\",\n      \n      \"On Judgment Day, disbelievers are driven in groups to Hellfire. When gates open, they see awaiting horror and hear roaring. Keepers rebuke them.\",\n      \n      \"Each gate represents different punishment intensity. The Qur'an says Hell's gates lock upon inhabitants forever. There's no escape once Allah's judgment passes.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜŸéŸë ÿ¨ŸéŸáŸéŸÜŸéŸëŸÖŸé ŸÑŸéŸÖŸéŸàŸíÿπŸêÿØŸèŸáŸèŸÖŸí ÿ£Ÿéÿ¨ŸíŸÖŸéÿπŸêŸäŸÜŸé €ù ŸÑŸéŸáŸéÿß ÿ≥Ÿéÿ®ŸíÿπŸéÿ©Ÿè ÿ£Ÿéÿ®ŸíŸàŸéÿßÿ®Ÿç\",\n      translation: \"And indeed, Hell is the promised place for them all. It has seven gates. (Qur'an 15:43-44)\",\n      source: \"Qur'an 15:43-44\"\n    },\n    keyLesson: \"Hellfire has seven gates, each for different levels of sin and disbelief. Once its gates close upon the inhabitants, there is no escape from eternal punishment.\"\n  },\n  {\n    id: 6,\n    title: \"The People of Hellfire\",\n    quizId: 6,\n    description: [\n      \"Most Hellfire inhabitants are disbelievers who rejected Allah and His messengers. This includes polytheists, atheists, and those knowing truth but refusing it.\",\n      \n      \"The Prophet Ô∑∫ saw most inhabitants will be ungrateful women. This warns against ingratitude and disbelief. Men and women are equally accountable.\",\n      \n      \"Others destined for Hellfire include oppressors, murderers, and major sinners. Sinful Muslims may be removed through Allah's mercy. Only disbelievers remain forever.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸÑŸéÿß ŸäŸéÿ∫ŸíŸÅŸêÿ±Ÿè ÿ£ŸéŸÜ ŸäŸèÿ¥Ÿíÿ±ŸéŸÉŸé ÿ®ŸêŸáŸê ŸàŸéŸäŸéÿ∫ŸíŸÅŸêÿ±Ÿè ŸÖŸéÿß ÿØŸèŸàŸÜŸé ÿ∞ŸéŸ∞ŸÑŸêŸÉŸé ŸÑŸêŸÖŸéŸÜ ŸäŸéÿ¥Ÿéÿßÿ°Ÿè\",\n      translation: \"Indeed, Allah does not forgive association with Him, but He forgives what is less than that for whom He wills. (Qur'an 4:48)\",\n      source: \"Qur'an 4:48\"\n    },\n    keyLesson: \"Disbelievers will remain in Hellfire forever, while sinful Muslims may be punished then forgiven. The worst sin is shirk (associating partners with Allah), which Allah never forgives without repentance.\"\n  },\n  {\n    id: 7,\n    title: \"Hypocrites in Hellfire\",\n    quizId: 7,\n    description: [\n      \"Hypocrites suffer Hellfire's lowest, most severe level. They pretended to believe while secretly disbelieving, deceiving Muslims appearing righteous but harboring hatred.\",\n      \n      \"Allah despises hypocrisy because it's lying to people and Allah. Hypocrites prayed with Muslims but secretly worked against Islam, earning Hell's deepest pit.\",\n      \n      \"The Qur'an describes hypocrites begging believers for light on Judgment Day. A wall separates them forever. Believers respond the hypocrites deceived themselves.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸíŸÖŸèŸÜŸéÿßŸÅŸêŸÇŸêŸäŸÜŸé ŸÅŸêŸä ÿßŸÑÿØŸéŸëÿ±ŸíŸÉŸê ÿßŸÑŸíÿ£Ÿéÿ≥ŸíŸÅŸéŸÑŸê ŸÖŸêŸÜŸé ÿßŸÑŸÜŸéŸëÿßÿ±Ÿê\",\n      translation: \"Indeed, the hypocrites will be in the lowest depths of the Fire. (Qur'an 4:145)\",\n      source: \"Qur'an 4:145\"\n    },\n    keyLesson: \"Hypocrites receive the worst punishment in Hellfire's lowest level because they deceived both Allah and believers. Sincerity in faith is essential to avoid their terrible fate.\"\n  },\n  {\n    id: 8,\n    title: \"Disbelievers in Hellfire\",\n    quizId: 8,\n    description: [\n      \"Those who rejected Allah's messengers will be dragged to Hellfire blind, deaf, and mute. They drink boiling water and eat from Zaqq≈´m tree.\",\n      \n      \"Disbelievers argue in Hellfire, blaming leaders who misled them and cursing followers. The weak blame arrogant, arrogant blame weak. All share punishment together.\",\n      \n      \"They cry to keepers, begging for death or relief, receiving none. They confess sins and beg for second chances. It's too late‚Äîtheir fate is sealed.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéŸÅŸéÿ±ŸèŸàÿß ŸÑŸéŸáŸèŸÖŸí ŸÜŸéÿßÿ±Ÿè ÿ¨ŸéŸáŸéŸÜŸéŸëŸÖŸé ŸÑŸéÿß ŸäŸèŸÇŸíÿ∂ŸéŸâŸ∞ ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸí ŸÅŸéŸäŸéŸÖŸèŸàÿ™ŸèŸàÿß ŸàŸéŸÑŸéÿß ŸäŸèÿÆŸéŸÅŸéŸëŸÅŸè ÿπŸéŸÜŸíŸáŸèŸÖ ŸÖŸêŸëŸÜŸí ÿπŸéÿ∞Ÿéÿßÿ®ŸêŸáŸéÿß\",\n      translation: \"And for those who disbelieved will be the fire of Hell. They are neither killed so they may die, nor is its torment lightened for them. (Qur'an 35:36)\",\n      source: \"Qur'an 35:36\"\n    },\n    keyLesson: \"Disbelievers will suffer eternal torment with no escape, death, or relief. They will beg for mercy but find none because they rejected Allah's mercy while alive.\"\n  },\n  {\n    id: 9,\n    title: \"Sinful Muslims in Hellfire\",\n    quizId: 9,\n    description: [\n      \"Muslims who died without repenting from major sins may enter Hellfire for purification. They believed in Allah so won't remain in Hell forever.\",\n      \n      \"The Prophet Ô∑∫ will intercede for many sinful Muslims. Allah will forgive others by mercy alone. Some are punished briefly then admitted to Paradise.\",\n      \n      \"The difference is Muslims eventually leave Hellfire, disbelievers never do. This emphasizes holding onto faith while struggling with sin. True Tawheed protects us.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿß ŸäŸéÿÆŸíŸÑŸèÿØŸè ŸÅŸêŸäŸáŸê ŸÖŸéŸÜŸí ŸÉŸéÿßŸÜŸé ŸÅŸêŸä ŸÇŸéŸÑŸíÿ®ŸêŸáŸê ŸÖŸêÿ´ŸíŸÇŸéÿßŸÑŸè ÿ≠Ÿéÿ®ŸéŸëÿ©Ÿç ŸÖŸêŸÜŸí ÿÆŸéÿ±ŸíÿØŸéŸÑŸç ŸÖŸêŸÜŸí ÿ•ŸêŸäŸÖŸéÿßŸÜŸç\",\n      translation: \"No one who has even an atom's weight of faith in his heart will remain in it (Hellfire) forever. (Sahih Muslim 193)\",\n      source: \"Sahih Muslim 193\"\n    },\n    keyLesson: \"Sinful Muslims may be punished in Hellfire temporarily but will eventually enter Paradise. This shows that maintaining faith in Allah, even with sins, protects us from eternal damnation.\"\n  },\n  {\n    id: 10,\n    title: \"The Scale of Deeds and Hellfire\",\n    quizId: 10,\n    description: [\n      \"On Judgment Day, everyone's deeds will be weighed precisely. Those whose bad deeds outweigh good will be sent to Hellfire. Every atom's weight is measured.\",\n      \n      \"Disbelievers' deeds are worthless because they lacked faith. The Qur'an compares their deeds to scattered dust blown away by wind. Without belief, nothing saves them.\",\n      \n      \"For Muslims, faith gives weight to good deeds. Small kindness becomes heavy when done sincerely for Allah. The scale shows perfect justice‚Äîeveryone receives what they earned.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ£ŸéŸÖŸéŸëÿß ŸÖŸéŸÜ ÿ´ŸéŸÇŸèŸÑŸéÿ™Ÿí ŸÖŸéŸàŸéÿßÿ≤ŸêŸäŸÜŸèŸáŸè €ù ŸÅŸéŸáŸèŸàŸé ŸÅŸêŸä ÿπŸêŸäÿ¥Ÿéÿ©Ÿç ÿ±ŸéŸëÿßÿ∂ŸêŸäŸéÿ©Ÿç €ù ŸàŸéÿ£ŸéŸÖŸéŸëÿß ŸÖŸéŸÜŸí ÿÆŸéŸÅŸéŸëÿ™Ÿí ŸÖŸéŸàŸéÿßÿ≤ŸêŸäŸÜŸèŸáŸè €ù ŸÅŸéÿ£ŸèŸÖŸèŸëŸáŸè ŸáŸéÿßŸàŸêŸäŸéÿ©Ÿå\",\n      translation: \"As for the one whose scales are heavy, he will be in a pleasant life. But as for the one whose scales are light, his refuge will be an abyss (Hellfire). (Qur'an 101:6-9)\",\n      source: \"Qur'an 101:6-9\"\n    },\n    keyLesson: \"Our deeds will be weighed precisely on Judgment Day. Those whose bad deeds outweigh good, or who lacked faith, will enter Hellfire. This scale motivates us to increase good deeds and avoid sin.\"\n  },\n  {\n    id: 11,\n    title: \"The Severity of Hellfire\",\n    quizId: 11,\n    description: [\n      \"Hellfire's heat is seventy times hotter than any Earth fire. Inhabitants wear fire garments, drink boiling water, and breathe scorching winds.\",\n      \n      \"The least punished person has fire sandals causing his brain to boil. People's skin burns off then is replaced instantly so pain continues forever.\",\n      \n      \"People will be given bodies that cannot die but feel intense pain. They'll burn, thirst, hunger beyond imagination. This shows disbelief and sin's seriousness.\"\n    ],\n    evidence: {\n      arabic: \"ŸÉŸèŸÑŸéŸëŸÖŸéÿß ŸÜŸéÿ∂Ÿêÿ¨Ÿéÿ™Ÿí ÿ¨ŸèŸÑŸèŸàÿØŸèŸáŸèŸÖ ÿ®ŸéÿØŸéŸëŸÑŸíŸÜŸéÿßŸáŸèŸÖŸí ÿ¨ŸèŸÑŸèŸàÿØŸãÿß ÿ∫ŸéŸäŸíÿ±ŸéŸáŸéÿß ŸÑŸêŸäŸéÿ∞ŸèŸàŸÇŸèŸàÿß ÿßŸÑŸíÿπŸéÿ∞Ÿéÿßÿ®Ÿé\",\n      translation: \"Every time their skins are roasted, We will replace them with other skins so they may taste the punishment. (Qur'an 4:56)\",\n      source: \"Qur'an 4:56\"\n    },\n    keyLesson: \"Hellfire's torment is unimaginably severe and continuous, with no rest or death. This reality should drive us to obey Allah and seek His protection from such punishment.\"\n  },\n  {\n    id: 12,\n    title: \"Hellfire's Speech\",\n    quizId: 12,\n    description: [\n      \"Hellfire itself will speak on Judgment Day. When disbelievers are thrown in, it roars and bellows with rage, almost bursting from fury.\",\n      \n      \"Hellfire will ask Allah, 'Are there any more?' showing it hungers for more disbelievers to punish. Its rage is directed at Allah's signs rejecters.\",\n      \n      \"Hellfire will be brought forward with seventy thousand ropes, each pulled by seventy thousand angels. Everyone sees it roaring. Even the righteous will fall to their knees.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿéÿß ÿ±Ÿéÿ£Ÿéÿ™ŸíŸáŸèŸÖ ŸÖŸêŸëŸÜ ŸÖŸéŸëŸÉŸéÿßŸÜŸç ÿ®ŸéÿπŸêŸäÿØŸç ÿ≥ŸéŸÖŸêÿπŸèŸàÿß ŸÑŸéŸáŸéÿß ÿ™Ÿéÿ∫ŸéŸäŸèŸëÿ∏Ÿãÿß ŸàŸéÿ≤ŸéŸÅŸêŸäÿ±Ÿãÿß\",\n      translation: \"When it (Hellfire) sees them from a distant place, they will hear its fury and roaring. (Qur'an 25:12)\",\n      source: \"Qur'an 25:12\"\n    },\n    keyLesson: \"Hellfire will roar with rage and speak on Judgment Day, testifying against disbelievers. Its fury and voice make its reality undeniable and should motivate us toward righteousness.\"\n  },\n  {\n    id: 13,\n    title: \"Food and Drink in Hellfire\",\n    quizId: 13,\n    description: [\n      \"The food in Hellfire is Zaqq≈´m tree's fruit, thorny and bitter, looking like devils' heads. Hunger forces inhabitants to eat it despite horrible taste.\",\n      \n      \"After eating Zaqq≈´m, they drink boiling water like molten metal tearing apart their insides. They gulp it desperately but it never quenches thirst.\",\n      \n      \"Sometimes they're given pus and blood to drink, forced to swallow. This disgusting sustenance shows complete worldly pleasure reversal, punishment for rejecting Allah.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿ¥Ÿéÿ¨Ÿéÿ±Ÿéÿ™Ÿé ÿßŸÑÿ≤ŸéŸëŸÇŸèŸëŸàŸÖŸê €ù ÿ∑ŸéÿπŸéÿßŸÖŸè ÿßŸÑŸíÿ£Ÿéÿ´ŸêŸäŸÖŸê €ù ŸÉŸéÿßŸÑŸíŸÖŸèŸáŸíŸÑŸê ŸäŸéÿ∫ŸíŸÑŸêŸä ŸÅŸêŸä ÿßŸÑŸíÿ®Ÿèÿ∑ŸèŸàŸÜŸê €ù ŸÉŸéÿ∫ŸéŸÑŸíŸäŸê ÿßŸÑŸíÿ≠ŸéŸÖŸêŸäŸÖŸê\",\n      translation: \"Indeed, the tree of Zaqq≈´m is food for the sinful. Like molten brass, it will boil in their bellies like the boiling of scalding water. (Qur'an 44:43-46)\",\n      source: \"Qur'an 44:43-46\"\n    },\n    keyLesson: \"The inhabitants of Hellfire will eat painful, bitter food and drink boiling water that tears them apart. This torment contrasts Paradise's delights and shows the consequence of rejecting Allah.\"\n  },\n  {\n    id: 14,\n    title: \"Chains and Regret\",\n    quizId: 14,\n    description: [\n      \"Disbelievers will be bound in chains seventy cubits long (about 32 meters). These iron restraints bind hands to necks. They're dragged through Hellfire, unable to resist.\",\n      \n      \"They'll be yoked together in columns, chained as groups. This humiliation adds to physical pain. The chains symbolize how sins imprisoned them in life.\",\n      \n      \"In these chains, they feel overwhelming regret, wishing desperately to return to Earth. They cry they were warned but didn't listen. Regret in Hell is useless.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸèÿ∞ŸèŸàŸáŸè ŸÅŸéÿ∫ŸèŸÑŸèŸëŸàŸáŸè €ù ÿ´ŸèŸÖŸéŸë ÿßŸÑŸíÿ¨Ÿéÿ≠ŸêŸäŸÖŸé ÿµŸéŸÑŸèŸëŸàŸáŸè €ù ÿ´ŸèŸÖŸéŸë ŸÅŸêŸä ÿ≥ŸêŸÑŸíÿ≥ŸêŸÑŸéÿ©Ÿç ÿ∞Ÿéÿ±ŸíÿπŸèŸáŸéÿß ÿ≥Ÿéÿ®ŸíÿπŸèŸàŸÜŸé ÿ∞Ÿêÿ±ŸéÿßÿπŸãÿß ŸÅŸéÿßÿ≥ŸíŸÑŸèŸÉŸèŸàŸáŸè\",\n      translation: \"Seize him and shackle him. Then drive him into Hellfire. Then insert him into a chain whose length is seventy cubits. (Qur'an 69:30-32)\",\n      source: \"Qur'an 69:30-32\"\n    },\n    keyLesson: \"Disbelievers will be bound in massive chains and dragged through Hellfire, filled with regret but unable to escape. This shows that the time for repentance is now, before death.\"\n  },\n  {\n    id: 15,\n    title: \"Crying and Pleas for Help\",\n    quizId: 15,\n    description: [\n      \"Hellfire people will cry so much that if ships could sail in their tears, they would float. They'll weep until tears run out, then weep blood.\",\n      \n      \"They'll call to Hell's keepers, begging for death or lighter punishment. Keepers respond they must remain forever and are getting exactly what they deserve.\",\n      \n      \"They'll call to Paradise people, begging for water or food. A barrier separates them forever. Believers respond Allah has forbidden these blessings to disbelievers.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸéÿßÿØŸéŸàŸíÿß ŸäŸéÿß ŸÖŸéÿßŸÑŸêŸÉŸè ŸÑŸêŸäŸéŸÇŸíÿ∂Ÿê ÿπŸéŸÑŸéŸäŸíŸÜŸéÿß ÿ±Ÿéÿ®ŸèŸëŸÉŸé €ñ ŸÇŸéÿßŸÑŸé ÿ•ŸêŸÜŸéŸëŸÉŸèŸÖ ŸÖŸéŸëÿßŸÉŸêÿ´ŸèŸàŸÜŸé\",\n      translation: \"And they will cry, 'O MƒÅlik! Let your Lord put an end to us!' He will say, 'Indeed, you will remain.' (Qur'an 43:77)\",\n      source: \"Qur'an 43:77\"\n    },\n    keyLesson: \"The inhabitants of Hellfire will cry and beg endlessly for relief, but they will receive none. Their eternal regret and despair should motivate us to obey Allah now.\"\n  },\n  {\n    id: 16,\n    title: \"Intercession from Hellfire\",\n    quizId: 16,\n    description: [\n      \"The Prophet Muhammad Ô∑∫ will intercede for certain sinful Muslims in Hellfire. Allah will accept this intercession and many believers will be saved by His mercy.\",\n      \n      \"However, there's absolutely no intercession for disbelievers who died in disbelief. Their punishment is permanent. No prophet, angel, or righteous person can help them escape.\",\n      \n      \"This shows Allah's mercy toward believers who sinned but never lost faith. It emphasizes dying with true belief's critical importance. Without faith, intercession is impossible.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿÆŸíÿ±Ÿèÿ¨Ÿè ŸÖŸêŸÜŸé ÿßŸÑŸÜŸéŸëÿßÿ±Ÿê ŸÖŸéŸÜŸí ŸÇŸéÿßŸÑŸé ŸÑŸéÿß ÿ•ŸêŸÑŸéŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéŸÅŸêŸä ŸÇŸéŸÑŸíÿ®ŸêŸáŸê ŸàŸéÿ≤ŸíŸÜŸè ÿ∞Ÿéÿ±ŸéŸëÿ©Ÿç ŸÖŸêŸÜŸí ÿ•ŸêŸäŸÖŸéÿßŸÜŸç\",\n      translation: \"There will come out of Hellfire whoever said 'There is no god but Allah' and had in his heart even an atom's weight of faith. (Sahih Bukhari 99)\",\n      source: \"Sahih Bukhari 99\"\n    },\n    keyLesson: \"Believers in Hellfire may be saved through intercession, but disbelievers have no one to help them. Faith in Allah is the key to eventual salvation from punishment.\"\n  },\n  {\n    id: 17,\n    title: \"The Last Person Out of Hellfire\",\n    quizId: 17,\n    description: [\n      \"The last person to leave Hellfire will be a Muslim who committed many sins. After immense time burning in Hell, Allah commands angels to remove him.\",\n      \n      \"This person will crawl out of Hell scorched and exhausted. He crosses to Paradise barely escaping. When he sees Hell behind, he'll thank Allah eternally.\",\n      \n      \"Even though he enters Paradise last with lowest rank, he'll experience joy beyond imagination. Allah grants him a kingdom ten times Earth's size.\"\n    ],\n    evidence: {\n      arabic: \"ÿ¢ÿÆŸêÿ±Ÿè ŸÖŸéŸÜŸí ŸäŸéÿÆŸíÿ±Ÿèÿ¨Ÿè ŸÖŸêŸÜŸé ÿßŸÑŸÜŸéŸëÿßÿ±Ÿê ÿ±Ÿéÿ¨ŸèŸÑŸå ŸäŸéÿÆŸíÿ±Ÿèÿ¨Ÿè ŸÖŸêŸÜŸíŸáŸéÿß ÿ≠Ÿéÿ®ŸíŸàŸãÿß\",\n      translation: \"The last person to come out of Hellfire will be a man who comes out of it crawling. (Sahih Muslim 186)\",\n      source: \"Sahih Muslim 186\"\n    },\n    keyLesson: \"The last believer to leave Hellfire will still enter Paradise and receive blessings beyond imagination. This shows Allah's mercy even to the most sinful believers who held onto faith.\"\n  },\n  {\n    id: 18,\n    title: \"Lessons from Hellfire\",\n    quizId: 18,\n    description: [\n      \"Learning about Hellfire teaches us actions have real, eternal consequences. It's not mythology or metaphor‚Äîit's a real place awaiting those who reject truth.\",\n      \n      \"Hellfire reminds us of Allah's perfect justice. No one enters except by choosing to disbelieve or persist in major sins. Those in Hell earned it by rejecting His mercy.\",\n      \n      \"Most importantly, Hellfire teaches us to value Allah's mercy and guidance. We should remain humble and grateful. We should fear Allah's punishment while hoping for His mercy.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ£ŸéŸÜÿ∞Ÿéÿ±Ÿíÿ™ŸèŸÉŸèŸÖŸí ŸÜŸéÿßÿ±Ÿãÿß ÿ™ŸéŸÑŸéÿ∏ŸéŸëŸâŸ∞ €ù ŸÑŸéÿß ŸäŸéÿµŸíŸÑŸéÿßŸáŸéÿß ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸíÿ£Ÿéÿ¥ŸíŸÇŸéŸâ\",\n      translation: \"So I have warned you of a blazing Fire. None will enter it except the most wretched. (Qur'an 92:14-15)\",\n      source: \"Qur'an 92:14-15\"\n    },\n    keyLesson: \"Hellfire teaches us about Allah's justice, the seriousness of our choices, and the immense value of faith. We must live with awareness that our eternal destination depends on our beliefs and actions.\"\n  },\n  {\n    id: 19,\n    title: \"Reflection and Change\",\n    quizId: 19,\n    description: [\n      \"Now that we understand Hellfire's reality, we must reflect on our lives. Are we living to earn Allah's pleasure? Do we avoid major sins and repent when we make mistakes?\",\n      \n      \"Knowledge without action is useless. Learning about Hellfire should inspire immediate behavior change. We should increase good deeds and strengthen our relationship with Allah through prayer.\",\n      \n      \"Remember Allah's mercy is always available to those who sincerely repent. The door to repentance remains open until death. Let Hellfire motivate us toward Paradise.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ŸäŸéÿß ÿπŸêÿ®ŸéÿßÿØŸêŸäŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ£Ÿéÿ≥Ÿíÿ±ŸéŸÅŸèŸàÿß ÿπŸéŸÑŸéŸâŸ∞ ÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸáŸêŸÖŸí ŸÑŸéÿß ÿ™ŸéŸÇŸíŸÜŸéÿ∑ŸèŸàÿß ŸÖŸêŸÜ ÿ±ŸéŸëÿ≠ŸíŸÖŸéÿ©Ÿê ÿßŸÑŸÑŸéŸëŸáŸê €ö ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸäŸéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑÿ∞ŸèŸëŸÜŸèŸàÿ®Ÿé ÿ¨ŸéŸÖŸêŸäÿπŸãÿß\",\n      translation: \"Say, 'O My servants who have transgressed against themselves, do not despair of the mercy of Allah. Indeed, Allah forgives all sins.' (Qur'an 39:53)\",\n      source: \"Qur'an 39:53\"\n    },\n    keyLesson: \"Learning about Hellfire must lead to real change in our lives. We should repent sincerely, strengthen our faith, and strive for Paradise while there is still time to choose our eternal destination.\"\n  }\n];\n","path":null,"size_bytes":22525,"size_tokens":null},"src/data/lessons/paradiseLessons.js":{"content":"export const paradiseLessons = [\n  {\n    id: 1,\n    title: \"Introduction to Paradise\",\n    quizId: 1,\n    description: [\n      \"Paradise (Jannah) is the eternal home Allah prepared for believers who do righteous deeds. It offers infinite joy, beauty, and peace beyond imagination.\",\n      \n      \"No eye has seen, no ear heard, no mind conceived Paradise's beauty. Even the lowest rank surpasses the entire world's pleasures combined.\",\n      \n      \"Paradise is gained through Allah's mercy combined with sincere faith and good actions. The Prophet Ô∑∫ taught that mercy covers us when we believe and strive.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ≥Ÿéÿßÿ±ŸêÿπŸèŸàÿß ÿ•ŸêŸÑŸéŸâŸ∞ ŸÖŸéÿ∫ŸíŸÅŸêÿ±Ÿéÿ©Ÿç ŸÖŸêŸëŸÜ ÿ±ŸéŸëÿ®ŸêŸëŸÉŸèŸÖŸí ŸàŸéÿ¨ŸéŸÜŸéŸëÿ©Ÿç ÿπŸéÿ±Ÿíÿ∂ŸèŸáŸéÿß ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿè ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿè ÿ£ŸèÿπŸêÿØŸéŸëÿ™Ÿí ŸÑŸêŸÑŸíŸÖŸèÿ™ŸéŸëŸÇŸêŸäŸÜŸé\",\n      translation: \"And hasten to forgiveness from your Lord and a Paradise as wide as the heavens and earth, prepared for the righteous. (Qur'an 3:133)\",\n      source: \"Qur'an 3:133\"\n    },\n    keyLesson: \"Paradise is an eternal reward beyond imagination, prepared by Allah for those who believe and do good. It is gained through Allah's mercy combined with sincere faith and righteous action.\"\n  },\n  {\n    id: 2,\n    title: \"Names of Paradise\",\n    quizId: 2,\n    description: [\n      \"Paradise has many beautiful Qur'anic names revealing different blessings. Jannah means 'garden.' Dar As-SalƒÅm means 'Abode of Peace' where no conflict or sadness exists.\",\n      \n      \"Other names include Jannat Al-Firdaws (highest Paradise), Jannat 'Adn (Gardens of Eternity), and Jannat An-Na'eem (Gardens of Delight). Each reveals different perfection aspects.\",\n      \n      \"Allah uses different names to help us understand and desire Paradise. Knowing these names increases our motivation to work toward this ultimate eternal goal.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸáŸèŸÖŸí ÿØŸéÿßÿ±Ÿè ÿßŸÑÿ≥ŸéŸëŸÑŸéÿßŸÖŸê ÿπŸêŸÜÿØŸé ÿ±Ÿéÿ®ŸêŸëŸáŸêŸÖŸí\",\n      translation: \"For them will be the Home of Peace (Dar As-SalƒÅm) with their Lord. (Qur'an 6:127)\",\n      source: \"Qur'an 6:127\"\n    },\n    keyLesson: \"The many names of Paradise reveal different aspects of its beauty and blessings. Each name motivates us to strive for this eternal home of peace, joy, and perfection.\"\n  },\n  {\n    id: 3,\n    title: \"The Creation of Paradise\",\n    quizId: 3,\n    description: [\n      \"Allah created Paradise before creating humanity, preparing it for those who believe and worship Him alone. It already exists right now, complete and waiting.\",\n      \n      \"Paradise's soil is pure musk, its buildings are gold and silver bricks, and its pebbles are pearls and precious jewels. Even basic elements surpass Earth's beauty.\",\n      \n      \"Allah created Paradise demonstrating His generosity, mercy, and power. Its existence now proves Allah's promise is real and certain, motivating us to prepare through worship.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéÿ±Ÿíÿ∂ŸèŸáŸéÿß ŸÉŸéÿπŸéÿ±Ÿíÿ∂Ÿê ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿê ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê\",\n      translation: \"Its width is like the width of the heavens and the earth. (Sahih Muslim 2825)\",\n      source: \"Sahih Muslim 2825\"\n    },\n    keyLesson: \"Paradise already exists, created by Allah from the finest and most beautiful materials imaginable. Its reality right now proves that Allah's promise is certain and true.\"\n  },\n  {\n    id: 4,\n    title: \"The Gates of Paradise\",\n    quizId: 4,\n    description: [\n      \"Paradise has eight magnificent gates, each reserved for people excelling in specific worship acts. There are gates for prayer, fasting, charity, and other righteous deeds.\",\n      \n      \"The gates are extremely wide‚Äîthe distance between sides equals the distance between Mecca and Busra. This immense width shows how welcoming Paradise is to believers.\",\n      \n      \"People enter through the gate matching their best deeds. Exceptional people like Abu Bakr are called from all eight gates, motivating us to excel in worship.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ≥ŸêŸäŸÇŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿßÿ™ŸéŸëŸÇŸéŸàŸíÿß ÿ±Ÿéÿ®ŸéŸëŸáŸèŸÖŸí ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ÿ≤ŸèŸÖŸéÿ±Ÿãÿß €ñ ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ÿ•Ÿêÿ∞Ÿéÿß ÿ¨Ÿéÿßÿ°ŸèŸàŸáŸéÿß ŸàŸéŸÅŸèÿ™Ÿêÿ≠Ÿéÿ™Ÿí ÿ£Ÿéÿ®ŸíŸàŸéÿßÿ®ŸèŸáŸéÿß\",\n      translation: \"And those who feared their Lord will be led to Paradise in groups until, when they reach it while its gates have been opened... (Qur'an 39:73)\",\n      source: \"Qur'an 39:73\"\n    },\n    keyLesson: \"Paradise has eight wide gates, each for those who excelled in specific worship. This teaches us to excel in all types of good deeds and worship Allah in diverse ways.\"\n  },\n  {\n    id: 5,\n    title: \"The Key to Jannah\",\n    quizId: 5,\n    description: [\n      \"The key to Paradise is saying 'LƒÅ ilƒÅha illƒÅ AllƒÅh' with sincere belief and living according to its meaning through righteous actions proving our sincerity.\",\n      \n      \"Saying the words alone is not enough. The key needs the right 'teeth'‚Äîactions demonstrating true belief like prayer, charity, fasting, and avoiding major sins.\",\n      \n      \"The Prophet Ô∑∫ taught that whoever dies with sincere Tawheed will eventually enter Paradise. Holding firmly to faith is essential salvation's foundation without which deeds are worthless.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ŸÇŸéÿßŸÑŸé ŸÑŸéÿß ÿ•ŸêŸÑŸéŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéŸÉŸéŸÅŸéÿ±Ÿé ÿ®ŸêŸÖŸéÿß ŸäŸèÿπŸíÿ®ŸéÿØŸè ŸÖŸêŸÜŸí ÿØŸèŸàŸÜŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ≠Ÿéÿ±ŸèŸÖŸé ŸÖŸéÿßŸÑŸèŸáŸè ŸàŸéÿØŸéŸÖŸèŸáŸè ŸàŸéÿ≠Ÿêÿ≥Ÿéÿßÿ®ŸèŸáŸè ÿπŸéŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"Whoever says 'There is no god but Allah' and rejects all that is worshipped besides Allah, his wealth and blood are sacred, and his reckoning is with Allah. (Sahih Muslim 23)\",\n      source: \"Sahih Muslim 23\"\n    },\n    keyLesson: \"The key to Paradise is sincere faith in Allah's oneness combined with righteous actions. Faith without deeds is incomplete, and deeds without faith are worthless.\"\n  },\n  {\n    id: 6,\n    title: \"The Lowest Rank in Jannah\",\n    quizId: 6,\n    description: [\n      \"Even the person with the lowest Paradise rank will receive blessings beyond imagination. The Prophet Ô∑∫ described a kingdom ten times Earth's size with all treasures.\",\n      \n      \"When this person sees his gifts, he'll think he received the greatest blessing. But Allah will tell him he has the same and ten times more.\",\n      \n      \"If this is the lowest rank, imagine the higher levels' blessings. Even struggling believers who barely enter Paradise will experience eternal joy beyond wildest dreams.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿ£ŸéÿØŸíŸÜŸéŸâ ÿ£ŸéŸáŸíŸÑŸê ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ŸÖŸéŸÜŸíÿ≤ŸêŸÑŸéÿ©Ÿã ŸÑŸéÿ±Ÿéÿ¨ŸèŸÑŸå ŸäŸéŸÜŸíÿ∏Ÿèÿ±Ÿè ÿ•ŸêŸÑŸéŸâ ÿ¨ŸêŸÜŸéÿßŸÜŸêŸáŸê ŸàŸéÿ£Ÿéÿ≤ŸíŸàŸéÿßÿ¨ŸêŸáŸê ŸàŸéÿÆŸéÿØŸéŸÖŸêŸáŸê ŸàŸéÿ≥Ÿèÿ±Ÿèÿ±ŸêŸáŸê ŸÖŸéÿ≥ŸêŸäÿ±Ÿéÿ©Ÿé ÿ£ŸéŸÑŸíŸÅŸê ÿ≥ŸéŸÜŸéÿ©Ÿç\",\n      translation: \"Indeed, the lowest rank in Paradise will have a kingdom extending as far as he can see for a thousand years. (Sahih Muslim 189)\",\n      source: \"Sahih Muslim 189\"\n    },\n    keyLesson: \"Even the lowest rank in Paradise includes unimaginable blessings‚Äîa kingdom ten times the size of Earth. This shows Allah's infinite generosity to all believers, even the weakest in faith.\"\n  },\n  {\n    id: 7,\n    title: \"The Highest Paradise - Firdaws\",\n    quizId: 7,\n    description: [\n      \"Jannat Al-Firdaws is the highest, most magnificent Paradise level located directly beneath Allah's Throne. It's reserved for those who strived hardest in worshiping Allah.\",\n      \n      \"From Firdaws flow the four main Paradise rivers spreading throughout different levels below. Firdaws people include prophets, the truthful, martyrs, and the most righteous.\",\n      \n      \"The Prophet Ô∑∫ taught us to specifically ask for Al-Firdaws Al-A'lƒÅ when requesting Paradise. Allah loves when His servants ask Him for the best of everything.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ÿ≥Ÿéÿ£ŸéŸÑŸíÿ™ŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸé ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé ŸÅŸéÿßÿ≥Ÿíÿ£ŸéŸÑŸèŸàŸáŸè ÿßŸÑŸíŸÅŸêÿ±ŸíÿØŸéŸàŸíÿ≥Ÿé ŸÅŸéÿ•ŸêŸÜŸéŸëŸáŸè ÿ£ŸéŸàŸíÿ≥Ÿéÿ∑Ÿè ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ŸàŸéÿ£ŸéÿπŸíŸÑŸéŸâ ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ŸàŸéŸÅŸéŸàŸíŸÇŸéŸáŸè ÿπŸéÿ±Ÿíÿ¥Ÿè ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸÜŸê\",\n      translation: \"When you ask Allah for Paradise, ask Him for Firdaws, for it is the middle and highest part of Paradise, and above it is the Throne of the Most Merciful. (Sahih Bukhari 2790)\",\n      source: \"Sahih Bukhari 2790\"\n    },\n    keyLesson: \"Firdaws is the highest Paradise beneath Allah's Throne. We should always aim for the highest levels by excelling in worship and asking Allah specifically for Firdaws.\"\n  },\n  {\n    id: 8,\n    title: \"The Rivers of Paradise\",\n    quizId: 8,\n    description: [\n      \"Paradise contains rivers of pure water never becoming stale, rivers of milk never changing in taste, rivers of purified honey, and rivers of wine causing no harm.\",\n      \n      \"These rivers are gifts for the righteous who avoided Allah's prohibitions. Believers sacrificed worldly pleasures for Allah and will receive far better versions eternally in Paradise.\",\n      \n      \"The most special river is Al-Kawthar, given to Prophet Muhammad Ô∑∫. Its water is whiter than milk, sweeter than honey, and whoever drinks never thirsts again.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸêŸäŸáŸéÿß ÿ£ŸéŸÜŸíŸáŸéÿßÿ±Ÿå ŸÖŸêŸëŸÜ ŸÖŸéŸëÿßÿ°Ÿç ÿ∫ŸéŸäŸíÿ±Ÿê ÿ¢ÿ≥ŸêŸÜŸç ŸàŸéÿ£ŸéŸÜŸíŸáŸéÿßÿ±Ÿå ŸÖŸêŸëŸÜ ŸÑŸéŸëÿ®ŸéŸÜŸç ŸÑŸéŸëŸÖŸí ŸäŸéÿ™Ÿéÿ∫ŸéŸäŸéŸëÿ±Ÿí ÿ∑ŸéÿπŸíŸÖŸèŸáŸè ŸàŸéÿ£ŸéŸÜŸíŸáŸéÿßÿ±Ÿå ŸÖŸêŸëŸÜŸí ÿÆŸéŸÖŸíÿ±Ÿç ŸÑŸéŸëÿ∞ŸéŸëÿ©Ÿç ŸÑŸêŸëŸÑÿ¥ŸéŸëÿßÿ±Ÿêÿ®ŸêŸäŸÜŸé ŸàŸéÿ£ŸéŸÜŸíŸáŸéÿßÿ±Ÿå ŸÖŸêŸëŸÜŸí ÿπŸéÿ≥ŸéŸÑŸç ŸÖŸèŸëÿµŸéŸÅŸãŸëŸâ\",\n      translation: \"In it are rivers of water never changing, rivers of milk never changing in taste, rivers of wine delightful to the drinkers, and rivers of purified honey. (Qur'an 47:15)\",\n      source: \"Qur'an 47:15\"\n    },\n    keyLesson: \"Paradise's rivers of water, milk, wine, and honey reward believers who sacrificed worldly pleasures for Allah. Al-Kawthar is the Prophet's Ô∑∫ special river, showing his honored position.\"\n  },\n  {\n    id: 9,\n    title: \"The Palaces of Paradise\",\n    quizId: 9,\n    description: [\n      \"Paradise palaces are built from gold and silver bricks with mortar made of musk. Precious stones decorate every surface, creating beauty beyond description and imagination.\",\n      \n      \"Some palaces are so transparent people can see through them completely. The higher the Paradise level, the more magnificent the palaces become, shining like bright stars.\",\n      \n      \"These palaces are earned through specific good deeds. Whoever builds a mosque for Allah will receive a Paradise palace. Good character and righteous acts also earn palaces.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéŸÜŸí ÿ®ŸéŸÜŸéŸâ ŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸãÿß ŸäŸéÿ®Ÿíÿ™Ÿéÿ∫ŸêŸä ÿ®ŸêŸáŸê ŸàŸéÿ¨ŸíŸáŸé ÿßŸÑŸÑŸéŸëŸáŸê ÿ®ŸéŸÜŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéŸáŸè ŸÖŸêÿ´ŸíŸÑŸéŸáŸè ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"Whoever builds a mosque seeking Allah's pleasure, Allah will build for him something similar to it in Paradise. (Sahih Bukhari 450)\",\n      source: \"Sahih Bukhari 450\"\n    },\n    keyLesson: \"Paradise's palaces are made from gold, silver, and precious jewels, each earned through specific good deeds. Building mosques, good character, and righteous actions earn us magnificent homes in Paradise.\"\n  },\n  {\n    id: 10,\n    title: \"Clothing and Fragrance\",\n    quizId: 10,\n    description: [\n      \"Paradise people will wear the finest garments made of silk and brocade, adorned with gold and pearls. Their clothes never tear, wear out, or become dirty.\",\n      \n      \"Everyone in Paradise will have the sweetest fragrance, with their sweat smelling like musk. They'll never experience bad smells, sweat from heat, or any unpleasant odor.\",\n      \n      \"The Qur'an mentions believers wearing green garments of fine silk and brocade while reclining on thrones. Green symbolizes eternal freshness, growth, and life in Paradise forever.\"\n    ],\n    evidence: {\n      arabic: \"ÿπŸéÿßŸÑŸêŸäŸéŸáŸèŸÖŸí ÿ´ŸêŸäŸéÿßÿ®Ÿè ÿ≥ŸèŸÜÿØŸèÿ≥Ÿç ÿÆŸèÿ∂Ÿíÿ±Ÿå ŸàŸéÿ•Ÿêÿ≥Ÿíÿ™Ÿéÿ®Ÿíÿ±ŸéŸÇŸå €ñ ŸàŸéÿ≠ŸèŸÑŸèŸëŸàÿß ÿ£Ÿéÿ≥ŸéÿßŸàŸêÿ±Ÿé ŸÖŸêŸÜ ŸÅŸêÿ∂ŸéŸëÿ©Ÿç\",\n      translation: \"Upon them will be green garments of fine silk and brocade, and they will be adorned with bracelets of silver. (Qur'an 76:21)\",\n      source: \"Qur'an 76:21\"\n    },\n    keyLesson: \"The people of Paradise will wear the finest silk garments adorned with gold and pearls, and they will smell like musk. Everything about them will radiate beauty and pleasant fragrance.\"\n  },\n  {\n    id: 11,\n    title: \"Food and Drink in Paradise\",\n    quizId: 11,\n    description: [\n      \"In Paradise, people will eat and drink whatever they desire instantly without effort. They'll have any bird meat, delicious fruits, and countless never-experienced food varieties.\",\n      \n      \"Unlike worldly food, Paradise's food causes no negative effects. People won't get sick, gain weight, use the bathroom, or feel uncomfortable. Waste becomes pleasant-smelling musk sweat.\",\n      \n      \"The Qur'an describes fruits in continuous supply, never ending and never forbidden. Believers recline on couches while servants offer any imaginable food without worldly limitations.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéÿ≠ŸíŸÖŸê ÿ∑ŸéŸäŸíÿ±Ÿç ŸÖŸêŸëŸÖŸéŸëÿß ŸäŸéÿ¥Ÿíÿ™ŸéŸáŸèŸàŸÜŸé\",\n      translation: \"And the meat of fowl, from whatever they desire. (Qur'an 56:21)\",\n      source: \"Qur'an 56:21\"\n    },\n    keyLesson: \"Paradise offers endless delicious food and drink with no negative effects. Believers can eat whatever they desire instantly, experiencing only pleasure and satisfaction without any harm or discomfort.\"\n  },\n  {\n    id: 12,\n    title: \"Companionship in Paradise\",\n    quizId: 12,\n    description: [\n      \"Paradise offers not just physical pleasures but perfect companionship. Believers enjoy the company of prophets, the truthful, martyrs, and the righteous without any conflicts.\",\n      \n      \"Allah will remove all grudges and ill feelings from hearts. Former enemies who forgave each other become close friends, sitting on thrones facing each other in harmony.\",\n      \n      \"The best companionship is with believing family members. Parents reunite with children, spouses stay together, and friends meet again. Believers thank Allah eternally for guiding loved ones.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÜŸéÿ≤ŸéÿπŸíŸÜŸéÿß ŸÖŸéÿß ŸÅŸêŸä ÿµŸèÿØŸèŸàÿ±ŸêŸáŸêŸÖ ŸÖŸêŸëŸÜŸí ÿ∫ŸêŸÑŸçŸë ÿ•ŸêÿÆŸíŸàŸéÿßŸÜŸãÿß ÿπŸéŸÑŸéŸâŸ∞ ÿ≥Ÿèÿ±Ÿèÿ±Ÿç ŸÖŸèŸëÿ™ŸéŸÇŸéÿßÿ®ŸêŸÑŸêŸäŸÜŸé\",\n      translation: \"And We will remove whatever is in their hearts of resentment, [making them] brothers, on thrones facing each other. (Qur'an 15:47)\",\n      source: \"Qur'an 15:47\"\n    },\n    keyLesson: \"Paradise offers perfect companionship without conflict, jealousy, or hatred. Believers will enjoy the company of prophets, righteous people, and reunions with faithful family members in pure love and harmony.\"\n  },\n  {\n    id: 13,\n    title: \"Families in Paradise\",\n    quizId: 13,\n    description: [\n      \"Believing families will be reunited in Paradise, even if their righteousness levels differed. Allah will elevate family members to the highest level achieved by any member.\",\n      \n      \"The Qur'an promises that those who believed and whose offspring followed them in faith will be joined by their descendants. This reunion eliminates separation's worldly pain.\",\n      \n      \"However, only those who died with faith can reunite. Disbelieving family members cannot enter Paradise. This reality should motivate us to guide our families toward faith.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ŸàŸéÿßÿ™ŸéŸëÿ®ŸéÿπŸéÿ™ŸíŸáŸèŸÖŸí ÿ∞Ÿèÿ±ŸêŸëŸäŸéŸëÿ™ŸèŸáŸèŸÖ ÿ®Ÿêÿ•ŸêŸäŸÖŸéÿßŸÜŸç ÿ£ŸéŸÑŸíÿ≠ŸéŸÇŸíŸÜŸéÿß ÿ®ŸêŸáŸêŸÖŸí ÿ∞Ÿèÿ±ŸêŸëŸäŸéŸëÿ™ŸéŸáŸèŸÖŸí\",\n      translation: \"And those who believed and whose descendants followed them in faith - We will join with them their descendants. (Qur'an 52:21)\",\n      source: \"Qur'an 52:21\"\n    },\n    keyLesson: \"Believing families will be reunited in Paradise at the highest level achieved by any member. This motivates us to guide our families to faith so we can all be together eternally.\"\n  },\n  {\n    id: 14,\n    title: \"Hoor al-'Ayn\",\n    quizId: 14,\n    description: [\n      \"Allah will grant believing men and women spouses in Paradise of perfect beauty, character, and purity called Hoor al-'Ayn. These are special Paradise creations possessing indescribable beauty.\",\n      \n      \"The Hoor al-'Ayn are described as pure, modest, and loving only their spouses. For believing women, they'll receive the best of spouses who love and honor them perfectly.\",\n      \n      \"These spouses represent the perfection of love and intimacy without worldly problems. There'll be no arguments, jealousy, aging, illness, or any imperfection causing unhappiness or dissatisfaction.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸêŸäŸáŸêŸÜŸéŸë ŸÇŸéÿßÿµŸêÿ±Ÿéÿßÿ™Ÿè ÿßŸÑÿ∑ŸéŸëÿ±ŸíŸÅŸê ŸÑŸéŸÖŸí ŸäŸéÿ∑ŸíŸÖŸêÿ´ŸíŸáŸèŸÜŸéŸë ÿ•ŸêŸÜÿ≥Ÿå ŸÇŸéÿ®ŸíŸÑŸéŸáŸèŸÖŸí ŸàŸéŸÑŸéÿß ÿ¨ŸéÿßŸÜŸåŸë\",\n      translation: \"In them are women limiting [their] glances, untouched before them by man or jinn. (Qur'an 55:56)\",\n      source: \"Qur'an 55:56\"\n    },\n    keyLesson: \"Allah will grant believers spouses of perfect beauty and character in Paradise. These relationships will bring only joy and love without any worldly problems or imperfections.\"\n  },\n  {\n    id: 15,\n    title: \"The Markets of Paradise\",\n    quizId: 15,\n    description: [\n      \"Paradise has special gatherings called markets where people meet not to buy or sell, but to socialize and receive gifts. The Prophet Ô∑∫ described a Friday market.\",\n      \n      \"In these markets, people will meet friends, talk, and enjoy each other's company. Allah will provide gifts and increase their beauty each time they attend these gatherings.\",\n      \n      \"These markets represent perfect social gatherings without worldly markets' problems. There's no competition, jealousy, exhaustion, or disappointment. Everyone receives exactly what makes them happy and satisfied.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ŸÑŸéÿ≥ŸèŸàŸÇŸãÿß ŸäŸéÿ£Ÿíÿ™ŸèŸàŸÜŸéŸáŸéÿß ŸÉŸèŸÑŸéŸë ÿ¨ŸèŸÖŸèÿπŸéÿ©Ÿç\",\n      translation: \"Indeed, in Paradise there is a market which they will come to every Friday. (Sahih Muslim 2833)\",\n      source: \"Sahih Muslim 2833\"\n    },\n    keyLesson: \"Paradise has special markets where people gather for socializing and receiving gifts from Allah. These gatherings bring joy and increase beauty without any worldly problems like competition or exhaustion.\"\n  },\n  {\n    id: 16,\n    title: \"Eternal Youth and Beauty\",\n    quizId: 16,\n    description: [\n      \"Everyone in Paradise will be restored to the age of thirty-three years, the prime of youth and strength. They'll remain at this perfect age forever eternally.\",\n      \n      \"All imperfections from worldly life will be removed. People who were sick, disabled, blind, or scarred will be perfectly healthy and whole at their absolute best appearance.\",\n      \n      \"Paradise people will also be very tall and beautiful, matching their father Adam's height and beauty. Their skin will glow with health, radiance, and perfection adding endless joys.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿØŸíÿÆŸèŸÑŸè ÿ£ŸéŸáŸíŸÑŸè ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé ÿ¨Ÿèÿ±ŸíÿØŸãÿß ŸÖŸèÿ±ŸíÿØŸãÿß ŸÖŸèŸÉŸéÿ≠ŸéŸëŸÑŸêŸäŸÜŸé ÿ£Ÿéÿ®ŸíŸÜŸéÿßÿ°Ÿé ÿ´ŸéŸÑŸéÿßÿ´ŸêŸäŸÜŸé ÿ£ŸéŸàŸí ÿ´ŸéŸÑŸéÿßÿ´Ÿç ŸàŸéÿ´ŸéŸÑŸéÿßÿ´ŸêŸäŸÜŸé ÿ≥ŸéŸÜŸéÿ©Ÿã\",\n      translation: \"The people of Paradise will enter Paradise hairless (smooth), beardless, with their eyes anointed with kohl, aged thirty or thirty-three years. (Jami' at-Tirmidhi 2545)\",\n      source: \"Jami' at-Tirmidhi 2545\"\n    },\n    keyLesson: \"Everyone in Paradise will be restored to the perfect age of thirty-three years with ideal beauty and health. All imperfections will be removed, and this perfect state lasts forever.\"\n  },\n  {\n    id: 17,\n    title: \"Seeing Allah's Face\",\n    quizId: 17,\n    description: [\n      \"The greatest Paradise blessing, surpassing all other joys, will be seeing Allah's Noble Face. This vision will happen regularly like gazing at the full moon clearly.\",\n      \n      \"When believers see their Lord, all other Paradise joys will seem small by comparison. This vision fills them with indescribable happiness, peace, and complete overwhelming satisfaction.\",\n      \n      \"The Prophet Ô∑∫ said believers will see Allah without any difficulty or crowding. This ultimate blessing is reserved for those who maintained Tawheed and sincerely worshiped Allah alone.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸèÿ¨ŸèŸàŸáŸå ŸäŸéŸàŸíŸÖŸéÿ¶Ÿêÿ∞Ÿç ŸÜŸéŸëÿßÿ∂Ÿêÿ±Ÿéÿ©Ÿå €ù ÿ•ŸêŸÑŸéŸâŸ∞ ÿ±Ÿéÿ®ŸêŸëŸáŸéÿß ŸÜŸéÿßÿ∏Ÿêÿ±Ÿéÿ©Ÿå\",\n      translation: \"Faces that Day will be radiant, looking at their Lord. (Qur'an 75:22-23)\",\n      source: \"Qur'an 75:22-23\"\n    },\n    keyLesson: \"The greatest Paradise blessing is seeing Allah's Noble Face. This surpasses all other joys and brings indescribable happiness and satisfaction to believers who worshiped Allah alone.\"\n  },\n  {\n    id: 18,\n    title: \"The Speech of Allah\",\n    quizId: 18,\n    description: [\n      \"Allah will speak directly to the Paradise people without any intermediary. He'll greet them with peace, saying 'SalƒÅmun'‚Äîbringing them immense honor, joy, and satisfaction.\",\n      \n      \"This direct communication with Allah is one of Paradise's greatest honors. Believers will hear their Lord's voice speaking words of pleasure, approval, and eternal welcome to them.\",\n      \n      \"The Qur'an says Allah will tell Paradise people, 'Peace be upon you for what you patiently endured. Excellent is the final home.' This divine greeting brings complete satisfaction.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≥ŸéŸÑŸéÿßŸÖŸå ŸÇŸéŸàŸíŸÑŸãÿß ŸÖŸêŸëŸÜ ÿ±ŸéŸëÿ®ŸçŸë ÿ±ŸéŸëÿ≠ŸêŸäŸÖŸç\",\n      translation: \"Peace, a word from a Merciful Lord. (Qur'an 36:58)\",\n      source: \"Qur'an 36:58\"\n    },\n    keyLesson: \"Allah will speak directly to Paradise people, greeting them with peace. This divine communication is one of the greatest honors, bringing immense joy and satisfaction to believers.\"\n  },\n  {\n    id: 19,\n    title: \"No Death or Sorrow\",\n    quizId: 19,\n    description: [\n      \"In Paradise, there is no death, illness, pain, sadness, or worry. People will live eternally in perfect health, happiness, and peace without any form of suffering.\",\n      \n      \"An announcer will proclaim to Paradise people that they will live forever and never die, be healthy forever and never become sick, be eternally young and strong.\",\n      \n      \"They'll never experience the fear of losing blessings or loved ones. Everything good lasts forever. This eternal security brings complete peace of mind and heart to believers.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéÿß ŸäŸéŸÖŸéÿ≥ŸèŸëŸáŸèŸÖŸí ŸÅŸêŸäŸáŸéÿß ŸÜŸéÿµŸéÿ®Ÿå ŸàŸéŸÖŸéÿß ŸáŸèŸÖ ŸÖŸêŸëŸÜŸíŸáŸéÿß ÿ®ŸêŸÖŸèÿÆŸíÿ±Ÿéÿ¨ŸêŸäŸÜŸé\",\n      translation: \"No fatigue will touch them therein, nor from it will they ever be evicted. (Qur'an 15:48)\",\n      source: \"Qur'an 15:48\"\n    },\n    keyLesson: \"Paradise has no death, illness, pain, or sorrow. Believers will live forever in perfect health and happiness, never fearing loss or suffering. This eternal security brings complete peace.\"\n  },\n  {\n    id: 20,\n    title: \"Reflection and Preparation\",\n    quizId: 20,\n    description: [\n      \"Learning about Paradise should motivate us to work harder toward pleasing Allah through sincere worship, good character, and helping others in need every day of our lives.\",\n      \n      \"We should regularly remember Paradise and ask Allah to grant us Firdaws. Making dua for Paradise keeps our hearts attached to this ultimate eternal goal and reward.\",\n      \n      \"The path to Paradise requires sincere faith, righteous actions, avoiding sins, repenting when we make mistakes, and being patient with life's tests. May Allah grant us all Paradise.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ŸàŸéÿπŸéŸÖŸêŸÑŸèŸàÿß ÿßŸÑÿµŸéŸëÿßŸÑŸêÿ≠Ÿéÿßÿ™Ÿê ÿ£ŸèŸàŸÑŸéŸ∞ÿ¶ŸêŸÉŸé ÿ£ŸéÿµŸíÿ≠Ÿéÿßÿ®Ÿè ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê €ñ ŸáŸèŸÖŸí ŸÅŸêŸäŸáŸéÿß ÿÆŸéÿßŸÑŸêÿØŸèŸàŸÜŸé\",\n      translation: \"And those who believe and do righteous deeds - those are the companions of Paradise; they will abide therein eternally. (Qur'an 2:82)\",\n      source: \"Qur'an 2:82\"\n    },\n    keyLesson: \"Learning about Paradise motivates us to work toward pleasing Allah through sincere faith, righteous actions, and avoiding sins. We should regularly ask Allah to grant us Firdaws.\"\n  }\n];\n","path":null,"size_bytes":24794,"size_tokens":null},"src/data/lessons/fourWomenLessons.js":{"content":"// Four Greatest Women in Islam Learning Path\n// 12 lessons about Maryam, Asiyah, Khadijah, and Fatimah\n// Each lesson: 3 paragraphs (18-28 words each), authentic Quranic/hadith evidence, key lesson\n// Sources: Qur'an, Sahih Bukhari, and Sahih Muslim\n\nconst greatestWomenLessons = [\n  {\n    id: 1,\n    title: \"Maryam - Part 1\",\n    description: [\n      \"Maryam's mother dedicated her unborn child to Allah's service. When Maryam was born, her mother accepted Allah's plan with gratitude and named her Maryam, meaning devoted servant.\",\n      \"Maryam grew up in the temple under Prophet Zakariyyah's care. She devoted herself to worship and prayer. Allah provided her with miraculous sustenance from Heaven that amazed Zakariyyah greatly.\",\n      \"Whenever Zakariyyah visited Maryam's chamber, he found fresh food with her. When he asked where it came from, Maryam replied it was from Allah who provides without limit.\"\n    ],\n    evidence: {\n      arabic: \"ŸÉŸèŸÑŸéŸëŸÖŸéÿß ÿØŸéÿÆŸéŸÑŸé ÿπŸéŸÑŸéŸäŸíŸáŸéÿß ÿ≤ŸéŸÉŸéÿ±ŸêŸäŸéŸëÿß ÿßŸÑŸíŸÖŸêÿ≠Ÿíÿ±Ÿéÿßÿ®Ÿé ŸàŸéÿ¨ŸéÿØŸé ÿπŸêŸÜÿØŸéŸáŸéÿß ÿ±Ÿêÿ≤ŸíŸÇŸãÿß €ñ ŸÇŸéÿßŸÑŸé ŸäŸéÿß ŸÖŸéÿ±ŸíŸäŸéŸÖŸè ÿ£ŸéŸÜŸéŸëŸâŸ∞ ŸÑŸéŸÉŸê ŸáŸéŸ∞ÿ∞Ÿéÿß €ñ ŸÇŸéÿßŸÑŸéÿ™Ÿí ŸáŸèŸàŸé ŸÖŸêŸÜŸí ÿπŸêŸÜÿØŸê ÿßŸÑŸÑŸéŸëŸáŸê €ñ ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸäŸéÿ±Ÿíÿ≤ŸèŸÇŸè ŸÖŸéŸÜ ŸäŸéÿ¥Ÿéÿßÿ°Ÿè ÿ®Ÿêÿ∫ŸéŸäŸíÿ±Ÿê ÿ≠Ÿêÿ≥Ÿéÿßÿ®Ÿç\",\n      translation: \"Whenever Zakariyyah entered upon her in the prayer chamber, he found with her provision. He said, 'O Maryam, from where is this?' She said, 'It is from Allah. Indeed, Allah provides for whom He wills without account.'\",\n      source: \"Qur'an 3:37\"\n    },\n    keyLesson: \"Pure devotion to Allah from childhood brings His miraculous blessings and provisions beyond human understanding.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"Maryam - Part 2\",\n    description: [\n      \"Angel Jibra'il appeared to Maryam in human form while she was alone. Frightened, she sought Allah's protection. The angel announced Allah had chosen her to bear a miraculous blessed child.\",\n      \"Maryam asked how she could have a child when no man had touched her. The angel explained Allah creates what He wills by simply saying 'Be' and it is.\",\n      \"When the birth pains came, Maryam felt alone and distressed. Allah miraculously made a stream flow beneath her and dates fall from the palm tree above for nourishment and comfort.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸÜŸéÿßÿØŸéÿßŸáŸéÿß ŸÖŸêŸÜ ÿ™Ÿéÿ≠Ÿíÿ™ŸêŸáŸéÿß ÿ£ŸéŸÑŸéŸëÿß ÿ™Ÿéÿ≠Ÿíÿ≤ŸéŸÜŸêŸä ŸÇŸéÿØŸí ÿ¨ŸéÿπŸéŸÑŸé ÿ±Ÿéÿ®ŸèŸëŸÉŸê ÿ™Ÿéÿ≠Ÿíÿ™ŸéŸÉŸê ÿ≥Ÿéÿ±ŸêŸäŸãŸëÿß ŸàŸéŸáŸèÿ≤ŸêŸëŸä ÿ•ŸêŸÑŸéŸäŸíŸÉŸê ÿ®Ÿêÿ¨Ÿêÿ∞ŸíÿπŸê ÿßŸÑŸÜŸéŸëÿÆŸíŸÑŸéÿ©Ÿê ÿ™Ÿèÿ≥ŸéÿßŸÇŸêÿ∑Ÿí ÿπŸéŸÑŸéŸäŸíŸÉŸê ÿ±Ÿèÿ∑Ÿéÿ®Ÿãÿß ÿ¨ŸéŸÜŸêŸäŸãŸëÿß\",\n      translation: \"But he called her from below her, 'Do not grieve; your Lord has provided beneath you a stream. And shake toward you the trunk of the palm tree; it will drop upon you ripe, fresh dates.'\",\n      source: \"Qur'an 19:24-25\"\n    },\n    keyLesson: \"Allah provides comfort and sustenance during our most difficult trials when we trust in His wisdom and plan.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Maryam - Part 3\",\n    description: [\n      \"When Maryam brought baby Isa to her people, they accused her of wrongdoing. Instead of defending herself, she pointed to the infant in her arms with complete trust.\",\n      \"Baby Isa spoke miraculously from the cradle, declaring he was Allah's servant. He announced Allah gave him scripture and prophethood, commanding him to pray and give charity throughout life.\",\n      \"Allah honored Maryam above all women of creation. The Prophet Muhammad Ô∑∫ named her among the four greatest women ever. Her patience and purity remain eternal examples for believers.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ÿßÿµŸíÿ∑ŸéŸÅŸéÿßŸÉŸê ŸàŸéÿ∑ŸéŸáŸéŸëÿ±ŸéŸÉŸê ŸàŸéÿßÿµŸíÿ∑ŸéŸÅŸéÿßŸÉŸê ÿπŸéŸÑŸéŸâŸ∞ ŸÜŸêÿ≥Ÿéÿßÿ°Ÿê ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"Indeed, Allah has chosen you and purified you and chosen you above the women of the worlds.\",\n      source: \"Qur'an 3:42\"\n    },\n    keyLesson: \"Patience during false accusations and complete trust in Allah's defense brings honor in this life and the next.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"Asiyah - Part 1\",\n    description: [\n      \"Asiyah was married to Pharaoh, history's most arrogant tyrant who claimed divinity. Despite living in a palace of disbelief and oppression, she secretly believed in the One True Allah.\",\n      \"She witnessed Pharaoh's cruelty daily but maintained her faith hidden in her heart. Asiyah saw through his false claims of godhood and recognized only Allah deserves worship and submission.\",\n      \"Living surrounded by luxury and power, Asiyah chose truth over comfort. Her faith remained firm while everyone around her worshipped Pharaoh. She awaited Allah's help patiently and quietly.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ∂Ÿéÿ±Ÿéÿ®Ÿé ÿßŸÑŸÑŸéŸëŸáŸè ŸÖŸéÿ´ŸéŸÑŸãÿß ŸÑŸêŸëŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿßŸÖŸíÿ±Ÿéÿ£Ÿéÿ™Ÿé ŸÅŸêÿ±ŸíÿπŸéŸàŸíŸÜŸé\",\n      translation: \"And Allah presents an example of those who believed: the wife of Pharaoh.\",\n      source: \"Qur'an 66:11\"\n    },\n    keyLesson: \"True faith can flourish even in the most hostile environments when the heart remains devoted to Allah alone.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Asiyah - Part 2\",\n    description: [\n      \"When baby Musa was found in the river, Asiyah's heart filled with love for him. She convinced Pharaoh to spare the baby and let her raise him in the palace.\",\n      \"Asiyah cared for Musa with tenderness and love, not knowing he would become the prophet who would challenge her husband's tyranny. Allah placed mercy in her heart for His chosen messenger.\",\n      \"Through her compassion, Allah's plan unfolded perfectly. Musa grew in Pharaoh's own palace, protected and nurtured. Asiyah's kindness helped preserve the life of Allah's future prophet and liberator.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÇŸéÿßŸÑŸéÿ™Ÿê ÿßŸÖŸíÿ±Ÿéÿ£Ÿéÿ™Ÿè ŸÅŸêÿ±ŸíÿπŸéŸàŸíŸÜŸé ŸÇŸèÿ±ŸéŸëÿ™Ÿè ÿπŸéŸäŸíŸÜŸç ŸÑŸêŸëŸä ŸàŸéŸÑŸéŸÉŸé €ñ ŸÑŸéÿß ÿ™ŸéŸÇŸíÿ™ŸèŸÑŸèŸàŸáŸè ÿπŸéÿ≥ŸéŸâŸ∞ ÿ£ŸéŸÜ ŸäŸéŸÜŸÅŸéÿπŸéŸÜŸéÿß ÿ£ŸéŸàŸí ŸÜŸéÿ™ŸéŸëÿÆŸêÿ∞ŸéŸáŸè ŸàŸéŸÑŸéÿØŸãÿß\",\n      translation: \"And the wife of Pharaoh said, 'He will be a comfort to me and you. Do not kill him; perhaps he may benefit us, or we may adopt him as a son.'\",\n      source: \"Qur'an 28:9\"\n    },\n    keyLesson: \"Allah uses compassionate hearts as instruments of His divine plan, even in the homes of His greatest enemies.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Asiyah - Part 3\",\n    description: [\n      \"When Pharaoh discovered Asiyah's faith in Musa's God, his rage knew no bounds. He ordered her tortured brutally to force her to renounce belief and return to worshipping him.\",\n      \"As they tortured her under the scorching sun, Asiyah raised her eyes to Heaven and made a beautiful supplication. She asked Allah for a house in Paradise near Him.\",\n      \"Allah took her soul before the boulder crushed her body, showing her the house He prepared in Paradise. The Prophet Muhammad Ô∑∫ named her among the four best women ever created.\"\n    ],\n    evidence: {\n      arabic: \"ÿ±Ÿéÿ®ŸêŸë ÿßÿ®ŸíŸÜŸê ŸÑŸêŸä ÿπŸêŸÜÿØŸéŸÉŸé ÿ®ŸéŸäŸíÿ™Ÿãÿß ŸÅŸêŸä ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê ŸàŸéŸÜŸéÿ¨ŸêŸëŸÜŸêŸä ŸÖŸêŸÜ ŸÅŸêÿ±ŸíÿπŸéŸàŸíŸÜŸé ŸàŸéÿπŸéŸÖŸéŸÑŸêŸáŸê ŸàŸéŸÜŸéÿ¨ŸêŸëŸÜŸêŸä ŸÖŸêŸÜŸé ÿßŸÑŸíŸÇŸéŸàŸíŸÖŸê ÿßŸÑÿ∏ŸéŸëÿßŸÑŸêŸÖŸêŸäŸÜŸé\",\n      translation: \"My Lord, build for me near You a house in Paradise and save me from Pharaoh and his deeds and save me from the wrongdoing people.\",\n      source: \"Qur'an 66:11\"\n    },\n    keyLesson: \"True success means choosing eternal Paradise over temporary worldly comfort, even if it costs our very lives.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Khadijah - Part 1\",\n    description: [\n      \"Khadijah was a noble, wealthy businesswoman known throughout Makkah for wisdom and honor. People called her 'The Pure One' because of her impeccable character and dignified reputation.\",\n      \"She hired Muhammad Ô∑∫ to lead her trade caravan because of his legendary trustworthiness and honesty. His excellent character and integrity during the journey deeply impressed her servant Maysarah.\",\n      \"Khadijah proposed marriage to Muhammad Ô∑∫ through her uncle. Though she was older and previously married, he accepted gladly. Their marriage became blessed with deep love and mutual respect.\"\n    ],\n    evidence: {\n      arabic: \"ÿÆŸéŸäŸíÿ±Ÿè ŸÜŸêÿ≥Ÿéÿßÿ¶ŸêŸáŸéÿß ŸÖŸéÿ±ŸíŸäŸéŸÖŸèÿå ŸàŸéÿÆŸéŸäŸíÿ±Ÿè ŸÜŸêÿ≥Ÿéÿßÿ¶ŸêŸáŸéÿß ÿÆŸéÿØŸêŸäÿ¨Ÿéÿ©Ÿè\",\n      translation: \"The best of women is Maryam, and the best of women is Khadijah.\",\n      source: \"Sahih Bukhari 3815\"\n    },\n    keyLesson: \"Noble character and wisdom in choosing a righteous spouse bring blessings that last beyond this world into eternity.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Khadijah - Part 2\",\n    description: [\n      \"When revelation first came to Muhammad Ô∑∫ in the cave, he returned home trembling and fearful. Khadijah immediately comforted him, declaring Allah would never disgrace someone so noble.\",\n      \"Khadijah became the very first person to accept Islam, believing instantly without doubt or hesitation. She supported him completely during the difficult early years when Muslims faced brutal persecution.\",\n      \"She spent her entire wealth supporting Islam and feeding poor Muslims during the boycott years. Khadijah never wavered in her faith or support, standing as Islam's first and strongest pillar.\"\n    ],\n    evidence: {\n      arabic: \"ŸÉŸéŸÑŸéŸëÿß ŸàŸéÿßŸÑŸÑŸéŸëŸáŸê ŸÖŸéÿß ŸäŸèÿÆŸíÿ≤ŸêŸäŸÉŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ£Ÿéÿ®ŸéÿØŸãÿß ÿ•ŸêŸÜŸéŸëŸÉŸé ŸÑŸéÿ™ŸéÿµŸêŸÑŸè ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸÖŸé ŸàŸéÿ™Ÿéÿ≠ŸíŸÖŸêŸÑŸè ÿßŸÑŸíŸÉŸéŸÑŸéŸë ŸàŸéÿ™ŸéŸÉŸíÿ≥Ÿêÿ®Ÿè ÿßŸÑŸíŸÖŸéÿπŸíÿØŸèŸàŸÖŸé ŸàŸéÿ™ŸéŸÇŸíÿ±ŸêŸä ÿßŸÑÿ∂ŸéŸëŸäŸíŸÅŸé ŸàŸéÿ™ŸèÿπŸêŸäŸÜŸè ÿπŸéŸÑŸéŸâ ŸÜŸéŸàŸéÿßÿ¶Ÿêÿ®Ÿê ÿßŸÑŸíÿ≠ŸéŸÇŸêŸë\",\n      translation: \"No! By Allah, Allah will never disgrace you. You maintain family ties, support the weak, give to the poor, honor guests, and help those afflicted by calamity.\",\n      source: \"Sahih Bukhari 3\"\n    },\n    keyLesson: \"Immediate belief and unwavering support during the hardest trials make one beloved to Allah and His messenger forever.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Khadijah - Part 3\",\n    description: [\n      \"During the Year of Sorrow, both Khadijah and Abu Talib died within months. The Prophet Ô∑∫ lost his beloved wife and protective uncle, grieving deeply for his greatest supporter.\",\n      \"Even after her death, the Prophet Ô∑∫ honored Khadijah constantly. He sent meat to her friends and spoke of her virtues. When Aishah felt jealous, he explained no one could replace Khadijah.\",\n      \"Angel Jibra'il brought special greetings from Allah to Khadijah, giving her glad tidings of a palace in Paradise made entirely of pearls. Her legacy as Islam's first believer remains eternal.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸêŸëŸä ŸÇŸéÿØŸí ÿ±Ÿèÿ≤ŸêŸÇŸíÿ™Ÿè ÿ≠Ÿèÿ®ŸéŸëŸáŸéÿß\",\n      translation: \"I have been granted her love.\",\n      source: \"Sahih Muslim 2435\"\n    },\n    keyLesson: \"True love and loyalty in marriage, especially for Allah's sake, continue beyond death and earn eternal rewards in Paradise.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Fatimah - Part 1\",\n    description: [\n      \"Fatimah was the youngest daughter of the Prophet Muhammad Ô∑∫ and Khadijah. The Prophet Ô∑∫ loved her immensely, standing whenever she entered and kissing her forehead with tenderness.\",\n      \"She witnessed the persecution of her father in Makkah. Young Fatimah once removed harmful filth from his back while he prayed, showing courage beyond her years and deep love.\",\n      \"Fatimah married Ali ibn Abi Talib, the Prophet's Ô∑∫ cousin and close companion. Their marriage was simple and blessed. The Prophet Ô∑∫ said she was the leader of all women in Paradise.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿßÿ∑ŸêŸÖŸéÿ©Ÿè ÿ≥ŸéŸäŸêŸëÿØŸéÿ©Ÿè ŸÜŸêÿ≥Ÿéÿßÿ°Ÿê ÿ£ŸéŸáŸíŸÑŸê ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿê\",\n      translation: \"Fatimah is the leader of the women of Paradise.\",\n      source: \"Sahih Bukhari 3623\"\n    },\n    keyLesson: \"Being beloved to the Prophet Ô∑∫ through righteousness and devotion guarantees leadership among the blessed in Paradise.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"Fatimah - Part 2\",\n    description: [\n      \"Despite being the Prophet's Ô∑∫ daughter, Fatimah lived in poverty. She ground grain by hand until her hands blistered. When she asked for a servant, the Prophet Ô∑∫ taught her dhikr instead.\",\n      \"The Prophet Ô∑∫ told her that glorifying Allah thirty-three times, praising Him thirty-three times, and magnifying Him thirty-four times after each prayer was better than any servant.\",\n      \"Fatimah accepted his guidance completely, choosing spiritual wealth over worldly comfort. She lived simply, working hard with her own hands while maintaining patience and devotion to Allah always.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÑŸéÿß ÿ£ŸéÿØŸèŸÑŸèŸëŸÉŸèŸÖŸéÿß ÿπŸéŸÑŸéŸâ ŸÖŸéÿß ŸáŸèŸàŸé ÿÆŸéŸäŸíÿ±Ÿå ŸÑŸéŸÉŸèŸÖŸéÿß ŸÖŸêŸÜŸí ÿÆŸéÿßÿØŸêŸÖŸçÿü\",\n      translation: \"Shall I not guide you to something better for you than a servant?\",\n      source: \"Sahih Bukhari 5362\"\n    },\n    keyLesson: \"Remembrance of Allah is more valuable than worldly comfort, and patience through hardship brings eternal rewards beyond measure.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Fatimah - Part 3\",\n    description: [\n      \"Fatimah had deep knowledge of the Quran and Sunnah, learning directly from her father. She possessed wisdom beyond her years and understood Islam's teachings with remarkable clarity and depth.\",\n      \"The Prophet Ô∑∫ told Fatimah privately that she would be the first of his family to join him after death. She wept, then smiled when he said she would be the leader of Paradise's women.\",\n      \"Fatimah died six months after her father, fulfilling his prophecy. Her legacy of patience, piety, knowledge, and devotion continues inspiring Muslim women throughout all generations until today.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÖŸéÿß ÿ™Ÿéÿ±Ÿíÿ∂ŸéŸäŸíŸÜŸé ÿ£ŸéŸÜŸí ÿ™ŸéŸÉŸèŸàŸÜŸêŸä ÿ≥ŸéŸäŸêŸëÿØŸéÿ©Ÿé ŸÜŸêÿ≥Ÿéÿßÿ°Ÿê ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ÿ£ŸéŸàŸí ÿ≥ŸéŸäŸêŸëÿØŸéÿ©Ÿé ŸÜŸêÿ≥Ÿéÿßÿ°Ÿê ŸáŸéÿ∞ŸêŸáŸê ÿßŸÑŸíÿ£ŸèŸÖŸéŸëÿ©Ÿê\",\n      translation: \"Are you not pleased that you will be the leader of the believing women or the leader of the women of this nation?\",\n      source: \"Sahih Bukhari 3624\"\n    },\n    keyLesson: \"Living with knowledge, piety, and complete devotion to Allah makes one a timeless role model for all future generations.\",\n    quizId: 12\n  }\n];\n\nexport default greatestWomenLessons;\n","path":null,"size_bytes":14751,"size_tokens":null},"src/data/lessons/prophetLifeLessons.js":{"content":"// Life of Prophet Muhammad Ô∑∫ Learning Path\n// Based on Ar-Raheeq al-Makhtum (The Sealed Nectar)\n// 78 lessons covering the complete Seerah chronologically\n// Each lesson: 3 paragraphs (~23 words each), authentic sources, Key Lesson Learned\n// Sources: Qur'an, Sahih Bukhari, Sahih Muslim\n\nconst prophetLifeLessons = [\n  // ============================================================\n  // SECTION 1: Early Life & Pre-Prophethood (12 lessons)\n  // ============================================================\n\n  {\n    id: 1,\n    title: \"The Year of the Elephant\",\n    description: [\n      \"In the year Muhammad Ô∑∫ was born, Abraha the Abyssinian ruler marched toward Makkah with a mighty army and war elephants. He intended to destroy the sacred Ka'bah to make people worship in his cathedral instead.\",\n      \"When Abraha approached, the elephant refused to move toward the Ka'bah. Allah sent flocks of birds carrying stones of baked clay. These birds pelted Abraha's army with these stones, destroying them completely.\",\n      \"This miraculous event showed Allah's protection of His sacred House. It happened in the same year Prophet Muhammad Ô∑∫ was born, making his birth year memorable. The Arabs called it the Year of the Elephant.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÑŸéŸÖŸí ÿ™Ÿéÿ±Ÿé ŸÉŸéŸäŸíŸÅŸé ŸÅŸéÿπŸéŸÑŸé ÿ±Ÿéÿ®ŸèŸëŸÉŸé ÿ®Ÿêÿ£ŸéÿµŸíÿ≠Ÿéÿßÿ®Ÿê ÿßŸÑŸíŸÅŸêŸäŸÑŸê\",\n      translation: \"Have you not seen how your Lord dealt with the companions of the elephant?\",\n      source: \"Qur'an 105:1\"\n    },\n    keyLesson: \"Allah protects His sacred places and will defend those who are sincere to Him.\",\n    quizId: 1\n  },\n\n  {\n    id: 2,\n    title: \"The Birth of Muhammad Ô∑∫\",\n    description: [\n      \"Muhammad Ô∑∫ was born on Monday, the 12th of Rabi al-Awwal in the Year of the Elephant. His father Abdullah had passed away before his birth. His mother Aminah raised him alone in Makkah with great love.\",\n      \"On the night of his birth, miraculous signs appeared. His mother saw a light emanating from her that illuminated the palaces of Syria. The idols in the Ka'bah fell down, and light filled the earth.\",\n      \"His grandfather Abdul-Muttalib named him Muhammad Ô∑∫, a name rarely used among Arabs. It means 'the praised one.' This name would later prove prophetic as he became the most praised person in human history.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸÇŸéÿØŸí ÿ¨Ÿéÿßÿ°ŸéŸÉŸèŸÖŸí ÿ±Ÿéÿ≥ŸèŸàŸÑŸå ŸÖŸêŸëŸÜŸí ÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸÉŸèŸÖŸí\",\n      translation: \"There has certainly come to you a Messenger from among yourselves.\",\n      source: \"Qur'an 9:128\"\n    },\n    keyLesson: \"The Prophet's Ô∑∫ birth was blessed with miracles, showing his special status even before prophethood.\",\n    quizId: 2\n  },\n\n  {\n    id: 3,\n    title: \"Nursed by Halimah\",\n    description: [\n      \"Arab nobles sent their infants to Bedouin tribes in the desert for better health and pure Arabic language. Foster mothers came to Makkah seeking children. Halimah as-Sa'diyah was among them but hesitated to take an orphan.\",\n      \"When Halimah finally accepted baby Muhammad Ô∑∫, blessings poured into her life. Her weak camel became strong, her dry goats gave abundant milk, and prosperity filled her home. Everything she touched was blessed with abundance.\",\n      \"Muhammad Ô∑∫ lived with Halimah's family for four years in the desert. He grew healthy and strong, learning pure Arabic and developing good character. Halimah loved him dearly and witnessed countless blessings through him.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸàŸéÿ¨ŸéÿØŸéŸÉŸé ÿπŸéÿßÿ¶ŸêŸÑŸãÿß ŸÅŸéÿ£Ÿéÿ∫ŸíŸÜŸéŸâŸ∞\",\n      translation: \"And He found you poor and made you self-sufficient.\",\n      source: \"Qur'an 93:8\"\n    },\n    keyLesson: \"Even as an infant, the Prophet Ô∑∫ brought blessings to those around him, showing Allah's care for him.\",\n    quizId: 3\n  },\n\n  {\n    id: 4,\n    title: \"The Opening of the Chest\",\n    description: [\n      \"When Muhammad Ô∑∫ was four years old and living with Halimah, two angels came to him while he played. They opened his chest, removed his heart, and took out a black clot from it, purifying him completely.\",\n      \"The angels washed his heart with Zamzam water in a golden basin. They weighed him against ten men, then a hundred, then a thousand‚Äîhe outweighed them all. This showed his spiritual weight and importance to come.\",\n      \"Halimah witnessed this miracle with fear and returned Muhammad Ô∑∫ to his mother Aminah in Makkah. This purification prepared him for the heavy responsibility of prophethood that would come forty years later.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÑŸéŸÖŸí ŸÜŸéÿ¥Ÿíÿ±Ÿéÿ≠Ÿí ŸÑŸéŸÉŸé ÿµŸéÿØŸíÿ±ŸéŸÉŸé\",\n      translation: \"Did We not expand for you your breast?\",\n      source: \"Qur'an 94:1\"\n    },\n    keyLesson: \"Allah purified the Prophet's Ô∑∫ heart from evil, preparing him to receive divine revelation and guide humanity.\",\n    quizId: 4\n  },\n\n  {\n    id: 5,\n    title: \"Childhood and Orphanhood\",\n    description: [\n      \"Muhammad Ô∑∫ lived with his mother Aminah until age six. She took him to Madinah to visit his father's grave and relatives. On the return journey, Aminah fell ill and passed away at Abwa, leaving him completely orphaned.\",\n      \"His grandfather Abdul-Muttalib took custody of young Muhammad Ô∑∫. Abdul-Muttalib loved him deeply, giving him special treatment and always keeping him close. He saw greatness in his grandson that others didn't notice yet.\",\n      \"When Muhammad Ô∑∫ turned eight, Abdul-Muttalib also passed away. His uncle Abu Talib then became his guardian, raising him with his own children. Despite poverty, Abu Talib protected and supported Muhammad Ô∑∫ throughout his life.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÑŸéŸÖŸí ŸäŸéÿ¨ŸêÿØŸíŸÉŸé ŸäŸéÿ™ŸêŸäŸÖŸãÿß ŸÅŸéÿ¢ŸàŸéŸâŸ∞\",\n      translation: \"Did He not find you an orphan and give you refuge?\",\n      source: \"Qur'an 93:6\"\n    },\n    keyLesson: \"Despite losing his parents young, Allah protected Muhammad Ô∑∫ and placed him with loving guardians who raised him well.\",\n    quizId: 5\n  },\n\n  {\n    id: 6,\n    title: \"Journey to Syria with Abu Talib\",\n    description: [\n      \"At age twelve, Muhammad Ô∑∫ traveled with his uncle Abu Talib on a trade caravan to Syria. During this journey, they stopped at the dwelling of Bahira, a Christian monk living in isolation.\",\n      \"Bahira recognized signs of prophethood in young Muhammad Ô∑∫ from his scriptures. He saw a cloud shading Muhammad Ô∑∫ and trees bowing as he passed. Bahira warned Abu Talib to protect his nephew from enemies, especially Jews and Romans.\",\n      \"Abu Talib heeded the warning and returned Muhammad Ô∑∫ to Makkah earlier than planned. This journey exposed Muhammad Ô∑∫ to different lands and peoples, broadening his worldview and preparing him for his future mission.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸäŸéÿ™ŸéŸëÿ®ŸêÿπŸèŸàŸÜŸé ÿßŸÑÿ±ŸéŸëÿ≥ŸèŸàŸÑŸé ÿßŸÑŸÜŸéŸëÿ®ŸêŸäŸéŸë ÿßŸÑŸíÿ£ŸèŸÖŸêŸëŸäŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿ¨ŸêÿØŸèŸàŸÜŸéŸáŸè ŸÖŸéŸÉŸíÿ™ŸèŸàÿ®Ÿãÿß ÿπŸêŸÜÿØŸéŸáŸèŸÖŸí ŸÅŸêŸä ÿßŸÑÿ™ŸéŸëŸàŸíÿ±Ÿéÿßÿ©Ÿê ŸàŸéÿßŸÑŸíÿ•ŸêŸÜÿ¨ŸêŸäŸÑŸê\",\n      translation: \"Those who follow the Messenger, the unlettered prophet, whom they find written in the Torah and the Gospel.\",\n      source: \"Qur'an 7:157\"\n    },\n    keyLesson: \"Even before prophethood, people of knowledge recognized special signs in Muhammad Ô∑∫ that indicated his future mission.\",\n    quizId: 6\n  },\n\n  {\n    id: 7,\n    title: \"Youth and Reputation\",\n    description: [\n      \"As Muhammad Ô∑∫ grew into a young man, he worked as a shepherd for Makkah's families. This humble work taught him patience, responsibility, and care for those under his authority‚Äîqualities essential for future leadership.\",\n      \"He became known throughout Makkah as Al-Amin, meaning 'The Trustworthy,' and As-Sadiq, meaning 'The Truthful.' Even his enemies never caught him in a lie or witnessed him breaking a trust before or after prophethood.\",\n      \"Unlike other Makkan youth, Muhammad Ô∑∫ never participated in immoral activities, idol worship, or foolish games. He remained pure in character, modest in behavior, and dignified in conduct, standing apart from corruption around him.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜŸéŸëŸÉŸé ŸÑŸéÿπŸéŸÑŸéŸâŸ∞ ÿÆŸèŸÑŸèŸÇŸç ÿπŸéÿ∏ŸêŸäŸÖŸç\",\n      translation: \"And indeed, you are of a great moral character.\",\n      source: \"Qur'an 68:4\"\n    },\n    keyLesson: \"The Prophet Ô∑∫ earned trust and respect through honest dealings and noble character long before receiving revelation.\",\n    quizId: 7\n  },\n\n  {\n    id: 8,\n    title: \"Marriage to Khadijah\",\n    description: [\n      \"Khadijah bint Khuwaylid was a wealthy, noble, and honorable businesswoman. Impressed by Muhammad Ô∑∫'s Ô∑∫ honesty and trustworthiness, she hired him to manage her trade caravan to Syria when he was twenty-five years old.\",\n      \"Her servant Maysarah accompanied Muhammad Ô∑∫ and witnessed his exceptional character and integrity. The business trip was extremely successful. Maysarah told Khadijah about miracles he saw, including clouds shading Muhammad Ô∑∫ from desert heat.\",\n      \"Khadijah, forty years old, proposed marriage to Muhammad Ô∑∫ through a relative. He accepted, and they married. She supported him completely, bearing his children and becoming his greatest supporter. Their marriage lasted twenty-five blessed years.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ÿßÿµŸíÿ∑ŸéŸÅŸéŸâŸ∞ ÿ¢ÿØŸéŸÖŸé ŸàŸéŸÜŸèŸàÿ≠Ÿãÿß ŸàŸéÿ¢ŸÑŸé ÿ•Ÿêÿ®Ÿíÿ±ŸéÿßŸáŸêŸäŸÖŸé ŸàŸéÿ¢ŸÑŸé ÿπŸêŸÖŸíÿ±ŸéÿßŸÜŸé ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"Indeed, Allah chose Adam and Noah and the family of Abraham and the family of Imran over the worlds.\",\n      source: \"Qur'an 3:33\"\n    },\n    keyLesson: \"Khadijah's marriage to the Prophet Ô∑∫ was built on trust and mutual respect, becoming the foundation of support for Islam.\",\n    quizId: 8\n  },\n\n  {\n    id: 9,\n    title: \"Rebuilding the Ka'bah\",\n    description: [\n      \"When Muhammad Ô∑∫ was thirty-five, Makkah's tribes decided to rebuild the damaged Ka'bah. They worked together until time came to place the sacred Black Stone in its corner. Each tribe wanted this honor, leading to serious dispute.\",\n      \"The tribes nearly fought over this privilege. They agreed to let the next person entering the sanctuary decide. Muhammad Ô∑∫ entered, and everyone accepted him as the judge, calling him 'Al-Amin, the Trustworthy One.'\",\n      \"Muhammad Ô∑∫ wisely placed the Black Stone on a cloth and asked each tribal leader to hold an edge. Together they lifted it, and he placed it in position. His brilliant solution prevented bloodshed and satisfied everyone's honor.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ∞Ÿí ŸäŸéÿ±ŸíŸÅŸéÿπŸè ÿ•Ÿêÿ®Ÿíÿ±ŸéÿßŸáŸêŸäŸÖŸè ÿßŸÑŸíŸÇŸéŸàŸéÿßÿπŸêÿØŸé ŸÖŸêŸÜŸé ÿßŸÑŸíÿ®ŸéŸäŸíÿ™Ÿê ŸàŸéÿ•Ÿêÿ≥ŸíŸÖŸéÿßÿπŸêŸäŸÑŸè\",\n      translation: \"And when Abraham was raising the foundations of the House and Ishmael.\",\n      source: \"Qur'an 2:127\"\n    },\n    keyLesson: \"The Prophet's Ô∑∫ wisdom and fairness prevented conflict, showing his leadership abilities even before prophethood.\",\n    quizId: 9\n  },\n\n  {\n    id: 10,\n    title: \"Solitude in Cave Hira\",\n    description: [\n      \"As Muhammad Ô∑∫ approached forty, he felt increasingly drawn to solitude and contemplation. He would retreat to Cave Hira on Mount Nur, spending days in deep reflection about life's purpose and humanity's condition.\",\n      \"Khadijah supported his spiritual retreats, sending food and supplies. He spent the month of Ramadan in the cave, worshipping Allah according to the way of Prophet Ibrahim, rejecting the idolatry surrounding him in Makkah.\",\n      \"During these retreats, Muhammad Ô∑∫ reflected on creation, the universe, and human existence. He felt certainty that the idols around the Ka'bah were false, and that only One God deserved worship and complete submission.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸäŸéÿ∞ŸíŸÉŸèÿ±ŸèŸàŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸé ŸÇŸêŸäŸéÿßŸÖŸãÿß ŸàŸéŸÇŸèÿπŸèŸàÿØŸãÿß ŸàŸéÿπŸéŸÑŸéŸâŸ∞ ÿ¨ŸèŸÜŸèŸàÿ®ŸêŸáŸêŸÖŸí ŸàŸéŸäŸéÿ™ŸéŸÅŸéŸÉŸéŸëÿ±ŸèŸàŸÜŸé ŸÅŸêŸä ÿÆŸéŸÑŸíŸÇŸê ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê\",\n      translation: \"Who remember Allah while standing, sitting, and lying on their sides and give thought to the creation of the heavens and the earth.\",\n      source: \"Qur'an 3:191\"\n    },\n    keyLesson: \"Solitude and reflection prepared the Prophet's Ô∑∫ heart and mind to receive the tremendous responsibility of divine revelation.\",\n    quizId: 10\n  },\n\n  {\n    id: 11,\n    title: \"The First Revelation\",\n    description: [\n      \"On a Monday night in Ramadan, when Muhammad Ô∑∫ was forty years old, Angel Jibra'il appeared in Cave Hira in his true form. The angel commanded, 'Read!' Muhammad Ô∑∫ replied, 'I cannot read.'\",\n      \"Jibra'il embraced him tightly three times, each time commanding 'Read!' Finally he recited the first verses of Qur'an: 'Read in the name of your Lord who created...' These were the first words of divine revelation to Muhammad Ô∑∫.\",\n      \"Trembling from this overwhelming experience, Muhammad Ô∑∫ rushed home to Khadijah saying, 'Cover me! Cover me!' She comforted him, then took him to her cousin Waraqah, a Christian scholar who confirmed Muhammad Ô∑∫ was Allah's chosen prophet.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÇŸíÿ±Ÿéÿ£Ÿí ÿ®Ÿêÿßÿ≥ŸíŸÖŸê ÿ±Ÿéÿ®ŸêŸëŸÉŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿÆŸéŸÑŸéŸÇŸé\",\n      translation: \"Read in the name of your Lord who created.\",\n      source: \"Qur'an 96:1\"\n    },\n    keyLesson: \"The first revelation marked the beginning of prophethood, changing Muhammad Ô∑∫ and the entire course of human history forever.\",\n    quizId: 11\n  },\n\n  {\n    id: 12,\n    title: \"Secret Da'wah Begins\",\n    description: [\n      \"After the first revelation, Muhammad Ô∑∫ began calling people to Islam secretly. He started with those closest to him: his wife Khadijah believed immediately, followed by his young cousin Ali and his adopted son Zayd ibn Harithah.\",\n      \"His best friend Abu Bakr accepted Islam without hesitation. Abu Bakr then brought other respected Makkans including Uthman, Zubayr, Abdur-Rahman ibn Awf, Sa'd ibn Abi Waqqas, and Talhah. The Muslim community grew quietly in secret.\",\n      \"For three years, Muslims prayed and studied Qur'an in secret, meeting in homes and secluded places. They hid their faith from Makkah's powerful idolaters, building a strong foundation before facing the inevitable persecution to come.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéŸÜÿ∞Ÿêÿ±Ÿí ÿπŸéÿ¥ŸêŸäÿ±Ÿéÿ™ŸéŸÉŸé ÿßŸÑŸíÿ£ŸéŸÇŸíÿ±Ÿéÿ®ŸêŸäŸÜŸé\",\n      translation: \"And warn your closest kindred.\",\n      source: \"Qur'an 26:214\"\n    },\n    keyLesson: \"The Prophet Ô∑∫ built Islam's foundation carefully, starting with trusted individuals before public preaching began.\",\n    quizId: 12\n  },\n\n  // ============================================================\n  // SECTION 2: Makkah Period (28 lessons)\n  // ============================================================\n\n  {\n    id: 13,\n    title: \"Public Preaching Begins\",\n    description: [\n      \"After three years of secret da'wah, Allah commanded Muhammad Ô∑∫ to openly proclaim Islam. He climbed Mount Safa and called the Quraysh tribes. When they gathered, he asked if they would believe him if he warned of an army behind the mountain.\",\n      \"Everyone confirmed they would trust him because he never lied. Then he warned them about the punishment of rejecting Allah's message. His uncle Abu Lahab cursed him publicly, saying 'May you perish! Is this why you gathered us?'\",\n      \"This marked the beginning of open confrontation. The comfortable secret phase ended. Muslims now faced public mockery, social pressure, and growing hostility. But the Prophet Ô∑∫ continued preaching fearlessly, trusting Allah's protection and ultimate victory.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿßÿµŸíÿØŸéÿπŸí ÿ®ŸêŸÖŸéÿß ÿ™Ÿèÿ§ŸíŸÖŸéÿ±Ÿè ŸàŸéÿ£ŸéÿπŸíÿ±Ÿêÿ∂Ÿí ÿπŸéŸÜŸê ÿßŸÑŸíŸÖŸèÿ¥Ÿíÿ±ŸêŸÉŸêŸäŸÜŸé\",\n      translation: \"Then declare what you are commanded and turn away from the polytheists.\",\n      source: \"Qur'an 15:94\"\n    },\n    keyLesson: \"When Allah commands public preaching, believers must speak truth courageously despite opposition and personal cost.\",\n    quizId: 13\n  },\n\n  {\n    id: 14,\n    title: \"Opposition Begins\",\n    description: [\n      \"Quraysh leaders rejected Islam, fearing it would destroy their wealth, power, and social status. They couldn't deny Muhammad Ô∑∫'s Ô∑∫ honesty and character, so they called him a magician, poet, and madman instead.\",\n      \"They offered him wealth, kingship, and beautiful women if he would stop preaching. Muhammad Ô∑∫ refused everything, saying even if they placed the sun in his right hand and moon in his left, he wouldn't abandon this message.\",\n      \"Quraysh tried different tactics: bribery, threats, mockery, and lies. They spread rumors and discouraged people from listening. Despite all opposition, the Prophet Ô∑∫ remained patient and continued calling people to worship Allah alone.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸáŸèŸÖŸí ŸÉŸéÿßŸÜŸèŸàÿß ÿ•Ÿêÿ∞Ÿéÿß ŸÇŸêŸäŸÑŸé ŸÑŸéŸáŸèŸÖŸí ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸäŸéÿ≥Ÿíÿ™ŸéŸÉŸíÿ®Ÿêÿ±ŸèŸàŸÜŸé\",\n      translation: \"Indeed they, when it was said to them, 'There is no deity but Allah,' were arrogant.\",\n      source: \"Qur'an 37:35\"\n    },\n    keyLesson: \"Truth faces opposition from those who benefit from falsehood, but patience and persistence ultimately prevail.\",\n    quizId: 14\n  },\n\n  {\n    id: 15,\n    title: \"Torture of Early Muslims\",\n    description: [\n      \"Weak Muslims without tribal protection faced brutal torture. Bilal, an African slave, was dragged to the desert under scorching sun with a massive rock on his chest. He repeated only 'Ahad, Ahad‚ÄîOne, One' refusing to renounce Islam.\",\n      \"Yasir and his wife Sumayyah were tortured mercilessly. Abu Jahl murdered Sumayyah with a spear, making her Islam's first martyr. Ammar was tortured until he temporarily spoke against Islam under extreme duress, though his heart remained faithful.\",\n      \"Other slaves like Khabbab were burned with hot coals and tortured with red-hot armor. Despite unbearable pain, most remained steadfast. Abu Bakr used his wealth to purchase and free tortured slaves, including Bilal and several others.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£Ÿèÿ∞ŸêŸÜŸé ŸÑŸêŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸäŸèŸÇŸéÿßÿ™ŸéŸÑŸèŸàŸÜŸé ÿ®Ÿêÿ£ŸéŸÜŸéŸëŸáŸèŸÖŸí ÿ∏ŸèŸÑŸêŸÖŸèŸàÿß\",\n      translation: \"Permission to fight has been given to those who are being fought, because they were wronged.\",\n      source: \"Qur'an 22:39\"\n    },\n    keyLesson: \"Early Muslims sacrificed everything for faith, showing that true belief means standing firm despite persecution.\",\n    quizId: 15\n  },\n\n  {\n    id: 16,\n    title: \"First Migration to Abyssinia\",\n    description: [\n      \"As persecution intensified, the Prophet Ô∑∫ permitted weak Muslims to migrate to Abyssinia where the Christian king was known for justice. Eleven men and four women secretly left Makkah, seeking religious freedom and safety.\",\n      \"Quraysh sent delegates with gifts to Negus, the Abyssinian king, demanding the Muslims' return. They claimed the Muslims abandoned their religion and insulted Jesus. Negus listened fairly, calling the Muslims to defend themselves before making judgment.\",\n      \"Ja'far ibn Abi Talib spoke eloquently, explaining Islam's teachings and reciting Qur'an about Mary and Jesus. Moved to tears, Negus refused to hand over the Muslims, recognizing truth in their message. They found peaceful refuge in Abyssinia.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéÿ™Ÿéÿ¨ŸêÿØŸéŸÜŸéŸë ÿ£ŸéŸÇŸíÿ±Ÿéÿ®ŸéŸáŸèŸÖ ŸÖŸéŸëŸàŸéÿØŸéŸëÿ©Ÿã ŸÑŸêŸëŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÇŸéÿßŸÑŸèŸàÿß ÿ•ŸêŸÜŸéŸëÿß ŸÜŸéÿµŸéÿßÿ±ŸéŸâŸ∞\",\n      translation: \"And you will find the nearest of them in affection to the believers those who say, 'We are Christians.'\",\n      source: \"Qur'an 5:82\"\n    },\n    keyLesson: \"When persecution becomes unbearable, migration to safe lands is permissible and can protect the religion.\",\n    quizId: 16\n  },\n\n  {\n    id: 17,\n    title: \"Hamzah Accepts Islam\",\n    description: [\n      \"Abu Jahl publicly insulted and physically harmed the Prophet Ô∑∫ near Mount Safa. A slave woman witnessed this abuse and told Hamzah, the Prophet's Ô∑∫ uncle, a brave and respected warrior feared throughout Makkah.\",\n      \"Hamzah, returning from hunting, became furious. He went straight to Abu Jahl in the Ka'bah courtyard and struck him with his bow, challenging him to insult Muhammad Ô∑∫ again. Hamzah then declared his acceptance of Islam publicly.\",\n      \"Hamzah's Islam strengthened Muslims significantly. His courage and fighting skills provided protection. Muslims could now pray openly near the Ka'bah with less fear. Quraysh realized they could no longer abuse Muslims without consequence or retaliation.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ¨ŸéÿßŸáŸêÿØŸèŸàÿß ŸÅŸêŸä ÿßŸÑŸÑŸéŸëŸáŸê ÿ≠ŸéŸÇŸéŸë ÿ¨ŸêŸáŸéÿßÿØŸêŸáŸê\",\n      translation: \"And strive for Allah with the striving due to Him.\",\n      source: \"Qur'an 22:78\"\n    },\n    keyLesson: \"Strong believers standing up against oppression embolden the weak and change the balance of power.\",\n    quizId: 17\n  },\n\n  {\n    id: 18,\n    title: \"Umar ibn al-Khattab Accepts Islam\",\n    description: [\n      \"Umar was among Islam's fiercest enemies. One day he decided to kill Muhammad Ô∑∫ to end Islam forever. On his way, someone informed him that his own sister and brother-in-law had secretly accepted Islam.\",\n      \"Enraged, Umar went to his sister's house. He heard them reciting Qur'an and attacked his brother-in-law. His sister defended her husband, and Umar struck her, drawing blood. Seeing his sister bleeding yet firm in faith softened his heart.\",\n      \"He asked to read what they were reciting. After purifying himself, he read Surah Ta-Ha. The words touched his heart deeply. He immediately went to the Prophet Ô∑∫ and accepted Islam. Muslims' strength doubled, and they began praying openly at the Ka'bah.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸÉŸé ŸÑŸéÿß ÿ™ŸéŸáŸíÿØŸêŸä ŸÖŸéŸÜŸí ÿ£Ÿéÿ≠Ÿíÿ®Ÿéÿ®Ÿíÿ™Ÿé ŸàŸéŸÑŸéŸ∞ŸÉŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸäŸéŸáŸíÿØŸêŸä ŸÖŸéŸÜ ŸäŸéÿ¥Ÿéÿßÿ°Ÿè\",\n      translation: \"Indeed, you do not guide whom you like, but Allah guides whom He wills.\",\n      source: \"Qur'an 28:56\"\n    },\n    keyLesson: \"Allah guides whom He wills; even the strongest enemies can become Islam's greatest champions.\",\n    quizId: 18\n  },\n\n  {\n    id: 19,\n    title: \"Muslims Worship Publicly\",\n    description: [\n      \"With Hamzah and Umar's acceptance of Islam, Muslims gained courage to worship openly. They formed ranks and prayed publicly near the Ka'bah for the first time. This public display shocked and angered the Quraysh leadership significantly.\",\n      \"Umar said he wanted Islam to be open, not hidden. Muslims marched in two lines to the Ka'bah, one led by Hamzah and the other by Umar. This bold display demonstrated Islam's growing strength and Muslims' readiness to face consequences.\",\n      \"Quraysh realized Islam wasn't disappearing despite torture and threats. Muslims' public worship showed they wouldn't hide anymore. This marked a turning point where believers demonstrated courage, and Quraysh recognized they needed stronger measures to stop Islam's spread.\"\n    ],\n    evidence: {\n      arabic: \"ŸáŸèŸàŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£Ÿéÿ±Ÿíÿ≥ŸéŸÑŸé ÿ±Ÿéÿ≥ŸèŸàŸÑŸéŸáŸè ÿ®ŸêÿßŸÑŸíŸáŸèÿØŸéŸâŸ∞ ŸàŸéÿØŸêŸäŸÜŸê ÿßŸÑŸíÿ≠ŸéŸÇŸêŸë ŸÑŸêŸäŸèÿ∏ŸíŸáŸêÿ±ŸéŸáŸè ÿπŸéŸÑŸéŸâ ÿßŸÑÿØŸêŸëŸäŸÜŸê ŸÉŸèŸÑŸêŸëŸáŸê\",\n      translation: \"It is He who sent His Messenger with guidance and the religion of truth to manifest it over all religion.\",\n      source: \"Qur'an 9:33\"\n    },\n    keyLesson: \"When believers gain strength, they should worship openly and stand firm for their faith.\",\n    quizId: 19\n  },\n\n  {\n    id: 20,\n    title: \"The Social Boycott\",\n    description: [\n      \"Unable to stop Islam through violence, Quraysh implemented a complete social and economic boycott against Banu Hashim and Banu Muttalib, the Prophet's Ô∑∫ clans. They wrote an agreement forbidding all trade, marriage, or social contact with them.\",\n      \"The Prophet Ô∑∫ and his relatives were confined to a valley outside Makkah for three years. They faced extreme hunger, eating leaves and tree bark. Children's cries from hunger could be heard throughout Makkah at night.\",\n      \"Despite severe hardship, neither the Prophet Ô∑∫ nor his clan abandoned Islam or surrendered. They remained patient and steadfast. Some kind-hearted Makkans secretly smuggled food at night, risking punishment to help the suffering families isolated in the valley.\"\n    ],\n    evidence: {\n      arabic: \"ÿ£ŸéŸÖŸí ÿ≠Ÿéÿ≥Ÿêÿ®Ÿíÿ™ŸèŸÖŸí ÿ£ŸéŸÜ ÿ™ŸéÿØŸíÿÆŸèŸÑŸèŸàÿß ÿßŸÑŸíÿ¨ŸéŸÜŸéŸëÿ©Ÿé ŸàŸéŸÑŸéŸÖŸéŸëÿß ŸäŸéÿ£Ÿíÿ™ŸêŸÉŸèŸÖ ŸÖŸéŸëÿ´ŸéŸÑŸè ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿÆŸéŸÑŸéŸàŸíÿß ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸÉŸèŸÖ €ñ ŸÖŸéŸëÿ≥ŸéŸëÿ™ŸíŸáŸèŸÖŸè ÿßŸÑŸíÿ®Ÿéÿ£Ÿíÿ≥Ÿéÿßÿ°Ÿè ŸàŸéÿßŸÑÿ∂ŸéŸëÿ±ŸéŸëÿßÿ°Ÿè\",\n      translation: \"Or do you think you will enter Paradise while such trial has not yet come to you as came to those who passed on before you? They were touched by poverty and hardship.\",\n      source: \"Qur'an 2:214\"\n    },\n    keyLesson: \"Believers must remain patient during collective punishment and oppression, trusting Allah will bring relief.\",\n    quizId: 20\n  },\n\n  {\n    id: 21,\n    title: \"The Boycott Ends\",\n    description: [\n      \"After three years of boycott, some Quraysh leaders felt guilt over their relatives' suffering. Termites had eaten the boycott document except where Allah's name was written, leaving it miraculously intact‚Äîa clear sign from Allah.\",\n      \"The Prophet Ô∑∫ informed his uncle about the termites before anyone checked. When they verified it, they found exactly as he said. This miracle softened some hearts, and several leaders decided to end the unjust boycott immediately.\",\n      \"The boycott ended, but the hardship had taken its toll. The Muslims emerged weaker physically but stronger in faith. Their steadfastness during three years of starvation and isolation proved their unwavering commitment to Islam regardless of sacrifice.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéÿ•ŸêŸÜŸéŸë ŸÖŸéÿπŸé ÿßŸÑŸíÿπŸèÿ≥Ÿíÿ±Ÿê ŸäŸèÿ≥Ÿíÿ±Ÿãÿß €ù ÿ•ŸêŸÜŸéŸë ŸÖŸéÿπŸé ÿßŸÑŸíÿπŸèÿ≥Ÿíÿ±Ÿê ŸäŸèÿ≥Ÿíÿ±Ÿãÿß\",\n      translation: \"For indeed, with hardship comes ease. Indeed, with hardship comes ease.\",\n      source: \"Qur'an 94:5-6\"\n    },\n    keyLesson: \"After every difficulty, Allah brings relief; patience during trials leads to eventual victory.\",\n    quizId: 21\n  },\n\n  {\n    id: 22,\n    title: \"Death of Khadijah\",\n    description: [\n      \"Shortly after the boycott ended, Khadijah, the Prophet's Ô∑∫ beloved wife and greatest supporter, passed away. For twenty-five years, she had stood by him, believed in him when others rejected him, and comforted him through every hardship.\",\n      \"Khadijah was the first to believe, the first to pray, and the mother of all his children except Ibrahim. She spent her wealth supporting Islam and gave the Prophet Ô∑∫ emotional strength when the entire world opposed him.\",\n      \"Her death left the Prophet Ô∑∫ deeply grieved. He never forgot her sacrifices, always speaking of her with love and respect. He called this year the 'Year of Sorrow' because of the tremendous personal losses he endured.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ÿßÿµŸíÿ∑ŸéŸÅŸéŸâŸ∞ ÿ¢ÿØŸéŸÖŸé ŸàŸéŸÜŸèŸàÿ≠Ÿãÿß ŸàŸéÿ¢ŸÑŸé ÿ•Ÿêÿ®Ÿíÿ±ŸéÿßŸáŸêŸäŸÖŸé ŸàŸéÿ¢ŸÑŸé ÿπŸêŸÖŸíÿ±ŸéÿßŸÜŸé ÿπŸéŸÑŸéŸâ ÿßŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"Indeed, Allah chose Adam and Noah and the family of Abraham and the family of Imran over the worlds.\",\n      source: \"Qur'an 3:33\"\n    },\n    keyLesson: \"Khadijah's unwavering support made her among the greatest women in history and the Prophet's Ô∑∫ most beloved companion.\",\n    quizId: 22\n  },\n\n  {\n    id: 23,\n    title: \"Death of Abu Talib\",\n    description: [\n      \"Soon after Khadijah's death, Abu Talib, the Prophet's Ô∑∫ uncle and protector, also passed away. Though Abu Talib never accepted Islam, he defended his nephew against Quraysh throughout his life out of family loyalty and love.\",\n      \"The Prophet Ô∑∫ desperately wanted Abu Talib to accept Islam before death. On his deathbed, with Quraysh leaders present, the Prophet Ô∑∫ pleaded with him to say the Shahadah. But Abu Talib refused, fearing shame before Arabs, dying on his ancestral religion.\",\n      \"After Abu Talib's death, the Prophet Ô∑∫ lost his main tribal protection. Quraysh became bolder in their persecution, knowing no powerful guardian stood to defend him. This made the situation in Makkah increasingly dangerous for Muslims.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëŸÉŸé ŸÑŸéÿß ÿ™ŸéŸáŸíÿØŸêŸä ŸÖŸéŸÜŸí ÿ£Ÿéÿ≠Ÿíÿ®Ÿéÿ®Ÿíÿ™Ÿé ŸàŸéŸÑŸéŸ∞ŸÉŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸäŸéŸáŸíÿØŸêŸä ŸÖŸéŸÜ ŸäŸéÿ¥Ÿéÿßÿ°Ÿè\",\n      translation: \"Indeed, you do not guide whom you like, but Allah guides whom He wills.\",\n      source: \"Qur'an 28:56\"\n    },\n    keyLesson: \"Guidance belongs to Allah alone; even the Prophet Ô∑∫ couldn't guide his own beloved uncle to Islam.\",\n    quizId: 23\n  },\n\n  {\n    id: 24,\n    title: \"Journey to Ta'if\",\n    description: [\n      \"After losing both Khadijah and Abu Talib, persecution in Makkah intensified. The Prophet Ô∑∫ traveled to Ta'if, hoping the tribe of Thaqif would accept Islam and provide protection. He walked over sixty miles through desert mountains seeking support.\",\n      \"The leaders of Ta'if mocked him and rejected his message. They unleashed street children and slaves to stone him as he left the city. Rocks struck him until his feet bled. His sandals filled with blood. Even Zayd, who accompanied him, was injured trying to protect him.\",\n      \"Bruised and bleeding, the Prophet Ô∑∫ took shelter in an orchard. This was perhaps his lowest moment: rejected, homeless, and physically wounded. Yet he didn't curse Ta'if. Instead, he made a beautiful du'a asking Allah for strength to continue his mission.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßÿµŸíÿ®Ÿêÿ±Ÿí ŸÑŸêÿ≠ŸèŸÉŸíŸÖŸê ÿ±Ÿéÿ®ŸêŸëŸÉŸé ŸÅŸéÿ•ŸêŸÜŸéŸëŸÉŸé ÿ®Ÿêÿ£ŸéÿπŸíŸäŸèŸÜŸêŸÜŸéÿß\",\n      translation: \"And be patient for the decision of your Lord, for indeed, you are in Our eyes.\",\n      source: \"Qur'an 52:48\"\n    },\n    keyLesson: \"Even at the lowest point, the Prophet Ô∑∫ remained patient and continued his mission without despair or revenge.\",\n    quizId: 24\n  },\n\n  {\n    id: 25,\n    title: \"Du'a in the Garden\",\n    description: [\n      \"Bleeding and exhausted in Ta'if's garden, the Prophet Ô∑∫ raised his hands in a heartfelt du'a. He didn't complain about pain or ask for revenge. Instead, he acknowledged his weakness and sought only Allah's pleasure and strength to continue.\",\n      \"He said: 'O Allah, to You I complain of my weakness, lack of resources, and lowliness before people. You are the Lord of the weak, and You are my Lord. To whom do You leave me? If You are not angry with me, I do not care.'\",\n      \"This beautiful prayer showed complete submission and trust. The Prophet Ô∑∫ cared only about Allah's approval, not worldly success or people's acceptance. His sincerity in this moment of pain demonstrated the true meaning of tawakkul and iman.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸí ÿπŸéŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê €ö ŸàŸéŸÉŸéŸÅŸéŸâŸ∞ ÿ®ŸêÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéŸÉŸêŸäŸÑŸãÿß\",\n      translation: \"And rely upon Allah; and sufficient is Allah as Disposer of affairs.\",\n      source: \"Qur'an 33:3\"\n    },\n    keyLesson: \"In our darkest moments, turning to Allah with sincere du'a brings comfort and strength to continue.\",\n    quizId: 25\n  },\n\n  {\n    id: 26,\n    title: \"Addas the Christian Servant\",\n    description: [\n      \"The garden belonged to two of the Prophet's Ô∑∫ distant relatives from Quraysh. Moved by his condition, they sent their Christian servant Addas with grapes to help him. Addas was from Nineveh in Iraq, far from Arabia.\",\n      \"Before eating, the Prophet Ô∑∫ said 'Bismillah,' which surprised Addas. When asked where he was from, the Prophet Ô∑∫ mentioned that Yunus, a prophet from Nineveh, was his brother in prophethood. This amazed Addas deeply.\",\n      \"Addas realized Muhammad Ô∑∫ was a true prophet. He kissed the Prophet's Ô∑∫ hands and feet, accepting Islam immediately. Even in his darkest hour, the Prophet Ô∑∫ continued calling people to Islam. This encounter brought comfort after Ta'if's brutal rejection.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ÿ£Ÿéÿ±Ÿíÿ≥ŸéŸÑŸíŸÜŸéÿßŸÉŸé ÿ•ŸêŸÑŸéŸëÿß ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©Ÿã ŸÑŸêŸëŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"And We have not sent you except as a mercy to the worlds.\",\n      source: \"Qur'an 21:107\"\n    },\n    keyLesson: \"Allah sends comfort and success in unexpected ways; every difficulty contains hidden blessings.\",\n    quizId: 26\n  },\n\n  {\n    id: 27,\n    title: \"The Angel of the Mountains\",\n    description: [\n      \"After Ta'if's rejection, Angel Jibra'il came with the Angel of the Mountains. They offered to crush Ta'if between its two mountains if the Prophet Ô∑∫ wished. This was divine permission to punish those who harmed him so brutally.\",\n      \"Despite his bleeding wounds and broken heart, the Prophet Ô∑∫ refused. He said, 'No, for I hope that Allah will bring forth from their descendants people who will worship Allah alone, associating nothing with Him in worship.'\",\n      \"This moment showed the Prophet's Ô∑∫ extraordinary mercy and foresight. He didn't seek revenge despite having divine permission. He hoped for future generations to accept Islam. His compassion for humanity exceeded his personal pain and suffering significantly.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ÿ£Ÿéÿ±Ÿíÿ≥ŸéŸÑŸíŸÜŸéÿßŸÉŸé ÿ•ŸêŸÑŸéŸëÿß ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©Ÿã ŸÑŸêŸëŸÑŸíÿπŸéÿßŸÑŸéŸÖŸêŸäŸÜŸé\",\n      translation: \"And We have not sent you except as a mercy to the worlds.\",\n      source: \"Qur'an 21:107\"\n    },\n    keyLesson: \"The Prophet Ô∑∫ chose mercy over revenge, hoping for future guidance rather than immediate punishment.\",\n    quizId: 27\n  },\n\n  {\n    id: 28,\n    title: \"The Night Journey - Isra\",\n    description: [\n      \"During the Year of Sorrow, a miraculous event occurred. One night, Angel Jibra'il came with the Buraq, a blessed riding animal. The Prophet Ô∑∫ was taken from Makkah to Al-Aqsa Mosque in Jerusalem in a single night‚Äîa journey taking weeks by caravan.\",\n      \"In Jerusalem, the Prophet Ô∑∫ led all previous prophets in prayer. This gathering symbolized the unity of Allah's message throughout history and confirmed Muhammad Ô∑∫'s Ô∑∫ position as the seal of prophets and final messenger to all humanity.\",\n      \"The journey showed Allah honoring His messenger after Ta'if's humiliation. When worldly people rejected him, Allah elevated him to heights no human had reached. This trip strengthened the Prophet Ô∑∫ and proved his truthfulness through this supernatural miracle.\"\n    ],\n    evidence: {\n      arabic: \"ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£Ÿéÿ≥Ÿíÿ±ŸéŸâŸ∞ ÿ®ŸêÿπŸéÿ®ŸíÿØŸêŸáŸê ŸÑŸéŸäŸíŸÑŸãÿß ŸÖŸêŸëŸÜŸé ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸê ÿßŸÑŸíÿ≠Ÿéÿ±ŸéÿßŸÖŸê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸê ÿßŸÑŸíÿ£ŸéŸÇŸíÿµŸéŸâ\",\n      translation: \"Exalted is He who took His Servant by night from al-Masjid al-Haram to al-Masjid al-Aqsa.\",\n      source: \"Qur'an 17:1\"\n    },\n    keyLesson: \"When people humiliate Allah's servants, He honors them in ways beyond imagination.\",\n    quizId: 28\n  },\n\n  {\n    id: 29,\n    title: \"The Ascension - Mi'raj\",\n    description: [\n      \"From Jerusalem, the Prophet Ô∑∫ ascended through the seven heavens, meeting prophets at each level: Adam, Yahya, Isa, Yusuf, Idris, Harun, Musa, and finally Ibrahim. Each welcomed him with honor and joy, recognizing his blessed status.\",\n      \"He witnessed Paradise and Hell, saw angels worshipping constantly, and reached a point no creation had reached before. There, Allah spoke directly to His beloved Prophet Ô∑∫ and prescribed the five daily prayers as a gift to the Muslim ummah.\",\n      \"Originally fifty prayers were prescribed, but following Musa's advice, the Prophet Ô∑∫ asked Allah to reduce them. Allah decreased them to five while maintaining the reward of fifty. This showed Allah's mercy and the high status of Salah in Islam.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéŸÇŸéÿØŸí ÿ±Ÿéÿ¢ŸáŸè ŸÜŸéÿ≤ŸíŸÑŸéÿ©Ÿã ÿ£ŸèÿÆŸíÿ±ŸéŸâŸ∞ €ù ÿπŸêŸÜÿØŸé ÿ≥ŸêÿØŸíÿ±Ÿéÿ©Ÿê ÿßŸÑŸíŸÖŸèŸÜÿ™ŸéŸáŸéŸâŸ∞\",\n      translation: \"And he certainly saw him in another descent, at the Lote Tree of the Utmost Boundary.\",\n      source: \"Qur'an 53:13-14\"\n    },\n    keyLesson: \"The Mi'raj demonstrated the Prophet's Ô∑∫ unique closeness to Allah and established prayer as Islam's pillar.\",\n    quizId: 29\n  },\n\n  {\n    id: 30,\n    title: \"Return and Mockery\",\n    description: [\n      \"When the Prophet Ô∑∫ told Quraysh about his night journey, they mocked him viciously. They said it was impossible to travel to Jerusalem and back in one night. Some Muslims with weak faith even left Islam over this story.\",\n      \"Abu Bakr was asked about the journey. Without hesitation, he said, 'If Muhammad Ô∑∫ said it, then it's true.' From that day, he was called As-Siddiq, 'The Truthful.' His unwavering belief strengthened other Muslims during this test of faith.\",\n      \"The Prophet Ô∑∫ described Jerusalem's details perfectly, though he'd never been there before. He even told them about a caravan returning to Makkah and when it would arrive. Everything occurred exactly as he described, proving his truthfulness miraculously.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ÿ¨ŸéÿπŸéŸÑŸíŸÜŸéÿß ÿßŸÑÿ±ŸèŸëÿ§ŸíŸäŸéÿß ÿßŸÑŸéŸëÿ™ŸêŸä ÿ£Ÿéÿ±ŸéŸäŸíŸÜŸéÿßŸÉŸé ÿ•ŸêŸÑŸéŸëÿß ŸÅŸêÿ™ŸíŸÜŸéÿ©Ÿã ŸÑŸêŸëŸÑŸÜŸéŸëÿßÿ≥Ÿê\",\n      translation: \"And We did not make the vision which We showed you except as a trial for the people.\",\n      source: \"Qur'an 17:60\"\n    },\n    keyLesson: \"True faith means trusting the Prophet Ô∑∫ completely, even when events seem impossible to limited human understanding.\",\n    quizId: 30\n  },\n\n  {\n    id: 31,\n    title: \"Calling the Tribes\",\n    description: [\n      \"Every year during Hajj season, Arab tribes visited Makkah. The Prophet Ô∑∫ visited their camps, calling them to Islam and asking for protection to deliver Allah's message. Tribe after tribe rejected him, mocked him, or simply ignored him completely.\",\n      \"His uncle Abu Lahab followed him to each camp, warning tribes not to listen and calling Muhammad Ô∑∫ a liar. Despite this sabotage and constant rejection, the Prophet Ô∑∫ continued approaching every tribe with patience, hoping someone would accept truth.\",\n      \"This went on for years during Hajj seasons. The Prophet Ô∑∫ faced humiliation and rejection repeatedly, yet he never gave up. His persistence in calling people to guidance despite endless refusals showed his commitment to delivering Allah's message to everyone.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑÿ±ŸéŸëÿ≥ŸèŸàŸÑŸè ÿ®ŸéŸÑŸêŸëÿ∫Ÿí ŸÖŸéÿß ÿ£ŸèŸÜÿ≤ŸêŸÑŸé ÿ•ŸêŸÑŸéŸäŸíŸÉŸé ŸÖŸêŸÜ ÿ±ŸéŸëÿ®ŸêŸëŸÉŸé\",\n      translation: \"O Messenger, announce that which has been revealed to you from your Lord.\",\n      source: \"Qur'an 5:67\"\n    },\n    keyLesson: \"Persistence in da'wah despite rejection is a prophetic quality we should emulate when calling others to Islam.\",\n    quizId: 31\n  },\n\n  {\n    id: 32,\n    title: \"Six Men from Yathrib\",\n    description: [\n      \"During Hajj, the Prophet Ô∑∫ met six men from the Khazraj tribe of Yathrib (later Madinah). Unlike other tribes, they listened carefully to his message. Yathrib had Jewish tribes who spoke of a coming prophet, making these men receptive.\",\n      \"They recognized truth in the Prophet's Ô∑∫ words and accepted Islam. Before returning to Yathrib, they promised to spread Islam among their people. They said their city was torn by war, and perhaps this prophet could unite them in peace.\",\n      \"This meeting planted Islam's seed in Yathrib. These six men returned home and spoke enthusiastically about Islam. Within a year, Islam spread significantly in Yathrib, preparing the ground for Muslims' eventual migration and the establishment of Islamic state.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸäŸéŸÖŸíŸÉŸèÿ±ŸèŸàŸÜŸé ŸàŸéŸäŸéŸÖŸíŸÉŸèÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸè €ñ ŸàŸéÿßŸÑŸÑŸéŸëŸáŸè ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑŸíŸÖŸéÿßŸÉŸêÿ±ŸêŸäŸÜŸé\",\n      translation: \"And they planned, and Allah planned. And Allah is the best of planners.\",\n      source: \"Qur'an 8:30\"\n    },\n    keyLesson: \"Allah's plan works in unexpected ways; when all doors close in one place, He opens them elsewhere.\",\n    quizId: 32\n  },\n\n  {\n    id: 33,\n    title: \"First Pledge of Aqabah\",\n    description: [\n      \"The following year, twelve men from Yathrib met the Prophet Ô∑∫ secretly at Aqabah during Hajj. They pledged to worship Allah alone, avoid sins, and obey the Prophet Ô∑∫ in righteousness. This was called the 'Pledge of Women' because it didn't include fighting.\",\n      \"The Prophet Ô∑∫ sent Mus'ab ibn Umayr to Yathrib to teach Qur'an and Islam. Mus'ab was eloquent, knowledgeable, and dedicated. Under his teaching, Islam spread rapidly throughout Yathrib, entering every household and touching every family in the city.\",\n      \"This pledge marked the beginning of organized Islamic community outside Makkah. Yathrib was preparing to become Madinah, the city that would welcome Muslims, protect the Prophet Ô∑∫, and serve as Islam's base for spreading throughout Arabia and beyond.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ŸàŸéŸáŸéÿßÿ¨Ÿéÿ±ŸèŸàÿß ŸàŸéÿ¨ŸéÿßŸáŸéÿØŸèŸàÿß ÿ®Ÿêÿ£ŸéŸÖŸíŸàŸéÿßŸÑŸêŸáŸêŸÖŸí ŸàŸéÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸáŸêŸÖŸí ŸÅŸêŸä ÿ≥Ÿéÿ®ŸêŸäŸÑŸê ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"Indeed, those who have believed and emigrated and fought with their wealth and lives in the cause of Allah.\",\n      source: \"Qur'an 8:72\"\n    },\n    keyLesson: \"Building strong Islamic communities requires dedicated teachers and committed learners working together patiently.\",\n    quizId: 33\n  },\n\n  {\n    id: 34,\n    title: \"Second Pledge of Aqabah\",\n    description: [\n      \"The next year, seventy-three men and two women from Yathrib came for Hajj. They met the Prophet Ô∑∫ secretly at night at Aqabah. This time, they pledged to protect him as they would protect their own families, even if it meant war.\",\n      \"They invited him to migrate to Yathrib, promising complete support and protection. The Prophet Ô∑∫ accepted their offer. This pledge meant Yathrib's people would fight all of Arabia if necessary to defend Muhammad Ô∑∫ and Islam‚Äîa tremendous commitment demonstrating deep faith.\",\n      \"Twelve leaders were appointed to manage their communities. This organizational structure laid the foundation for Islamic governance. The pledge gave Muslims hope for a safe homeland and marked the turning point from defensive survival to active Islamic state-building.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ™Ÿéÿ®ŸéŸàŸéŸëÿ°ŸèŸàÿß ÿßŸÑÿØŸéŸëÿßÿ±Ÿé ŸàŸéÿßŸÑŸíÿ•ŸêŸäŸÖŸéÿßŸÜŸé ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸáŸêŸÖŸí ŸäŸèÿ≠Ÿêÿ®ŸèŸëŸàŸÜŸé ŸÖŸéŸÜŸí ŸáŸéÿßÿ¨Ÿéÿ±Ÿé ÿ•ŸêŸÑŸéŸäŸíŸáŸêŸÖŸí\",\n      translation: \"And those who were settled in the Home and adopted the faith before them love those who emigrated to them.\",\n      source: \"Qur'an 59:9\"\n    },\n    keyLesson: \"True believers support each other through sacrifice, creating safe spaces for Islam to flourish.\",\n    quizId: 34\n  },\n\n  {\n    id: 35,\n    title: \"Permission to Migrate\",\n    description: [\n      \"After the Second Pledge of Aqabah, the Prophet Ô∑∫ gave Muslims permission to migrate to Yathrib. Believers began leaving Makkah secretly in small groups, fearing Quraysh would stop them and confiscate their wealth.\",\n      \"Families left behind homes, businesses, and possessions. They departed secretly at night, sacrificing everything for the sake of Islam. Many traveled dangerous desert routes, risking their lives to reach Yathrib and practice religion freely without persecution.\",\n      \"The Ansar (Helpers) of Yathrib welcomed the Muhajirun (Emigrants) warmly, sharing homes, wealth, and resources. This brotherhood between Ansar and Muhajirun became a beautiful example of Islamic unity transcending tribal loyalty and material attachment that defined Arab society.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéŸÜ ŸäŸèŸáŸéÿßÿ¨Ÿêÿ±Ÿí ŸÅŸêŸä ÿ≥Ÿéÿ®ŸêŸäŸÑŸê ÿßŸÑŸÑŸéŸëŸáŸê ŸäŸéÿ¨ŸêÿØŸí ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ŸÖŸèÿ±Ÿéÿßÿ∫ŸéŸÖŸãÿß ŸÉŸéÿ´ŸêŸäÿ±Ÿãÿß ŸàŸéÿ≥ŸéÿπŸéÿ©Ÿã\",\n      translation: \"And whoever emigrates for the cause of Allah will find on the earth many locations and abundance.\",\n      source: \"Qur'an 4:100\"\n    },\n    keyLesson: \"Sacrificing worldly comfort for Allah's sake leads to greater blessings and strengthens faith.\",\n    quizId: 35\n  },\n\n  {\n    id: 36,\n    title: \"The Assassination Plot\",\n    description: [\n      \"Quraysh realized Muslims were escaping to Yathrib where they'd gain strength. They feared the Prophet Ô∑∫ would unite Arabs against them. Leaders gathered at Dar al-Nadwa to plan his assassination before he could escape as well.\",\n      \"They devised a plan: select one young man from each tribe to strike Muhammad Ô∑∫ simultaneously. This would spread blood responsibility among all tribes, preventing Banu Hashim from seeking revenge against one specific tribe, avoiding tribal war while eliminating Islam's leader.\",\n      \"On the chosen night, young men surrounded the Prophet's Ô∑∫ house, waiting for dawn to attack. But Allah informed His prophet of the plot through revelation. The Prophet Ô∑∫ prepared to escape, trusting Allah's protection despite being completely surrounded by assassins.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ∞Ÿí ŸäŸéŸÖŸíŸÉŸèÿ±Ÿè ÿ®ŸêŸÉŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéŸÅŸéÿ±ŸèŸàÿß ŸÑŸêŸäŸèÿ´Ÿíÿ®Ÿêÿ™ŸèŸàŸÉŸé ÿ£ŸéŸàŸí ŸäŸéŸÇŸíÿ™ŸèŸÑŸèŸàŸÉŸé ÿ£ŸéŸàŸí ŸäŸèÿÆŸíÿ±Ÿêÿ¨ŸèŸàŸÉŸé €ö ŸàŸéŸäŸéŸÖŸíŸÉŸèÿ±ŸèŸàŸÜŸé ŸàŸéŸäŸéŸÖŸíŸÉŸèÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸè €ñ ŸàŸéÿßŸÑŸÑŸéŸëŸáŸè ÿÆŸéŸäŸíÿ±Ÿè ÿßŸÑŸíŸÖŸéÿßŸÉŸêÿ±ŸêŸäŸÜŸé\",\n      translation: \"And when those who disbelieved plotted against you to restrain you or kill you or evict you. But they plan, and Allah plans. And Allah is the best of planners.\",\n      source: \"Qur'an 8:30\"\n    },\n    keyLesson: \"Allah protects His messengers and believers from enemies' plots, no matter how carefully planned.\",\n    quizId: 36\n  },\n\n  {\n    id: 37,\n    title: \"The Miraculous Escape\",\n    description: [\n      \"The Prophet Ô∑∫ asked Ali to sleep in his bed wearing his green cloak as a decoy. That night, he walked through the assassins surrounding his house. Allah made them blind to his presence. He threw dust on their heads reciting Qur'an, walking past them completely unseen.\",\n      \"Ali bravely slept in the Prophet's Ô∑∫ bed, risking his life. When assassins burst in at dawn, they found Ali instead of Muhammad Ô∑∫. Furious, they realized the Prophet Ô∑∫ had escaped. They immediately organized search parties throughout Makkah and surrounding areas.\",\n      \"This escape showed Allah's protection clearly. Despite being surrounded, the Prophet Ô∑∫ walked past armed men planning to kill him. His trust in Allah combined with practical planning saved his life and allowed Islam's continuation and eventual triumph over disbelief.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÑŸéŸëÿß ÿ™ŸéŸÜÿµŸèÿ±ŸèŸàŸáŸè ŸÅŸéŸÇŸéÿØŸí ŸÜŸéÿµŸéÿ±ŸéŸáŸè ÿßŸÑŸÑŸéŸëŸáŸè\",\n      translation: \"If you do not aid him, Allah has already aided him.\",\n      source: \"Qur'an 9:40\"\n    },\n    keyLesson: \"Complete trust in Allah combined with practical action leads to success against overwhelming odds.\",\n    quizId: 37\n  },\n\n  {\n    id: 38,\n    title: \"The Cave of Thawr\",\n    description: [\n      \"The Prophet Ô∑∫ and Abu Bakr headed south toward Cave Thawr, opposite the direction to Yathrib to confuse pursuers. They hid in the cave for three days while Quraysh searched frantically throughout Makkah and surrounding valleys and mountains.\",\n      \"Abu Bakr entered the cave first, blocking holes with his clothes to protect the Prophet Ô∑∫ from creatures inside. A poisonous snake bit his foot, but he remained silent, not wanting to disturb the Prophet Ô∑∫ who was resting his head on his companion's lap peacefully.\",\n      \"Abu Bakr's son Abdullah brought news at night, his daughter Asma brought food, and their shepherd Amir brought sheep to cover their tracks with animal footprints. The family worked together risking their lives to help the Prophet Ô∑∫ escape safely to Yathrib.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿí ŸáŸèŸÖŸéÿß ŸÅŸêŸä ÿßŸÑŸíÿ∫Ÿéÿßÿ±Ÿê ÿ•Ÿêÿ∞Ÿí ŸäŸéŸÇŸèŸàŸÑŸè ŸÑŸêÿµŸéÿßÿ≠Ÿêÿ®ŸêŸáŸê ŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≤ŸéŸÜŸí ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿπŸéŸÜŸéÿß\",\n      translation: \"When they were in the cave and he said to his companion, 'Do not grieve; indeed Allah is with us.'\",\n      source: \"Qur'an 9:40\"\n    },\n    keyLesson: \"Abu Bakr's sacrifice and the Prophet's Ô∑∫ reassurance teach us that Allah is always with sincere believers.\",\n    quizId: 38\n  },\n\n  {\n    id: 39,\n    title: \"Spider and Dove Miracles\",\n    description: [\n      \"Quraysh trackers followed footprints to Cave Thawr. They stood right at the cave entrance, so close that Abu Bakr whispered, 'If they look down, they'll see us.' But Allah protected them through miracles beyond human planning.\",\n      \"A spider had quickly spun a web across the cave entrance, and a dove had built a nest and laid eggs. When trackers saw the undisturbed web and nest, they assumed no one could have entered recently. They turned away, never looking inside the cave.\",\n      \"Abu Bakr was afraid, but the Prophet Ô∑∫ reassured him: 'What do you think of two when Allah is their third?' This statement showed complete trust in Allah. Divine protection came through tiny creatures‚Äîa spider and dove‚Äîsaving the future of Islam miraculously.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸë ÿßŸÑŸÑŸéŸëŸáŸé ŸÖŸéÿπŸéŸÜŸéÿß\",\n      translation: \"Indeed, Allah is with us.\",\n      source: \"Qur'an 9:40\"\n    },\n    keyLesson: \"Allah protects His servants through unexpected means; trust Him completely regardless of how desperate situations appear.\",\n    quizId: 39\n  },\n\n  {\n    id: 40,\n    title: \"Journey to Madinah\",\n    description: [\n      \"After three days, the Prophet Ô∑∫ and Abu Bakr began their journey to Yathrib with a guide named Abdullah ibn Urayqit. They took a difficult, rarely-traveled coastal route through desert mountains to avoid Quraysh patrols and capture.\",\n      \"Quraysh offered one hundred camels as reward for capturing Muhammad Ô∑∫. Suraqah ibn Malik, a skilled horseman, pursued them hoping for the prize. Each time he approached, his horse's legs sank into the ground miraculously, stopping him from reaching them.\",\n      \"After the third time, Suraqah realized divine protection surrounded the Prophet Ô∑∫. He asked for safety when Islam prevailed. Years later, he accepted Islam and the Prophet Ô∑∫ gave him the bracelets of the Persian emperor, fulfilling his prediction of Islam's future victory.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸÑŸéŸëŸáŸè ŸäŸéÿπŸíÿµŸêŸÖŸèŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê\",\n      translation: \"And Allah will protect you from the people.\",\n      source: \"Qur'an 5:67\"\n    },\n    keyLesson: \"No human can harm whom Allah protects; trust in His plan and continue striving despite danger.\",\n    quizId: 40\n  },\n\n  // ============================================================\n  // SECTION 3: Madinah Period (30 lessons)\n  // ============================================================\n\n  {\n    id: 41,\n    title: \"Arrival at Quba\",\n    description: [\n      \"After an eight-day journey through harsh desert terrain, the Prophet Ô∑∫ arrived at Quba on the outskirts of Yathrib. The Muslims there had been waiting anxiously, watching the roads daily, longing for his arrival to their city.\",\n      \"They greeted him with overwhelming joy and celebration. Women and children climbed rooftops singing 'Tala'al Badru Alayna'‚Äî'The full moon has risen upon us.' Their happiness and warm welcome showed the deep love they already had for him.\",\n      \"The Prophet Ô∑∫ stayed in Quba for several days, establishing the first mosque in Islam. This mosque, built on pure foundations of taqwa, became a symbol of unity. Praying there earned special rewards, as mentioned by the Prophet Ô∑∫ himself.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸëŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸå ÿ£Ÿèÿ≥ŸêŸëÿ≥Ÿé ÿπŸéŸÑŸéŸâ ÿßŸÑÿ™ŸéŸëŸÇŸíŸàŸéŸâŸ∞ ŸÖŸêŸÜŸí ÿ£ŸéŸàŸéŸëŸÑŸê ŸäŸéŸàŸíŸÖŸç ÿ£Ÿéÿ≠ŸéŸÇŸèŸë ÿ£ŸéŸÜ ÿ™ŸéŸÇŸèŸàŸÖŸé ŸÅŸêŸäŸáŸê\",\n      translation: \"A mosque founded on righteousness from the first day is more worthy for you to stand in.\",\n      source: \"Qur'an 9:108\"\n    },\n    keyLesson: \"Building institutions on strong spiritual foundations ensures lasting success and Allah's blessings.\",\n    quizId: 41\n  },\n\n  {\n    id: 42,\n    title: \"Entry into Madinah\",\n    description: [\n      \"When the Prophet Ô∑∫ entered Madinah, every family wanted him to stay with them. Everyone tried to grab his camel's reins to bring him to their home. The Prophet Ô∑∫ said, 'Let her go, she is commanded by Allah.'\",\n      \"The camel walked through Madinah's streets and finally knelt at a plot belonging to two orphans. The Prophet Ô∑∫ purchased the land and announced this would be the site of his mosque and home. This choice showed humility and divine guidance.\",\n      \"He stayed with Abu Ayyub al-Ansari while the mosque was being built. Abu Ayyub considered hosting the Prophet Ô∑∫ the greatest honor of his life. This arrival marked the beginning of the Islamic state, transforming Yathrib into Madinah al-Munawwarah‚Äîthe Illuminated City.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ™Ÿéÿ®ŸéŸàŸéŸëÿ°ŸèŸàÿß ÿßŸÑÿØŸéŸëÿßÿ±Ÿé ŸàŸéÿßŸÑŸíÿ•ŸêŸäŸÖŸéÿßŸÜŸé ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸáŸêŸÖŸí\",\n      translation: \"And those who were settled in the Home and adopted the faith before them.\",\n      source: \"Qur'an 59:9\"\n    },\n    keyLesson: \"True believers compete in goodness and serving Islam, not in worldly status or wealth.\",\n    quizId: 42\n  },\n\n  {\n    id: 43,\n    title: \"Building Masjid Nabawi\",\n    description: [\n      \"The Prophet Ô∑∫ and his companions built Masjid Nabawi with their own hands. They carried bricks, mixed mud, and sang work songs together. The Prophet Ô∑∫ worked alongside them, never considering himself above physical labor or too noble to serve.\",\n      \"The mosque was simple: walls of mud and bricks, roof of palm branches, pillars of palm trunks. Despite its simplicity, it became the heart of Islamic civilization. Here, Muslims prayed, learned, judged disputes, planned strategies, and built their community of faith.\",\n      \"Rooms for the Prophet's Ô∑∫ wives were built adjacent to the mosque. This mosque wasn't just for prayer but the center of all Islamic life: education, governance, social affairs, and spirituality. It represented Islam's holistic approach to life and worship.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸêŸä ÿ®ŸèŸäŸèŸàÿ™Ÿç ÿ£Ÿéÿ∞ŸêŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ£ŸéŸÜ ÿ™Ÿèÿ±ŸíŸÅŸéÿπŸé ŸàŸéŸäŸèÿ∞ŸíŸÉŸéÿ±Ÿé ŸÅŸêŸäŸáŸéÿß ÿßÿ≥ŸíŸÖŸèŸáŸè\",\n      translation: \"In houses which Allah has ordered to be raised and that His name be mentioned therein.\",\n      source: \"Qur'an 24:36\"\n    },\n    keyLesson: \"Simplicity in worship spaces focuses hearts on Allah rather than worldly decoration and distraction.\",\n    quizId: 43\n  },\n\n  {\n    id: 44,\n    title: \"Brotherhood Between Muhajirun and Ansar\",\n    description: [\n      \"The Prophet Ô∑∫ established brotherhood between Muhajirun (Emigrants from Makkah) and Ansar (Helpers from Madinah). Each Ansari was paired with a Muhajir, creating bonds stronger than blood relations, built purely on Islamic faith and love.\",\n      \"Ansar shared everything: homes, wealth, farms, and even offered to divorce wives so Muhajirun brothers could marry. This selflessness was unprecedented in Arab society, where tribal and family loyalty dominated all relationships and determined all social structures.\",\n      \"This brotherhood eliminated tribal tensions and created unity based on faith. It proved Islam transcends race, tribe, and nationality. The Qur'an praised both groups equally, showing Allah valued sincere faith and sacrifice over lineage or tribal status.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ™Ÿéÿ®ŸéŸàŸéŸëÿ°ŸèŸàÿß ÿßŸÑÿØŸéŸëÿßÿ±Ÿé ŸàŸéÿßŸÑŸíÿ•ŸêŸäŸÖŸéÿßŸÜŸé ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸáŸêŸÖŸí ŸäŸèÿ≠Ÿêÿ®ŸèŸëŸàŸÜŸé ŸÖŸéŸÜŸí ŸáŸéÿßÿ¨Ÿéÿ±Ÿé ÿ•ŸêŸÑŸéŸäŸíŸáŸêŸÖŸí ŸàŸéŸÑŸéÿß ŸäŸéÿ¨ŸêÿØŸèŸàŸÜŸé ŸÅŸêŸä ÿµŸèÿØŸèŸàÿ±ŸêŸáŸêŸÖŸí ÿ≠Ÿéÿßÿ¨Ÿéÿ©Ÿã ŸÖŸêŸëŸÖŸéŸëÿß ÿ£ŸèŸàÿ™ŸèŸàÿß ŸàŸéŸäŸèÿ§Ÿíÿ´Ÿêÿ±ŸèŸàŸÜŸé ÿπŸéŸÑŸéŸâŸ∞ ÿ£ŸéŸÜŸÅŸèÿ≥ŸêŸáŸêŸÖŸí ŸàŸéŸÑŸéŸàŸí ŸÉŸéÿßŸÜŸé ÿ®ŸêŸáŸêŸÖŸí ÿÆŸéÿµŸéÿßÿµŸéÿ©Ÿå\",\n      translation: \"And those who were settled in the Home and faith before them love those who emigrated to them and find not any want in their breasts of what they were given but give them preference over themselves, even though they are in privation.\",\n      source: \"Qur'an 59:9\"\n    },\n    keyLesson: \"True Islamic brotherhood means selfless sharing and putting others' needs before personal comfort.\",\n    quizId: 44\n  },\n\n  {\n    id: 45,\n    title: \"The Constitution of Madinah\",\n    description: [\n      \"The Prophet Ô∑∫ established a written constitution governing Madinah's diverse population. This document defined rights, responsibilities, and rules for Muslims, Jews, and other groups, creating a pluralistic society based on justice and mutual respect among different communities.\",\n      \"The constitution established religious freedom, mutual defense, and peaceful coexistence. It prohibited treachery, ensured justice for all, and made the Prophet Ô∑∫ the final arbiter in disputes. This was perhaps history's first written constitution establishing structured governance and civil rights.\",\n      \"Non-Muslims were protected and given rights unprecedented in that era. This document showed Islam's commitment to justice and peace. It proved that Islamic governance could include diversity while maintaining clear principles, protecting minorities, and establishing order fairly.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ŸÉŸèŸàŸÜŸèŸàÿß ŸÇŸéŸàŸéŸëÿßŸÖŸêŸäŸÜŸé ŸÑŸêŸÑŸéŸëŸáŸê ÿ¥ŸèŸáŸéÿØŸéÿßÿ°Ÿé ÿ®ŸêÿßŸÑŸíŸÇŸêÿ≥Ÿíÿ∑Ÿê\",\n      translation: \"O you who have believed, be persistently standing firm for Allah, witnesses in justice.\",\n      source: \"Qur'an 5:8\"\n    },\n    keyLesson: \"Islamic governance ensures justice for all people regardless of religion, establishing rights and protecting minorities.\",\n    quizId: 45\n  },\n\n  {\n    id: 46,\n    title: \"Change of Qiblah\",\n    description: [\n      \"For sixteen or seventeen months, Muslims prayed facing Jerusalem. The Prophet Ô∑∫ wished to face the Ka'bah, the house built by Prophet Ibrahim. He looked to the sky, waiting for Allah's command regarding the direction of prayer.\",\n      \"During a congregational prayer, revelation came commanding Muslims to turn toward the Ka'bah in Makkah. Mid-prayer, the Prophet Ô∑∫ turned from Jerusalem toward Makkah. The congregation followed, completing their prayer facing the new Qiblah direction immediately and obediently.\",\n      \"This change tested obedience and showed Islam's independence. It connected Muslims to Ibrahim's legacy and distinguished their identity. The mosque where this occurred was named Masjid al-Qiblatayn‚Äîthe Mosque of Two Qiblahs‚Äîcommemorating this significant moment in Islamic history.\"\n    ],\n    evidence: {\n      arabic: \"ŸÅŸéŸàŸéŸÑŸêŸë ŸàŸéÿ¨ŸíŸáŸéŸÉŸé ÿ¥Ÿéÿ∑Ÿíÿ±Ÿé ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸê ÿßŸÑŸíÿ≠Ÿéÿ±ŸéÿßŸÖŸê €ö ŸàŸéÿ≠ŸéŸäŸíÿ´Ÿè ŸÖŸéÿß ŸÉŸèŸÜÿ™ŸèŸÖŸí ŸÅŸéŸàŸéŸÑŸèŸëŸàÿß ŸàŸèÿ¨ŸèŸàŸáŸéŸÉŸèŸÖŸí ÿ¥Ÿéÿ∑Ÿíÿ±ŸéŸáŸè\",\n      translation: \"So turn your face toward al-Masjid al-Haram. And wherever you are, turn your faces toward it.\",\n      source: \"Qur'an 2:144\"\n    },\n    keyLesson: \"Complete obedience to Allah's commands, even when they change, shows true submission and faith.\",\n    quizId: 46\n  },\n\n  {\n    id: 47,\n    title: \"Early Expeditions and Raids\",\n    description: [\n      \"Muslims began small military expeditions to gather intelligence, show strength, and pressure Quraysh economically. These early raids targeted Makkan trade caravans, disrupting their commerce and demonstrating that Muslims weren't weak refugees but an organized force.\",\n      \"These expeditions served multiple purposes: military training, building confidence, establishing presence, and putting economic pressure on Quraysh. Most expeditions returned without fighting, but they sent clear message that Muslims could defend themselves and strike back when necessary.\",\n      \"The Prophet Ô∑∫ personally led some expeditions and sent commanders for others. This prepared Muslims mentally and physically for eventual major confrontations. It also taught strategic thinking, discipline, and courage to companions who had only defensive experience in Makkah.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéÿπŸêÿØŸèŸëŸàÿß ŸÑŸéŸáŸèŸÖ ŸÖŸéŸëÿß ÿßÿ≥Ÿíÿ™Ÿéÿ∑ŸéÿπŸíÿ™ŸèŸÖ ŸÖŸêŸëŸÜ ŸÇŸèŸàŸéŸëÿ©Ÿç\",\n      translation: \"And prepare against them whatever you are able of power.\",\n      source: \"Qur'an 8:60\"\n    },\n    keyLesson: \"Preparation and strategic action are necessary for protecting the Muslim community from aggression.\",\n    quizId: 47\n  },\n\n  {\n    id: 48,\n    title: \"Abu Sufyan's Caravan\",\n    description: [\n      \"Abu Sufyan led a massive Quraysh trade caravan returning from Syria with enormous wealth. The Prophet Ô∑∫ learned about it and called Muslims to intercept this caravan, hoping to weaken Quraysh economically and compensate Muslims for confiscated Makkan property.\",\n      \"Abu Sufyan, clever and cautious, sensed danger. He changed the route, sent urgent messengers to Makkah requesting military protection, and moved swiftly along the coast. His quick thinking and intelligence gathering allowed him to narrowly escape Muslim interception successfully.\",\n      \"Though the caravan escaped, Quraysh mobilized their entire army to protect it. They decided to march to Badr to show power and intimidate Muslims even though the caravan was safe. This arrogant decision led to the historic Battle of Badr soon after.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•Ÿêÿ∞Ÿí ŸäŸéÿπŸêÿØŸèŸÉŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸè ÿ•Ÿêÿ≠ŸíÿØŸéŸâ ÿßŸÑÿ∑ŸéŸëÿßÿ¶ŸêŸÅŸéÿ™ŸéŸäŸíŸÜŸê ÿ£ŸéŸÜŸéŸëŸáŸéÿß ŸÑŸéŸÉŸèŸÖŸí\",\n      translation: \"And when Allah promised you one of the two groups, that it would be yours.\",\n      source: \"Qur'an 8:7\"\n    },\n    keyLesson: \"Allah's plans are perfect; even when immediate goals fail, greater victories often follow.\",\n    quizId: 48\n  },\n\n  {\n    id: 49,\n    title: \"Battle of Badr Begins\",\n    description: [\n      \"Quraysh's army of over one thousand well-equipped warriors marched toward Badr despite the caravan's safe escape. They wanted to crush Muslims permanently. The Prophet Ô∑∫ had only three hundred thirteen poorly equipped believers, mostly volunteers with limited battle experience.\",\n      \"The Prophet Ô∑∫ consulted his companions before battle. Abu Bakr, Umar, and Miqdad spoke encouragingly. Then Sa'd ibn Mu'adh, representing the Ansar, pledged total support: 'By Allah, if you ordered us to plunge into the sea, we would do it.'\",\n      \"The Muslims positioned themselves near water wells strategically. The Prophet Ô∑∫ built a shelter and spent the night in intense prayer, pleading with Allah: 'O Allah, if this small group is destroyed today, You will not be worshipped on earth.'\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿí ÿ™Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸêŸäÿ´ŸèŸàŸÜŸé ÿ±Ÿéÿ®ŸéŸëŸÉŸèŸÖŸí ŸÅŸéÿßÿ≥Ÿíÿ™Ÿéÿ¨Ÿéÿßÿ®Ÿé ŸÑŸéŸÉŸèŸÖŸí ÿ£ŸéŸÜŸêŸëŸä ŸÖŸèŸÖŸêÿØŸèŸëŸÉŸèŸÖ ÿ®Ÿêÿ£ŸéŸÑŸíŸÅŸç ŸÖŸêŸëŸÜŸé ÿßŸÑŸíŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ©Ÿê ŸÖŸèÿ±ŸíÿØŸêŸÅŸêŸäŸÜŸé\",\n      translation: \"When you asked help of your Lord, and He answered you, 'Indeed, I will reinforce you with a thousand from the angels, following one another.'\",\n      source: \"Qur'an 8:9\"\n    },\n    keyLesson: \"Trust in Allah and sincere du'a before facing overwhelming challenges brings divine support.\",\n    quizId: 49\n  },\n\n  {\n    id: 50,\n    title: \"Victory at Badr\",\n    description: [\n      \"Battle began with individual duels. Hamzah, Ali, and Ubaydah fought Quraysh champions and defeated them. Then armies clashed. Angels descended to fight alongside Muslims. Allah sent rain to settle dust, firm sand, and fill Muslims with tranquility and strength.\",\n      \"Despite being outnumbered three-to-one, Muslims fought with extraordinary courage and divine assistance. Key Quraysh leaders were killed, including Abu Jahl, Umayyah ibn Khalaf, and Utbah. Seventy Quraysh warriors died, and seventy were captured as prisoners.\",\n      \"Muslims lost only fourteen martyrs. The impossible victory shook Arabia. It proved Allah supported His messenger and that faith could overcome material superiority. Badr became the criterion separating truth from falsehood, believers from hypocrites, forever changing Islam's status in Arabia.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéŸÇŸéÿØŸí ŸÜŸéÿµŸéÿ±ŸéŸÉŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸè ÿ®Ÿêÿ®ŸéÿØŸíÿ±Ÿç ŸàŸéÿ£ŸéŸÜÿ™ŸèŸÖŸí ÿ£Ÿéÿ∞ŸêŸÑŸéŸëÿ©Ÿå\",\n      translation: \"And already Allah had given you victory at Badr while you were few.\",\n      source: \"Qur'an 3:123\"\n    },\n    keyLesson: \"Victory comes from Allah, not numbers or equipment; faith and sincerity outweigh worldly power.\",\n    quizId: 50\n  },\n\n  {\n    id: 51,\n    title: \"Treatment of Prisoners\",\n    description: [\n      \"Muslims captured seventy Quraysh warriors. The Prophet Ô∑∫ consulted companions about their fate. Abu Bakr suggested ransom, allowing families to retrieve prisoners. Umar suggested execution, as these men had tortured Muslims. The Prophet Ô∑∫ chose mercy and accepted ransom.\",\n      \"Prisoners were treated humanely. Muslims gave them food before eating themselves. Poor prisoners who could teach ten Muslims to read were freed without ransom. This educational exchange spread literacy and showed Islam valued knowledge even from enemies.\",\n      \"Allah revealed verses suggesting Umar's opinion was strategically wiser. However, the Prophet's Ô∑∫ mercy demonstrated Islam's compassionate nature. This incident taught balance between justice and mercy, showing that kindness toward enemies can sometimes transform hearts more effectively than harshness.\"\n    ],\n    evidence: {\n      arabic: \"ŸÖŸéÿß ŸÉŸéÿßŸÜŸé ŸÑŸêŸÜŸéÿ®ŸêŸäŸçŸë ÿ£ŸéŸÜ ŸäŸéŸÉŸèŸàŸÜŸé ŸÑŸéŸáŸè ÿ£Ÿéÿ≥Ÿíÿ±ŸéŸâŸ∞ ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ŸäŸèÿ´ŸíÿÆŸêŸÜŸé ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê\",\n      translation: \"It is not for a prophet to have captives until he inflicts a massacre upon the earth.\",\n      source: \"Qur'an 8:67\"\n    },\n    keyLesson: \"Mercy toward enemies can be strategic while acknowledging justice sometimes requires firmness.\",\n    quizId: 51\n  },\n\n  {\n    id: 52,\n    title: \"After Badr - Growing Strength\",\n    description: [\n      \"Badr's victory transformed Muslims' status in Arabia. Tribes that ignored them now sought alliances. Fear of Muslim power spread throughout the peninsula. The small persecuted community was now a force demanding respect and consideration from all surrounding tribes.\",\n      \"Quraysh grieved their dead and vowed revenge. They prohibited mourning publicly to hide their pain and weakness. Abu Sufyan swore not to bathe until avenging Badr's defeat. The stage was set for continued conflict between Makkah and Madinah for years to come.\",\n      \"Muslims grew stronger militarily and politically. More revelations came, establishing laws, refining worship, and guiding the growing community. Islam was no longer just a faith but a complete system of life with political power, military capability, and social structure.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸèÿ±ŸêŸäÿØŸèŸàŸÜŸé ÿ£ŸéŸÜ ŸäŸèÿ∑ŸíŸÅŸêÿ¶ŸèŸàÿß ŸÜŸèŸàÿ±Ÿé ÿßŸÑŸÑŸéŸëŸáŸê ÿ®Ÿêÿ£ŸéŸÅŸíŸàŸéÿßŸáŸêŸáŸêŸÖŸí ŸàŸéŸäŸéÿ£Ÿíÿ®ŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸè ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜ ŸäŸèÿ™ŸêŸÖŸéŸë ŸÜŸèŸàÿ±ŸéŸáŸè\",\n      translation: \"They want to extinguish the light of Allah with their mouths, but Allah refuses except to perfect His light.\",\n      source: \"Qur'an 9:32\"\n    },\n    keyLesson: \"Allah's religion will prevail despite opposition; initial victories strengthen believers' resolve and faith.\",\n    quizId: 52\n  },\n\n  {\n    id: 53,\n    title: \"Preparations for Uhud\",\n    description: [\n      \"Quraysh prepared for revenge after Badr's humiliation. They mobilized three thousand warriors with cavalry, armor, and determination. Abu Sufyan led them toward Madinah, seeking to crush Muslims and restore Quraysh honor before all Arabia witnessed their weakness.\",\n      \"The Prophet Ô∑∫ initially planned to defend within Madinah using its fortifications strategically. But young Muslims eager for battle, especially those who missed Badr, pressured for open confrontation. Against his better judgment, the Prophet Ô∑∫ agreed to meet Quraysh outside the city.\",\n      \"Muslims marched out with one thousand men. However, the hypocrite Abdullah ibn Ubayy withdrew with three hundred followers, weakening Muslim forces significantly before battle even began. This betrayal left only seven hundred Muslims facing three thousand battle-hardened Quraysh warriors seeking revenge.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ¥ŸéÿßŸàŸêÿ±ŸíŸáŸèŸÖŸí ŸÅŸêŸä ÿßŸÑŸíÿ£ŸéŸÖŸíÿ±Ÿê €ñ ŸÅŸéÿ•Ÿêÿ∞Ÿéÿß ÿπŸéÿ≤ŸéŸÖŸíÿ™Ÿé ŸÅŸéÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸí ÿπŸéŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê\",\n      translation: \"And consult them in the matter. And when you have decided, then rely upon Allah.\",\n      source: \"Qur'an 3:159\"\n    },\n    keyLesson: \"Leaders should consult others but ultimately decide and trust Allah's plan completely.\",\n    quizId: 53\n  },\n\n  {\n    id: 54,\n    title: \"Battle of Uhud Begins\",\n    description: [\n      \"The Prophet Ô∑∫ positioned fifty archers on a mountain pass with strict orders: 'Do not leave this position regardless of what happens, even if you see birds eating our flesh. Protect our backs from cavalry.' This strategic position was crucial for Muslim victory.\",\n      \"Battle began with Quraysh sending their best warriors. Hamzah, Ali, and other companions fought brilliantly. Muslims were winning decisively. Quraysh lines broke, and their army began retreating in panic. Victory seemed certain. The battlefield filled with abandoned Quraysh equipment and weapons.\",\n      \"Seeing Quraysh fleeing, most archers disobeyed orders and left their posts to collect spoils of war. Their commander warned them, but they ignored him. Only a handful remained at their position, leaving Muslim backs vulnerable to cavalry attack from Khalid ibn Walid who still fought for Quraysh.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéŸÇŸéÿØŸí ÿµŸéÿØŸéŸÇŸéŸÉŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéÿπŸíÿØŸéŸáŸè ÿ•Ÿêÿ∞Ÿí ÿ™Ÿéÿ≠Ÿèÿ≥ŸèŸëŸàŸÜŸéŸáŸèŸÖ ÿ®Ÿêÿ•Ÿêÿ∞ŸíŸÜŸêŸáŸê €ñ ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ÿ•Ÿêÿ∞Ÿéÿß ŸÅŸéÿ¥ŸêŸÑŸíÿ™ŸèŸÖŸí ŸàŸéÿ™ŸéŸÜŸéÿßÿ≤ŸéÿπŸíÿ™ŸèŸÖŸí ŸÅŸêŸä ÿßŸÑŸíÿ£ŸéŸÖŸíÿ±Ÿê ŸàŸéÿπŸéÿµŸéŸäŸíÿ™ŸèŸÖ\",\n      translation: \"And Allah had certainly fulfilled His promise to you when you were killing them by His permission until you lost courage and disputed about the order and disobeyed.\",\n      source: \"Qur'an 3:152\"\n    },\n    keyLesson: \"Disobeying commands and seeking worldly gains can turn victory into defeat quickly.\",\n    quizId: 54\n  },\n\n  {\n    id: 55,\n    title: \"The Tide Turns\",\n    description: [\n      \"Khalid ibn Walid saw the archers' post abandoned. He led cavalry around the mountain, attacking Muslims from behind. Complete chaos erupted. Muslims were surrounded, confused, fighting on two fronts. The certain victory transformed into near-disaster within moments.\",\n      \"Rumors spread that the Prophet Ô∑∫ was killed. Many Muslims lost heart and stopped fighting. The Prophet Ô∑∫ was injured, his tooth broken, face bleeding. But he remained steadfast, calling Muslims to regroup. A small group of brave companions surrounded him, protecting him with their lives.\",\n      \"Hamzah was martyred, along with seventy companions. The Prophet's Ô∑∫ uncle, Islam's lion, was killed and mutilated by Hind. Despite personal grief, the Prophet Ô∑∫ led the surviving Muslims safely back to Madinah. Uhud was a painful loss after Badr's triumph and clear divine victory.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéÿß ÿ™ŸéŸáŸêŸÜŸèŸàÿß ŸàŸéŸÑŸéÿß ÿ™Ÿéÿ≠Ÿíÿ≤ŸéŸÜŸèŸàÿß ŸàŸéÿ£ŸéŸÜÿ™ŸèŸÖŸè ÿßŸÑŸíÿ£ŸéÿπŸíŸÑŸéŸàŸíŸÜŸé ÿ•ŸêŸÜ ŸÉŸèŸÜÿ™ŸèŸÖ ŸÖŸèŸëÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé\",\n      translation: \"So do not weaken and do not grieve, and you will be superior if you are believers.\",\n      source: \"Qur'an 3:139\"\n    },\n    keyLesson: \"Even the most faithful face setbacks; how we respond to defeat determines our ultimate success.\",\n    quizId: 55\n  },\n\n  {\n    id: 56,\n    title: \"Lessons from Uhud\",\n    description: [\n      \"Uhud taught painful lessons. Victory comes only from Allah, not human strength or numbers. Disobeying clear commands, even with good intentions, leads to disaster. Greed for material wealth can destroy spiritual success. These lessons were costly but essential for Muslims' growth and development.\",\n      \"The Qur'an revealed that Uhud was a test distinguishing true believers from hypocrites. It humbled Muslims after Badr's pride. It taught them that faith requires constant obedience, discipline, and trust in Allah's wisdom, not just bravery. Setbacks refine character more effectively than easy victories.\",\n      \"Despite defeat, Uhud showed remarkable courage. When the Prophet Ô∑∫ called the next day for volunteers to pursue Quraysh, the same wounded, tired believers immediately responded. Their resilience proved that true faith doesn't collapse from one setback but grows stronger through adversity and trials.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜ ŸäŸéŸÖŸíÿ≥Ÿéÿ≥ŸíŸÉŸèŸÖŸí ŸÇŸéÿ±Ÿíÿ≠Ÿå ŸÅŸéŸÇŸéÿØŸí ŸÖŸéÿ≥ŸéŸë ÿßŸÑŸíŸÇŸéŸàŸíŸÖŸé ŸÇŸéÿ±Ÿíÿ≠Ÿå ŸÖŸêŸëÿ´ŸíŸÑŸèŸáŸè €ö ŸàŸéÿ™ŸêŸÑŸíŸÉŸé ÿßŸÑŸíÿ£ŸéŸäŸéŸëÿßŸÖŸè ŸÜŸèÿØŸéÿßŸàŸêŸÑŸèŸáŸéÿß ÿ®ŸéŸäŸíŸÜŸé ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê\",\n      translation: \"If a wound should touch you, there has already touched the enemy a wound similar to it. And these days We alternate among the people.\",\n      source: \"Qur'an 3:140\"\n    },\n    keyLesson: \"Setbacks are tests that purify faith and teach valuable lessons unavailable through victory alone.\",\n    quizId: 56\n  },\n\n  {\n    id: 57,\n    title: \"Treachery of Banu Nadir\",\n    description: [\n      \"Banu Nadir, a Jewish tribe, had a treaty with Muslims. When the Prophet Ô∑∫ visited to discuss a matter, they plotted to drop a boulder on him from above, violating their agreement. Allah informed him of their treacherous plot, and he left immediately.\",\n      \"The Prophet Ô∑∫ gave them ten days to leave Madinah peacefully for breaking their treaty. The hypocrite leader Abdullah ibn Ubayy promised to support them if they stayed and fought. Trusting this promise, they refused to leave and prepared for siege inside their fortified settlements.\",\n      \"Muslims besieged their fortifications. Abdullah ibn Ubayy's promised help never came. After several days, Banu Nadir realized they were abandoned, negotiated safe exit, and left Madinah. This incident showed the consequences of treachery and importance of honoring agreements regardless of religion.\"\n    ],\n    evidence: {\n      arabic: \"ŸáŸèŸàŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£ŸéÿÆŸíÿ±Ÿéÿ¨Ÿé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéŸÅŸéÿ±ŸèŸàÿß ŸÖŸêŸÜŸí ÿ£ŸéŸáŸíŸÑŸê ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿê ŸÖŸêŸÜ ÿØŸêŸäŸéÿßÿ±ŸêŸáŸêŸÖŸí ŸÑŸêÿ£ŸéŸàŸéŸëŸÑŸê ÿßŸÑŸíÿ≠Ÿéÿ¥Ÿíÿ±Ÿê\",\n      translation: \"It is He who expelled the ones who disbelieved among the People of the Scripture from their homes at the first gathering.\",\n      source: \"Qur'an 59:2\"\n    },\n    keyLesson: \"Treachery and breaking agreements have serious consequences; trust must be honored regardless of circumstances.\",\n    quizId: 57\n  },\n\n  {\n    id: 58,\n    title: \"The Coalition Forms\",\n    description: [\n      \"After Uhud, Quraysh wanted to finish Muslims permanently. They formed an unprecedented alliance: Quraysh, Ghatafan, and other tribes united against Madinah. Exiled Banu Nadir leaders encouraged this coalition, promising support and resources for total annihilation of Muslims.\",\n      \"Ten thousand warriors marched toward Madinah‚Äîthe largest army Arabia had ever seen. Their goal was complete destruction. Muslims faced their most dangerous threat yet. The massive coalition represented nearly all of Arabia united against the small Muslim community.\",\n      \"News of this enormous army created fear in Madinah. Hypocrites claimed this was the end. Some Muslims wavered. But the Prophet Ô∑∫ remained calm, consulting companions about defense. Salman al-Farisi suggested a strategy unknown to Arabs: digging a trench around Madinah's vulnerable areas.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿí ÿ¨Ÿéÿßÿ°ŸèŸàŸÉŸèŸÖ ŸÖŸêŸëŸÜ ŸÅŸéŸàŸíŸÇŸêŸÉŸèŸÖŸí ŸàŸéŸÖŸêŸÜŸí ÿ£Ÿéÿ≥ŸíŸÅŸéŸÑŸé ŸÖŸêŸÜŸÉŸèŸÖŸí ŸàŸéÿ•Ÿêÿ∞Ÿí ÿ≤Ÿéÿßÿ∫Ÿéÿ™Ÿê ÿßŸÑŸíÿ£Ÿéÿ®ŸíÿµŸéÿßÿ±Ÿè ŸàŸéÿ®ŸéŸÑŸéÿ∫Ÿéÿ™Ÿê ÿßŸÑŸíŸÇŸèŸÑŸèŸàÿ®Ÿè ÿßŸÑŸíÿ≠ŸéŸÜŸéÿßÿ¨Ÿêÿ±Ÿé\",\n      translation: \"When they came at you from above you and from below you, and when eyes shifted and hearts reached the throats.\",\n      source: \"Qur'an 33:10\"\n    },\n    keyLesson: \"United enemies can be overwhelming, but faith and innovative strategies can overcome impossible odds.\",\n    quizId: 58\n  },\n\n  {\n    id: 59,\n    title: \"Digging the Trench\",\n    description: [\n      \"Muslims had only days to dig a massive trench before the coalition army arrived. Everyone worked desperately: men, women, and children. The Prophet Ô∑∫ worked alongside them, carrying dirt and stones, singing work songs to encourage them despite exhaustion and fear.\",\n      \"Food was scarce. The Prophet Ô∑∫ tied stones to his stomach to suppress hunger pangs. When a companion complained of hunger showing one stone tied to his belly, the Prophet Ô∑∫ showed two stones tied to his own stomach‚Äîsuffering more than anyone yet working harder than everyone.\",\n      \"During digging, they encountered massive boulders impossible to break. The Prophet Ô∑∫ struck them, and they shattered with sparks. He prophesied future conquests: Persia, Rome, Yemen. Companions saw light in those sparks. His optimism in dire circumstances kept morale high and hearts firm despite approaching danger.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸí ÿπŸéŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê €ö ŸàŸéŸÉŸéŸÅŸéŸâŸ∞ ÿ®ŸêÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéŸÉŸêŸäŸÑŸãÿß\",\n      translation: \"And rely upon Allah; and sufficient is Allah as Disposer of affairs.\",\n      source: \"Qur'an 33:3\"\n    },\n    keyLesson: \"Leaders who share hardships with followers inspire loyalty and perseverance through the darkest times.\",\n    quizId: 59\n  },\n\n  {\n    id: 60,\n    title: \"The Siege and Hardship\",\n    description: [\n      \"The coalition army arrived and found the trench‚Äîa strategy they'd never seen. They couldn't cross it. The siege began. For weeks, both sides faced off across the trench. Muslims endured cold, hunger, and fear. Hypocrites spread defeatism, claiming this was the end.\",\n      \"Muslims couldn't farm or trade. Supplies dwindled. They prayed in armor, ready for battle at any moment. The situation was desperate. The Qur'an described hearts reaching throats from fear. Yet true believers remained steadfast, trusting Allah's promise of victory against overwhelming odds.\",\n      \"Some coalition cavalry attempted to jump the trench. Ali killed their champion in single combat. These small victories boosted Muslim morale. But the siege continued. Madinah's survival depended on maintaining the trench defense and preventing the coalition from finding a way to cross it successfully.\"\n    ],\n    evidence: {\n      arabic: \"ŸáŸèŸÜŸéÿßŸÑŸêŸÉŸé ÿßÿ®Ÿíÿ™ŸèŸÑŸêŸäŸé ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸèŸàŸÜŸé ŸàŸéÿ≤ŸèŸÑŸíÿ≤ŸêŸÑŸèŸàÿß ÿ≤ŸêŸÑŸíÿ≤ŸéÿßŸÑŸãÿß ÿ¥ŸéÿØŸêŸäÿØŸãÿß\",\n      translation: \"There the believers were tested and shaken with a severe shaking.\",\n      source: \"Qur'an 33:11\"\n    },\n    keyLesson: \"Severe tests separate true believers from hypocrites; faith shines brightest during darkest trials.\",\n    quizId: 60\n  },\n\n  {\n    id: 61,\n    title: \"Banu Quraydhah's Betrayal\",\n    description: [\n      \"Banu Quraydhah, a Jewish tribe inside Madinah, had a treaty with Muslims. During the siege, they betrayed Muslims by allying with the coalition. This opened Madinah's undefended side, exposing Muslim families to attack from within while men defended the trench.\",\n      \"News of this betrayal shocked Muslims. The situation became catastrophic: enemies outside the trench, traitors inside the city. Women and children were vulnerable. The Prophet Ô∑∫ sent negotiators, but Banu Quraydhah refused reconciliation, demanding Muslim surrender or total destruction.\",\n      \"This was the darkest moment of the siege. Hypocrites said Islam was finished. But the Prophet Ô∑∫ remained calm, praying intensely. He knew only Allah could save them now. The believers' faith was tested to its absolute limit during this moment of complete vulnerability and desperation.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÑŸéŸÖŸéŸëÿß ÿ±Ÿéÿ£ŸéŸâ ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸèŸàŸÜŸé ÿßŸÑŸíÿ£Ÿéÿ≠Ÿíÿ≤Ÿéÿßÿ®Ÿé ŸÇŸéÿßŸÑŸèŸàÿß ŸáŸéŸ∞ÿ∞Ÿéÿß ŸÖŸéÿß ŸàŸéÿπŸéÿØŸéŸÜŸéÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéÿ±Ÿéÿ≥ŸèŸàŸÑŸèŸáŸè ŸàŸéÿµŸéÿØŸéŸÇŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéÿ±Ÿéÿ≥ŸèŸàŸÑŸèŸáŸè €ö ŸàŸéŸÖŸéÿß ÿ≤ŸéÿßÿØŸéŸáŸèŸÖŸí ÿ•ŸêŸÑŸéŸëÿß ÿ•ŸêŸäŸÖŸéÿßŸÜŸãÿß ŸàŸéÿ™Ÿéÿ≥ŸíŸÑŸêŸäŸÖŸãÿß\",\n      translation: \"And when the believers saw the companies, they said, 'This is what Allah and His Messenger had promised us, and Allah and His Messenger spoke the truth.' And it increased them only in faith and acceptance.\",\n      source: \"Qur'an 33:22\"\n    },\n    keyLesson: \"True believers' faith strengthens during trials that cause hypocrites and weak believers to despair.\",\n    quizId: 61\n  },\n\n  {\n    id: 62,\n    title: \"Divine Intervention - The Wind\",\n    description: [\n      \"The Prophet Ô∑∫ prayed desperately for Allah's help. That night, Allah sent a fierce, freezing wind that howled through the coalition camp. It uprooted tents, scattered fires, overturned cooking pots, and terrified horses. The wind created chaos and panic throughout the enemy camp.\",\n      \"Allah sent angels who spread fear into the coalition's hearts. They became suspicious of each other. Distrust grew between allies. The Muslim diplomat Nu'aym ibn Mas'ud cleverly increased this distrust, making tribes question each other's commitment and loyalty to the coalition cause.\",\n      \"Abu Sufyan, exhausted and demoralized, ordered retreat. The coalition dissolved in the night. When Muslims woke, the massive army had disappeared. Ten thousand warriors fled from Allah's wind and angels. Not a single Muslim died in this monthlong siege‚Äîa miracle of divine protection and strategic wisdom.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿßÿ∞ŸíŸÉŸèÿ±ŸèŸàÿß ŸÜŸêÿπŸíŸÖŸéÿ©Ÿé ÿßŸÑŸÑŸéŸëŸáŸê ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸí ÿ•Ÿêÿ∞Ÿí ÿ¨Ÿéÿßÿ°Ÿéÿ™ŸíŸÉŸèŸÖŸí ÿ¨ŸèŸÜŸèŸàÿØŸå ŸÅŸéÿ£Ÿéÿ±Ÿíÿ≥ŸéŸÑŸíŸÜŸéÿß ÿπŸéŸÑŸéŸäŸíŸáŸêŸÖŸí ÿ±ŸêŸäÿ≠Ÿãÿß ŸàŸéÿ¨ŸèŸÜŸèŸàÿØŸãÿß ŸÑŸéŸëŸÖŸí ÿ™Ÿéÿ±ŸéŸàŸíŸáŸéÿß\",\n      translation: \"O you who have believed, remember the favor of Allah upon you when armies came to attack you and We sent upon them a wind and armies you did not see.\",\n      source: \"Qur'an 33:9\"\n    },\n    keyLesson: \"When believers do their best and turn to Allah sincerely, He sends help in miraculous ways.\",\n    quizId: 62\n  },\n\n  {\n    id: 63,\n    title: \"The Coalition Retreats\",\n    description: [\n      \"The coalition's collapse was complete. Tribes fled separately, blaming each other for failure. The greatest military threat Muslims ever faced dissolved without major battle. Allah had defended His believers when all seemed lost through wind, angels, and psychological warfare among enemies.\",\n      \"The Prophet Ô∑∫ declared that after this, Muslims would take the offensive. Quraysh would no longer attack Madinah; Muslims would pressure Makkah. This marked a turning point. From this moment, Islam's enemies were on defensive while Muslims began expanding influence throughout Arabia systematically.\",\n      \"The Battle of the Trench proved that faith, strategic thinking, and divine help could overcome any material superiority. Muslims learned that Allah's support comes after human effort. Their patience during the month-long siege earned them miraculous victory and permanent freedom from Quraysh aggression.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ±ŸéÿØŸéŸë ÿßŸÑŸÑŸéŸëŸáŸè ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸÉŸéŸÅŸéÿ±ŸèŸàÿß ÿ®Ÿêÿ∫ŸéŸäŸíÿ∏ŸêŸáŸêŸÖŸí ŸÑŸéŸÖŸí ŸäŸéŸÜŸéÿßŸÑŸèŸàÿß ÿÆŸéŸäŸíÿ±Ÿãÿß €ö ŸàŸéŸÉŸéŸÅŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸè ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ÿßŸÑŸíŸÇŸêÿ™ŸéÿßŸÑŸé\",\n      translation: \"And Allah repelled those who disbelieved, in their rage, not having obtained any good. And sufficient was Allah for the believers in battle.\",\n      source: \"Qur'an 33:25\"\n    },\n    keyLesson: \"After the greatest test, Allah grants the greatest victory; patience through hardship leads to ultimate triumph.\",\n    quizId: 63\n  },\n\n  {\n    id: 64,\n    title: \"Judgment on Banu Quraydhah\",\n    description: [\n      \"After the coalition fled, Muslims immediately addressed Banu Quraydhah's treachery. The tribe that betrayed Muslims during their most vulnerable moment had to face consequences. The Prophet Ô∑∫ besieged their fortifications for twenty-five days until they surrendered unconditionally, seeking mercy.\",\n      \"Banu Quraydhah requested that Sa'd ibn Mu'adh, their former ally from the Ansar, judge their case. They hoped for leniency from their old friend. The Prophet Ô∑∫ accepted this request, showing fairness by letting their chosen judge decide their fate according to law.\",\n      \"Sa'd, mortally wounded during the Trench siege, ruled according to their own Torah's law for treason during war: execution of fighters, enslavement of families. His judgment was harsh but just by their own religious standards. The Prophet Ô∑∫ confirmed this ruling, and it was carried out completely.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ£ŸéŸÜÿ≤ŸéŸÑŸé ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ∏ŸéÿßŸáŸéÿ±ŸèŸàŸáŸèŸÖ ŸÖŸêŸëŸÜŸí ÿ£ŸéŸáŸíŸÑŸê ÿßŸÑŸíŸÉŸêÿ™Ÿéÿßÿ®Ÿê ŸÖŸêŸÜ ÿµŸéŸäŸéÿßÿµŸêŸäŸáŸêŸÖŸí ŸàŸéŸÇŸéÿ∞ŸéŸÅŸé ŸÅŸêŸä ŸÇŸèŸÑŸèŸàÿ®ŸêŸáŸêŸÖŸè ÿßŸÑÿ±ŸèŸëÿπŸíÿ®Ÿé ŸÅŸéÿ±ŸêŸäŸÇŸãÿß ÿ™ŸéŸÇŸíÿ™ŸèŸÑŸèŸàŸÜŸé ŸàŸéÿ™Ÿéÿ£Ÿíÿ≥Ÿêÿ±ŸèŸàŸÜŸé ŸÅŸéÿ±ŸêŸäŸÇŸãÿß\",\n      translation: \"And He brought down those who supported them among the People of the Scripture from their fortresses and cast terror into their hearts, so you killed a party and took captive a party.\",\n      source: \"Qur'an 33:26\"\n    },\n    keyLesson: \"Treachery and betrayal during critical moments have severe consequences; justice must be maintained.\",\n    quizId: 64\n  },\n\n  {\n    id: 65,\n    title: \"Journey to Hudaybiyyah\",\n    description: [\n      \"Six years after Hijrah, the Prophet Ô∑∫ had a dream of performing Umrah in Makkah. He prepared fourteen hundred Muslims for pilgrimage, taking sacrificial animals and wearing ihram to show peaceful intentions. They carried no weapons except travelers' swords, demonstrating non-aggressive pilgrimage purpose.\",\n      \"Quraysh heard about the Muslim approach and panicked. They sent cavalry to stop them, refusing to allow Muslims into Makkah despite Arab tradition of allowing all pilgrims access to Ka'bah. This denial violated sacred customs that even enemies traditionally respected during pilgrimage months.\",\n      \"The Prophet Ô∑∫ avoided confrontation by changing route. He camped at Hudaybiyyah on Makkah's boundary. His camel, Qaswa, sat down and refused to move. The Prophet Ô∑∫ said she was commanded by Allah to stop here. This spot would witness negotiations that changed Islam's future trajectory forever.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸÇŸéÿØŸí ÿµŸéÿØŸéŸÇŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ±Ÿéÿ≥ŸèŸàŸÑŸéŸáŸè ÿßŸÑÿ±ŸèŸëÿ§ŸíŸäŸéÿß ÿ®ŸêÿßŸÑŸíÿ≠ŸéŸÇŸêŸë €ñ ŸÑŸéÿ™ŸéÿØŸíÿÆŸèŸÑŸèŸÜŸéŸë ÿßŸÑŸíŸÖŸéÿ≥Ÿíÿ¨ŸêÿØŸé ÿßŸÑŸíÿ≠Ÿéÿ±ŸéÿßŸÖŸé ÿ•ŸêŸÜ ÿ¥Ÿéÿßÿ°Ÿé ÿßŸÑŸÑŸéŸëŸáŸè ÿ¢ŸÖŸêŸÜŸêŸäŸÜŸé\",\n      translation: \"Certainly Allah will fulfill the vision for His Messenger in truth. You will surely enter al-Masjid al-Haram, if Allah wills, in safety.\",\n      source: \"Qur'an 48:27\"\n    },\n    keyLesson: \"Sometimes Allah's wisdom requires patience before dreams are fulfilled; trust the timing of divine plans.\",\n    quizId: 65\n  },\n\n  {\n    id: 66,\n    title: \"Negotiations at Hudaybiyyah\",\n    description: [\n      \"Quraysh sent negotiators. Suhay ibn Amr came with demands. After long discussions, they proposed a treaty: Muslims return this year without Umrah, come next year for three days only, ten-year peace, Muslims return any Makkan who escapes to Madinah without guardian permission.\",\n      \"The terms seemed heavily favoring Quraysh. Many companions, especially Umar, felt humiliated. These conditions appeared to diminish Muslims after their growing strength. The Prophet Ô∑∫ remained calm, seeing long-term benefits invisible to others, trusting Allah's wisdom beyond immediate appearances and emotions.\",\n      \"When Suhay's son Abu Jandal escaped torture and reached camp in chains, begging for protection, the treaty required his return to Quraysh. This heartbreaking moment tested Muslims' obedience. Despite personal anguish, they submitted to the agreement, trusting the Prophet's Ô∑∫ judgment and Allah's greater plan.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ŸÅŸéÿ™Ÿéÿ≠ŸíŸÜŸéÿß ŸÑŸéŸÉŸé ŸÅŸéÿ™Ÿíÿ≠Ÿãÿß ŸÖŸèŸëÿ®ŸêŸäŸÜŸãÿß\",\n      translation: \"Indeed, We have given you a clear conquest.\",\n      source: \"Qur'an 48:1\"\n    },\n    keyLesson: \"Apparent setbacks can be hidden victories; trust leadership's wisdom even when logic suggests otherwise.\",\n    quizId: 66\n  },\n\n  {\n    id: 67,\n    title: \"The Pledge of Ridwan\",\n    description: [\n      \"During negotiations, Uthman was sent to Quraysh as envoy. Rumors spread that he was killed. The Prophet Ô∑∫ sat under a tree and called Muslims to pledge loyalty unto death. Every single person pledged without hesitation. This pledge is called Bay'ah al-Ridwan‚Äîthe Pledge of Allah's Pleasure.\",\n      \"The companions' willingness to fight and die showed absolute loyalty to the Prophet Ô∑∫. They would sacrifice everything rather than allow his messenger's humiliation or harm. Allah was pleased with this sincere pledge, and all fourteen hundred who pledged were guaranteed Paradise for their unwavering devotion.\",\n      \"Shortly after, Uthman returned safely. The tension dissolved, but the pledge's significance remained. It demonstrated the unbreakable bond between the Prophet Ô∑∫ and his companions. Their willingness to face impossible odds for honor and faith proved the strength of true Islamic brotherhood and complete submission.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸëŸÇŸéÿØŸí ÿ±Ÿéÿ∂ŸêŸäŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿπŸéŸÜŸê ÿßŸÑŸíŸÖŸèÿ§ŸíŸÖŸêŸÜŸêŸäŸÜŸé ÿ•Ÿêÿ∞Ÿí ŸäŸèÿ®ŸéÿßŸäŸêÿπŸèŸàŸÜŸéŸÉŸé ÿ™Ÿéÿ≠Ÿíÿ™Ÿé ÿßŸÑÿ¥ŸéŸëÿ¨Ÿéÿ±Ÿéÿ©Ÿê\",\n      translation: \"Certainly was Allah pleased with the believers when they pledged allegiance to you under the tree.\",\n      source: \"Qur'an 48:18\"\n    },\n    keyLesson: \"Absolute loyalty to Allah's messenger in the face of death earns Allah's eternal pleasure.\",\n    quizId: 67\n  },\n\n  {\n    id: 68,\n    title: \"Signing the Treaty\",\n    description: [\n      \"The treaty was written. When the scribe wrote 'Muhammad Ô∑∫, Messenger of Allah,' Suhay objected, refusing to acknowledge prophethood. The Prophet Ô∑∫ told Ali to erase it and write 'Muhammad Ô∑∫ son of Abdullah' instead. Ali refused emotionally. The Prophet Ô∑∫ erased it himself‚Äîa lesson in humility.\",\n      \"This treaty seemed like defeat but was actually a brilliant victory. The ten-year peace allowed Islam to spread without war. Tribes observed Muslims safely. Many converted. Within two years, Islam grew more than the previous twenty years combined, proving the treaty's wisdom beyond initial appearance.\",\n      \"The Qur'an called Hudaybiyyah a 'clear victory.' Companions didn't understand initially, but time proved Allah's wisdom. Sometimes apparent humiliation serves greater purposes. Patience and trust in divine planning leads to outcomes beyond human strategic thinking and immediate emotional reactions to disappointing circumstances.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•ŸêŸÜŸéŸëÿß ŸÅŸéÿ™Ÿéÿ≠ŸíŸÜŸéÿß ŸÑŸéŸÉŸé ŸÅŸéÿ™Ÿíÿ≠Ÿãÿß ŸÖŸèŸëÿ®ŸêŸäŸÜŸãÿß\",\n      translation: \"Indeed, We have given you a clear conquest.\",\n      source: \"Qur'an 48:1\"\n    },\n    keyLesson: \"Wisdom sometimes requires sacrificing pride for long-term benefit; trust divine timing over immediate gratification.\",\n    quizId: 68\n  },\n\n  {\n    id: 69,\n    title: \"Letters to Kings and Emperors\",\n    description: [\n      \"After Hudaybiyyah's peace, the Prophet Ô∑∫ sent letters inviting world rulers to Islam: Byzantine Emperor Heraclius, Persian Emperor Khosrow, Egyptian Muqawqis, Abyssinian Negus, and other kings. These letters called them to worship Allah alone and accept Islam for salvation.\",\n      \"These letters demonstrated Islam's universal message. The Prophet Ô∑∫ wasn't just a local leader but Allah's messenger to all humanity. Some rulers responded respectfully; others tore the letters angrily. Negus of Abyssinia secretly accepted Islam. Emperor Heraclius considered it seriously but chose worldly power over truth.\",\n      \"Khosrow of Persia arrogantly tore the letter and commanded his governor in Yemen to capture Muhammad Ô∑∫. The Prophet Ô∑∫ prophesied Khosrow's kingdom would be torn as he tore the letter. Years later, Persia fell to Muslim armies, and the prophecy was fulfilled completely and precisely.\"\n    ],\n    evidence: {\n      arabic: \"ŸÇŸèŸÑŸí ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿè ÿ•ŸêŸÜŸêŸëŸä ÿ±Ÿéÿ≥ŸèŸàŸÑŸè ÿßŸÑŸÑŸéŸëŸáŸê ÿ•ŸêŸÑŸéŸäŸíŸÉŸèŸÖŸí ÿ¨ŸéŸÖŸêŸäÿπŸãÿß\",\n      translation: \"Say, 'O mankind, indeed I am the Messenger of Allah to you all.'\",\n      source: \"Qur'an 7:158\"\n    },\n    keyLesson: \"Islam's message is universal; calling all humanity to truth is every Muslim's responsibility.\",\n    quizId: 69\n  },\n\n  {\n    id: 70,\n    title: \"Battle of Khaybar\",\n    description: [\n      \"Khaybar was a fortified Jewish settlement where Banu Nadir leaders settled after expulsion from Madinah. They continuously plotted against Muslims, instigated the Coalition, and spread hostility. After Hudaybiyyah, the Prophet Ô∑∫ marched to eliminate this threat permanently with strategic military force.\",\n      \"Khaybar had eight fortresses with strong defenses. Muslims besieged each fortress systematically. Ali was given the banner and opened the main fortress gate, which normally required multiple men. He used it as a shield in battle‚Äîa display of extraordinary strength blessed by Allah for this righteous cause.\",\n      \"After weeks of siege, Khaybar surrendered. The treaty allowed Jews to remain, farming land and paying half their produce as tax. This arrangement brought peace, provided Muslims with resources, and showed Islamic governance's fairness toward non-Muslims living under Islamic authority and protection.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿπŸéÿØŸéŸÉŸèŸÖŸè ÿßŸÑŸÑŸéŸëŸáŸè ŸÖŸéÿ∫ŸéÿßŸÜŸêŸÖŸé ŸÉŸéÿ´ŸêŸäÿ±Ÿéÿ©Ÿã ÿ™Ÿéÿ£ŸíÿÆŸèÿ∞ŸèŸàŸÜŸéŸáŸéÿß ŸÅŸéÿπŸéÿ¨ŸéŸëŸÑŸé ŸÑŸéŸÉŸèŸÖŸí ŸáŸéŸ∞ÿ∞ŸêŸáŸê\",\n      translation: \"Allah has promised you much war booty that you will take and has hastened for you this.\",\n      source: \"Qur'an 48:20\"\n    },\n    keyLesson: \"Eliminating sources of continuous hostility brings peace and security for the believing community.\",\n    quizId: 70\n  },\n\n  // ============================================================\n  // SECTION 4: Final Years (8 lessons)\n  // ============================================================\n\n  {\n    id: 71,\n    title: \"Umrah of Fulfillment\",\n    description: [\n      \"According to Hudaybiyyah treaty, Muslims could perform Umrah the following year. In 7 AH, the Prophet Ô∑∫ led two thousand Muslims to Makkah peacefully. Quraysh evacuated the city for three days as agreed, watching Muslims from surrounding mountains with mixed emotions.\",\n      \"Muslims entered Makkah in ihram, circled the Ka'bah, performed sa'i between Safa and Marwah, and completed Umrah peacefully. Quraysh witnessed Islamic brotherhood, discipline, and devotion. Many Makkans secretly admired what they saw, softening hearts toward Islam despite outward hostility remaining.\",\n      \"This peaceful Umrah demonstrated Islam's strength through spiritual discipline rather than military force. It fulfilled the Prophet's Ô∑∫ dream, proved Hudaybiyyah treaty's wisdom, and planted seeds of Islam in Makkan hearts. Within a year, Makkah would open to Islam without bloodshed, validating this peaceful approach.\"\n    ],\n    evidence: {\n      arabic: \"ŸÑŸéŸÇŸéÿØŸí ÿµŸéÿØŸéŸÇŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ±Ÿéÿ≥ŸèŸàŸÑŸéŸáŸè ÿßŸÑÿ±ŸèŸëÿ§ŸíŸäŸéÿß ÿ®ŸêÿßŸÑŸíÿ≠ŸéŸÇŸêŸë\",\n      translation: \"Certainly Allah will fulfill the vision for His Messenger in truth.\",\n      source: \"Qur'an 48:27\"\n    },\n    keyLesson: \"Allah's promises always come true; patience and trust in divine timing leads to fulfillment beyond expectations.\",\n    quizId: 71\n  },\n\n  {\n    id: 72,\n    title: \"Battle of Mu'tah\",\n    description: [\n      \"A Muslim envoy was killed by Ghassanid allies of Byzantine Empire‚Äîan act of war. The Prophet Ô∑∫ sent three thousand Muslims to Syria to respond. He appointed Zayd ibn Harithah as commander, then Ja'far if Zayd fell, then Abdullah ibn Rawahah if Ja'far fell, showing foresight and organization.\",\n      \"At Mu'tah, Muslims faced two hundred thousand Byzantine and Arab coalition forces. Despite impossible odds, they fought bravely. All three commanders were martyred as the Prophet Ô∑∫ had foreseen. Khalid ibn Walid, recently converted, took command and brilliantly withdrew the army safely through tactical genius.\",\n      \"Though technically a withdrawal, Mu'tah showed Muslim courage against overwhelming forces. The Prophet Ô∑∫ called Khalid 'Sword of Allah' for saving the army. This battle established Muslims as a power that even mighty Byzantium had to respect, expanding Islam's influence beyond Arabia into greater world stage.\"\n    ],\n    evidence: {\n      arabic: \"ŸäŸéÿß ÿ£ŸéŸäŸèŸëŸáŸéÿß ÿßŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ¢ŸÖŸéŸÜŸèŸàÿß ÿ•Ÿêÿ∞Ÿéÿß ŸÑŸéŸÇŸêŸäÿ™ŸèŸÖŸí ŸÅŸêÿ¶Ÿéÿ©Ÿã ŸÅŸéÿßÿ´Ÿíÿ®Ÿèÿ™ŸèŸàÿß\",\n      translation: \"O you who have believed, when you encounter a company, stand firm.\",\n      source: \"Qur'an 8:45\"\n    },\n    keyLesson: \"Courage means standing firm for truth even against impossible odds, trusting Allah for results.\",\n    quizId: 72\n  },\n\n  {\n    id: 73,\n    title: \"Quraysh Break the Treaty\",\n    description: [\n      \"Two years after Hudaybiyyah, Quraysh allied tribe attacked a Muslim-allied tribe, violating the ten-year treaty. Quraysh provided weapons and fighters. When the violated tribe sought Muslim protection, the treaty breach gave the Prophet Ô∑∫ justification to march on Makkah without breaking his word.\",\n      \"Quraysh leaders realized their mistake and sent Abu Sufyan to Madinah to renew the treaty. He went to his daughter Umm Habibah, the Prophet's Ô∑∫ wife, but she refused to let him sit on the Prophet's Ô∑∫ mat. Even his own daughter prioritized Islam over father, showing faith transcends family bonds.\",\n      \"Abu Sufyan's attempts at reconciliation failed. The Prophet Ô∑∫ prepared for Makkah's conquest in secrecy. He prayed that Quraysh wouldn't discover the plan until Muslims arrived, hoping to conquer without bloodshed. Allah answered this prayer, allowing strategic surprise that would minimize casualties and maximize mercy.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéÿ•ŸêŸÜ ŸÜŸéŸëŸÉŸéÿ´ŸèŸàÿß ÿ£ŸéŸäŸíŸÖŸéÿßŸÜŸéŸáŸèŸÖ ŸÖŸêŸëŸÜ ÿ®ŸéÿπŸíÿØŸê ÿπŸéŸáŸíÿØŸêŸáŸêŸÖŸí ŸàŸéÿ∑ŸéÿπŸéŸÜŸèŸàÿß ŸÅŸêŸä ÿØŸêŸäŸÜŸêŸÉŸèŸÖŸí ŸÅŸéŸÇŸéÿßÿ™ŸêŸÑŸèŸàÿß ÿ£Ÿéÿ¶ŸêŸÖŸéŸëÿ©Ÿé ÿßŸÑŸíŸÉŸèŸÅŸíÿ±Ÿê\",\n      translation: \"But if they break their oaths after their treaty and defame your religion, then fight the leaders of disbelief.\",\n      source: \"Qur'an 9:12\"\n    },\n    keyLesson: \"Breaking treaties has consequences; justice requires holding treaty violators accountable.\",\n    quizId: 73\n  },\n\n  {\n    id: 74,\n    title: \"The Conquest of Makkah\",\n    description: [\n      \"In Ramadan, 8 AH, ten thousand Muslims marched toward Makkah. Abbas, the Prophet's Ô∑∫ uncle, brought Abu Sufyan secretly to the Muslim camp. When Abu Sufyan saw the massive army, he realized resistance was hopeless. He accepted Islam, fearing destruction but also recognizing truth.\",\n      \"The Prophet Ô∑∫ promised safety for those who stayed home, sought Abu Sufyan's house, or entered the sanctuary. This generous amnesty prevented bloodshed. Muslims entered from four directions simultaneously. Only minimal resistance occurred in one sector where Khalid fought briefly, with few casualties overall.\",\n      \"The Prophet Ô∑∫ entered Makkah humbly, head bowed on his camel, reciting Qur'an. The city that expelled and tortured him now lay conquered beneath his authority. Instead of revenge, he declared general amnesty: 'Go, you are free.' This mercy conquered hearts more effectively than swords ever could.\"\n    ],\n    evidence: {\n      arabic: \"ÿ•Ÿêÿ∞Ÿéÿß ÿ¨Ÿéÿßÿ°Ÿé ŸÜŸéÿµŸíÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿßŸÑŸíŸÅŸéÿ™Ÿíÿ≠Ÿè €ù ŸàŸéÿ±Ÿéÿ£ŸéŸäŸíÿ™Ÿé ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿé ŸäŸéÿØŸíÿÆŸèŸÑŸèŸàŸÜŸé ŸÅŸêŸä ÿØŸêŸäŸÜŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéŸÅŸíŸàŸéÿßÿ¨Ÿãÿß\",\n      translation: \"When the victory of Allah has come and the conquest, and you see the people entering into the religion of Allah in multitudes.\",\n      source: \"Qur'an 110:1-2\"\n    },\n    keyLesson: \"Victory with mercy conquers hearts; forgiveness demonstrates strength greater than revenge.\",\n    quizId: 74\n  },\n\n  {\n    id: 75,\n    title: \"Purifying the Ka'bah\",\n    description: [\n      \"After conquering Makkah, the Prophet Ô∑∫ entered the Ka'bah and found it filled with three hundred sixty idols. Pointing his staff at each idol, he recited, 'Truth has come and falsehood has vanished. Indeed falsehood is bound to vanish.' Each idol fell when he pointed at it.\",\n      \"The walls contained pictures of prophets and angels. The Prophet Ô∑∫ ordered all images removed except a painting of Mary and baby Jesus, which he covered with his hands, protecting it until other images were erased. This showed respect for previous prophets while establishing pure monotheism in Allah's house.\",\n      \"After purification, the Prophet Ô∑∫ called Bilal to give the adhan from atop the Ka'bah. The former Abyssinian slave stood on Islam's holiest site, calling to prayer. This moment symbolized Islam's victory over racism, classism, and idolatry‚Äîestablishing equality and pure worship of Allah alone in Makkah.\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÇŸèŸÑŸí ÿ¨Ÿéÿßÿ°Ÿé ÿßŸÑŸíÿ≠ŸéŸÇŸèŸë ŸàŸéÿ≤ŸéŸáŸéŸÇŸé ÿßŸÑŸíÿ®Ÿéÿßÿ∑ŸêŸÑŸè €ö ÿ•ŸêŸÜŸéŸë ÿßŸÑŸíÿ®Ÿéÿßÿ∑ŸêŸÑŸé ŸÉŸéÿßŸÜŸé ÿ≤ŸéŸáŸèŸàŸÇŸãÿß\",\n      translation: \"And say, 'Truth has come, and falsehood has departed. Indeed, falsehood is bound to perish.'\",\n      source: \"Qur'an 17:81\"\n    },\n    keyLesson: \"Truth eventually prevails over falsehood; patience and persistence lead to ultimate victory.\",\n    quizId: 75\n  },\n\n  {\n    id: 76,\n    title: \"Arabia Enters Islam\",\n    description: [\n      \"After Makkah's conquest, Arab tribes recognized Islam's supremacy. Delegations came from across Arabia pledging allegiance and accepting Islam. The Year of Delegations saw Islam spread throughout the peninsula peacefully through conviction rather than force, fulfilling divine promise.\",\n      \"Major tribes like Thaqif, who stoned the Prophet Ô∑∫ at Ta'if years earlier, came seeking peace and accepting Islam. Former enemies became sincere believers. The transformation was remarkable‚Äîfrom universal rejection to universal acceptance within twenty-three years through perseverance and divine support.\",\n      \"By the Prophet's Ô∑∫ final year, almost all Arabia was Muslim. The mission was nearly complete. The small persecuted community in Makkah had become a nation. The message of Tawhid replaced idol worship throughout Arabia, establishing foundation for Islam's spread beyond Arabia to the entire known world.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸíŸäŸéŸàŸíŸÖŸé ÿ£ŸéŸÉŸíŸÖŸéŸÑŸíÿ™Ÿè ŸÑŸéŸÉŸèŸÖŸí ÿØŸêŸäŸÜŸéŸÉŸèŸÖŸí ŸàŸéÿ£Ÿéÿ™ŸíŸÖŸéŸÖŸíÿ™Ÿè ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸí ŸÜŸêÿπŸíŸÖŸéÿ™ŸêŸä ŸàŸéÿ±Ÿéÿ∂ŸêŸäÿ™Ÿè ŸÑŸéŸÉŸèŸÖŸè ÿßŸÑŸíÿ•Ÿêÿ≥ŸíŸÑŸéÿßŸÖŸé ÿØŸêŸäŸÜŸãÿß\",\n      translation: \"This day I have perfected for you your religion and completed My favor upon you and have approved for you Islam as religion.\",\n      source: \"Qur'an 5:3\"\n    },\n    keyLesson: \"Persistence in truth eventually leads to widespread acceptance; Allah's religion will prevail.\",\n    quizId: 76\n  },\n\n  {\n    id: 77,\n    title: \"The Farewell Hajj\",\n    description: [\n      \"In 10 AH, the Prophet Ô∑∫ performed his only Hajj as leader. Over one hundred thousand Muslims accompanied him. He taught them Hajj rituals, delivered powerful sermons, and completed establishing Islam's foundations. This became his farewell to the ummah, his final comprehensive teaching to Muslims.\",\n      \"On the Day of Arafah, he delivered his final sermon. He reminded Muslims of fundamental principles: sanctity of life, property, honor; racial equality; women's rights; following Qur'an and Sunnah. He asked, 'Have I conveyed the message?' Thousands replied, 'Yes!' He said, 'O Allah, bear witness.'\",\n      \"After this testimony, the verse was revealed: 'Today I have perfected your religion for you.' The Prophet Ô∑∫ wept, understanding this meant his mission was complete and his death near. This Hajj preserved Islam's teachings for all generations, ensuring the religion would continue perfectly after him.\"\n    ],\n    evidence: {\n      arabic: \"ÿßŸÑŸíŸäŸéŸàŸíŸÖŸé ÿ£ŸéŸÉŸíŸÖŸéŸÑŸíÿ™Ÿè ŸÑŸéŸÉŸèŸÖŸí ÿØŸêŸäŸÜŸéŸÉŸèŸÖŸí ŸàŸéÿ£Ÿéÿ™ŸíŸÖŸéŸÖŸíÿ™Ÿè ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸí ŸÜŸêÿπŸíŸÖŸéÿ™ŸêŸä\",\n      translation: \"This day I have perfected for you your religion and completed My favor upon you.\",\n      source: \"Qur'an 5:3\"\n    },\n    keyLesson: \"The Farewell Hajj preserved Islam's complete teachings for all time through comprehensive final guidance.\",\n    quizId: 77\n  },\n\n  {\n    id: 78,\n    title: \"The Prophet's Ô∑∫ Passing\",\n    description: [\n      \"Three months after Farewell Hajj, the Prophet Ô∑∫ fell ill. Despite intense fever, he continued leading prayers while he could. When unable to stand, he asked Abu Bakr to lead. The companions understood this indicated Abu Bakr should lead Muslims after the Prophet's Ô∑∫ death eventually.\",\n      \"On Monday morning, 12 Rabi al-Awwal, the Prophet Ô∑∫ briefly felt better. He smiled watching Muslims pray, his face radiating happiness at seeing his ummah united in worship. Then he returned to Aisha's room, rested his head on her lap, and looked toward heaven in his final moments.\",\n      \"He whispered, 'Rather, the highest companion in Paradise,' choosing eternal life over worldly life. His blessed soul departed at midday. The companions were devastated. Umar denied it. Abu Bakr proclaimed, 'Whoever worshipped Muhammad Ô∑∫, Muhammad Ô∑∫ is dead. Whoever worships Allah, Allah is Ever-Living, never dies.'\"\n    ],\n    evidence: {\n      arabic: \"ŸàŸéŸÖŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸå ÿ•ŸêŸÑŸéŸëÿß ÿ±Ÿéÿ≥ŸèŸàŸÑŸå ŸÇŸéÿØŸí ÿÆŸéŸÑŸéÿ™Ÿí ŸÖŸêŸÜ ŸÇŸéÿ®ŸíŸÑŸêŸáŸê ÿßŸÑÿ±ŸèŸëÿ≥ŸèŸÑŸè €ö ÿ£ŸéŸÅŸéÿ•ŸêŸÜ ŸÖŸéŸëÿßÿ™Ÿé ÿ£ŸéŸàŸí ŸÇŸèÿ™ŸêŸÑŸé ÿßŸÜŸÇŸéŸÑŸéÿ®Ÿíÿ™ŸèŸÖŸí ÿπŸéŸÑŸéŸâŸ∞ ÿ£ŸéÿπŸíŸÇŸéÿßÿ®ŸêŸÉŸèŸÖŸí\",\n      translation: \"Muhammad Ô∑∫ is not but a messenger. Other messengers have passed on before him. So if he was to die or be killed, would you turn back on your heels?\",\n      source: \"Qur'an 3:144\"\n    },\n    keyLesson: \"The Prophet Ô∑∫ was human and mortal; we worship Allah alone, following the Prophet's Ô∑∫ perfect example forever.\",\n    quizId: 78\n  }\n];\n\nexport default prophetLifeLessons;\n","path":null,"size_bytes":107763,"size_tokens":null},"src/components/PurchaseModal.jsx":{"content":"import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { X, Crown } from \"lucide-react\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport ZaydDefault from \"../assets/mascots/mascot_waving.webp\";\n\nexport default function PurchaseModal({ onClose }) {\n  const navigate = useNavigate();\n\n  const handleViewPremium = () => {\n    onClose();\n    navigate(\"/premium\");\n  };\n\n  return (\n    <div\n      onClick={onClose}\n      style={{\n        position: \"fixed\",\n        inset: 0,\n        backgroundColor: \"rgba(0,0,0,0.7)\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        zIndex: 2000,\n      }}\n    >\n      <div\n        onClick={(e) => e.stopPropagation()}\n        style={{\n          background: \"#0b132b\",\n          border: \"2px solid #FFD700\",\n          borderRadius: \"18px\",\n          padding: \"28px 24px\",\n          width: \"90%\",\n          maxWidth: \"380px\",\n          color: \"white\",\n          textAlign: \"center\",\n          boxShadow: \"0 0 25px rgba(255,215,0,0.3)\",\n          position: \"relative\",\n        }}\n      >\n        {/* X Close Button */}\n        <button\n          onClick={onClose}\n          style={{\n            position: \"absolute\",\n            top: \"12px\",\n            right: \"12px\",\n            background: \"transparent\",\n            border: \"none\",\n            color: \"#9CA3AF\",\n            cursor: \"pointer\",\n            padding: \"4px\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n          }}\n        >\n          <X size={24} />\n        </button>\n        {/* Zayd Mascot */}\n        <img\n          src={ZaydDefault}\n          alt=\"Zayd\"\n          style={{\n            width: 80,\n            height: 80,\n            animation: \"bounce 2s infinite\",\n            marginBottom: 12,\n          }}\n        />\n\n        <h2\n          style={{\n            color: \"#FFD700\",\n            fontSize: \"1.5rem\",\n            marginBottom: \"8px\",\n            fontWeight: 700,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: \"8px\",\n          }}\n        >\n          <Crown size={28} />\n          Upgrade to Premium\n        </h2>\n        <p style={{ marginBottom: \"20px\", color: \"#cbd5e1\", fontSize: \"0.9rem\" }}>\n          Unlock your full Islamic learning potential\n        </p>\n\n        {/* Benefits */}\n        <div style={{ \n          textAlign: \"left\", \n          marginBottom: \"20px\",\n          background: \"rgba(255, 215, 0, 0.05)\",\n          padding: \"16px\",\n          borderRadius: \"12px\",\n        }}>\n          <div style={{ color: \"#cbd5e1\", fontSize: \"0.85rem\", lineHeight: 1.8 }}>\n            <div style={{ marginBottom: 8 }}>‚úì All 14 learning paths</div>\n            <div style={{ marginBottom: 8 }}>‚úì Unlimited lessons</div>\n            <div style={{ marginBottom: 8 }}>‚úì Global Events access</div>\n            <div>‚úì Premium badge</div>\n          </div>\n        </div>\n\n        {/* View Premium Plans Button */}\n        <button\n          onClick={handleViewPremium}\n          style={{\n            backgroundColor: \"#FFD700\",\n            color: \"#111827\",\n            fontWeight: 700,\n            border: \"none\",\n            borderRadius: \"12px\",\n            padding: \"14px 24px\",\n            width: \"100%\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: \"8px\",\n          }}\n        >\n          <Crown size={20} />\n          View Premium Plans\n        </button>\n\n        {/* Bounce Animation */}\n        <style>{`\n          @keyframes bounce {\n            0%, 100% { transform: translateY(0); }\n            50% { transform: translateY(-10px); }\n          }\n        `}</style>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3876,"size_tokens":null},"src/store/friendsStore.js":{"content":"// src/store/friendsStore.js\n// Cloud-backed Friends Engine with Supabase\nimport { create } from \"zustand\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { avatarIndexToKey } from \"../utils/avatarUtils\";\nimport { useFriendChallengesStore } from \"./friendChallengesStore\";\n\nexport const useFriendsStore = create((set, get) => ({\n  friends: [],\n  sentRequests: [],\n  receivedRequests: [],\n  users: [],\n  globalLeaderboard: [],\n  loading: false,\n  error: null,\n  currentUserId: null,\n  realtimeChannel: null,\n  initialized: false,\n\n  // Initialize with real-time subscription\n  initialize: async () => {\n    if (get().initialized) return;\n    \n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user?.id) return;\n    \n    const userId = auth.user.id;\n    set({ currentUserId: userId });\n    \n    await get().loadAll();\n    get().setupRealtimeSubscription(userId);\n    set({ initialized: true });\n  },\n\n  // Setup real-time subscription for instant friend updates\n  setupRealtimeSubscription: (userId) => {\n    const existingChannel = get().realtimeChannel;\n    if (existingChannel) {\n      supabase.removeChannel(existingChannel);\n    }\n\n    const channel = supabase\n      .channel(`friends_${userId}`)\n      .on(\n        \"postgres_changes\",\n        {\n          event: \"*\",\n          schema: \"public\",\n          table: \"friends\",\n          filter: `user_id=eq.${userId}`,\n        },\n        () => get().loadAll()\n      )\n      .on(\n        \"postgres_changes\",\n        {\n          event: \"*\",\n          schema: \"public\",\n          table: \"friends\",\n          filter: `friend_id=eq.${userId}`,\n        },\n        () => get().loadAll()\n      )\n      .subscribe();\n\n    set({ realtimeChannel: channel });\n  },\n\n  cleanup: () => {\n    const { realtimeChannel } = get();\n    if (realtimeChannel) {\n      supabase.removeChannel(realtimeChannel);\n    }\n    set({\n      friends: [],\n      sentRequests: [],\n      receivedRequests: [],\n      users: [],\n      currentUserId: null,\n      realtimeChannel: null,\n      initialized: false,\n    });\n  },\n\n  loadAll: async () => {\n    try {\n      set({ loading: true, error: null });\n\n      let userId = get().currentUserId;\n      if (!userId) {\n        const { data: auth } = await supabase.auth.getUser();\n        if (!auth?.user) {\n          set({ friends: [], sentRequests: [], receivedRequests: [], users: [], loading: false });\n          return;\n        }\n        userId = auth.user.id;\n        set({ currentUserId: userId });\n      }\n\n      // PARALLEL fetch: friends, sent requests, received requests\n      const [friendsResult, sentResult, receivedResult] = await Promise.all([\n        supabase.from(\"friends\").select(\"*\").or(`user_id.eq.${userId},friend_id.eq.${userId}`).eq(\"status\", \"accepted\"),\n        supabase.from(\"friends\").select(\"*\").eq(\"user_id\", userId).eq(\"status\", \"pending\"),\n        supabase.from(\"friends\").select(\"*\").eq(\"friend_id\", userId).eq(\"status\", \"pending\"),\n      ]);\n\n      if (friendsResult.error) {\n        set({ friends: [], sentRequests: [], receivedRequests: [], users: [], loading: false, error: null });\n        return;\n      }\n\n      const friendsData = friendsResult.data || [];\n      const sent = sentResult.data || [];\n      const received = receivedResult.data || [];\n\n      // Collect all profile IDs needed\n      const friendIds = friendsData.map(f => f.user_id === userId ? f.friend_id : f.user_id);\n      const sentIds = sent.map(s => s.friend_id);\n      const receivedIds = received.map(r => r.user_id);\n      const allProfileIds = [...new Set([...friendIds, ...sentIds, ...receivedIds])];\n\n      // Single batch profile fetch\n      let allProfiles = [];\n      if (allProfileIds.length > 0) {\n        const { data: profiles } = await supabase\n          .from(\"profiles\")\n          .select(\"user_id, username, handle, avatar, xp, streak, coins, shield_count\")\n          .in(\"user_id\", allProfileIds);\n        allProfiles = profiles || [];\n      }\n\n      const profileMap = new Map(allProfiles.map(p => [p.user_id, p]));\n\n      const formatProfile = (profile, includeExtras = false) => ({\n        user_id: profile.user_id,\n        id: profile.user_id,\n        username: profile.username,\n        handle: profile.handle,\n        nickname: profile.username || profile.handle || \"User\",\n        avatar: typeof profile.avatar === \"number\" ? avatarIndexToKey(profile.avatar) : profile.avatar || \"avatar_man_lantern\",\n        xp: profile.xp || 0,\n        ...(includeExtras && { streak: profile.streak || 0, coins: profile.coins || 0, shield_count: profile.shield_count || 0 }),\n      });\n\n      const formattedFriends = friendIds.map(id => profileMap.get(id)).filter(Boolean).map(p => formatProfile(p, true));\n      \n      const formattedSent = sent.map(row => {\n        const profile = profileMap.get(row.friend_id) || {};\n        return { id: row.id, requestId: row.id, senderId: row.user_id, receiverId: row.friend_id, user_id: row.friend_id, ...formatProfile(profile) };\n      });\n\n      const formattedReceived = received.map(row => {\n        const profile = profileMap.get(row.user_id) || {};\n        return { id: row.id, requestId: row.id, senderId: row.user_id, receiverId: row.friend_id, user_id: row.user_id, ...formatProfile(profile) };\n      });\n\n      set({ friends: formattedFriends, sentRequests: formattedSent, receivedRequests: formattedReceived, loading: false });\n    } catch (err) {\n      set({ friends: [], sentRequests: [], receivedRequests: [], users: [], loading: false, error: null });\n    }\n  },\n\n  loadFriends: async () => {\n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user) return [];\n\n    const userId = auth.user.id;\n    \n    const { data, error } = await supabase\n      .from(\"friends\")\n      .select(\"*\")\n      .or(`user_id.eq.${userId},friend_id.eq.${userId}`)\n      .eq(\"status\", \"accepted\");\n\n    if (error) {\n      console.warn(\"loadFriends error:\", error.message);\n      return [];\n    }\n\n    const friendIds = (data || []).map((f) => \n      f.user_id === userId ? f.friend_id : f.user_id\n    );\n    if (friendIds.length === 0) {\n      set({ friends: [] });\n      return [];\n    }\n\n    const { data: profiles } = await supabase\n      .from(\"profiles\")\n      .select(\"user_id, username, handle, avatar, xp, streak, coins, shield_count\")\n      .in(\"user_id\", friendIds);\n\n    const friends = (profiles || []).map((profile) => ({\n      user_id: profile.user_id,\n      id: profile.user_id,\n      username: profile.username,\n      handle: profile.handle,\n      nickname: profile.username || profile.handle || \"User\",\n      avatar: typeof profile.avatar === \"number\"\n        ? avatarIndexToKey(profile.avatar)\n        : profile.avatar || \"avatar_man_lantern\",\n      xp: profile.xp || 0,\n      streak: profile.streak || 0,\n      coins: profile.coins || 0,\n      shield_count: profile.shield_count || 0,\n    }));\n\n    set({ friends });\n    return friends;\n  },\n\n  loadPendingRequests: async () => {\n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user) return [];\n\n    const userId = auth.user.id;\n\n    const { data, error } = await supabase\n      .from(\"friends\")\n      .select(\"*\")\n      .eq(\"friend_id\", userId)\n      .eq(\"status\", \"pending\");\n\n    if (error) {\n      console.warn(\"loadPendingRequests error:\", error.message);\n      return [];\n    }\n\n    const senderIds = (data || []).map((r) => r.user_id);\n    let senderProfiles = [];\n    if (senderIds.length > 0) {\n      const { data: profiles } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp\")\n        .in(\"user_id\", senderIds);\n      senderProfiles = profiles || [];\n    }\n\n    const formattedReceived = (data || []).map((row) => {\n      const profile = senderProfiles.find((p) => p.user_id === row.user_id) || {};\n      return {\n        id: row.id,\n        requestId: row.id,\n        senderId: row.user_id,\n        receiverId: row.friend_id,\n        user_id: row.user_id,\n        username: profile.username,\n        handle: profile.handle,\n        nickname: profile.username || profile.handle || \"User\",\n        avatar: typeof profile.avatar === \"number\"\n          ? avatarIndexToKey(profile.avatar)\n          : profile.avatar || \"avatar_man_lantern\",\n        xp: profile.xp || 0,\n      };\n    });\n\n    set({ receivedRequests: formattedReceived });\n    return formattedReceived;\n  },\n\n  loadRequests: async () => {\n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user) return { sent: [], received: [] };\n\n    const userId = auth.user.id;\n\n    const { data: sent } = await supabase\n      .from(\"friends\")\n      .select(\"*\")\n      .eq(\"user_id\", userId)\n      .eq(\"status\", \"pending\");\n\n    const { data: received } = await supabase\n      .from(\"friends\")\n      .select(\"*\")\n      .eq(\"friend_id\", userId)\n      .eq(\"status\", \"pending\");\n\n    const sentIds = (sent || []).map((s) => s.friend_id);\n    const receivedIds = (received || []).map((r) => r.user_id);\n\n    let sentProfiles = [];\n    let receivedProfiles = [];\n\n    if (sentIds.length > 0) {\n      const { data: profiles } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp\")\n        .in(\"user_id\", sentIds);\n      sentProfiles = profiles || [];\n    }\n\n    if (receivedIds.length > 0) {\n      const { data: profiles } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp\")\n        .in(\"user_id\", receivedIds);\n      receivedProfiles = profiles || [];\n    }\n\n    const formattedSent = (sent || []).map((row) => {\n      const p = sentProfiles.find((pr) => pr.user_id === row.friend_id) || {};\n      return {\n        id: row.id,\n        requestId: row.id,\n        senderId: row.user_id,\n        receiverId: row.friend_id,\n        user_id: row.friend_id,\n        username: p.username,\n        handle: p.handle,\n        nickname: p.username || p.handle || \"User\",\n        avatar: typeof p.avatar === \"number\" ? avatarIndexToKey(p.avatar) : p.avatar || \"avatar_man_lantern\",\n        xp: p.xp || 0,\n      };\n    });\n\n    const formattedReceived = (received || []).map((row) => {\n      const p = receivedProfiles.find((pr) => pr.user_id === row.user_id) || {};\n      return {\n        id: row.id,\n        requestId: row.id,\n        senderId: row.user_id,\n        receiverId: row.friend_id,\n        user_id: row.user_id,\n        username: p.username,\n        handle: p.handle,\n        nickname: p.username || p.handle || \"User\",\n        avatar: typeof p.avatar === \"number\" ? avatarIndexToKey(p.avatar) : p.avatar || \"avatar_man_lantern\",\n        xp: p.xp || 0,\n      };\n    });\n\n    set({ sentRequests: formattedSent, receivedRequests: formattedReceived });\n    return { sent: formattedSent, received: formattedReceived };\n  },\n\n  loadLeaderboard: async () => {\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp, streak\")\n        .order(\"xp\", { ascending: false })\n        .limit(100);\n\n      if (error) {\n        console.warn(\"loadLeaderboard error:\", error.message);\n        return [];\n      }\n\n      const formatted = (data || []).map((p) => ({\n        user_id: p.user_id,\n        username: p.username,\n        handle: p.handle,\n        avatar: typeof p.avatar === \"number\" ? avatarIndexToKey(p.avatar) : p.avatar,\n        xp: p.xp || 0,\n        streak: p.streak || 0,\n      }));\n\n      set({ globalLeaderboard: formatted });\n      return formatted;\n    } catch (err) {\n      console.warn(\"loadLeaderboard error:\", err);\n      return [];\n    }\n  },\n\n  searchUsers: async (query) => {\n    if (!query || query.trim().length < 2) return [];\n\n    const searchTerm = query.trim().toLowerCase();\n\n    try {\n      const { data: handleResults } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp, streak\")\n        .ilike(\"handle\", `%${searchTerm}%`)\n        .limit(20);\n\n      const { data: usernameResults } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp, streak\")\n        .ilike(\"username\", `%${searchTerm}%`)\n        .limit(20);\n\n      const combined = [...(handleResults || []), ...(usernameResults || [])];\n      const unique = Array.from(\n        new Map(combined.map((u) => [u.user_id, u])).values()\n      );\n\n      const { data: auth } = await supabase.auth.getUser();\n      const currentUserId = auth?.user?.id;\n\n      const filtered = unique\n        .filter((u) => u.user_id !== currentUserId)\n        .map((p) => ({\n          user_id: p.user_id,\n          id: p.user_id,\n          username: p.username,\n          handle: p.handle,\n          nickname: p.username || p.handle || \"User\",\n          avatar: typeof p.avatar === \"number\" ? avatarIndexToKey(p.avatar) : p.avatar,\n          xp: p.xp || 0,\n          streak: p.streak || 0,\n        }));\n\n      return filtered;\n    } catch (err) {\n      console.warn(\"searchUsers error:\", err);\n      return [];\n    }\n  },\n\n  sendFriendRequest: async (targetUserId) => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth?.user) return { success: false, error: \"Not logged in\" };\n\n      const myUserId = auth.user.id;\n      console.log(\"üì§ sendFriendRequest - myUserId:\", myUserId, \"targetUserId:\", targetUserId);\n\n      if (myUserId === targetUserId) {\n        return { success: false, error: \"You cannot add yourself\" };\n      }\n\n      // Check database directly for any existing relationship\n      const { data: existingRow, error: checkErr } = await supabase\n        .from(\"friends\")\n        .select(\"user_id, friend_id, status\")\n        .or(`and(user_id.eq.${myUserId},friend_id.eq.${targetUserId}),and(user_id.eq.${targetUserId},friend_id.eq.${myUserId})`)\n        .maybeSingle();\n\n      console.log(\"üì§ sendFriendRequest - existing check:\", existingRow, checkErr);\n\n      if (existingRow) {\n        if (existingRow.status === \"accepted\") {\n          return { success: false, error: \"Already friends\" };\n        }\n        if (existingRow.user_id === myUserId && existingRow.status === \"pending\") {\n          return { success: false, error: \"Request already sent\" };\n        }\n        if (existingRow.friend_id === myUserId && existingRow.status === \"pending\") {\n          return { success: false, error: \"They already sent you a request - check your requests!\" };\n        }\n      }\n\n      // Insert new friend request: user_id = sender, friend_id = receiver\n      const { error: insertErr } = await supabase.from(\"friends\").insert({\n        user_id: myUserId,\n        friend_id: targetUserId,\n        status: \"pending\",\n      });\n\n      console.log(\"üì§ sendFriendRequest - insert result:\", insertErr);\n\n      if (insertErr) {\n        if (insertErr.code === \"23505\") {\n          return { success: false, error: \"Request already exists\" };\n        }\n        console.error(\"sendFriendRequest insert error:\", insertErr);\n        return { success: false, error: \"Failed to send request\" };\n      }\n\n      // Refresh friends, sent requests, and pending requests\n      await get().loadFriends();\n      await get().loadRequests();\n      await get().loadPendingRequests();\n      return { success: true, message: \"Friend request sent!\" };\n    } catch (err) {\n      console.error(\"sendFriendRequest error:\", err);\n      return { success: false, error: \"Failed to send request\" };\n    }\n  },\n\n  acceptFriendRequest: async (requestId) => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth?.user) return { success: false, error: \"Not logged in\" };\n\n      const myUserId = auth.user.id;\n      console.log(\"ü§ù acceptFriendRequest - myUserId:\", myUserId, \"requestId:\", requestId);\n\n      // Update status to accepted using the row id\n      const { data: updateData, error: updateErr } = await supabase\n        .from(\"friends\")\n        .update({ status: \"accepted\" })\n        .eq(\"id\", requestId)\n        .select();\n\n      console.log(\"ü§ù acceptFriendRequest - update result:\", updateData, \"error:\", updateErr);\n\n      if (updateErr) {\n        console.error(\"Accept friend request error:\", updateErr);\n        return { success: false, error: \"Failed to accept request\" };\n      }\n\n      if (!updateData || updateData.length === 0) {\n        console.warn(\"ü§ù acceptFriendRequest - No request found with id:\", requestId);\n        return { success: false, error: \"Request not found or already accepted\" };\n      }\n\n      // Refresh friends, sent requests, and pending requests\n      await get().loadFriends();\n      await get().loadRequests();\n      await get().loadPendingRequests();\n      \n      const { friends } = get();\n      console.log(\"ü§ù acceptFriendRequest - friends after refresh:\", friends);\n      \n      return { success: true, message: \"Friend added!\" };\n    } catch (err) {\n      console.error(\"acceptFriendRequest error:\", err);\n      return { success: false, error: \"Failed to accept request\" };\n    }\n  },\n\n  declineFriendRequest: async (requestId) => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth?.user) return { success: false, error: \"Not logged in\" };\n\n      console.log(\"‚ùå declineFriendRequest - requestId:\", requestId);\n\n      // Delete the request by id\n      const { error: deleteErr } = await supabase\n        .from(\"friends\")\n        .delete()\n        .eq(\"id\", requestId);\n\n      console.log(\"‚ùå declineFriendRequest - delete error:\", deleteErr);\n\n      // Refresh friends, sent requests, and pending requests\n      await get().loadFriends();\n      await get().loadRequests();\n      await get().loadPendingRequests();\n      return { success: true };\n    } catch (err) {\n      console.error(\"declineFriendRequest error:\", err);\n      return { success: false, error: \"Failed to decline request\" };\n    }\n  },\n\n  cancelSentRequest: async (receiverId) => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth?.user) return { success: false, error: \"Not logged in\" };\n\n      const myUserId = auth.user.id;\n      console.log(\"üö´ cancelSentRequest - myUserId:\", myUserId, \"receiverId:\", receiverId);\n\n      // Delete where I am user_id (sender), target is friend_id (receiver)\n      const { error: deleteErr } = await supabase\n        .from(\"friends\")\n        .delete()\n        .eq(\"user_id\", myUserId)\n        .eq(\"friend_id\", receiverId)\n        .eq(\"status\", \"pending\");\n\n      console.log(\"üö´ cancelSentRequest - delete error:\", deleteErr);\n\n      // Refresh friends, sent requests, and pending requests\n      await get().loadFriends();\n      await get().loadRequests();\n      await get().loadPendingRequests();\n      return { success: true, message: \"Request cancelled\" };\n    } catch (err) {\n      console.error(\"cancelSentRequest error:\", err);\n      return { success: false, error: \"Failed to cancel request\" };\n    }\n  },\n\n  removeFriend: async (friendId) => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth?.user) return { success: false, error: \"Not logged in\" };\n\n      const myUserId = auth.user.id;\n      console.log(\"üóëÔ∏è removeFriend - myUserId:\", myUserId, \"friendId:\", friendId);\n\n      // Delete row where either direction matches (both must be accepted to be friends)\n      const { error: deleteErr } = await supabase\n        .from(\"friends\")\n        .delete()\n        .or(\n          `and(user_id.eq.${myUserId},friend_id.eq.${friendId}),and(user_id.eq.${friendId},friend_id.eq.${myUserId})`\n        );\n\n      console.log(\"üóëÔ∏è removeFriend - delete error:\", deleteErr);\n\n      // Also delete any friend challenges between these users\n      const { error: challengeErr } = await supabase\n        .from(\"friend_challenges\")\n        .delete()\n        .or(\n          `and(sender_id.eq.${myUserId},receiver_id.eq.${friendId}),and(sender_id.eq.${friendId},receiver_id.eq.${myUserId})`\n        );\n\n      console.log(\"üóëÔ∏è removeFriend - challenge delete error:\", challengeErr);\n\n      // Refresh friends and requests\n      await get().loadFriends();\n      await get().loadRequests();\n      await get().loadPendingRequests();\n      \n      // Refresh friend challenges store\n      await useFriendChallengesStore.getState().loadChallenges();\n      \n      return { success: true, message: \"Friend removed\" };\n    } catch (err) {\n      console.error(\"removeFriend error:\", err);\n      return { success: false, error: \"Failed to remove friend\" };\n    }\n  },\n\n  getUserById: (userId) => {\n    const { friends, sentRequests, receivedRequests } = get();\n\n    const friend = friends.find((f) => f.user_id === userId || f.id === userId);\n    if (friend) return friend;\n\n    const sent = sentRequests.find((r) => r.user_id === userId || r.id === userId);\n    if (sent) return sent;\n\n    const received = receivedRequests.find((r) => r.user_id === userId || r.id === userId);\n    if (received) return received;\n\n    return null;\n  },\n\n  getProfileById: async (userId) => {\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"user_id, username, handle, avatar, xp, streak, coins, shield_count\")\n        .eq(\"user_id\", userId)\n        .maybeSingle();\n\n      if (error || !data) return null;\n\n      return {\n        user_id: data.user_id,\n        id: data.user_id,\n        username: data.username,\n        handle: data.handle,\n        nickname: data.username || data.handle || \"User\",\n        avatar: typeof data.avatar === \"number\" ? avatarIndexToKey(data.avatar) : data.avatar,\n        xp: data.xp || 0,\n        streak: data.streak || 0,\n        coins: data.coins || 0,\n        shield_count: data.shield_count || 0,\n      };\n    } catch (err) {\n      console.warn(\"getProfileById error:\", err);\n      return null;\n    }\n  },\n\n  isFriend: (userId) => {\n    const { friends } = get();\n    return friends.some((f) => f.user_id === userId || f.id === userId);\n  },\n\n  canSendRequest: (userId) => {\n    const { friends, sentRequests, receivedRequests } = get();\n    if (friends.some((f) => f.user_id === userId || f.id === userId)) return false;\n    if (sentRequests.some((r) => r.user_id === userId || r.id === userId)) return false;\n    if (receivedRequests.some((r) => r.user_id === userId || r.id === userId)) return false;\n    return true;\n  },\n\n  getFriendship: (userId) => {\n    const { friends, sentRequests, receivedRequests } = get();\n    if (friends.some((f) => f.user_id === userId || f.id === userId)) return { status: \"accepted\" };\n    if (sentRequests.some((r) => r.user_id === userId || r.id === userId)) return { status: \"sent\" };\n    if (receivedRequests.some((r) => r.user_id === userId || r.id === userId)) return { status: \"received\" };\n    return { status: \"none\" };\n  },\n\n  updateCurrentUserData: async (userData) => {\n    const { globalLeaderboard } = get();\n    const { data: auth } = await supabase.auth.getUser();\n\n    if (!auth?.user) return;\n\n    const userId = auth.user.id;\n    const updatedLeaderboard = globalLeaderboard.map((u) =>\n      u.user_id === userId ? { ...u, ...userData } : u\n    );\n\n    set({ globalLeaderboard: updatedLeaderboard });\n  },\n\n  initializeUser: async () => {\n    return;\n  },\n\n  getAllFriends: () => {\n    return get().friends;\n  },\n  getSentRequests: () => get().sentRequests,\n  getReceivedRequests: () => get().receivedRequests,\n  getGlobalLeaderboard: () => get().globalLeaderboard,\n}));\n","path":null,"size_bytes":23414,"size_tokens":null},"src/components/LevelBadge.jsx":{"content":"// src/components/LevelBadge.jsx\n// Reusable component for displaying diamond level across the app\nimport React from \"react\";\nimport { DiamondIcon } from \"./DiamondIcon\";\nimport { getCurrentLevel, getXPProgress } from \"../utils/diamondLevels\";\n\nexport const LevelBadge = React.memo(function LevelBadge({ \n  xp, \n  size = \"medium\", \n  showXP = false, \n  showProgress = false,\n  animated = false \n}) {\n  const levelData = getCurrentLevel(xp);\n  const progress = getXPProgress(xp);\n\n  // Size presets\n  const sizeMap = {\n    small: { diamond: 20, text: \"0.8rem\", spacing: 6 },\n    medium: { diamond: 28, text: \"1rem\", spacing: 8 },\n    large: { diamond: 40, text: \"1.2rem\", spacing: 12 },\n  };\n\n  const s = sizeMap[size] || sizeMap.medium;\n\n  return (\n    <div style={{\n      display: \"inline-flex\",\n      alignItems: \"center\",\n      gap: s.spacing,\n    }}>\n      <DiamondIcon\n        xp={xp}\n        size={s.diamond}\n        animated={animated}\n        showGlow={true}\n      />\n      \n      <div style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"flex-start\",\n      }}>\n        <div style={{\n          color: levelData.color,\n          fontSize: s.text,\n          fontWeight: \"bold\",\n          lineHeight: 1.2,\n        }}>\n          Level {levelData.level}\n        </div>\n        \n        {showXP && (\n          <div style={{\n            color: \"rgba(212, 175, 55, 0.7)\",\n            fontSize: `calc(${s.text} * 0.75)`,\n            lineHeight: 1.2,\n          }}>\n            {xp.toLocaleString()} XP\n          </div>\n        )}\n        \n        {showProgress && progress.nextLevel && (\n          <div style={{\n            color: \"rgba(212, 175, 55, 0.6)\",\n            fontSize: `calc(${s.text} * 0.7)`,\n            lineHeight: 1.2,\n          }}>\n            {progress.currentLevelXP}/{progress.requiredDelta} to Level {progress.nextLevel.level}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\n// Simplified version for small spaces (just diamond + level number)\nexport const LevelBadgeCompact = React.memo(function LevelBadgeCompact({ xp, size = 24 }) {\n  const levelData = getCurrentLevel(xp);\n\n  return (\n    <div style={{\n      display: \"inline-flex\",\n      alignItems: \"center\",\n      gap: 6,\n      background: \"rgba(212, 175, 55, 0.1)\",\n      padding: \"4px 8px\",\n      borderRadius: 8,\n      border: \"1px solid rgba(212, 175, 55, 0.3)\",\n    }}>\n      <DiamondIcon\n        xp={xp}\n        size={size}\n        showGlow={false}\n      />\n      <span style={{\n        color: levelData.color,\n        fontSize: \"0.85rem\",\n        fontWeight: \"600\",\n      }}>\n        {levelData.level}\n      </span>\n    </div>\n  );\n});\n","path":null,"size_bytes":2667,"size_tokens":null},"src/utils/diamondLevels.js":{"content":"// src/utils/diamondLevels.js\n// 10-Level Diamond XP System for Islam Quest\n\n// üé® Diamond Level Configuration\nexport const DIAMOND_LEVELS = [\n  {\n    level: 1,\n    name: \"Bronze Diamond\",\n    color: \"#CD7F32\",\n    gradient: \"linear-gradient(135deg, #CD7F32 0%, #B87333 100%)\",\n    glow: \"0 0 20px rgba(205, 127, 50, 0.6)\",\n    minXP: 0,\n  },\n  {\n    level: 2,\n    name: \"Silver Diamond\",\n    color: \"#C0C0C0\",\n    gradient: \"linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%)\",\n    glow: \"0 0 20px rgba(192, 192, 192, 0.6)\",\n    minXP: null, // calculated dynamically\n  },\n  {\n    level: 3,\n    name: \"Gold Diamond\",\n    color: \"#FFD700\",\n    gradient: \"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)\",\n    glow: \"0 0 25px rgba(255, 215, 0, 0.7)\",\n    minXP: null,\n  },\n  {\n    level: 4,\n    name: \"Emerald Diamond\",\n    color: \"#10B981\",\n    gradient: \"linear-gradient(135deg, #10B981 0%, #059669 100%)\",\n    glow: \"0 0 25px rgba(16, 185, 129, 0.7)\",\n    minXP: null,\n  },\n  {\n    level: 5,\n    name: \"Ruby Diamond\",\n    color: \"#E11D48\",\n    gradient: \"linear-gradient(135deg, #E11D48 0%, #BE123C 100%)\",\n    glow: \"0 0 25px rgba(225, 29, 72, 0.7)\",\n    minXP: null,\n  },\n  {\n    level: 6,\n    name: \"Sapphire Diamond\",\n    color: \"#3B82F6\",\n    gradient: \"linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%)\",\n    glow: \"0 0 25px rgba(59, 130, 246, 0.7)\",\n    minXP: null,\n  },\n  {\n    level: 7,\n    name: \"Amethyst Diamond\",\n    color: \"#A855F7\",\n    gradient: \"linear-gradient(135deg, #A855F7 0%, #7C3AED 100%)\",\n    glow: \"0 0 30px rgba(168, 85, 247, 0.8)\",\n    minXP: null,\n  },\n  {\n    level: 8,\n    name: \"Diamond\",\n    color: \"#E0E7FF\",\n    gradient: \"linear-gradient(135deg, #E0E7FF 0%, #C7D2FE 100%)\",\n    glow: \"0 0 35px rgba(224, 231, 255, 0.9)\",\n    minXP: null,\n  },\n  {\n    level: 9,\n    name: \"Radiant Diamond\",\n    color: \"#60A5FA\",\n    gradient: \"linear-gradient(135deg, #60A5FA 0%, #3B82F6 50%, #1D4ED8 100%)\",\n    glow: \"0 0 40px rgba(96, 165, 250, 1)\",\n    minXP: null,\n  },\n  {\n    level: 10,\n    name: \"Legendary Diamond\",\n    color: \"#F4D03F\",\n    gradient: \"linear-gradient(135deg, #D4AF37 0%, #F4D03F 50%, #FFD700 100%)\",\n    glow: \"0 0 50px rgba(212, 175, 55, 1)\",\n    pulse: true, // special pulse animation for max level\n    minXP: null,\n  },\n];\n\n// üìä Calculate Total Available XP Dynamically\n// Import from central source to avoid hard-coding\nexport function getTotalAvailableLessons() {\n  // These match DEFAULT_PATHS in progressStore - keep in sync\n  const pathLessons = [104, 17, 47, 78, 13, 10, 12, 32, 11, 13, 12, 16, 19, 20];\n  return pathLessons.reduce((sum, lessons) => sum + lessons, 0); // 404 total\n}\n\nconst MAX_XP_PER_QUIZ = 140; // 4 questions √ó 20 + 40 bonus + 20 perfect = 140 XP\nconst TOTAL_AVAILABLE_XP = getTotalAvailableLessons() * MAX_XP_PER_QUIZ; // 56,560 XP\n\nexport function calculateLevelThresholds() {\n  const thresholds = [0]; // Level 1 starts at 0\n\n  // Distribution: Levels 1-3 quick (2-4 quizzes), 4-7 moderate, 8-10 slow grind\n  // Designed for early engagement and long-term achievement\n  const fixedXP = [\n    0,      // Level 1: Start\n    280,    // Level 2: 2 perfect quizzes (280 XP) - quick unlock\n    700,    // Level 3: 5 quizzes (~140 each) - still quick\n    1400,   // Level 4: 10 quizzes - starting moderate grind\n    3500,   // Level 5: 25 quizzes\n    7000,   // Level 6: 50 quizzes - mid-game milestone\n    14000,  // Level 7: 100 quizzes - significant achievement\n    25000,  // Level 8: 178 quizzes - late game\n    40000,  // Level 9: 285 quizzes - near completion\n    51000,  // Level 10: 364 quizzes - legendary (90% of total content)\n  ];\n\n  return fixedXP;\n}\n\n// Update DIAMOND_LEVELS with calculated thresholds\nconst thresholds = calculateLevelThresholds();\nDIAMOND_LEVELS.forEach((level, index) => {\n  if (index > 0) {\n    level.minXP = thresholds[index];\n  }\n});\n\n// üéØ Get Current Level from XP\nexport function getCurrentLevel(xp) {\n  for (let i = DIAMOND_LEVELS.length - 1; i >= 0; i--) {\n    if (xp >= DIAMOND_LEVELS[i].minXP) {\n      return DIAMOND_LEVELS[i];\n    }\n  }\n  return DIAMOND_LEVELS[0]; // Default to Bronze\n}\n\n// üìà Get XP Progress to Next Level\nexport function getXPProgress(xp) {\n  const currentLevel = getCurrentLevel(xp);\n  const currentLevelIndex = DIAMOND_LEVELS.findIndex(l => l.level === currentLevel.level);\n  \n  if (currentLevelIndex === DIAMOND_LEVELS.length - 1) {\n    // Max level reached\n    return {\n      current: xp,\n      required: DIAMOND_LEVELS[currentLevelIndex].minXP,\n      percentage: 100,\n      nextLevel: null,\n    };\n  }\n\n  const nextLevel = DIAMOND_LEVELS[currentLevelIndex + 1];\n  const current = xp - currentLevel.minXP;\n  const required = nextLevel.minXP - currentLevel.minXP;\n  const percentage = Math.min(100, Math.floor((current / required) * 100));\n\n  return {\n    current: xp,\n    currentLevelXP: current,\n    required: nextLevel.minXP,\n    requiredDelta: required,\n    percentage,\n    nextLevel,\n  };\n}\n\n// ‚ú® XP Multipliers\nexport const XP_MULTIPLIERS = {\n  LESSON: 1.0,\n  QUIZ: 1.0,\n  DAILY_QUEST: 1.2,\n  BOSS_LEVEL: 1.5,\n};\n\n// üéÅ Apply XP Multiplier\nexport function applyMultiplier(baseXP, multiplierType = 'LESSON') {\n  const multiplier = XP_MULTIPLIERS[multiplierType] || 1.0;\n  return Math.floor(baseXP * multiplier);\n}\n\n// üèÜ Check if Level Up Occurred\nexport function checkLevelUp(oldXP, newXP) {\n  const oldLevel = getCurrentLevel(oldXP);\n  const newLevel = getCurrentLevel(newXP);\n  \n  if (newLevel.level > oldLevel.level) {\n    return {\n      leveledUp: true,\n      oldLevel: oldLevel.level,\n      newLevel: newLevel.level,\n      levelData: newLevel,\n    };\n  }\n  \n  return { leveledUp: false };\n}\n\n// üìä Get All Levels with Progress Info\nexport function getAllLevelsWithProgress(currentXP) {\n  return DIAMOND_LEVELS.map(level => {\n    const isUnlocked = currentXP >= level.minXP;\n    const isCurrent = getCurrentLevel(currentXP).level === level.level;\n    \n    return {\n      ...level,\n      isUnlocked,\n      isCurrent,\n    };\n  });\n}\n\n// üé® Get Diamond Icon Style\nexport function getDiamondStyle(levelData, options = {}) {\n  const { size = 24, animated = false, pulsing = false } = options;\n  \n  return {\n    width: size,\n    height: size,\n    background: levelData.gradient,\n    boxShadow: levelData.glow,\n    borderRadius: \"4px\",\n    transform: \"rotate(45deg)\",\n    display: \"inline-block\",\n    animation: animated ? \"sparkle 2s ease-in-out infinite\" : pulsing && levelData.pulse ? \"pulse 2s ease-in-out infinite\" : \"none\",\n  };\n}\n","path":null,"size_bytes":6506,"size_tokens":null},"src/components/ZaydLevelUpPopup.jsx":{"content":"// src/components/ZaydLevelUpPopup.jsx\nimport React, { useEffect, useState } from \"react\";\nimport { Sparkles } from \"lucide-react\";\nimport { DiamondIcon } from \"./DiamondIcon\";\nimport { DIAMOND_LEVELS } from \"../utils/diamondLevels\";\nimport mascot from \"../assets/mascots/mascot_congratulation.webp\";\n\nexport function ZaydLevelUpPopup({ levelUpData, onClose }) {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    // Trigger animation\n    setTimeout(() => setIsVisible(true), 100);\n\n    // Auto-close after 4 seconds\n    const timer = setTimeout(() => {\n      setIsVisible(false);\n      setTimeout(onClose, 300); // Wait for fade-out animation\n    }, 4000);\n\n    return () => clearTimeout(timer);\n  }, [onClose]);\n\n  if (!levelUpData) return null;\n\n  const newLevelData = DIAMOND_LEVELS.find(l => l.level === levelUpData.newLevel);\n\n  return (\n    <div\n      onClick={() => {\n        setIsVisible(false);\n        setTimeout(onClose, 300);\n      }}\n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: \"rgba(0, 0, 0, 0.7)\",\n        zIndex: 2000,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        padding: 20,\n        animation: isVisible ? \"fadeIn 0.3s ease-out\" : \"fadeOut 0.3s ease-out\",\n      }}\n    >\n      <div style={{\n        background: \"linear-gradient(180deg, #0B1E2D 0%, #162C3D 100%)\",\n        borderRadius: 24,\n        maxWidth: 400,\n        width: \"100%\",\n        padding: 32,\n        border: \"3px solid #D4AF37\",\n        boxShadow: \"0 0 60px rgba(212, 175, 55, 0.6)\",\n        textAlign: \"center\",\n        position: \"relative\",\n        animation: isVisible ? \"bounceIn 0.5s ease-out\" : \"bounceOut 0.3s ease-in\",\n      }}>\n        {/* Sparkles Background Effect */}\n        <div style={{\n          position: \"absolute\",\n          top: -10,\n          right: -10,\n          animation: \"sparkle 2s ease-in-out infinite\",\n        }}>\n          <Sparkles size={32} color=\"#D4AF37\" />\n        </div>\n        <div style={{\n          position: \"absolute\",\n          bottom: -10,\n          left: -10,\n          animation: \"sparkle 2s ease-in-out infinite 0.5s\",\n        }}>\n          <Sparkles size={24} color=\"#F4D03F\" />\n        </div>\n\n        {/* Zayd Mascot */}\n        <div style={{\n          width: 80,\n          height: 80,\n          margin: \"0 auto 16px\",\n          animation: \"bounce 0.6s ease-out\",\n        }}>\n          <img \n            src={mascot} \n            alt=\"Zayd\" \n            style={{ \n              width: \"100%\", \n              height: \"100%\", \n              objectFit: \"contain\",\n            }} \n          />\n        </div>\n\n        {/* Level Up Message */}\n        <h2 style={{\n          color: \"#D4AF37\",\n          fontSize: \"1.5rem\",\n          fontWeight: \"bold\",\n          marginBottom: 8,\n        }}>\n          üåô masha'Allah!\n        </h2>\n\n        <p style={{\n          color: \"rgba(212, 175, 55, 0.9)\",\n          fontSize: \"1.1rem\",\n          marginBottom: 24,\n        }}>\n          You've reached Level {levelUpData.newLevel}!\n        </p>\n\n        {/* New Diamond */}\n        <div style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          gap: 16,\n          marginBottom: 24,\n        }}>\n          <div style={{\n            animation: \"scaleIn 0.5s ease-out 0.3s both\",\n          }}>\n            <DiamondIcon\n              level={levelUpData.newLevel}\n              size={64}\n              animated={true}\n              showGlow={true}\n            />\n          </div>\n        </div>\n\n        <div style={{\n          color: \"#D4AF37\",\n          fontSize: \"1.2rem\",\n          fontWeight: \"bold\",\n          marginBottom: 8,\n        }}>\n          {newLevelData?.name}\n        </div>\n\n        <p style={{\n          color: \"rgba(212, 175, 55, 0.7)\",\n          fontSize: \"0.9rem\",\n          lineHeight: 1.5,\n        }}>\n          Keep up the amazing work! üåü\n        </p>\n\n        {/* Tap to Continue */}\n        <div style={{\n          marginTop: 24,\n          color: \"rgba(212, 175, 55, 0.5)\",\n          fontSize: \"0.75rem\",\n        }}>\n          Tap anywhere to continue\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// CSS Animations (add to global CSS)\nexport const levelUpAnimations = `\n  @keyframes bounceIn {\n    0% {\n      transform: scale(0.3);\n      opacity: 0;\n    }\n    50% {\n      transform: scale(1.05);\n    }\n    70% {\n      transform: scale(0.9);\n    }\n    100% {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n\n  @keyframes bounceOut {\n    0% {\n      transform: scale(1);\n      opacity: 1;\n    }\n    100% {\n      transform: scale(0.3);\n      opacity: 0;\n    }\n  }\n\n  @keyframes scaleIn {\n    0% {\n      transform: scale(0);\n      opacity: 0;\n    }\n    50% {\n      transform: scale(1.2);\n    }\n    100% {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n\n  @keyframes bounce {\n    0%, 100% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-10px);\n    }\n  }\n`;\n","path":null,"size_bytes":5067,"size_tokens":null},"src/components/ViewAllLevelsModal.jsx":{"content":"// src/components/ViewAllLevelsModal.jsx\nimport React, { useState } from \"react\";\nimport { X } from \"lucide-react\";\nimport { DIAMOND_LEVELS, getAllLevelsWithProgress } from \"../utils/diamondLevels\";\nimport { DiamondIcon } from \"./DiamondIcon\";\n\nexport function ViewAllLevelsModal({ currentXP, onClose }) {\n  const levelsWithProgress = getAllLevelsWithProgress(currentXP);\n  const [hoveredLevel, setHoveredLevel] = useState(null);\n\n  return (\n    <div style={{\n      position: \"fixed\",\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      background: \"rgba(0, 0, 0, 0.85)\",\n      zIndex: 1000,\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      padding: 20,\n      animation: \"fadeIn 0.3s ease-out\",\n    }}>\n      <div style={{\n        background: \"linear-gradient(180deg, #0B1E2D 0%, #162C3D 100%)\",\n        borderRadius: 24,\n        maxWidth: 500,\n        width: \"100%\",\n        maxHeight: \"85vh\",\n        overflowY: \"auto\",\n        padding: 24,\n        border: \"2px solid rgba(212, 175, 55, 0.3)\",\n        boxShadow: \"0 0 40px rgba(212, 175, 55, 0.3)\",\n        position: \"relative\",\n      }}>\n        {/* Close Button */}\n        <button\n          onClick={onClose}\n          style={{\n            position: \"absolute\",\n            top: 16,\n            right: 16,\n            background: \"rgba(239, 68, 68, 0.2)\",\n            border: \"1px solid rgba(239, 68, 68, 0.5)\",\n            borderRadius: \"50%\",\n            width: 32,\n            height: 32,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            cursor: \"pointer\",\n            color: \"#ef4444\",\n          }}\n        >\n          <X size={18} />\n        </button>\n\n        {/* Header */}\n        <div style={{ textAlign: \"center\", marginBottom: 32 }}>\n          <h2 style={{\n            background: \"linear-gradient(135deg, #D4AF37 0%, #F4D03F 100%)\",\n            WebkitBackgroundClip: \"text\",\n            WebkitTextFillColor: \"transparent\",\n            fontSize: \"1.8rem\",\n            fontWeight: \"bold\",\n            marginBottom: 8,\n          }}>\n            üíé Diamond Levels\n          </h2>\n          <p style={{\n            color: \"rgba(212, 175, 55, 0.7)\",\n            fontSize: \"0.9rem\",\n          }}>\n            Collect all 10 gems of knowledge!\n          </p>\n        </div>\n\n        {/* Levels Grid */}\n        <div style={{\n          display: \"grid\",\n          gridTemplateColumns: \"repeat(2, 1fr)\",\n          gap: 16,\n        }}>\n          {levelsWithProgress.map((levelData) => {\n            const isHovered = hoveredLevel === levelData.level;\n            const locked = !levelData.isUnlocked;\n\n            return (\n              <div\n                key={levelData.level}\n                onMouseEnter={() => setHoveredLevel(levelData.level)}\n                onMouseLeave={() => setHoveredLevel(null)}\n                style={{\n                  background: levelData.isCurrent\n                    ? \"linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(244, 208, 63, 0.1) 100%)\"\n                    : locked\n                    ? \"rgba(30, 41, 59, 0.5)\"\n                    : \"rgba(212, 175, 55, 0.05)\",\n                  border: levelData.isCurrent\n                    ? \"2px solid #D4AF37\"\n                    : locked\n                    ? \"1px solid rgba(100, 116, 139, 0.3)\"\n                    : \"1px solid rgba(212, 175, 55, 0.2)\",\n                  borderRadius: 16,\n                  padding: 16,\n                  textAlign: \"center\",\n                  cursor: \"pointer\",\n                  transition: \"all 0.3s ease\",\n                  transform: isHovered ? \"scale(1.05)\" : \"scale(1)\",\n                  opacity: locked ? 0.5 : 1,\n                  filter: locked ? \"grayscale(80%)\" : \"none\",\n                }}\n              >\n                {/* Diamond Icon */}\n                <div style={{ marginBottom: 12 }}>\n                  <DiamondIcon\n                    level={levelData.level}\n                    size={isHovered ? 56 : 48}\n                    animated={isHovered && !locked}\n                    showGlow={!locked}\n                  />\n                </div>\n\n                {/* Level Info */}\n                <div style={{\n                  color: locked ? \"rgba(148, 163, 184, 0.7)\" : \"#D4AF37\",\n                  fontWeight: \"bold\",\n                  fontSize: \"1rem\",\n                  marginBottom: 4,\n                }}>\n                  Level {levelData.level}\n                </div>\n\n                <div style={{\n                  color: locked ? \"rgba(148, 163, 184, 0.5)\" : \"rgba(212, 175, 55, 0.7)\",\n                  fontSize: \"0.75rem\",\n                }}>\n                  {levelData.name}\n                </div>\n\n                {/* XP Range */}\n                {isHovered && (\n                  <div style={{\n                    marginTop: 8,\n                    fontSize: \"0.7rem\",\n                    color: locked ? \"rgba(148, 163, 184, 0.6)\" : \"rgba(212, 175, 55, 0.6)\",\n                    animation: \"fadeIn 0.3s ease-out\",\n                  }}>\n                    {levelData.minXP.toLocaleString()} XP\n                  </div>\n                )}\n\n                {/* Current Level Badge */}\n                {levelData.isCurrent && (\n                  <div style={{\n                    marginTop: 8,\n                    background: \"linear-gradient(135deg, #D4AF37 0%, #F4D03F 100%)\",\n                    color: \"#0B1E2D\",\n                    fontSize: \"0.65rem\",\n                    fontWeight: \"bold\",\n                    padding: \"4px 8px\",\n                    borderRadius: 8,\n                    display: \"inline-block\",\n                  }}>\n                    CURRENT\n                  </div>\n                )}\n\n                {/* Locked Icon */}\n                {locked && (\n                  <div style={{\n                    marginTop: 8,\n                    fontSize: \"1.2rem\",\n                  }}>\n                    üîí\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Footer Message */}\n        <div style={{\n          marginTop: 24,\n          padding: 16,\n          background: \"rgba(212, 175, 55, 0.1)\",\n          borderRadius: 12,\n          border: \"1px solid rgba(212, 175, 55, 0.2)\",\n          textAlign: \"center\",\n        }}>\n          <p style={{\n            color: \"rgba(212, 175, 55, 0.8)\",\n            fontSize: \"0.85rem\",\n            margin: 0,\n          }}>\n            üåô Keep learning to unlock higher diamond levels!\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":6629,"size_tokens":null},"src/components/DiamondIcon.jsx":{"content":"// src/components/DiamondIcon.jsx\nimport React from \"react\";\nimport { getCurrentLevel, DIAMOND_LEVELS } from \"../utils/diamondLevels\";\n\nexport const DiamondIcon = React.memo(function DiamondIcon({ \n  xp = null, \n  level = null, \n  size = 24, \n  animated = false, \n  showGlow = true \n}) {\n  // Get level data either from XP or direct level number\n  let levelData;\n  if (xp !== null) {\n    levelData = getCurrentLevel(xp);\n  } else if (level !== null) {\n    levelData = DIAMOND_LEVELS.find(l => l.level === level) || DIAMOND_LEVELS[0];\n  } else {\n    levelData = DIAMOND_LEVELS[0]; // Default to Bronze\n  }\n\n  const diamondSize = size;\n  const innerSize = diamondSize * 0.6;\n\n  return (\n    <div style={{\n      position: \"relative\",\n      width: diamondSize,\n      height: diamondSize,\n      display: \"inline-block\",\n    }}>\n      {/* Glow effect */}\n      {showGlow && (\n        <div style={{\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -50%)\",\n          width: diamondSize * 1.5,\n          height: diamondSize * 1.5,\n          background: levelData.gradient,\n          filter: \"blur(8px)\",\n          opacity: 0.4,\n          borderRadius: \"50%\",\n          animation: levelData.pulse ? \"pulse 2s ease-in-out infinite\" : \"none\",\n        }}/>\n      )}\n      \n      {/* Outer diamond */}\n      <div style={{\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%) rotate(45deg)\",\n        width: diamondSize,\n        height: diamondSize,\n        background: levelData.gradient,\n        boxShadow: showGlow ? levelData.glow : \"none\",\n        animation: animated ? \"sparkle 2s ease-in-out infinite\" : levelData.pulse ? \"pulse 2s ease-in-out infinite\" : \"none\",\n      }}/>\n      \n      {/* Inner diamond (for depth) */}\n      <div style={{\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%) rotate(45deg)\",\n        width: innerSize,\n        height: innerSize,\n        background: \"rgba(255, 255, 255, 0.3)\",\n        backdropFilter: \"blur(2px)\",\n      }}/>\n    </div>\n  );\n});\n\n// CSS animations (add to global CSS or include here as a style tag)\nexport const diamondAnimations = `\n  @keyframes sparkle {\n    0%, 100% {\n      transform: translate(-50%, -50%) rotate(45deg) scale(1);\n      opacity: 1;\n    }\n    50% {\n      transform: translate(-50%, -50%) rotate(45deg) scale(1.1);\n      opacity: 0.8;\n    }\n  }\n\n  @keyframes pulse {\n    0%, 100% {\n      transform: translate(-50%, -50%) rotate(45deg) scale(1);\n      filter: brightness(1);\n    }\n    50% {\n      transform: translate(-50%, -50%) rotate(45deg) scale(1.05);\n      filter: brightness(1.2);\n    }\n  }\n`;\n","path":null,"size_bytes":2747,"size_tokens":null},"src/components/events/EventInfoModal.jsx":{"content":"import React from \"react\";\nimport assets from \"../../assets/assets\";\nimport \"./EventModals.css\";\n\nexport default function EventInfoModal({ event, onStart, onCancel }) {\n  return (\n    <div className=\"event-modal-overlay\">\n      <div className=\"event-modal\">\n        {/* Zayd Header */}\n        <div className=\"modal-mascot-header\">\n          <img src={assets.mascots.mascot_waving} alt=\"Mascot\" className=\"modal-zayd\" />\n        </div>\n\n        {/* Event Info */}\n        <h2 className=\"modal-title\">{event.icon} {event.name}</h2>\n        <p className=\"modal-subtitle\">{event.description}</p>\n\n        {/* Rules Card */}\n        <div className=\"modal-info-card\">\n          <h3 className=\"info-card-title\">Event Rules</h3>\n          <ul className=\"info-card-list\">\n            <li>üìù Answer 10 challenging questions</li>\n            <li>‚è± 60 seconds total time limit</li>\n            <li>üí∞ Entry fee: 25 coins (non-refundable)</li>\n            <li>üèÜ Rewards based on your final rank</li>\n            <li>‚ú® Only your first attempt counts</li>\n          </ul>\n        </div>\n\n        {/* Rewards Card */}\n        <div className=\"modal-info-card\">\n          <h3 className=\"info-card-title\">Rewards (Final Results)</h3>\n          <ul className=\"info-card-list\">\n            <li>ü•á 1st Place: +1000 XP, +300 coins</li>\n            <li>ü•à 2nd-3rd: +750 XP, +200 coins</li>\n            <li>ü•â 4th-10th: +500 XP, +100 coins</li>\n            <li>üéØ All participants: +100 XP, +10 coins</li>\n          </ul>\n        </div>\n\n        {/* Important Note */}\n        <div className=\"modal-note\">\n          <p>üí° Results unlock Thursday 22:00 GMT</p>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"modal-actions\">\n          <button className=\"modal-btn-secondary\" onClick={onCancel}>\n            Cancel\n          </button>\n          <button className=\"modal-btn-primary\" onClick={onStart}>\n            Bismillah - Start Now!\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2021,"size_tokens":null},"src/pages/EventQuiz.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useEventsStore } from \"../store/eventsStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { useVibration } from \"../hooks/useVibration\";\nimport { getEventQuestions } from \"../data/eventQuestions\";\nimport PointingMascot from \"../assets/mascots/mascot_pointing_v2.webp\";\nimport \"./EventQuiz.css\";\n\nexport default function EventQuiz() {\n  const { eventId } = useParams();\n  const navigate = useNavigate();\n  const { getEvents, enterEvent, hasEntered } = useEventsStore();\n  const { coins, removeCoins } = useProgressStore();\n  const { showModal } = useModalStore();\n  const { vibrate } = useVibration();\n  \n  const events = getEvents();\n  const event = events.find(e => e.id === eventId);\n  \n  const [quizStarted, setQuizStarted] = useState(false);\n  const [questions, setQuestions] = useState([]);\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState(null);\n  const [userAnswers, setUserAnswers] = useState([]);\n  const [timeLeft, setTimeLeft] = useState(60); // 60 seconds total\n  const [quizScore, setQuizScore] = useState(0);\n  const [isCompleting, setIsCompleting] = useState(false);\n  const autoAdvanceTimeoutRef = React.useRef(null);\n  const selectedAnswerRef = React.useRef(null);\n\n  // Redirect if invalid event\n  useEffect(() => {\n    if (!event) {\n      navigate(\"/events\");\n      return;\n    }\n  }, [event, navigate]);\n\n  // Show info modal on mount\n  useEffect(() => {\n    if (event) {\n      showModal(MODAL_TYPES.EVENT_INFO, {\n        event,\n        onStart: handleStartQuiz,\n        onCancel: () => navigate(\"/events\")\n      });\n    }\n  }, []);\n\n  // No longer needed - coins checked in handleStartQuiz before countdown\n\n  // Timer countdown\n  useEffect(() => {\n    if (!quizStarted || timeLeft <= 0) return;\n\n    const timer = setInterval(() => {\n      setTimeLeft(prev => {\n        if (prev <= 1) {\n          // Time's up! Auto-submit with current answers\n          // Build final answer if one is selected\n          let finalAnswers = [...userAnswers];\n          if (selectedAnswerRef.current !== null) {\n            const isCorrect = selectedAnswerRef.current === questions[currentQuestionIndex].correct;\n            finalAnswers.push({\n              questionId: questions[currentQuestionIndex].id,\n              selectedAnswer: selectedAnswerRef.current,\n              correct: isCorrect\n            });\n          }\n          handleQuizComplete(finalAnswers);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [quizStarted, timeLeft, userAnswers, questions, currentQuestionIndex]);\n\n  const handleStartQuiz = () => {\n    // Pre-countdown validation: Check coins to prevent wasted countdown\n    if (coins < 25) {\n      alert(\"You need 25 coins to enter this event!\");\n      navigate(\"/events\");\n      return;\n    }\n    \n    // Start countdown\n    showModal(MODAL_TYPES.EVENT_COUNTDOWN, {\n      onComplete: handleCountdownComplete\n    });\n  };\n\n  const handleCountdownComplete = () => {\n    // Critical validations AFTER countdown but BEFORE quiz starts\n    // This ensures atomicity: if checks fail, no coins lost\n    // Prevent duplicate entries and coin deductions\n    if (hasEntered(eventId)) {\n      alert(\"You've already entered this event!\");\n      navigate(\"/events\");\n      return;\n    }\n    \n    // Load questions FIRST to validate\n    const eventQuestions = getEventQuestions(eventId, 10);\n    \n    if (!eventQuestions || eventQuestions.length === 0) {\n      alert(\"Error loading quiz questions. Please try again.\");\n      navigate(\"/events\");\n      return;\n    }\n    \n    // Deduct coins ONLY after confirming questions loaded\n    const success = removeCoins(25);\n    if (!success) {\n      alert(\"You don't have enough coins! You need 25 coins to enter.\");\n      navigate(\"/events\");\n      return;\n    }\n    \n    // Start quiz FIRST (atomic with coin deduction)\n    setQuestions(eventQuestions);\n    setQuizStarted(true);\n    \n    // Record entry IMMEDIATELY after quiz starts (transactional integrity)\n    // This prevents coin loss if user refreshes during quiz\n    // Entry will be updated with final score when quiz completes\n    enterEvent(eventId, 0, []);\n  };\n\n  const handleAnswerSelect = (answerIndex) => {\n    if (selectedAnswer !== null || isCompleting) return; // Prevent double-selection\n    \n    setSelectedAnswer(answerIndex);\n    selectedAnswerRef.current = answerIndex; // Store in ref for timeout closure\n    \n    // Auto-advance after 500ms for better UX\n    autoAdvanceTimeoutRef.current = setTimeout(() => {\n      handleNextQuestion();\n    }, 500);\n  };\n\n  const handleNextQuestion = () => {\n    const answer = selectedAnswerRef.current;\n    if (answer === null || isCompleting) return; // Safety check using ref\n    \n    // Clear any pending auto-advance\n    if (autoAdvanceTimeoutRef.current) {\n      clearTimeout(autoAdvanceTimeoutRef.current);\n      autoAdvanceTimeoutRef.current = null;\n    }\n    \n    // Build new answer entry\n    const isCorrect = answer === questions[currentQuestionIndex].correct;\n    const newAnswer = {\n      questionId: questions[currentQuestionIndex].id,\n      selectedAnswer: answer,\n      correct: isCorrect\n    };\n    \n    // Haptic feedback based on answer correctness\n    if (isCorrect) {\n      vibrate([50, 30, 50]); // Success pattern\n    } else {\n      vibrate(200); // Error buzz\n    }\n    \n    // Build complete answers array\n    const updatedAnswers = [...userAnswers, newAnswer];\n    setUserAnswers(updatedAnswers);\n\n    // Move to next or finish\n    if (currentQuestionIndex < questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n      setSelectedAnswer(null);\n      selectedAnswerRef.current = null; // Reset ref\n    } else {\n      // Pass complete answers to avoid async setState issue\n      handleQuizComplete(updatedAnswers);\n    }\n  };\n\n  const handleQuizComplete = (finalAnswers = userAnswers) => {\n    if (isCompleting) return; // Prevent double-completion\n    setIsCompleting(true);\n    \n    // Clear any pending auto-advance\n    if (autoAdvanceTimeoutRef.current) {\n      clearTimeout(autoAdvanceTimeoutRef.current);\n      autoAdvanceTimeoutRef.current = null;\n    }\n    \n    setQuizStarted(false);\n    \n    // Calculate final score using passed-in answers (includes last answer)\n    const score = finalAnswers.filter(a => a.correct).length;\n    setQuizScore(score);\n    \n    // Calculate completion time (60 seconds total - remaining time)\n    const completionTime = 60 - timeLeft;\n    \n    // UPDATE entry with final score, answers, and completion time\n    // Entry was already created in handleCountdownComplete with score=0\n    enterEvent(eventId, score, finalAnswers, completionTime);\n    \n    // Show provisional results\n    showModal(MODAL_TYPES.EVENT_PROVISIONAL_RESULTS, {\n      event,\n      score,\n      totalQuestions: questions.length,\n      onClose: () => navigate(\"/events\")\n    });\n  };\n\n  if (!event) return null;\n\n  // Only calculate currentQuestion if questions exist\n  const currentQuestion = questions.length > 0 ? questions[currentQuestionIndex] : null;\n  const progress = questions.length > 0 ? ((currentQuestionIndex + 1) / questions.length) * 100 : 0;\n\n  return (\n    <div className=\"screen no-extra-space event-quiz-container\">\n      {/* Quiz Screen */}\n      {quizStarted && currentQuestion && (\n        <>\n          {/* Header */}\n          <div className=\"quiz-header\">\n            <div className=\"quiz-event-name\">{event.icon} {event.name}</div>\n            <div className=\"quiz-timer\" style={{\n              color: timeLeft <= 10 ? '#ef4444' : '#10b981'\n            }}>\n              ‚è± {timeLeft}s\n            </div>\n          </div>\n\n          {/* Progress Bar */}\n          <div className=\"quiz-progress-container\">\n            <div className=\"quiz-progress-bar\" style={{ width: `${progress}%` }} />\n          </div>\n          <p className=\"quiz-progress-text\">\n            Question {currentQuestionIndex + 1} of {questions.length}\n          </p>\n\n          {/* Question Card */}\n          <div className=\"quiz-question-card\">\n            <h2 className=\"quiz-question-text\">{currentQuestion.question}</h2>\n            \n            {/* Answer Options */}\n            <div className=\"quiz-options\">\n              {currentQuestion.options.map((option, index) => (\n                <button\n                  key={index}\n                  className={`quiz-option ${selectedAnswer === index ? 'selected' : ''}`}\n                  onClick={() => handleAnswerSelect(index)}\n                  disabled={selectedAnswer !== null || isCompleting}\n                >\n                  <span className=\"option-letter\">{String.fromCharCode(65 + index)}</span>\n                  <span className=\"option-text\">{option}</span>\n                </button>\n              ))}\n            </div>\n\n            {/* Auto-advancing - no Next button needed */}\n            <p className=\"quiz-auto-advance-hint\">\n              {selectedAnswer === null ? 'Select your answer...' : 'Moving to next question...'}\n            </p>\n          </div>\n\n          {/* Mascot - Always show pointing_v2 during quiz */}\n          <div className=\"quiz-mascot\">\n            <img src={PointingMascot} alt=\"Mascot\" />\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":9582,"size_tokens":null},"src/components/events/ProvisionalResultsModal.jsx":{"content":"import React from \"react\";\nimport { useEventsStore } from \"../../store/eventsStore\";\nimport SittingMascot from \"../../assets/mascots/mascot_sitting_v2.webp\";\nimport CongratsMascot from \"../../assets/mascots/mascot_congratulation.webp\";\nimport \"./EventModals.css\";\n\nexport default function ProvisionalResultsModal({ event, score, totalQuestions, onClose }) {\n  const { getEntry } = useEventsStore();\n  const entry = getEntry(event.id);\n  const provisionalRank = entry?.provisionalRank || \"?\";\n  \n  // Events have 10 questions, use 75% threshold (8/10) for congratulation mascot\n  const passed = score >= Math.ceil(totalQuestions * 0.75);\n  const mascotImg = passed ? CongratsMascot : SittingMascot;\n\n  return (\n    <div className=\"event-modal-overlay\">\n      <div className=\"event-modal provisional-modal\">\n        {/* Zayd Header */}\n        <div className=\"modal-mascot-header\">\n          <img src={mascotImg} alt=\"Mascot\" className=\"modal-zayd bounce\" />\n        </div>\n\n        {/* Title */}\n        <h2 className=\"modal-title\">Quiz Complete! üéØ</h2>\n        <p className=\"modal-subtitle\">Provisional Results</p>\n\n        {/* Score Card */}\n        <div className=\"results-score-card\">\n          <div className=\"score-display\">\n            <span className=\"score-number\">{score}</span>\n            <span className=\"score-total\">/ {totalQuestions}</span>\n          </div>\n          <p className=\"score-label\">Correct Answers</p>\n        </div>\n\n        {/* Provisional Rank */}\n        <div className=\"provisional-rank-card\">\n          <div className=\"rank-icon\">üìä</div>\n          <div className=\"rank-info\">\n            <p className=\"rank-label\">Provisional Rank Estimate</p>\n            <p className=\"rank-number\">~#{provisionalRank}</p>\n          </div>\n        </div>\n\n        {/* Info Message */}\n        <div className=\"modal-info-message\">\n          <p className=\"info-icon\">‚è∞</p>\n          <p className=\"info-text\">\n            <strong>Official results</strong> will be released on<br />\n            <span className=\"highlight\">Thursday at 10:00 PM GMT</span>\n          </p>\n        </div>\n\n        {/* XP Info */}\n        <div className=\"modal-note\">\n          <p>üí∞ Entry fee: -25 coins (already deducted)</p>\n          <p>‚ú® Rewards will be given based on your final rank</p>\n        </div>\n\n        {/* Action Button */}\n        <button className=\"modal-btn-primary\" onClick={onClose}>\n          Back to Events\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2484,"size_tokens":null},"src/pages/EventQuiz.css":{"content":"/* Event Quiz Page Styles */\n\n.event-quiz-container {\n  padding: 20px 16px;\n  background: radial-gradient(circle at 20% 20%, rgba(10, 15, 30, 1) 0%, rgba(3, 6, 20, 1) 70%);\n}\n\n/* Quiz Header */\n.quiz-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.quiz-event-name {\n  color: #d4af37;\n  font-size: 1.1rem;\n  font-weight: 700;\n}\n\n.quiz-timer {\n  font-size: 1.3rem;\n  font-weight: 700;\n  padding: 8px 16px;\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 12px;\n  border: 2px solid currentColor;\n  box-shadow: 0 0 15px currentColor;\n}\n\n/* Progress Bar */\n.quiz-progress-container {\n  height: 8px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.quiz-progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, #10b981 0%, #d4af37 100%);\n  transition: width 0.3s ease;\n  box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);\n}\n\n.quiz-progress-text {\n  color: #94a3b8;\n  font-size: 0.85rem;\n  text-align: center;\n  margin-bottom: 24px;\n}\n\n/* Question Card */\n.quiz-question-card {\n  background: rgba(255, 255, 255, 0.05);\n  border: 2px solid rgba(212, 175, 55, 0.3);\n  border-radius: 20px;\n  padding: 24px;\n  margin-bottom: 24px;\n  box-shadow: 0 0 30px rgba(212, 175, 55, 0.2);\n}\n\n.quiz-question-text {\n  color: #fff;\n  font-size: 1.15rem;\n  font-weight: 600;\n  line-height: 1.6;\n  margin-bottom: 24px;\n}\n\n/* Auto-advance Hint */\n.quiz-auto-advance-hint {\n  text-align: center;\n  color: #10b981;\n  font-size: 0.9rem;\n  font-weight: 600;\n  margin-top: 20px;\n  padding: 12px;\n  background: rgba(16, 185, 129, 0.1);\n  border-radius: 10px;\n  border: 1px solid rgba(16, 185, 129, 0.3);\n}\n\n/* Answer Options */\n.quiz-options {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin-bottom: 24px;\n}\n\n.quiz-option {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  background: rgba(255, 255, 255, 0.08);\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 14px;\n  padding: 16px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  text-align: left;\n}\n\n.quiz-option:hover {\n  background: rgba(255, 255, 255, 0.12);\n  border-color: rgba(212, 175, 55, 0.5);\n}\n\n.quiz-option.selected {\n  background: rgba(212, 175, 55, 0.2);\n  border-color: #d4af37;\n  box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);\n}\n\n.option-letter {\n  min-width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(212, 175, 55, 0.3);\n  color: #d4af37;\n  font-weight: 700;\n  border-radius: 8px;\n  font-size: 0.95rem;\n}\n\n.quiz-option.selected .option-letter {\n  background: #d4af37;\n  color: #0B1E2D;\n}\n\n.option-text {\n  flex: 1;\n  color: #e2e8f0;\n  font-size: 0.95rem;\n  line-height: 1.5;\n}\n\n/* Next Button */\n.quiz-next-btn {\n  width: 100%;\n  padding: 16px;\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: #fff;\n  font-size: 1.05rem;\n  font-weight: 700;\n  border: none;\n  border-radius: 14px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  box-shadow: 0 4px 20px rgba(16, 185, 129, 0.3);\n}\n\n.quiz-next-btn:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 25px rgba(16, 185, 129, 0.4);\n}\n\n.quiz-next-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Mascot */\n.quiz-mascot {\n  position: fixed;\n  bottom: 100px;\n  right: 20px;\n  width: 80px;\n  height: 80px;\n  animation: float 3s ease-in-out infinite;\n}\n\n.quiz-mascot img {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));\n}\n\n@keyframes float {\n  0%, 100% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-10px);\n  }\n}\n","path":null,"size_bytes":3668,"size_tokens":null},"src/pages/GlobalEvents.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { Globe } from \"lucide-react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useEventsStore } from \"../store/eventsStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { getAvatarImage } from \"../utils/avatarUtils\";\nimport \"./GlobalEvents.css\";\n\nexport default function GlobalEvents() {\n  const navigate = useNavigate();\n  const {\n    getEvents,\n    hasEntered,\n    areResultsUnlocked,\n    getTimeUntilResults,\n    checkWeekReset,\n    areResultsViewed,\n    getEntry,\n    loadMyEntries,\n    loadLeaderboard,\n    getMyRank,\n    claimEventRewards\n  } = useEventsStore();\n  \n  const { coins } = useProgressStore();\n  const { showModal } = useModalStore();\n  const events = getEvents();\n  const resultsUnlocked = areResultsUnlocked();\n  \n  const [timeLeft, setTimeLeft] = useState(\"\");\n  const [selectedEvent, setSelectedEvent] = useState(null);\n  const [isLoadingEvents, setIsLoadingEvents] = useState(true);\n\n  // Check for week reset on mount, load cloud entries\n  useEffect(() => {\n    const initEvents = async () => {\n      setIsLoadingEvents(true);\n      checkWeekReset();\n      \n      // Load cloud entries for the current week\n      try {\n        await loadMyEntries();\n      } catch (err) {\n        console.log('Cloud entries not available:', err.message);\n      }\n      \n      setIsLoadingEvents(false);\n    };\n    \n    initEvents();\n  }, [checkWeekReset, loadMyEntries]);\n\n  // Update countdown timer\n  useEffect(() => {\n    const updateTimer = () => {\n      const ms = getTimeUntilResults();\n      const days = Math.floor(ms / (1000 * 60 * 60 * 24));\n      const hours = Math.floor((ms % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n      const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));\n      \n      if (days > 0) {\n        setTimeLeft(`${days}d ${hours}h until results`);\n      } else if (hours > 0) {\n        setTimeLeft(`${hours}h ${minutes}m until results`);\n      } else {\n        setTimeLeft(`${minutes}m until results`);\n      }\n    };\n\n    updateTimer();\n    const interval = setInterval(updateTimer, 60000); // Update every minute\n    return () => clearInterval(interval);\n  }, [getTimeUntilResults]);\n\n  const handleEventClick = (event) => {\n    // Show Ramadan coming soon modal\n    showModal(MODAL_TYPES.RAMADAN_COMING_SOON);\n  };\n\n  return (\n    <div className=\"screen no-extra-space global-events-container\" style={{ position: \"relative\" }}>\n      {/* Back Button */}\n      <div style={{ padding: \"16px 16px 0\" }}>\n        <button className=\"back-btn\" onClick={() => navigate(\"/challenge\")}>\n          ‚Üê Back\n        </button>\n      </div>\n\n      {/* Header */}\n      <div className=\"events-header\" style={{ textAlign: \"center\", padding: \"16px 20px\" }}>\n        <h1 className=\"events-title\" style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", gap: 8, margin: 0 }}>\n          <Globe size={24} style={{ color: '#D4AF37' }} />\n          Global Events\n        </h1>\n        <p className=\"events-subtitle\" style={{ textAlign: \"center\", margin: \"8px 0 16px\", color: \"#94a3b8\" }}>Compete with Muslims worldwide</p>\n        \n        {/* Info Section */}\n        <div style={{ \n          background: \"rgba(212, 175, 55, 0.1)\", \n          borderRadius: 12, \n          padding: \"12px 16px\",\n          border: \"1px solid rgba(212, 175, 55, 0.2)\",\n          display: \"inline-block\",\n          textAlign: \"center\"\n        }}>\n          <p style={{ color: \"#cbd5e1\", fontSize: \"0.85rem\", margin: \"0 0 4px\" }}>\n            <span style={{ color: \"#D4AF37\" }}>Entry fee:</span> 25 coins per event\n          </p>\n          <p style={{ color: \"#cbd5e1\", fontSize: \"0.85rem\", margin: \"0 0 4px\" }}>\n            <span style={{ color: \"#D4AF37\" }}>Weekly reset:</span> Friday 00:00 GMT\n          </p>\n          <p style={{ color: \"#cbd5e1\", fontSize: \"0.85rem\", margin: 0 }}>\n            <span style={{ color: \"#D4AF37\" }}>Rewards:</span> Based on your rank\n          </p>\n        </div>\n      </div>\n\n      {/* Loading State */}\n      {isLoadingEvents && (\n        <div style={{\n          padding: \"40px 20px\",\n          textAlign: \"center\",\n          color: \"#D4AF37\"\n        }}>\n          <div style={{ fontSize: \"2rem\", marginBottom: \"12px\" }}>‚è≥</div>\n          <p>Loading events...</p>\n        </div>\n      )}\n\n      {/* Event Cards Grid */}\n      {!isLoadingEvents && (\n      <div className=\"events-grid\">\n        {events.map((event) => {\n          const entered = hasEntered(event.id);\n          const hasResults = resultsUnlocked && entered;\n          const viewed = areResultsViewed(event.id);\n          \n          return (\n            <div\n              key={event.id}\n              className={`event-card ${hasResults && !viewed ? 'pulsing' : ''}`}\n              style={{\n                background: event.theme.gradient,\n                boxShadow: `${event.theme.glow}, 0 4px 20px rgba(0,0,0,0.3)`\n              }}\n              onClick={() => handleEventClick(event)}\n            >\n              {/* Event Icon */}\n              <div className=\"event-icon\">{event.icon}</div>\n              \n              {/* Event Name */}\n              <h3 className=\"event-name\">{event.name}</h3>\n              \n              {/* Event Description */}\n              <p className=\"event-description\">{event.description}</p>\n              \n              {/* Entry Info */}\n              <div className=\"event-footer\">\n                <span className=\"event-entry-fee\">üí∞ 25 coins</span>\n                <span className=\"event-leaderboard-icon\">üìä</span>\n              </div>\n\n              {/* Entered Badge - Bottom Center */}\n              {entered && (\n                <div className=\"event-entered-badge\">\n                  ‚úÖ Entered\n                </div>\n              )}\n\n              {/* New Event Badge (for un-entered events) */}\n              {!entered && (\n                <div className=\"new-event-badge\">Coming soon</div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":6197,"size_tokens":null},"src/components/events/EventModals.css":{"content":"/* Event Modals Shared Styles */\n\n.event-modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.95);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 20px;\n  padding-top: max(20px, env(safe-area-inset-top, 20px));\n  padding-right: max(20px, env(safe-area-inset-right, 20px));\n  padding-bottom: max(20px, env(safe-area-inset-bottom, 20px));\n  padding-left: max(20px, env(safe-area-inset-left, 20px));\n  overflow-y: auto;\n}\n\n.event-modal {\n  background: radial-gradient(circle at 20% 20%, rgba(15, 25, 45, 1) 0%, rgba(5, 10, 25, 1) 70%);\n  border: 2px solid rgba(212, 175, 55, 0.5);\n  border-radius: 24px;\n  padding: 24px;\n  max-width: 500px;\n  width: 100%;\n  max-height: 85%;\n  overflow-y: auto;\n  box-shadow: 0 0 40px rgba(212, 175, 55, 0.3);\n  animation: modalSlideIn 0.3s ease;\n}\n\n@keyframes modalSlideIn {\n  from {\n    transform: translateY(30px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n/* Modal Header with Zayd */\n.modal-mascot-header {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 16px;\n}\n\n.modal-zayd {\n  width: 100px;\n  height: 100px;\n  object-fit: contain;\n  filter: drop-shadow(0 4px 15px rgba(212, 175, 55, 0.3));\n}\n\n.modal-zayd.bounce {\n  animation: bounce 0.6s ease-in-out 2;\n}\n\n.modal-zayd.celebrate {\n  animation: celebrate 1s ease-in-out infinite;\n}\n\n@keyframes bounce {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-15px); }\n}\n\n@keyframes celebrate {\n  0%, 100% { transform: rotate(-5deg) scale(1); }\n  50% { transform: rotate(5deg) scale(1.05); }\n}\n\n/* Modal Title */\n.modal-title {\n  color: #fff;\n  font-size: 1.5rem;\n  font-weight: 700;\n  text-align: center;\n  margin-bottom: 8px;\n  background: linear-gradient(90deg, #fff 0%, #d4af37 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n}\n\n.modal-subtitle {\n  color: #94a3b8;\n  font-size: 1rem;\n  text-align: center;\n  margin-bottom: 20px;\n}\n\n/* Info Cards */\n.modal-info-card {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(212, 175, 55, 0.3);\n  border-radius: 16px;\n  padding: 16px;\n  margin-bottom: 16px;\n}\n\n.info-card-title {\n  color: #d4af37;\n  font-size: 1rem;\n  font-weight: 700;\n  margin-bottom: 12px;\n}\n\n.info-card-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.info-card-list li {\n  color: #e2e8f0;\n  font-size: 0.9rem;\n  line-height: 1.8;\n  padding-left: 8px;\n}\n\n/* Modal Note */\n.modal-note {\n  background: rgba(16, 185, 129, 0.1);\n  border: 1px solid rgba(16, 185, 129, 0.3);\n  border-radius: 12px;\n  padding: 12px;\n  margin-bottom: 20px;\n}\n\n.modal-note p {\n  color: #10b981;\n  font-size: 0.85rem;\n  margin: 4px 0;\n  text-align: center;\n}\n\n/* Modal Actions */\n.modal-actions {\n  display: flex;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.modal-btn-primary,\n.modal-btn-secondary {\n  flex: 1;\n  padding: 14px;\n  font-size: 1rem;\n  font-weight: 700;\n  border: none;\n  border-radius: 14px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.modal-btn-primary {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: #fff;\n  box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);\n}\n\n.modal-btn-primary:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);\n}\n\n.modal-btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: #d4af37;\n  border: 2px solid rgba(212, 175, 55, 0.4);\n}\n\n.modal-btn-secondary:hover {\n  background: rgba(212, 175, 55, 0.2);\n  border-color: #d4af37;\n}\n\n/* === COUNTDOWN MODAL === */\n\n.countdown-modal {\n  background: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 30px;\n  box-shadow: none;\n  width: 100%;\n  max-width: none;\n  height: auto;\n}\n\n@keyframes pulseGlow {\n  0%, 100% {\n    box-shadow: 0 0 60px rgba(212, 175, 55, 0.5);\n  }\n  50% {\n    box-shadow: 0 0 80px rgba(212, 175, 55, 0.7);\n  }\n}\n\n.countdown-modal .countdown-mascot {\n  width: 200px;\n  height: 200px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: radial-gradient(circle, rgba(212, 175, 55, 0.15) 0%, transparent 70%);\n  border-radius: 50%;\n  padding: 20px;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n.countdown-rocket {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  filter: drop-shadow(0 8px 20px rgba(212, 175, 55, 0.4));\n}\n\n.countdown-modal .countdown-number {\n  font-size: 10rem;\n  font-weight: 900;\n  color: #d4af37;\n  text-shadow: 0 0 50px rgba(212, 175, 55, 0.9);\n  line-height: 1;\n}\n\n.countdown-modal .countdown-message {\n  color: #10b981;\n  font-size: 1.5rem;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n  margin-top: 10px;\n}\n\n/* === PROVISIONAL RESULTS MODAL === */\n\n.provisional-modal {\n  text-align: center;\n}\n\n.results-score-card {\n  background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(212, 175, 55, 0.2) 100%);\n  border: 2px solid rgba(16, 185, 129, 0.5);\n  border-radius: 20px;\n  padding: 24px;\n  margin-bottom: 20px;\n  box-shadow: 0 0 25px rgba(16, 185, 129, 0.3);\n}\n\n.score-display {\n  font-size: 3.5rem;\n  font-weight: 900;\n  color: #fff;\n  margin-bottom: 8px;\n}\n\n.score-number {\n  color: #10b981;\n}\n\n.score-total {\n  color: #94a3b8;\n  font-size: 2rem;\n}\n\n.score-label {\n  color: #cbd5e1;\n  font-size: 1rem;\n  margin: 0;\n}\n\n.provisional-rank-card {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(212, 175, 55, 0.3);\n  border-radius: 16px;\n  padding: 16px;\n  margin-bottom: 20px;\n}\n\n.rank-icon {\n  font-size: 2.5rem;\n}\n\n.rank-info {\n  flex: 1;\n  text-align: left;\n}\n\n.rank-label {\n  color: #94a3b8;\n  font-size: 0.85rem;\n  margin-bottom: 4px;\n}\n\n.rank-number {\n  color: #d4af37;\n  font-size: 1.8rem;\n  font-weight: 700;\n  margin: 0;\n}\n\n.modal-info-message {\n  background: rgba(59, 130, 246, 0.1);\n  border: 2px solid rgba(59, 130, 246, 0.3);\n  border-radius: 16px;\n  padding: 16px;\n  margin-bottom: 16px;\n  text-align: center;\n}\n\n.info-icon {\n  font-size: 2rem;\n  margin-bottom: 8px;\n}\n\n.info-text {\n  color: #e2e8f0;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  margin: 0;\n}\n\n.info-text strong {\n  color: #3b82f6;\n}\n\n.highlight {\n  color: #d4af37;\n  font-weight: 700;\n}\n\n/* === FINAL RESULTS MODAL === */\n\n.final-results-modal {\n  max-width: 600px;\n}\n\n.zayd-message-card {\n  background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(16, 185, 129, 0.2) 100%);\n  border: 2px solid rgba(212, 175, 55, 0.4);\n  border-radius: 16px;\n  padding: 16px;\n  margin-bottom: 20px;\n}\n\n.zayd-message {\n  color: #fff;\n  font-size: 1.05rem;\n  font-weight: 600;\n  text-align: center;\n  margin: 0;\n}\n\n.your-rank-card {\n  background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(212, 175, 55, 0.2) 100%);\n  border: 3px solid #10b981;\n  border-radius: 20px;\n  padding: 20px;\n  margin-bottom: 24px;\n  text-align: center;\n  box-shadow: 0 0 30px rgba(16, 185, 129, 0.4);\n}\n\n.rank-label {\n  color: #94a3b8;\n  font-size: 0.9rem;\n  margin-bottom: 8px;\n}\n\n.rank-display {\n  font-size: 3rem;\n  font-weight: 900;\n  color: #10b981;\n  margin: 0 0 8px 0;\n}\n\n.rank-score {\n  color: #cbd5e1;\n  font-size: 1.1rem;\n  margin: 0;\n}\n\n/* Leaderboard */\n.leaderboard-section {\n  margin-bottom: 24px;\n}\n\n.leaderboard-title {\n  color: #d4af37;\n  font-size: 1.2rem;\n  font-weight: 700;\n  margin-bottom: 16px;\n  text-align: center;\n}\n\n.leaderboard-list {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.leaderboard-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 14px;\n  padding: 12px;\n  transition: all 0.3s ease;\n}\n\n.leaderboard-item.gold {\n  background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%);\n  border-color: #d4af37;\n  box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);\n}\n\n.leaderboard-item.silver {\n  background: linear-gradient(135deg, rgba(192, 192, 192, 0.2) 0%, rgba(169, 169, 169, 0.1) 100%);\n  border-color: #c0c0c0;\n  box-shadow: 0 0 15px rgba(192, 192, 192, 0.3);\n}\n\n.leaderboard-item.bronze {\n  background: linear-gradient(135deg, rgba(205, 127, 50, 0.2) 0%, rgba(184, 115, 51, 0.1) 100%);\n  border-color: #cd7f32;\n}\n\n.leaderboard-item.user-item {\n  background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(5, 150, 105, 0.2) 100%);\n  border-color: #10b981;\n  box-shadow: 0 0 25px rgba(16, 185, 129, 0.5);\n}\n\n.leaderboard-rank {\n  min-width: 40px;\n  color: #d4af37;\n  font-size: 1.1rem;\n  font-weight: 700;\n  text-align: center;\n}\n\n.leaderboard-avatar {\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  border: 2px solid rgba(212, 175, 55, 0.5);\n  object-fit: cover;\n}\n\n.leaderboard-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.leaderboard-name {\n  color: #fff;\n  font-size: 0.95rem;\n  font-weight: 600;\n  margin-bottom: 4px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  line-height: 1.2;\n  max-width: 100%;\n}\n\n.leaderboard-score {\n  color: #10b981;\n  font-size: 1.1rem;\n  font-weight: 700;\n  min-width: 50px;\n  text-align: right;\n}\n\n.user-rank-highlight {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 2px solid rgba(212, 175, 55, 0.3);\n}\n\n/* Full Leaderboard */\n.full-leaderboard-section {\n  margin-top: 24px;\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.full-leaderboard-list {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.leaderboard-item-compact {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 10px;\n  padding: 10px;\n}\n\n.leaderboard-item-compact.user-item {\n  background: rgba(16, 185, 129, 0.2);\n  border-color: #10b981;\n}\n\n.compact-rank {\n  min-width: 35px;\n  color: #94a3b8;\n  font-size: 0.9rem;\n  font-weight: 600;\n}\n\n.compact-avatar {\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  border: 2px solid rgba(212, 175, 55, 0.4);\n}\n\n.compact-name {\n  flex: 1;\n  color: #e2e8f0;\n  font-size: 0.9rem;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: normal;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  line-height: 1.2;\n}\n\n.compact-score {\n  color: #10b981;\n  font-size: 0.95rem;\n  font-weight: 600;\n  min-width: 45px;\n  text-align: right;\n}\n","path":null,"size_bytes":10503,"size_tokens":null},"src/components/events/FinalResultsModal.jsx":{"content":"import React, { useState, useEffect, useRef } from \"react\";\nimport { useEventsStore, EMPTY_LEADERBOARD } from \"../../store/eventsStore\";\nimport { useProgressStore } from \"../../store/progressStore\";\nimport { useUserStore } from \"../../store/useUserStore\";\nimport { useAnalytics } from \"../../hooks/useAnalytics\";\nimport { shallow } from \"zustand/shallow\";\nimport assets from \"../../assets/assets\";\nimport { LevelBadge } from \"../LevelBadge\";\nimport { getAvatarImage } from \"../../utils/avatarUtils\";\nimport \"./EventModals.css\";\n\nexport default function FinalResultsModal({ event, onClose }) {\n  // Separate selectors to avoid shallow comparison issues\n  const weekId = useEventsStore(state => state.currentWeekId);\n  const entry = useEventsStore(state => state.weeklyEntries[event.id] ?? null);\n  const leaderboard = useEventsStore(state => {\n    const wid = state.currentWeekId;\n    return wid ? (state.leaderboards[wid]?.[event.id] ?? EMPTY_LEADERBOARD) : EMPTY_LEADERBOARD;\n  });\n  \n  const { addXPAndCoins, xp } = useProgressStore();\n  const { nickname, avatar } = useUserStore();\n  const analytics = useAnalytics();\n  \n  const [showFullLeaderboard, setShowFullLeaderboard] = useState(false);\n  const hasInitialized = useRef(false);\n  \n  // Derived state\n  const hasLeaderboard = leaderboard !== EMPTY_LEADERBOARD && leaderboard.length > 0;\n  const isLoading = entry && !hasLeaderboard;\n  \n  // Calculate userRank from leaderboard\n  const userIndex = leaderboard.findIndex(p => p.userId === \"current_user\");\n  const userRank = userIndex >= 0 ? userIndex + 1 : null;\n  \n  // Single initialization effect\n  useEffect(() => {\n    if (hasInitialized.current) return;\n    if (!entry) return;\n    \n    // Generate leaderboard\n    if (!hasLeaderboard) {\n      const generateMockLeaderboard = useEventsStore.getState().generateMockLeaderboard;\n      generateMockLeaderboard(event.id, entry);\n    }\n    \n    // Grant rewards if we have a rank\n    if (userRank) {\n      const grantRewardsForEvent = useEventsStore.getState().grantRewardsForEvent;\n      const rewards = grantRewardsForEvent(event.id, userRank);\n      \n      if (rewards) {\n        addXPAndCoins(rewards.xpReward, rewards.coinReward);\n        \n        // Track event reward for analytics\n        analytics('event_reward', {\n          eventId: event.id,\n          eventName: event.name,\n          userRank,\n          xpEarned: rewards.xpReward,\n          coinsEarned: rewards.coinReward\n        });\n      }\n    }\n    \n    hasInitialized.current = true;\n  }, [event.id, entry, hasLeaderboard, userRank, addXPAndCoins, analytics]);\n  \n  // Get Zayd message based on rank\n  const getZaydMessage = () => {\n    if (!userRank) return \"Keep learning and growing! üåô\";\n    \n    if (userRank === 1) return \"SubhanAllah! You conquered this week! üèÜ\";\n    if (userRank <= 10) return \"masha'Allah! You're a top achiever! üåü\";\n    if (userRank <= 100) return \"Great effort ‚Äî keep climbing! üí™\";\n    return \"Next week is yours, insha'Allah! üåô\";\n  };\n  \n  const zaydImage = assets.mascots.mascot_congratulation;\n  \n  // Handle missing entry (error state)\n  if (!entry) {\n    return (\n      <div className=\"event-modal-overlay\">\n        <div className=\"event-modal\">\n          <p>Error: No entry found</p>\n          <button onClick={onClose} className=\"modal-close-btn\">Close</button>\n        </div>\n      </div>\n    );\n  }\n  \n  // Handle loading state\n  if (isLoading) {\n    return (\n      <div className=\"event-modal-overlay\">\n        <div className=\"event-modal\">\n          <p>Loading results...</p>\n        </div>\n      </div>\n    );\n  }\n  \n  const top10 = leaderboard.slice(0, 10);\n  const userEntry = leaderboard.find(p => p.userId === \"current_user\");\n\n  return (\n    <div className=\"event-modal-overlay\">\n      <div className=\"event-modal final-results-modal\">\n        {/* Header */}\n        <div className=\"modal-mascot-header\">\n          <img src={zaydImage} alt=\"Zayd\" className=\"modal-zayd celebrate\" />\n        </div>\n        \n        <h2 className=\"modal-title\">üèÜ Global Event Results üèÜ</h2>\n        <p className=\"modal-subtitle\">{event.icon} {event.name}</p>\n\n        {/* Zayd Message */}\n        <div className=\"zayd-message-card\">\n          <p className=\"zayd-message\">{getZaydMessage()}</p>\n        </div>\n\n        {/* Your Rank */}\n        {userRank && (\n          <div className=\"your-rank-card\">\n            <p className=\"rank-label\">Your Final Rank</p>\n            <p className=\"rank-display\">#{userRank}</p>\n            <p className=\"rank-score\">Score: {entry.score}/10</p>\n          </div>\n        )}\n\n        {/* Top 10 Leaderboard */}\n        <div className=\"leaderboard-section\">\n          <h3 className=\"leaderboard-title\">üèÖ Top 10 Champions</h3>\n          <div className=\"leaderboard-list\">\n            {top10.map((player, index) => {\n              const isUser = player.userId === \"current_user\";\n              const rankClass = index === 0 ? 'gold' : index <= 2 ? 'silver' : 'bronze';\n              \n              return (\n                <div\n                  key={player.userId}\n                  className={`leaderboard-item ${rankClass} ${isUser ? 'user-item' : ''}`}\n                >\n                  <div className=\"leaderboard-rank\">#{index + 1}</div>\n                  <img\n                    src={getAvatarImage(\n                      isUser ? avatar : player.avatar,\n                      { userId: player.userId, nickname: isUser ? nickname : player.nickname }\n                    )}\n                    alt={player.nickname}\n                    className=\"leaderboard-avatar\"\n                  />\n                  <div className=\"leaderboard-info\">\n                    <p className=\"leaderboard-name\">{isUser ? nickname : player.nickname}</p>\n                    <LevelBadge xp={isUser ? xp : (player.xp || 0)} size=\"small\" />\n                  </div>\n                  <div className=\"leaderboard-score\">{player.score}/10</div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* User's Rank if outside top 10 */}\n        {userEntry && userRank && userRank > 10 && (\n          <div className=\"user-rank-highlight\">\n            <div className=\"leaderboard-item user-item\">\n              <div className=\"leaderboard-rank\">#{userRank}</div>\n              <img\n                src={getAvatarImage(avatar, { userId: \"current_user\", nickname })}\n                alt={nickname}\n                className=\"leaderboard-avatar\"\n              />\n              <div className=\"leaderboard-info\">\n                <p className=\"leaderboard-name\">{nickname}</p>\n                <LevelBadge xp={xp} size=\"small\" />\n              </div>\n              <div className=\"leaderboard-score\">{entry.score}/10</div>\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"modal-actions\">\n          {!showFullLeaderboard && (\n            <>\n              <button\n                className=\"modal-btn-secondary\"\n                onClick={() => setShowFullLeaderboard(true)}\n              >\n                üìä View Full Leaderboard\n              </button>\n              <button className=\"modal-btn-primary\" onClick={onClose}>\n                üè° Back to Events\n              </button>\n            </>\n          )}\n          \n          {showFullLeaderboard && (\n            <>\n              <button\n                className=\"modal-btn-secondary\"\n                onClick={() => setShowFullLeaderboard(false)}\n              >\n                ‚Üê Back to Top 10\n              </button>\n              <button className=\"modal-btn-primary\" onClick={onClose}>\n                üè° Back to Events\n              </button>\n            </>\n          )}\n        </div>\n\n        {/* Full Leaderboard View */}\n        {showFullLeaderboard && (\n          <div className=\"full-leaderboard-section\">\n            <h3 className=\"leaderboard-title\">Complete Rankings</h3>\n            <div className=\"full-leaderboard-list\">\n              {leaderboard.map((player, index) => {\n                const isUser = player.userId === \"current_user\";\n                \n                return (\n                  <div\n                    key={`${player.userId}_${index}`}\n                    className={`leaderboard-item-compact ${isUser ? 'user-item' : ''}`}\n                  >\n                    <span className=\"compact-rank\">#{index + 1}</span>\n                    <img\n                      src={getAvatarImage(\n                        isUser ? avatar : player.avatar,\n                        { userId: player.userId, nickname: isUser ? nickname : player.nickname }\n                      )}\n                      alt={player.nickname}\n                      className=\"compact-avatar\"\n                    />\n                    <span className=\"compact-name\">{isUser ? nickname : player.nickname}</span>\n                    <span className=\"compact-score\">{player.score}/10</span>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9081,"size_tokens":null},"src/pages/GlobalEvents.css":{"content":"/* Global Events Page Styles */\n\n.global-events-container {\n  padding: 20px 16px;\n  background: radial-gradient(circle at 20% 20%, rgba(10, 15, 30, 1) 0%, rgba(3, 6, 20, 1) 70%);\n}\n\n.events-header {\n  margin-bottom: 24px;\n}\n\n.back-btn {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(212, 175, 55, 0.3);\n  color: #d4af37;\n  padding: 8px 16px;\n  border-radius: 12px;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  margin-bottom: 16px;\n}\n\n.back-btn:hover {\n  background: rgba(212, 175, 55, 0.2);\n  box-shadow: 0 0 12px rgba(212, 175, 55, 0.3);\n}\n\n.events-title {\n  font-size: 2rem;\n  font-weight: 700;\n  background: linear-gradient(90deg, #fff 0%, #d4af37 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  margin-bottom: 8px;\n}\n\n.events-subtitle {\n  color: #94a3b8;\n  font-size: 0.95rem;\n}\n\n/* Timer Banner */\n.events-timer-banner {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  background: rgba(16, 185, 129, 0.15);\n  border: 2px solid rgba(16, 185, 129, 0.4);\n  border-radius: 16px;\n  padding: 16px;\n  margin-bottom: 20px;\n  box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);\n}\n\n.timer-icon {\n  font-size: 2rem;\n}\n\n.timer-text {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.timer-label {\n  color: #10b981;\n  font-size: 0.85rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n.timer-value {\n  color: #fff;\n  font-size: 1.1rem;\n  font-weight: 700;\n}\n\n/* Info Card */\n.events-info-card {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(212, 175, 55, 0.3);\n  border-radius: 12px;\n  padding: 14px;\n  margin-bottom: 24px;\n}\n\n.info-text {\n  color: #cbd5e1;\n  font-size: 0.85rem;\n  line-height: 1.6;\n  margin: 0;\n}\n\n.info-highlight {\n  color: #d4af37;\n  font-weight: 600;\n  margin: 0 4px;\n}\n\n/* Events Grid */\n.events-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 16px;\n  margin-bottom: 40px;\n}\n\n/* Event Card */\n.event-card {\n  position: relative;\n  padding: 20px 16px;\n  border-radius: 20px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 200px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n\n.event-card:active {\n  transform: scale(0.98);\n}\n\n.event-card.pulsing {\n  animation: pulse-glow 2s ease-in-out infinite;\n}\n\n@keyframes pulse-glow {\n  0%, 100% {\n    box-shadow: 0 0 20px rgba(212, 175, 55, 0.4), 0 4px 20px rgba(0, 0, 0, 0.3);\n  }\n  50% {\n    box-shadow: 0 0 30px rgba(212, 175, 55, 0.6), 0 4px 25px rgba(0, 0, 0, 0.4);\n  }\n}\n\n/* Entered Badge - Bottom Center */\n.event-entered-badge {\n  position: absolute;\n  bottom: 10px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: rgba(0, 0, 0, 0.7);\n  color: #10b981;\n  font-size: 0.7rem;\n  font-weight: 600;\n  padding: 4px 10px;\n  border-radius: 12px;\n  border: 1px solid rgba(16, 185, 129, 0.5);\n}\n\n/* New Event Badge (for un-entered events) */\n.new-event-badge {\n  position: absolute;\n  top: 10px;\n  left: 10px;\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: #fff;\n  font-size: 0.7rem;\n  font-weight: 700;\n  padding: 4px 10px;\n  border-radius: 12px;\n  box-shadow: 0 0 15px rgba(239, 68, 68, 0.5);\n  animation: bounce-badge 1s ease-in-out infinite;\n}\n\n\n@keyframes bounce-badge {\n  0%, 100% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-4px);\n  }\n}\n\n/* Event Content */\n.event-icon {\n  font-size: 3rem;\n  margin-bottom: 12px;\n}\n\n.event-name {\n  color: #fff;\n  font-size: 1.1rem;\n  font-weight: 700;\n  margin-bottom: 8px;\n  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n}\n\n.event-description {\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 0.75rem;\n  margin-bottom: auto;\n  line-height: 1.4;\n}\n\n.event-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 16px;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.event-entry-fee {\n  color: #fff;\n  font-size: 0.85rem;\n  font-weight: 600;\n}\n\n.event-leaderboard-icon {\n  font-size: 1.2rem;\n}\n\n/* Responsive */\n@media (max-width: 480px) {\n  .events-grid {\n    gap: 12px;\n  }\n  \n  .event-card {\n    min-height: 180px;\n    padding: 16px 12px;\n  }\n  \n  .event-icon {\n    font-size: 2.5rem;\n  }\n  \n  .event-name {\n    font-size: 1rem;\n  }\n  \n  .event-description {\n    font-size: 0.7rem;\n  }\n}\n","path":null,"size_bytes":4350,"size_tokens":null},"src/data/eventQuestions.js":{"content":"// Global Events Question Banks\n// Each event has 10 hard MCQs from assigned paths\n// Questions are harder than regular quizzes with detailed options\n\nexport const EVENT_QUESTIONS = {\n  // üïå Pillar Clash - Foundations of Islam (Path 2)\n  pillar_clash: [\n    {\n      id: \"pc_1\",\n      question: \"What are the three fundamental questions asked in the grave according to authentic hadith?\",\n      options: [\n        \"Who is your Lord? What is your religion? Who is your Prophet?\",\n        \"What did you worship? What book did you follow? Who was your leader?\",\n        \"Do you believe in Allah? Did you pray? Did you give charity?\",\n        \"Why did you live? What good did you do? Who taught you Islam?\"\n      ],\n      correct: 0,\n      evidence: \"Narrated in Sunan At-Tirmidhi and Musnad Ahmad\"\n    },\n    {\n      id: \"pc_2\",\n      question: \"Which pillar of Islam is mentioned most frequently in the Qur'an alongside Salah?\",\n      options: [\n        \"Zakah (charity)\",\n        \"Sawm (fasting)\",\n        \"Hajj (pilgrimage)\",\n        \"Shahada (testimony)\"\n      ],\n      correct: 0,\n      evidence: \"Zakah is mentioned with Salah over 80 times in the Qur'an\"\n    },\n    {\n      id: \"pc_3\",\n      question: \"What percentage of one's wealth is due for Zakah on gold, silver, and cash savings?\",\n      options: [\n        \"2.5% annually\",\n        \"5% annually\",\n        \"10% at harvest\",\n        \"20% of profit\"\n      ],\n      correct: 0,\n      evidence: \"2.5% is the nisab rate mentioned in authentic hadith collections\"\n    },\n    {\n      id: \"pc_4\",\n      question: \"Which surah contains the verse 'This day I have perfected your religion for you'?\",\n      options: [\n        \"Surah Al-Ma'idah\",\n        \"Surah Al-Baqarah\",\n        \"Surah Al-Fatiha\",\n        \"Surah Al-Ikhlas\"\n      ],\n      correct: 0,\n      evidence: \"Revealed in Surah Al-Ma'idah (5:3) during the Farewell Pilgrimage\"\n    },\n    {\n      id: \"pc_5\",\n      question: \"How many obligatory (fard) units (rak'ahs) are in the five daily prayers combined?\",\n      options: [\n        \"17 rak'ahs\",\n        \"20 rak'ahs\",\n        \"25 rak'ahs\",\n        \"12 rak'ahs\"\n      ],\n      correct: 0,\n      evidence: \"Fajr(2) + Dhuhr(4) + Asr(4) + Maghrib(3) + Isha(4) = 17\"\n    },\n    {\n      id: \"pc_6\",\n      question: \"What is the minimum amount of gold (nisab) one must possess for Zakah to become obligatory?\",\n      options: [\n        \"85 grams (approximately 3 ounces)\",\n        \"100 grams (approximately 3.5 ounces)\",\n        \"200 grams (approximately 7 ounces)\",\n        \"50 grams (approximately 1.75 ounces)\"\n      ],\n      correct: 0,\n      evidence: \"Based on authentic hadith about 20 dinars worth of gold\"\n    },\n    {\n      id: \"pc_7\",\n      question: \"Which night is better than a thousand months according to the Qur'an?\",\n      options: [\n        \"Laylat al-Qadr (Night of Decree)\",\n        \"Laylat al-Isra (Night Journey)\",\n        \"Laylat al-Bara'ah (Night of Forgiveness)\",\n        \"Laylat al-Mi'raj (Night of Ascension)\"\n      ],\n      correct: 0,\n      evidence: \"Surah Al-Qadr (97:3) - 'Better than a thousand months'\"\n    },\n    {\n      id: \"pc_8\",\n      question: \"What are the three types of Tawheed (Islamic monotheism)?\",\n      options: [\n        \"Tawheed ar-Rububiyyah, Tawheed al-Uluhiyyah, Tawheed al-Asma wa's-Sifat\",\n        \"Belief in Allah, Angels, and Books\",\n        \"Prayer, Fasting, and Charity\",\n        \"Knowledge, Action, and Sincerity\"\n      ],\n      correct: 0,\n      evidence: \"Classical Islamic scholarship classification of monotheism\"\n    },\n    {\n      id: \"pc_9\",\n      question: \"Which companion is mentioned by name in the Qur'an?\",\n      options: [\n        \"Zayd ibn Harithah (RA)\",\n        \"Abu Bakr (RA)\",\n        \"Umar ibn Al-Khattab (RA)\",\n        \"Ali ibn Abi Talib (RA)\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned in Surah Al-Ahzab (33:37) regarding adoption laws\"\n    },\n    {\n      id: \"pc_10\",\n      question: \"What are the six articles of faith (Iman) in Islam?\",\n      options: [\n        \"Belief in Allah, Angels, Books, Messengers, Last Day, and Divine Decree\",\n        \"Prayer, Fasting, Charity, Pilgrimage, Jihad, and Knowledge\",\n        \"Quran, Sunnah, Ijma, Qiyas, Istihsan, and Maslahah\",\n        \"Tawheed, Salah, Sawm, Zakah, Hajj, and Dawah\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned in Sahih Muslim - Hadith of Jibra'il\"\n    }\n  ],\n\n  // ‚ú® Names of Allah Mastery - Names of Allah (Path 1)\n  names_mastery: [\n    {\n      id: \"nm_1\",\n      question: \"Al-Qahhar means 'The Subduer.' Which name pairs with it to show Allah's complete authority?\",\n      options: [\n        \"Al-Jabbar (The Compeller)\",\n        \"Ar-Rahman (The Most Merciful)\",\n        \"Al-Latif (The Subtle)\",\n        \"Al-Halim (The Forbearing)\"\n      ],\n      correct: 0,\n      evidence: \"Both emphasize Allah's absolute power and authority\"\n    },\n    {\n      id: \"nm_2\",\n      question: \"Which Beautiful Name means 'The Watchful Guardian' who never sleeps?\",\n      options: [\n        \"Al-Raqib\",\n        \"Al-Hafiz\",\n        \"Al-Muhaymin\",\n        \"Al-Wakil\"\n      ],\n      correct: 0,\n      evidence: \"From Surah Al-Ma'idah (5:117) - 'You are ever Watchful'\"\n    },\n    {\n      id: \"nm_3\",\n      question: \"Ar-Razzaq means 'The Provider.' What is the difference between Ar-Razzaq and Ar-Raziq?\",\n      options: [\n        \"Ar-Razzaq emphasizes continuous abundant provision for all creation\",\n        \"They mean exactly the same with no difference\",\n        \"Ar-Raziq only provides for believers\",\n        \"Ar-Razzaq only provides spiritual guidance\"\n      ],\n      correct: 0,\n      evidence: \"Ar-Razzaq (intensive form) shows constant universal provision\"\n    },\n    {\n      id: \"nm_4\",\n      question: \"Which name pair shows Allah is both 'The Most Gentle' and 'The All-Aware'?\",\n      options: [\n        \"Al-Latif, Al-Khabir\",\n        \"Ar-Ra'uf, Al-Hakim\",\n        \"Al-Halim, Al-Alim\",\n        \"Al-Wadud, Al-Basir\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned together in Surah Luqman (31:16) and elsewhere\"\n    },\n    {\n      id: \"nm_5\",\n      question: \"Al-Muhaimin means 'The Guardian.' In which surah is this name mentioned?\",\n      options: [\n        \"Surah Al-Hashr (The Exile)\",\n        \"Surah Al-Fatiha (The Opening)\",\n        \"Surah Al-Ikhlas (The Sincerity)\",\n        \"Surah An-Nas (Mankind)\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned in Surah Al-Hashr (59:23) among Allah's names\"\n    },\n    {\n      id: \"nm_6\",\n      question: \"What does Al-Muntaqim mean, and how does it relate to divine justice?\",\n      options: [\n        \"The Avenger who takes retribution from oppressors with perfect justice\",\n        \"The Forgiver who pardons all sins without accountability\",\n        \"The Patient One who delays all punishment forever\",\n        \"The Merciful who never punishes anyone\"\n      ],\n      correct: 0,\n      evidence: \"Balanced with mercy, used for those who persist in wrongdoing\"\n    },\n    {\n      id: \"nm_7\",\n      question: \"Al-Awwal and Al-Akhir mean 'The First' and 'The Last.' In which famous verse are they mentioned together?\",\n      options: [\n        \"Ayat al-Kursi extension in Surah Al-Hadid\",\n        \"The opening of Surah Al-Fatiha\",\n        \"The conclusion of Surah Al-Ikhlas\",\n        \"The beginning of Surah Al-Baqarah\"\n      ],\n      correct: 0,\n      evidence: \"Surah Al-Hadid (57:3) - 'He is the First and the Last'\"\n    },\n    {\n      id: \"nm_8\",\n      question: \"Which Beautiful Name means 'The Responsive' who answers every sincere supplication?\",\n      options: [\n        \"Al-Mujib\",\n        \"As-Sami\",\n        \"Al-Basir\",\n        \"Al-Karim\"\n      ],\n      correct: 0,\n      evidence: \"From Surah Hud (11:61) - 'Indeed my Lord is ever responsive'\"\n    },\n    {\n      id: \"nm_9\",\n      question: \"Al-Haqq means 'The Truth.' Which verse emphasizes that Allah is the only Haqq?\",\n      options: [\n        \"That is because Allah is the Truth, and what they call upon besides Him is falsehood (22:62)\",\n        \"Say He is Allah, the One (112:1)\",\n        \"There is no god but He (2:255)\",\n        \"Allah is the Creator of all things (39:62)\"\n      ],\n      correct: 0,\n      evidence: \"Surah Al-Hajj (22:62) directly states this\"\n    },\n    {\n      id: \"nm_10\",\n      question: \"How many Beautiful Names of Allah are commonly known from authentic hadith?\",\n      options: [\n        \"99 names, though Allah has more names unknown to us\",\n        \"Exactly 99 names with no more\",\n        \"100 names including Al-A'zam\",\n        \"70 names mentioned in the Qur'an\"\n      ],\n      correct: 0,\n      evidence: \"Sahih Bukhari & Muslim - '99 names, whoever memorizes them enters Paradise'\"\n    }\n  ],\n\n  // üåô Faith Test - Akhirah paths (Angels, Grave, Day of Judgement, Hellfire, Paradise)\n  faith_test: [\n    {\n      id: \"ft_1\",\n      question: \"Which angel will blow the Trumpet (Sur) to signal the Day of Resurrection?\",\n      options: [\n        \"Israfil (AS)\",\n        \"Mikail (AS)\",\n        \"Jibra'il (AS)\",\n        \"Azrael (AS)\"\n      ],\n      correct: 0,\n      evidence: \"Authentic hadith identify Israfil as the angel of the Trumpet\"\n    },\n    {\n      id: \"ft_2\",\n      question: \"What are the names of the two angels who question people in the grave?\",\n      options: [\n        \"Munkar and Nakir\",\n        \"Raqib and Atid\",\n        \"Kiraman Katibin\",\n        \"Haroot and Maroot\"\n      ],\n      correct: 0,\n      evidence: \"Named in authentic hadith collections\"\n    },\n    {\n      id: \"ft_3\",\n      question: \"How many levels (gates) does Paradise have according to authentic hadith?\",\n      options: [\n        \"Eight gates with specific names\",\n        \"Seven gates for seven good deeds\",\n        \"Twelve gates for each month\",\n        \"Countless gates for every good deed\"\n      ],\n      correct: 0,\n      evidence: \"Sahih Bukhari mentions eight gates including Ar-Rayyan for those who fast\"\n    },\n    {\n      id: \"ft_4\",\n      question: \"What is the name of the bridge over Hellfire that everyone must cross on Judgment Day?\",\n      options: [\n        \"As-Sirat\",\n        \"Al-Mizan\",\n        \"Al-Kawthar\",\n        \"Al-Hawd\"\n      ],\n      correct: 0,\n      evidence: \"Described in Sahih Muslim as thinner than hair and sharper than sword\"\n    },\n    {\n      id: \"ft_5\",\n      question: \"Which angel is responsible for taking souls at the time of death?\",\n      options: [\n        \"The Angel of Death (commonly called Azrael, though not mentioned in Qur'an)\",\n        \"Jibra'il (AS)\",\n        \"Mikail (AS)\",\n        \"Israfil (AS)\"\n      ],\n      correct: 0,\n      evidence: \"Qur'an (32:11) mentions 'Angel of Death' without specific name\"\n    },\n    {\n      id: \"ft_6\",\n      question: \"What is the lowest level of Paradise called?\",\n      options: [\n        \"The lowest level is still 10 times better than the entire world\",\n        \"Dar as-Salam\",\n        \"Jannat al-Firdaws\",\n        \"Jannat al-Adn\"\n      ],\n      correct: 0,\n      evidence: \"Sahih Bukhari describes even the lowest Paradise dweller's rewards\"\n    },\n    {\n      id: \"ft_7\",\n      question: \"How wide is Hellfire according to the Qur'an?\",\n      options: [\n        \"As wide as the heavens and earth (metaphor for vast size)\",\n        \"7 levels of equal size\",\n        \"Wider than all oceans combined\",\n        \"Beyond human measurement\"\n      ],\n      correct: 0,\n      evidence: \"Similar expression used in Qur'an (57:21) for Paradise width\"\n    },\n    {\n      id: \"ft_8\",\n      question: \"On the Day of Judgment, what will testify against or for a person?\",\n      options: [\n        \"Their limbs, skin, and even the earth itself\",\n        \"Only the angels who recorded their deeds\",\n        \"Only other people who witnessed their actions\",\n        \"Only their own admission\"\n      ],\n      correct: 0,\n      evidence: \"Surah Fussilat (41:20-21) - limbs will testify\"\n    },\n    {\n      id: \"ft_9\",\n      question: \"What is the highest level of Paradise called, and who dwells there?\",\n      options: [\n        \"Al-Firdaws, for the most righteous believers\",\n        \"Jannat al-Adn, for all believers equally\",\n        \"Jannat an-Na'im, for martyrs only\",\n        \"Dar as-Salam, for prophets only\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned in Surah Al-Kahf (18:107) and authentic hadith\"\n    },\n    {\n      id: \"ft_10\",\n      question: \"What happens during the 'punishment of the grave' (Adhab al-Qabr)?\",\n      options: [\n        \"The soul experiences punishment or bliss in Barzakh while the body remains\",\n        \"The physical body is tortured continuously\",\n        \"Nothing happens until the Day of Judgment\",\n        \"Only disbelievers experience anything\"\n      ],\n      correct: 0,\n      evidence: \"Explained in Sahih Bukhari and Muslim regarding the intermediate realm\"\n    }\n  ],\n\n  // üìñ Seerah Challenge - Life of Muhammad Ô∑∫ (Path 4 - Sealed Nectar)\n  seerah_challenge: [\n    {\n      id: \"sc_1\",\n      question: \"In which year was the Prophet Ô∑∫ born, known as the Year of the Elephant?\",\n      options: [\n        \"570 CE (approximately)\",\n        \"610 CE\",\n        \"571 CE exactly\",\n        \"600 CE\"\n      ],\n      correct: 0,\n      evidence: \"The Sealed Nectar - Year Abraha attacked Makkah with elephants\"\n    },\n    {\n      id: \"sc_2\",\n      question: \"Who was the Prophet's Ô∑∫ wet nurse who took him to live in the desert?\",\n      options: [\n        \"Halimah As-Sa'diyyah\",\n        \"Barakah (Umm Ayman)\",\n        \"Thuwaybah\",\n        \"Aminah bint Wahb\"\n      ],\n      correct: 0,\n      evidence: \"Raised him for four years among Banu Sa'd tribe\"\n    },\n    {\n      id: \"sc_3\",\n      question: \"What significant event happened to the Prophet Ô∑∫ at age 40?\",\n      options: [\n        \"He received the first revelation in Cave Hira\",\n        \"He married Khadijah (RA)\",\n        \"He became a successful merchant\",\n        \"He rebuilt the Kaaba\"\n      ],\n      correct: 0,\n      evidence: \"610 CE - Revelation of first verses of Surah Al-Alaq\"\n    },\n    {\n      id: \"sc_4\",\n      question: \"Which treaty allowed Muslims to perform Umrah but was seemingly unfavorable at first?\",\n      options: [\n        \"Treaty of Hudaybiyyah\",\n        \"Pact of Al-Aqabah\",\n        \"Constitution of Madinah\",\n        \"Treaty of Ta'if\"\n      ],\n      correct: 0,\n      evidence: \"6 AH - Allah called it 'a clear victory' in Surah Al-Fath\"\n    },\n    {\n      id: \"sc_5\",\n      question: \"Who was the first male to accept Islam?\",\n      options: [\n        \"Abu Bakr As-Siddiq (RA)\",\n        \"Ali ibn Abi Talib (RA)\",\n        \"Zayd ibn Harithah (RA)\",\n        \"Umar ibn Al-Khattab (RA)\"\n      ],\n      correct: 0,\n      evidence: \"First free adult male; Ali was a child, Zayd was freed slave\"\n    },\n    {\n      id: \"sc_6\",\n      question: \"What miracle occurred during the Battle of Badr that helped the Muslims?\",\n      options: [\n        \"Allah sent angels to fight alongside Muslims and caused drowsiness to give them rest\",\n        \"The sun stood still in the sky\",\n        \"Rain fell only on the enemy\",\n        \"A massive earthquake struck\"\n      ],\n      correct: 0,\n      evidence: \"Mentioned in Surah Al-Anfal (8:9-11) and authentic hadith\"\n    },\n    {\n      id: \"sc_7\",\n      question: \"How long did the Prophet Ô∑∫ receive revelation?\",\n      options: [\n        \"23 years (13 in Makkah, 10 in Madinah)\",\n        \"20 years equally divided\",\n        \"25 years total\",\n        \"15 years in Makkah only\"\n      ],\n      correct: 0,\n      evidence: \"From age 40 to 63 - historical consensus\"\n    },\n    {\n      id: \"sc_8\",\n      question: \"What was the name of the Prophet's Ô∑∫ grandfather who raised him?\",\n      options: [\n        \"Abdul-Muttalib\",\n        \"Abu Talib\",\n        \"Abdullah\",\n        \"Abu Lahab\"\n      ],\n      correct: 0,\n      evidence: \"Raised him after his mother's death until age 8\"\n    },\n    {\n      id: \"sc_9\",\n      question: \"During the Night Journey (Isra and Mi'raj), from which location did the Prophet Ô∑∫ ascend to the heavens?\",\n      options: [\n        \"Masjid Al-Aqsa in Jerusalem\",\n        \"The Kaaba in Makkah\",\n        \"Masjid Quba in Madinah\",\n        \"Mount Sinai\"\n      ],\n      correct: 0,\n      evidence: \"Surah Al-Isra (17:1) - 'from Al-Masjid Al-Haram to Al-Masjid Al-Aqsa'\"\n    },\n    {\n      id: \"sc_10\",\n      question: \"Which battle is called the 'Battle of the Confederates' or 'Battle of the Trench'?\",\n      options: [\n        \"Battle of Al-Ahzab (Khandaq)\",\n        \"Battle of Uhud\",\n        \"Battle of Hunayn\",\n        \"Battle of Tabuk\"\n      ],\n      correct: 0,\n      evidence: \"5 AH - Defensive trench strategy suggested by Salman Al-Farsi (RA)\"\n    }\n  ]\n};\n\n// Utility function to get randomized questions for an event\nexport function getEventQuestions(eventId, count = 10) {\n  const questions = EVENT_QUESTIONS[eventId] || [];\n  \n  // Shuffle questions\n  const shuffled = [...questions].sort(() => Math.random() - 0.5);\n  \n  // Take requested count and randomize answer order\n  return shuffled.slice(0, count).map(q => {\n    const randomized = randomizeOptions(q.options, q.correct);\n    return {\n      ...q,\n      options: randomized.options,\n      correct: randomized.correct\n    };\n  });\n}\n\n// Randomize answer options but track correct answer\nfunction randomizeOptions(options, correctIndex) {\n  const correctAnswer = options[correctIndex];\n  const shuffled = [...options].sort(() => Math.random() - 0.5);\n  \n  return {\n    options: shuffled,\n    correct: shuffled.indexOf(correctAnswer)\n  };\n}\n","path":null,"size_bytes":17435,"size_tokens":null},"src/store/eventsStore.js":{"content":"import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { useProgressStore } from \"./progressStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { avatarIndexToKey } from \"../utils/avatarUtils\";\nimport { logXpEvent } from \"../backend/xpLogs\";\n\nexport const EMPTY_LEADERBOARD = Object.freeze([]);\n\nfunction getCurrentWeekId() {\n  const now = new Date();\n  const dayOfWeek = now.getUTCDay();\n  const currentDate = new Date(now);\n  const daysToFriday = dayOfWeek >= 5 ? dayOfWeek - 5 : dayOfWeek + 2;\n  currentDate.setUTCDate(currentDate.getUTCDate() - daysToFriday);\n  currentDate.setUTCHours(0, 0, 0, 0);\n  return currentDate.toISOString().split('T')[0];\n}\n\nfunction areResultsUnlocked() {\n  const now = new Date();\n  const dayOfWeek = now.getUTCDay();\n  const hour = now.getUTCHours();\n  if (dayOfWeek === 4 && hour >= 22) return true;\n  if (dayOfWeek === 5 || dayOfWeek === 6 || dayOfWeek === 0) return true;\n  return false;\n}\n\nfunction getTimeUntilResults() {\n  const now = new Date();\n  const dayOfWeek = now.getUTCDay();\n  const nextThursday = new Date(now);\n  if (dayOfWeek === 4 && now.getUTCHours() >= 22) {\n    nextThursday.setUTCDate(nextThursday.getUTCDate() + 7);\n  } else if (dayOfWeek < 4) {\n    nextThursday.setUTCDate(nextThursday.getUTCDate() + (4 - dayOfWeek));\n  } else {\n    nextThursday.setUTCDate(nextThursday.getUTCDate() + (4 + 7 - dayOfWeek));\n  }\n  nextThursday.setUTCHours(22, 0, 0, 0);\n  return nextThursday - now;\n}\n\nconst EVENTS = [\n  {\n    id: \"pillar_clash\",\n    name: \"Pillar Clash\",\n    description: \"Master the Foundations of Islam\",\n    pathIds: [2],\n    theme: {\n      gradient: \"linear-gradient(135deg, #10b981 0%, #d4af37 100%)\",\n      glow: \"0 0 20px rgba(16, 185, 129, 0.4)\"\n    },\n    icon: \"üïå\"\n  },\n  {\n    id: \"names_mastery\",\n    name: \"Names of Allah Mastery\",\n    description: \"Learn the Beautiful Names\",\n    pathIds: [1],\n    theme: {\n      gradient: \"linear-gradient(135deg, #3b82f6 0%, #d4af37 100%)\",\n      glow: \"0 0 20px rgba(59, 130, 246, 0.4)\"\n    },\n    icon: \"‚ú®\"\n  },\n  {\n    id: \"faith_test\",\n    name: \"Faith Test\",\n    description: \"Explore the Akhirah\",\n    pathIds: [10, 11, 12, 13, 14],\n    theme: {\n      gradient: \"linear-gradient(135deg, #8b5cf6 0%, #d4af37 100%)\",\n      glow: \"0 0 20px rgba(139, 92, 246, 0.4)\"\n    },\n    icon: \"üåô\"\n  },\n  {\n    id: \"seerah_challenge\",\n    name: \"Seerah Challenge\",\n    description: \"Journey through the Sealed Nectar\",\n    pathIds: [4],\n    theme: {\n      gradient: \"linear-gradient(135deg, #ef4444 0%, #d4af37 100%)\",\n      glow: \"0 0 20px rgba(239, 68, 68, 0.4)\"\n    },\n    icon: \"üìñ\"\n  }\n];\n\nexport const useEventsStore = create(\n  persist(\n    (set, get) => ({\n      currentWeekId: getCurrentWeekId(),\n      weeklyEntries: {},\n      leaderboards: {},\n      resultsViewed: {},\n      loading: false,\n      error: null,\n\n      checkWeekReset: () => {\n        const newWeekId = getCurrentWeekId();\n        const { currentWeekId, weeklyEntries } = get();\n        if (newWeekId !== currentWeekId) {\n          set({\n            currentWeekId: newWeekId,\n            weeklyEntries: {},\n            leaderboards: {},\n            resultsViewed: {}\n          });\n        }\n      },\n\n      enterEventCloud: async (eventId, score, answers, completionTime = null) => {\n        try {\n          set({ loading: true, error: null });\n          \n          const { data: auth } = await supabase.auth.getUser();\n          if (!auth?.user) {\n            set({ loading: false, error: \"Not authenticated\" });\n            return { success: false, error: \"NOT_AUTHENTICATED\" };\n          }\n          \n          const userId = auth.user.id;\n          const weekId = getCurrentWeekId();\n          \n          const { data: existing, error: checkError } = await supabase\n            .from('event_entries')\n            .select('id')\n            .eq('user_id', userId)\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .maybeSingle();\n          \n          if (existing) {\n            set({ loading: false });\n            return { success: false, error: \"ALREADY_ENTERED\" };\n          }\n          \n          const { count: higherScoreCount, error: countError1 } = await supabase\n            .from('event_entries')\n            .select('*', { count: 'exact', head: true })\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .gt('score', score);\n          \n          let sameScoreFasterCount = 0;\n          if (completionTime !== null) {\n            const { count: fasterCount, error: countError2 } = await supabase\n              .from('event_entries')\n              .select('*', { count: 'exact', head: true })\n              .eq('event_id', eventId)\n              .eq('week_id', weekId)\n              .eq('score', score)\n              .lt('completion_time', completionTime);\n            \n            if (!countError2) {\n              sameScoreFasterCount = fasterCount || 0;\n            }\n          }\n          \n          const provisionalRank = (countError1 ? 0 : (higherScoreCount || 0)) + sameScoreFasterCount + 1;\n          \n          const { data, error } = await supabase\n            .from('event_entries')\n            .insert({\n              user_id: userId,\n              event_id: eventId,\n              week_id: weekId,\n              score: score,\n              answers: answers,\n              completion_time: completionTime,\n              provisional_rank: provisionalRank\n            })\n            .select()\n            .maybeSingle();\n          \n          if (error) {\n            if (error.code === '23505') {\n              set({ loading: false });\n              return { success: false, error: \"ALREADY_ENTERED\" };\n            }\n            console.error('Enter event error:', error);\n            set({ loading: false, error: error.message });\n            return { success: false, error: error.message };\n          }\n          \n          set(state => ({\n            weeklyEntries: {\n              ...state.weeklyEntries,\n              [eventId]: {\n                score,\n                answers,\n                completedAt: data.created_at,\n                provisionalRank,\n                cloudId: data.id\n              }\n            },\n            loading: false\n          }));\n          \n          useProgressStore.getState().markDayComplete();\n          \n          return { success: true, entry: data, provisionalRank };\n        } catch (err) {\n          console.error('Enter event error:', err);\n          set({ loading: false, error: err.message });\n          return { success: false, error: err.message };\n        }\n      },\n\n      hasEnteredCloud: async (eventId) => {\n        try {\n          const { data: auth } = await supabase.auth.getUser();\n          if (!auth?.user) return false;\n          \n          const userId = auth.user.id;\n          const weekId = getCurrentWeekId();\n          \n          const { data, error } = await supabase\n            .from('event_entries')\n            .select('id')\n            .eq('user_id', userId)\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .maybeSingle();\n          \n          return !!data;\n        } catch (err) {\n          console.error('Check entered error:', err);\n          return false;\n        }\n      },\n\n      loadMyEntries: async () => {\n        try {\n          set({ loading: true, error: null });\n          \n          const { data: auth } = await supabase.auth.getUser();\n          if (!auth?.user) {\n            set({ loading: false });\n            return {};\n          }\n          \n          const userId = auth.user.id;\n          const weekId = getCurrentWeekId();\n          \n          const { data, error } = await supabase\n            .from('event_entries')\n            .select('*')\n            .eq('user_id', userId)\n            .eq('week_id', weekId);\n          \n          if (error) {\n            console.error('Load my entries error:', error);\n            set({ loading: false });\n            return {};\n          }\n          \n          const entries = {};\n          (data || []).forEach(entry => {\n            entries[entry.event_id] = {\n              score: entry.score,\n              answers: entry.answers,\n              completedAt: entry.created_at,\n              provisionalRank: entry.provisional_rank,\n              finalRank: entry.final_rank,\n              rewardsClaimed: entry.rewards_claimed,\n              cloudId: entry.id\n            };\n          });\n          \n          set({ weeklyEntries: entries, loading: false });\n          return entries;\n        } catch (err) {\n          console.error('Load entries error:', err);\n          set({ loading: false });\n          return {};\n        }\n      },\n\n      loadLeaderboard: async (eventId, limit = 50) => {\n        try {\n          const weekId = getCurrentWeekId();\n          \n          const { data, error } = await supabase\n            .from('event_entries')\n            .select(`\n              id,\n              user_id,\n              score,\n              completion_time,\n              created_at\n            `)\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .order('score', { ascending: false })\n            .order('completion_time', { ascending: true, nullsFirst: false })\n            .order('created_at', { ascending: true })\n            .limit(limit);\n          \n          if (error) {\n            console.error('Load leaderboard error:', error);\n            return [];\n          }\n          \n          const userIds = (data || []).map(e => e.user_id);\n          let profiles = {};\n          \n          if (userIds.length > 0) {\n            const { data: profileData } = await supabase\n              .from('profiles')\n              .select('user_id, username, handle, avatar, premium')\n              .in('user_id', userIds);\n            \n            (profileData || []).forEach(p => {\n              profiles[p.user_id] = p;\n            });\n          }\n          \n          const leaderboard = (data || []).map((entry, index) => {\n            const profile = profiles[entry.user_id] || {};\n            return {\n              rank: index + 1,\n              userId: entry.user_id,\n              nickname: profile.username || profile.handle || 'User',\n              avatar: typeof profile.avatar === 'number' \n                ? avatarIndexToKey(profile.avatar)\n                : profile.avatar || 'avatar_man_lantern',\n              score: entry.score,\n              completionTime: entry.completion_time,\n              completedAt: entry.created_at,\n              premium: profile.premium || false\n            };\n          });\n          \n          set(state => ({\n            leaderboards: {\n              ...state.leaderboards,\n              [weekId]: {\n                ...(state.leaderboards[weekId] || {}),\n                [eventId]: leaderboard\n              }\n            }\n          }));\n          \n          return leaderboard;\n        } catch (err) {\n          console.error('Load leaderboard error:', err);\n          return [];\n        }\n      },\n\n      getMyRank: async (eventId) => {\n        try {\n          const { data: auth } = await supabase.auth.getUser();\n          if (!auth?.user) return null;\n          \n          const userId = auth.user.id;\n          const weekId = getCurrentWeekId();\n          \n          const { data: myEntry, error: entryError } = await supabase\n            .from('event_entries')\n            .select('score, completion_time, created_at')\n            .eq('user_id', userId)\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .maybeSingle();\n          \n          if (entryError || !myEntry) return null;\n          \n          const { count, error: countError } = await supabase\n            .from('event_entries')\n            .select('*', { count: 'exact', head: true })\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .or(`score.gt.${myEntry.score},and(score.eq.${myEntry.score},completion_time.lt.${myEntry.completion_time || 9999})`);\n          \n          if (countError) {\n            console.error('Get rank error:', countError);\n            return null;\n          }\n          \n          return (count || 0) + 1;\n        } catch (err) {\n          console.error('Get rank error:', err);\n          return null;\n        }\n      },\n\n      claimEventRewards: async (eventId) => {\n        try {\n          const { data: auth } = await supabase.auth.getUser();\n          if (!auth?.user) {\n            return { success: false, error: \"NOT_AUTHENTICATED\" };\n          }\n          \n          const userId = auth.user.id;\n          const weekId = getCurrentWeekId();\n          \n          const { data: entry, error: fetchError } = await supabase\n            .from('event_entries')\n            .select('*')\n            .eq('user_id', userId)\n            .eq('event_id', eventId)\n            .eq('week_id', weekId)\n            .maybeSingle();\n          \n          if (fetchError || !entry) {\n            return { success: false, error: \"ENTRY_NOT_FOUND\" };\n          }\n          \n          if (entry.rewards_claimed) {\n            return { success: false, error: \"ALREADY_CLAIMED\" };\n          }\n          \n          const rank = await get().getMyRank(eventId);\n          if (!rank) {\n            return { success: false, error: \"RANK_NOT_FOUND\" };\n          }\n          \n          const rewards = get().computeRewardsForRank(rank);\n          \n          const { error: updateError } = await supabase\n            .from('event_entries')\n            .update({\n              rewards_claimed: true,\n              final_rank: rank,\n              xp_earned: rewards.xpReward,\n              coins_earned: rewards.coinReward\n            })\n            .eq('id', entry.id);\n          \n          if (updateError) {\n            console.error('Claim rewards error:', updateError);\n            return { success: false, error: updateError.message };\n          }\n          \n          const { addXPAndCoins } = useProgressStore.getState();\n          addXPAndCoins(rewards.xpReward, rewards.coinReward);\n          \n          // Log XP event for global event\n          if (rewards.xpReward > 0) {\n            logXpEvent(userId, rewards.xpReward, \"event\");\n          }\n          \n          set(state => ({\n            resultsViewed: {\n              ...state.resultsViewed,\n              [eventId]: true\n            },\n            weeklyEntries: {\n              ...state.weeklyEntries,\n              [eventId]: {\n                ...state.weeklyEntries[eventId],\n                rewardsClaimed: true,\n                finalRank: rank\n              }\n            }\n          }));\n          \n          return { success: true, rank, rewards };\n        } catch (err) {\n          console.error('Claim rewards error:', err);\n          return { success: false, error: err.message };\n        }\n      },\n\n      enterEvent: (eventId, score, answers, completionTime = null) => {\n        const { currentWeekId, weeklyEntries } = get();\n        const provisionalRank = Math.floor(Math.random() * 50) + 1;\n        useProgressStore.getState().markDayComplete();\n        set({\n          weeklyEntries: {\n            ...weeklyEntries,\n            [eventId]: {\n              score,\n              answers,\n              completedAt: new Date().toISOString(),\n              provisionalRank\n            }\n          }\n        });\n        get().enterEventCloud(eventId, score, answers, completionTime);\n      },\n\n      hasEntered: (eventId) => {\n        const { weeklyEntries } = get();\n        return !!weeklyEntries[eventId];\n      },\n\n      getEntry: (eventId) => {\n        const { weeklyEntries } = get();\n        return weeklyEntries[eventId] || null;\n      },\n\n      markResultsViewed: (eventId) => {\n        const { resultsViewed } = get();\n        set({\n          resultsViewed: {\n            ...resultsViewed,\n            [eventId]: true\n          }\n        });\n      },\n\n      areResultsViewed: (eventId) => {\n        const { resultsViewed } = get();\n        return !!resultsViewed[eventId];\n      },\n\n      computeRewardsForRank: (rank) => {\n        if (rank === 1) return { xpReward: 1000, coinReward: 300 };\n        if (rank <= 3) return { xpReward: 750, coinReward: 200 };\n        if (rank <= 10) return { xpReward: 500, coinReward: 100 };\n        return { xpReward: 100, coinReward: 10 };\n      },\n\n      grantRewardsForEvent: (eventId, userRank) => {\n        if (get().resultsViewed[eventId]) {\n          return null;\n        }\n        const computedRewards = get().computeRewardsForRank(userRank);\n        let rewards = null;\n        set((state) => {\n          if (state.resultsViewed[eventId]) {\n            return;\n          }\n          rewards = computedRewards;\n          return {\n            resultsViewed: {\n              ...state.resultsViewed,\n              [eventId]: true,\n            },\n          };\n        });\n        const { addXPAndCoins } = useProgressStore.getState();\n        if (rewards) {\n          addXPAndCoins(rewards.xpReward, rewards.coinReward);\n        }\n        return rewards;\n      },\n\n      generateMockLeaderboard: (eventId, userEntry) => {\n        const { currentWeekId, leaderboards } = get();\n        const mockPlayers = [\n          { nickname: \"Abdullah\", avatar: \"avatar1\", score: 10 },\n          { nickname: \"Fatimah\", avatar: \"avatar2\", score: 9 },\n          { nickname: \"Yusuf\", avatar: \"avatar3\", score: 9 },\n          { nickname: \"Maryam\", avatar: \"avatar4\", score: 8 },\n          { nickname: \"Ibrahim\", avatar: \"avatar5\", score: 8 },\n          { nickname: \"Khadijah\", avatar: \"avatar6\", score: 8 },\n          { nickname: \"Zakariya\", avatar: \"avatar7\", score: 7 },\n          { nickname: \"Aisha\", avatar: \"avatar8\", score: 7 },\n          { nickname: \"Bilal\", avatar: \"avatar9\", score: 7 },\n          { nickname: \"Hafsa\", avatar: \"avatar10\", score: 6 }\n        ].map((p, i) => ({\n          ...p,\n          userId: `mock_${i}`,\n          completedAt: new Date(Date.now() - Math.random() * 86400000).toISOString()\n        }));\n        mockPlayers.push({\n          userId: \"current_user\",\n          nickname: \"You\",\n          avatar: \"avatar1\",\n          score: userEntry.score,\n          completedAt: userEntry.completedAt\n        });\n        mockPlayers.sort((a, b) => {\n          if (b.score !== a.score) return b.score - a.score;\n          return new Date(a.completedAt) - new Date(b.completedAt);\n        });\n        const weekLeaderboards = leaderboards[currentWeekId] || {};\n        set({\n          leaderboards: {\n            ...leaderboards,\n            [currentWeekId]: {\n              ...weekLeaderboards,\n              [eventId]: mockPlayers\n            }\n          }\n        });\n        return mockPlayers;\n      },\n\n      getLeaderboard: (eventId) => {\n        const { currentWeekId, leaderboards } = get();\n        return leaderboards[currentWeekId]?.[eventId] || [];\n      },\n\n      getUserRank: (eventId) => {\n        const leaderboard = get().getLeaderboard(eventId);\n        const { data: auth } = supabase.auth.getUser();\n        const userIndex = leaderboard.findIndex(p => \n          p.userId === \"current_user\" || p.userId === auth?.user?.id\n        );\n        return userIndex >= 0 ? userIndex + 1 : null;\n      },\n\n      areResultsUnlocked,\n      getTimeUntilResults,\n      getEvents: () => EVENTS,\n\n      syncToSupabase: async () => {\n        await get().loadMyEntries();\n      },\n\n      loadFromSupabase: async () => {\n        await get().loadMyEntries();\n      },\n    }),\n    {\n      name: \"islam-quest-events-v2\",\n      partialize: (state) => ({\n        currentWeekId: state.currentWeekId,\n        weeklyEntries: state.weeklyEntries,\n        leaderboards: state.leaderboards,\n        resultsViewed: state.resultsViewed\n      })\n    }\n  )\n);\n","path":null,"size_bytes":19810,"size_tokens":null},"src/components/events/CountdownModal.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport mascotCountdown from \"../../assets/mascots/mascot_countdown.webp\";\nimport \"./EventModals.css\";\n\nexport default function CountdownModal({ onComplete }) {\n  const [count, setCount] = useState(3);\n\n  useEffect(() => {\n    if (count === 0) {\n      setTimeout(onComplete, 500);\n      return;\n    }\n\n    const timer = setTimeout(() => {\n      setCount(count - 1);\n    }, 1000);\n\n    return () => clearTimeout(timer);\n  }, [count, onComplete]);\n\n  return (\n    <div className=\"event-modal-overlay\">\n      <div className=\"countdown-modal\">\n        {/* Countdown Rocket */}\n        <div className=\"countdown-mascot\">\n          <img src={mascotCountdown} alt=\"Countdown Rocket\" className=\"countdown-rocket\" />\n        </div>\n\n        {/* Countdown Number */}\n        <div className=\"countdown-number\">\n          {count > 0 ? count : \"GO!\"}\n        </div>\n\n        {/* Message */}\n        <p className=\"countdown-message\">\n          {count > 0 ? \"Get ready...\" : \"Bismillah!\"}\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1069,"size_tokens":null},"src/components/events/InsufficientCoinsModal.jsx":{"content":"import React from \"react\";\nimport assets from \"../../assets/assets\";\nimport \"./EventModals.css\";\n\nexport default function InsufficientCoinsModal({ onClose }) {\n  return (\n    <div className=\"event-modal-overlay\" onClick={onClose}>\n      <div className=\"event-modal-card\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"event-modal-header\">\n          <img\n            src={assets.mascots.mascot_sitting_v2}\n            alt=\"Mascot\"\n            className=\"modal-mascot-large\"\n          />\n        </div>\n\n        <div className=\"event-modal-content\">\n          <h2 className=\"modal-title\">Not Enough Coins!</h2>\n          <p className=\"modal-text\">\n            You need <strong>25 coins</strong> to enter this Global Event.\n          </p>\n          <p className=\"modal-text\">\n            Complete lessons and quizzes to earn more coins and join the competition!\n          </p>\n\n          <div className=\"coins-display\">\n            <span className=\"coin-icon\">ü™ô</span>\n            <span className=\"coin-text\">Earn coins from lessons</span>\n          </div>\n        </div>\n\n        <div className=\"event-modal-actions\">\n          <button className=\"modal-btn-primary\" onClick={onClose}>\n            Got It!\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1287,"size_tokens":null},"src/store/challengeStore.js":{"content":"import { create } from \"zustand\";\nimport { useProgressStore } from \"./progressStore\";\nimport { useFriendsStore } from \"./friendsStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { logXpEvent } from \"../backend/xpLogs\";\nimport { logChallengeRequest, logChallengeResult } from \"../backend/challengeLogs\";\n\nimport namesOfAllahQuizzesData from '../data/quizzes/namesOfAllah.json';\nimport foundationsQuizzesData from '../data/quizzes/foundations.json';\nimport prophetsQuizzesData from '../data/quizzes/prophets.json';\nimport prophetLifeQuizzesData from '../data/quizzes/prophetLife.json';\nimport wivesQuizzesData from '../data/quizzes/wivesQuizzes.json';\nimport tenPromisedQuizzesData from '../data/quizzes/tenPromisedQuizzes.json';\nimport greatestWomenQuizzesData from '../data/quizzes/greatestWomenQuizzes.json';\nimport companionsQuizzesData from '../data/quizzes/companionsQuizzes.json';\nimport angelsQuizzesData from '../data/quizzes/angelsQuizzes.json';\nimport endTimesQuizzesData from '../data/quizzes/endTimesQuizzes.json';\nimport graveQuizzesData from '../data/quizzes/graveQuizzes.json';\nimport judgementQuizzesData from '../data/quizzes/judgementQuizzes.json';\nimport hellfireQuizzesData from '../data/quizzes/hellfireQuizzes.json';\nimport paradiseQuizzesData from '../data/quizzes/paradiseQuizzes.json';\n\nconst STORAGE_KEY = \"islamQuestChallenges_v2\";\nconst CHALLENGE_DURATION = 48 * 60 * 60 * 1000;\n\nexport const CHALLENGE_MODES = {\n  MIND_BATTLE: {\n    id: \"mind_battle\",\n    name: \"Mind Battle\",\n    icon: \"üß†\",\n    description: \"8 questions\",\n    questionCount: 8,\n    trackTime: true,\n    rewards: { win: { xp: 100, coins: 20 }, lose: { xp: 20, coins: 0 }, draw: { xp: 50, coins: 0 } },\n    gradient: \"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)\",\n    glow: \"0 0 20px rgba(139, 92, 246, 0.5)\"\n  },\n  LIGHTNING_ROUND: {\n    id: \"lightning_round\",\n    name: \"Lightning Round\",\n    icon: \"‚ö°\",\n    description: \"10 questions in 60 seconds\",\n    questionCount: 10,\n    totalTime: 60,\n    rewards: { win: { xp: 150, coins: 25 }, lose: { xp: 25, coins: 0 } },\n    gradient: \"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",\n    glow: \"0 0 20px rgba(245, 158, 11, 0.5)\"\n  },\n  SPEED_RUN: {\n    id: \"speed_run\",\n    name: \"Speed Run\",\n    icon: \"üèÉ\",\n    description: \"Answer as many correctly in 30 seconds (max 40 questions)\",\n    questionCount: 40,\n    totalTime: 30,\n    rewards: { win: { xp: 120, coins: 20 }, lose: { xp: 20, coins: 0 }, draw: { xp: 50, coins: 0 } },\n    gradient: \"linear-gradient(135deg, #10b981 0%, #059669 100%)\",\n    glow: \"0 0 20px rgba(16, 185, 129, 0.5)\"\n  },\n  SUDDEN_DEATH: {\n    id: \"sudden_death\",\n    name: \"Sudden Death\",\n    icon: \"‚öîÔ∏è\",\n    description: \"Build the longest chain of correct answers\",\n    questionCount: 25,\n    trackTime: true,\n    rewards: { win: { xp: 200, coins: 30 }, lose: { xp: 0, coins: 0 }, draw: { xp: 100, coins: 15 } },\n    gradient: \"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)\",\n    glow: \"0 0 20px rgba(239, 68, 68, 0.5)\"\n  }\n};\n\nexport const BOSS_LEVEL = {\n  id: \"boss_level\",\n  name: \"The Boss Level\",\n  icon: \"üëë\",\n  description: \"Daily ultra-hard challenge ‚Äî 12 questions, 30 seconds\",\n  questionCount: 12,\n  totalTime: 30,\n  minLevel: 1, // TODO: Change back to 8 after testing\n  rewards: { win: { xp: 500, coins: 100 }, lose: { xp: 50, coins: 0 } },\n  gradient: \"linear-gradient(135deg, #1e3a5f 0%, #0f1c2e 100%)\",\n  glow: \"0 0 30px rgba(30, 58, 95, 0.7)\"\n};\n\nexport const calculateLongestChain = (answers) => {\n  if (!answers || answers.length === 0) return 0;\n  let longest = 0;\n  let current = 0;\n  answers.forEach(a => {\n    if (a.correct) {\n      current++;\n      longest = Math.max(longest, current);\n    } else {\n      current = 0;\n    }\n  });\n  return longest;\n};\n\nconst generateUUID = () => {\n  if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n    return crypto.randomUUID();\n  }\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    const r = Math.random() * 16 | 0;\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n};\n\nexport const useChallengeStore = create((set, get) => ({\n  challenges: [],\n  bossAttempts: [],\n  challengeHistory: [],\n  recentlyShownQuestions: [],\n  questionPoolCache: null,\n  cacheTimestamp: null,\n  loading: false,\n  error: null,\n\n  saveToStorage: () => {\n    const data = {\n      challenges: get().challenges,\n      bossAttempts: get().bossAttempts,\n      challengeHistory: get().challengeHistory,\n      recentlyShownQuestions: get().recentlyShownQuestions,\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\n  },\n\n  loadFromStorage: () => {\n    const saved = localStorage.getItem(STORAGE_KEY);\n    if (saved) {\n      const data = JSON.parse(saved);\n      set({\n        challenges: data.challenges || [],\n        bossAttempts: data.bossAttempts || [],\n        challengeHistory: data.challengeHistory || [],\n        recentlyShownQuestions: data.recentlyShownQuestions || [],\n      });\n    }\n  },\n\n  trackShownQuestion: (questionText) => {\n    set(state => {\n      const updated = [questionText, ...state.recentlyShownQuestions].slice(0, 100);\n      return { recentlyShownQuestions: updated };\n    });\n    get().saveToStorage();\n  },\n\n  // Normalize answer option lengths and shuffle to prevent obvious clues\n  normalizeAndShuffleOptions: (question) => {\n    const { options, answer } = question;\n    const correctAnswer = options[answer];\n    \n    // Create shuffled options array\n    const shuffledOptions = [...options].sort(() => Math.random() - 0.5);\n    const newAnswerIndex = shuffledOptions.indexOf(correctAnswer);\n    \n    return {\n      ...question,\n      options: shuffledOptions,\n      answer: newAnswerIndex\n    };\n  },\n\n  generateQuestionVariation: (originalQuestion) => {\n    const { question, options, answer, difficulty } = originalQuestion;\n    const newOptions = [...options];\n    const correctAnswer = options[answer];\n    const distractors = newOptions.filter((_, idx) => idx !== answer);\n    const shuffledDistractors = distractors.sort(() => Math.random() - 0.5);\n    const newAnswerIndex = Math.floor(Math.random() * 4);\n    const finalOptions = [];\n    for (let i = 0; i < 4; i++) {\n      if (i === newAnswerIndex) {\n        finalOptions.push(correctAnswer);\n      } else {\n        finalOptions.push(shuffledDistractors.shift());\n      }\n    }\n    return {\n      ...originalQuestion,\n      options: finalOptions,\n      answer: newAnswerIndex,\n      isVariation: true\n    };\n  },\n\n  buildQuestionPool: () => {\n    const { lessonStates } = useProgressStore.getState();\n    const allQuestions = [];\n    Object.keys(lessonStates).forEach(lessonKey => {\n      const lessonState = lessonStates[lessonKey];\n      if (lessonState?.completed === true || lessonState?.passed === true) {\n        if (lessonState.questions && Array.isArray(lessonState.questions)) {\n          allQuestions.push(...lessonState.questions.map(q => ({\n            ...q,\n            sourceLesson: lessonKey\n          })));\n        }\n      }\n    });\n    return allQuestions;\n  },\n\n  getQuestionPool: () => {\n    const { questionPoolCache, cacheTimestamp } = get();\n    const { lessonStates } = useProgressStore.getState();\n    const currentLessonCount = Object.keys(lessonStates).filter(\n      key => lessonStates[key]?.completed || lessonStates[key]?.passed\n    ).length;\n    if (!questionPoolCache || !cacheTimestamp || \n        questionPoolCache.lessonCount !== currentLessonCount) {\n      const pool = get().buildQuestionPool();\n      set({\n        questionPoolCache: { questions: pool, lessonCount: currentLessonCount },\n        cacheTimestamp: Date.now()\n      });\n      return pool;\n    }\n    return questionPoolCache.questions;\n  },\n\n  filterRecentQuestions: (questions) => {\n    const { recentlyShownQuestions } = get();\n    return questions.filter(q => !recentlyShownQuestions.includes(q.question));\n  },\n\n  expandQuestionPool: (questions, targetCount) => {\n    const expanded = [...questions];\n    const neededVariations = Math.max(0, targetCount - questions.length);\n    if (neededVariations > 0 && questions.length > 0) {\n      for (let i = 0; i < neededVariations; i++) {\n        const sourceQuestion = questions[i % questions.length];\n        const variation = get().generateQuestionVariation(sourceQuestion);\n        expanded.push(variation);\n      }\n    }\n    return expanded;\n  },\n\n  createChallenge: (friendId, mode) => {\n    console.log('üéÆ Creating local challenge');\n    \n    const modeConfig = typeof mode === 'string' \n      ? Object.values(CHALLENGE_MODES).find(m => m.id === mode) \n      : mode;\n    \n    if (!modeConfig) {\n      console.error('Invalid mode:', mode);\n      return { success: false, error: 'INVALID_MODE' };\n    }\n    \n    const realFriends = useFriendsStore.getState().friends || [];\n    const allFriends = useFriendsStore.getState().getAllFriends?.() || realFriends;\n    const friend = allFriends.find(f => f.user_id === friendId || f.id === friendId) ||\n                   realFriends.find(f => f.user_id === friendId || f.id === friendId);\n    \n    const questions = get().getQuestionsForMode(modeConfig);\n    \n    if (questions.length === 0) {\n      console.error('No questions available for challenge');\n      return { success: false, error: 'NO_QUESTIONS' };\n    }\n    \n    const challenge = {\n      id: generateUUID(),\n      mode: modeConfig.id,\n      challengerId: 'current_user',\n      opponentId: friendId,\n      opponentName: friend?.nickname || friend?.username || friend?.odolena_nickname || 'Friend',\n      opponentAvatar: friend?.avatar || friend?.odolena_avatar || 'avatar_man_beard',\n      questions: questions,\n      status: 'active',\n      challengerScore: null,\n      challengerAnswers: null,\n      challengerTime: null,\n      challengerChain: null,\n      opponentScore: null,\n      opponentAnswers: null,\n      opponentTime: null,\n      opponentChain: null,\n      winner: null,\n      isDraw: false,\n      createdAt: new Date().toISOString(),\n      expiresAt: new Date(Date.now() + CHALLENGE_DURATION).toISOString()\n    };\n    \n    set(state => ({\n      challenges: [...state.challenges, challenge]\n    }));\n    get().saveToStorage();\n    \n    // Log challenge request\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logChallengeRequest(userId, modeConfig.id, friendId);\n      }\n    })();\n    \n    console.log('‚úÖ Challenge created:', challenge.id);\n    return { success: true, challenge };\n  },\n  \n  submitChallengeAttempt: (challengeId, score, answers, completionTime = null, chain = null) => {\n    console.log('üéÆ Submitting challenge attempt locally');\n    \n    const challenge = get().challenges.find(c => c.id === challengeId);\n    if (!challenge) {\n      return { success: false, error: 'CHALLENGE_NOT_FOUND' };\n    }\n    \n    const modeConfig = typeof challenge.mode === 'string' \n      ? Object.values(CHALLENGE_MODES).find(m => m.id === challenge.mode)\n      : challenge.mode;\n    \n    const opponentScore = Math.floor(Math.random() * (challenge.questions?.length || 8));\n    const opponentTime = Math.floor(Math.random() * 60) + 20;\n    const opponentChain = modeConfig?.id === 'sudden_death' \n      ? Math.floor(Math.random() * 6) + 1 \n      : null;\n    const opponentAnswers = (challenge.questions || []).map((q, i) => ({\n      questionId: q.id || `q_${i}`,\n      selectedAnswer: Math.floor(Math.random() * 4),\n      correct: i < opponentScore\n    }));\n    \n    let winnerId = null;\n    let isDraw = false;\n    \n    if (modeConfig?.id === 'sudden_death') {\n      const userChain = chain || calculateLongestChain(answers);\n      if (userChain > opponentChain) {\n        winnerId = 'current_user';\n      } else if (opponentChain > userChain) {\n        winnerId = challenge.opponentId;\n      } else {\n        isDraw = true;\n      }\n    } else {\n      if (score > opponentScore) {\n        winnerId = 'current_user';\n      } else if (opponentScore > score) {\n        winnerId = challenge.opponentId;\n      } else {\n        if (modeConfig?.trackTime && completionTime !== null) {\n          winnerId = completionTime < opponentTime ? 'current_user' : challenge.opponentId;\n        } else {\n          isDraw = true;\n        }\n      }\n    }\n    \n    const updatedChallenge = {\n      ...challenge,\n      challengerScore: score,\n      challengerAnswers: answers,\n      challengerTime: completionTime,\n      challengerChain: chain,\n      opponentScore: opponentScore,\n      opponentAnswers: opponentAnswers,\n      opponentTime: opponentTime,\n      opponentChain: opponentChain,\n      status: 'completed',\n      winner: winnerId,\n      isDraw: isDraw,\n      completedAt: new Date().toISOString()\n    };\n    \n    set(state => ({\n      challenges: state.challenges.map(c => \n        c.id === challengeId ? updatedChallenge : c\n      ),\n      challengeHistory: [...state.challengeHistory, updatedChallenge]\n    }));\n    get().saveToStorage();\n    useProgressStore.getState().markDayComplete();\n    \n    // Log challenge result\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        const result = isDraw ? \"draw\" : (winnerId === 'current_user' ? \"win\" : \"lose\");\n        const modeConf = typeof challenge.mode === 'string' \n          ? Object.values(CHALLENGE_MODES).find(m => m.id === challenge.mode)\n          : challenge.mode;\n        const xpGained = modeConf?.rewards?.[result]?.xp || 0;\n        const modeId = typeof challenge.mode === 'string' ? challenge.mode : modeConf?.id;\n        logChallengeResult(userId, modeId, result, xpGained, challenge.opponentId);\n      }\n    })();\n    \n    return { success: true, challenge: updatedChallenge };\n  },\n\n  loadAllMyChallenges: () => {\n    console.log('üéÆ Loading local challenges');\n    return get().challenges;\n  },\n\n  saveBossAttempt: (score, answers, completionTime = null) => {\n    // Boss always scores 11/12 - user must get 11 or 12 to beat the Boss\n    const bossScore = 11;\n    const passed = score >= bossScore;\n    const rewards = passed ? BOSS_LEVEL.rewards.win : BOSS_LEVEL.rewards.lose;\n    \n    const attempt = {\n      id: generateUUID(),\n      score: score,\n      answers: answers,\n      completionTime: completionTime,\n      completedAt: new Date().toISOString(),\n      maxScore: BOSS_LEVEL.questionCount,\n      passed: passed\n    };\n    \n    set(state => ({\n      bossAttempts: [...state.bossAttempts, attempt]\n    }));\n    get().saveToStorage();\n    useProgressStore.getState().markDayComplete();\n    \n    return { success: true, attempt, rewards };\n  },\n\n  canPlayBossToday: () => {\n    const today = new Date().toDateString();\n    const { bossAttempts } = get();\n    const todayAttempt = bossAttempts.find(a => \n      new Date(a.completedAt).toDateString() === today\n    );\n    return !todayAttempt;\n  },\n\n  saveChallengeProgress: (challengeId, score, answers, isChallenger, completionTime = null) => {\n    set(state => ({\n      challenges: state.challenges.map(c => {\n        if (c.id === challengeId) {\n          let updatedChallenge = { ...c };\n          if (isChallenger) {\n            updatedChallenge.challengerScore = score;\n            updatedChallenge.challengerAnswers = answers;\n            updatedChallenge.challengerTime = completionTime;\n            updatedChallenge.status = c.opponentScore !== null ? \"completed\" : \"active\";\n          } else {\n            updatedChallenge.opponentScore = score;\n            updatedChallenge.opponentAnswers = answers;\n            updatedChallenge.opponentTime = completionTime;\n            updatedChallenge.status = c.challengerScore !== null ? \"completed\" : \"active\";\n          }\n          const modeId = typeof c.mode === 'string' ? c.mode : c.mode?.id;\n          if (modeId === 'sudden_death') {\n            updatedChallenge.challengerChain = updatedChallenge.challengerAnswers \n              ? calculateLongestChain(updatedChallenge.challengerAnswers) \n              : 0;\n            updatedChallenge.opponentChain = updatedChallenge.opponentAnswers \n              ? calculateLongestChain(updatedChallenge.opponentAnswers) \n              : 0;\n          }\n          return updatedChallenge;\n        }\n        return c;\n      })\n    }));\n    get().saveToStorage();\n  },\n\n  completeChallenge: (challengeId) => {\n    const challenge = get().challenges.find(c => c.id === challengeId);\n    if (!challenge) return;\n\n    let winner = null;\n    const modeId = typeof challenge.mode === 'string' ? challenge.mode : challenge.mode?.id;\n    const isSuddenDeath = modeId === 'sudden_death';\n    \n    if (isSuddenDeath) {\n      let challengerChain = challenge.challengerChain;\n      let opponentChain = challenge.opponentChain;\n      if (challengerChain === null || challengerChain === undefined) {\n        challengerChain = challenge.challengerAnswers ? calculateLongestChain(challenge.challengerAnswers) : 0;\n      }\n      if (opponentChain === null || opponentChain === undefined) {\n        opponentChain = challenge.opponentAnswers ? calculateLongestChain(challenge.opponentAnswers) : 0;\n      }\n      if (challengerChain > opponentChain) {\n        winner = challenge.challengerId;\n      } else if (opponentChain > challengerChain) {\n        winner = challenge.opponentId;\n      } else {\n        winner = \"draw\";\n      }\n    } else {\n      if (challenge.challengerScore > challenge.opponentScore) {\n        winner = challenge.challengerId;\n      } else if (challenge.opponentScore > challenge.challengerScore) {\n        winner = challenge.opponentId;\n      } else {\n        const mode = Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n        if (mode?.trackTime && challenge.challengerTime !== null && challenge.opponentTime !== null) {\n          winner = challenge.challengerTime < challenge.opponentTime \n            ? challenge.challengerId \n            : challenge.opponentId;\n        } else {\n          winner = \"draw\";\n        }\n      }\n    }\n    \n    useProgressStore.getState().markDayComplete();\n\n    set(state => ({\n      challenges: state.challenges.map(c =>\n        c.id === challengeId ? { ...c, winner, status: \"completed\" } : c\n      ),\n      challengeHistory: [...state.challengeHistory, { ...challenge, winner }]\n    }));\n\n    get().saveToStorage();\n    return winner;\n  },\n\n  getQuestionsForMode: (mode) => {\n    let config;\n    if (typeof mode === 'string') {\n      config = Object.values(CHALLENGE_MODES).find(m => m.id === mode);\n    } else {\n      config = mode;\n    }\n    if (!config) {\n      console.error('Invalid mode:', mode);\n      return [];\n    }\n    \n    let allQuestions = get().getQuestionPool();\n    if (allQuestions.length === 0) {\n      console.log('üéÆ No completed lessons - using fallback questions for challenges');\n      allQuestions = get().getFallbackQuestions();\n    }\n    \n    if (allQuestions.length === 0) {\n      allQuestions = get().getFallbackQuestions();\n    }\n    \n    const freshQuestions = get().filterRecentQuestions(allQuestions);\n    let filteredQuestions = freshQuestions.length > 0 ? freshQuestions : allQuestions;\n    \n    if (config.id === 'mind_battle') {\n      const difficultyFiltered = filteredQuestions.filter(q => \n        q.difficulty === 'hard' || q.difficulty === 'medium'\n      );\n      if (difficultyFiltered.length > 0) {\n        filteredQuestions = difficultyFiltered;\n      }\n    } else if (config.id === 'speed_run') {\n      const speedFiltered = filteredQuestions.filter(q => \n        q.difficulty !== 'hard' || Math.random() > 0.5\n      );\n      if (speedFiltered.length > 0) {\n        filteredQuestions = speedFiltered;\n      }\n    }\n    \n    const count = config.questionCount || 8;\n    if (filteredQuestions.length < count) {\n      filteredQuestions = get().expandQuestionPool(filteredQuestions, count);\n    }\n    \n    const shuffled = filteredQuestions.sort(() => Math.random() - 0.5);\n    const selected = shuffled.slice(0, count);\n    \n    // Track shown questions and shuffle options to remove obvious clues\n    const normalizedQuestions = selected.map(q => {\n      get().trackShownQuestion(q.question);\n      return get().normalizeAndShuffleOptions(q);\n    });\n    \n    return normalizedQuestions;\n  },\n\n  getFallbackQuestions: () => {\n    return [\n      { question: \"What is the first pillar of Islam?\", options: [\"Prayer\", \"Shahada (Declaration of Faith)\", \"Fasting\", \"Charity\"], answer: 1, difficulty: \"medium\" },\n      { question: \"How many daily prayers are obligatory in Islam?\", options: [\"3\", \"4\", \"5\", \"6\"], answer: 2, difficulty: \"easy\" },\n      { question: \"Which prophet built the Kaaba?\", options: [\"Prophet Muhammad Ô∑∫\", \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the holy book of Islam?\", options: [\"Torah\", \"Bible\", \"Qur'an\", \"Vedas\"], answer: 2, difficulty: \"easy\" },\n      { question: \"In which month do Muslims fast?\", options: [\"Rajab\", \"Shaban\", \"Ramadan\", \"Dhul Hijjah\"], answer: 2, difficulty: \"easy\" },\n      { question: \"What is Zakat?\", options: [\"Fasting\", \"Prayer\", \"Charity\", \"Pilgrimage\"], answer: 2, difficulty: \"easy\" },\n      { question: \"Where is the Kaaba located?\", options: [\"Medina\", \"Mecca\", \"Jerusalem\", \"Cairo\"], answer: 1, difficulty: \"easy\" },\n      { question: \"What does 'Islam' mean?\", options: [\"Peace\", \"Submission to Allah\", \"Both peace and submission\", \"Faith\"], answer: 2, difficulty: \"medium\" },\n      { question: \"Who was the first person to accept Islam?\", options: [\"Abu Bakr\", \"Khadijah ÿ±ÿ∂Ÿä ÿßŸÑŸÑŸá ÿπŸÜŸáÿß\", \"Ali\", \"Umar\"], answer: 1, difficulty: \"medium\" },\n      { question: \"How many verses are in Surah Al-Fatiha?\", options: [\"5\", \"6\", \"7\", \"8\"], answer: 2, difficulty: \"medium\" },\n      { question: \"What is the meaning of 'Bismillah'?\", options: [\"In the name of Allah\", \"Praise be to Allah\", \"Allah is Great\", \"There is no god but Allah\"], answer: 0, difficulty: \"easy\" },\n      { question: \"Which direction do Muslims face when praying?\", options: [\"East\", \"West\", \"Towards Mecca\", \"North\"], answer: 2, difficulty: \"easy\" },\n      { question: \"How many surahs are in the Qur'an?\", options: [\"100\", \"114\", \"120\", \"99\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the last pillar of Islam?\", options: [\"Shahada\", \"Prayer\", \"Zakat\", \"Hajj\"], answer: 3, difficulty: \"medium\" },\n      { question: \"Who was the last prophet in Islam?\", options: [\"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Muhammad Ô∑∫\", \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 2, difficulty: \"easy\" },\n      { question: \"What is the night journey of Prophet Muhammad Ô∑∫ called?\", options: [\"Hijra\", \"Isra and Mi'raj\", \"Badr\", \"Uhud\"], answer: 1, difficulty: \"medium\" },\n      { question: \"How many times is 'Allahu Akbar' said in the Adhan?\", options: [\"2\", \"4\", \"6\", \"8\"], answer: 1, difficulty: \"hard\" },\n      { question: \"What was the first word revealed to Prophet Muhammad Ô∑∫?\", options: [\"Say\", \"Read\", \"Pray\", \"Believe\"], answer: 1, difficulty: \"medium\" },\n      { question: \"Which angel brought revelations to Prophet Muhammad Ô∑∫?\", options: [\"Mikael\", \"Israfil\", \"Jibreel ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Azrael\"], answer: 2, difficulty: \"easy\" },\n      { question: \"What is the name of the well in Mecca near the Kaaba?\", options: [\"Zamzam\", \"Safa\", \"Marwa\", \"Arafat\"], answer: 0, difficulty: \"medium\" },\n      { question: \"How many prophets are mentioned by name in the Qur'an?\", options: [\"15\", \"20\", \"25\", \"30\"], answer: 2, difficulty: \"hard\" },\n      { question: \"What is the shortest surah in the Qur'an?\", options: [\"Al-Fatiha\", \"Al-Ikhlas\", \"Al-Kawthar\", \"An-Nas\"], answer: 2, difficulty: \"hard\" },\n      { question: \"In which city was Prophet Muhammad Ô∑∫ born?\", options: [\"Medina\", \"Mecca\", \"Jerusalem\", \"Taif\"], answer: 1, difficulty: \"easy\" },\n      { question: \"What is the Friday prayer called?\", options: [\"Fajr\", \"Jumu'ah\", \"Isha\", \"Maghrib\"], answer: 1, difficulty: \"easy\" },\n      { question: \"How many rakats are in Fajr prayer?\", options: [\"2\", \"3\", \"4\", \"5\"], answer: 0, difficulty: \"medium\" },\n      { question: \"What is the blessed night in Ramadan called?\", options: [\"Night of Power (Laylat al-Qadr)\", \"Night of Journey\", \"Night of Destiny\", \"Night of Blessing\"], answer: 0, difficulty: \"medium\" },\n      { question: \"Who was the mother of Prophet Ismail ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ?\", options: [\"Sarah\", \"Hajar\", \"Maryam\", \"Asiyah\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the first month of the Islamic calendar?\", options: [\"Ramadan\", \"Muharram\", \"Rajab\", \"Shawwal\"], answer: 1, difficulty: \"medium\" },\n      { question: \"How many years did Prophet Muhammad Ô∑∫ receive revelations?\", options: [\"10 years\", \"15 years\", \"23 years\", \"30 years\"], answer: 2, difficulty: \"hard\" },\n      { question: \"What is the Arabic word for fasting?\", options: [\"Salah\", \"Sawm\", \"Zakat\", \"Hajj\"], answer: 1, difficulty: \"easy\" },\n      { question: \"Which prophet is known as 'Khalilullah' (Friend of Allah)?\", options: [\"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Nuh ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 2, difficulty: \"medium\" },\n      { question: \"What are the two main celebrations in Islam?\", options: [\"Eid al-Fitr and Eid al-Adha\", \"Eid al-Fitr and Mawlid\", \"Eid al-Adha and Ashura\", \"Mawlid and Ashura\"], answer: 0, difficulty: \"easy\" },\n      { question: \"What is the name of the treaty signed between Muslims and Quraysh?\", options: [\"Treaty of Medina\", \"Treaty of Hudaybiyyah\", \"Treaty of Aqaba\", \"Treaty of Taif\"], answer: 1, difficulty: \"hard\" },\n      { question: \"Which surah is known as 'the heart of the Qur'an'?\", options: [\"Al-Baqarah\", \"Ya-Sin\", \"Al-Rahman\", \"Al-Mulk\"], answer: 1, difficulty: \"hard\" },\n      { question: \"How many times should a Muslim perform Hajj in their lifetime?\", options: [\"Once\", \"Twice\", \"Three times\", \"Every year\"], answer: 0, difficulty: \"easy\" },\n      { question: \"What is the meaning of 'Alhamdulillah'?\", options: [\"God is Great\", \"In the name of God\", \"All praise is due to Allah\", \"God willing\"], answer: 2, difficulty: \"easy\" },\n      { question: \"Which companion was known as 'As-Siddiq' (The Truthful)?\", options: [\"Umar ibn al-Khattab\", \"Abu Bakr\", \"Uthman ibn Affan\", \"Ali ibn Abi Talib\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the prayer before dawn called?\", options: [\"Fajr\", \"Zuhr\", \"Asr\", \"Isha\"], answer: 0, difficulty: \"easy\" },\n      { question: \"What is the Arabic term for supplication?\", options: [\"Salah\", \"Dua\", \"Dhikr\", \"Tasbih\"], answer: 1, difficulty: \"easy\" },\n      { question: \"Which prophet was swallowed by a whale?\", options: [\"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Yunus ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Nuh ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Ayyub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 1, difficulty: \"easy\" },\n      { question: \"What is the meaning of 'SubhanAllah'?\", options: [\"All praise is due to Allah\", \"Glory be to Allah\", \"Allah is Great\", \"In the name of Allah\"], answer: 1, difficulty: \"easy\" },\n      { question: \"How many rakats are in Isha prayer?\", options: [\"2\", \"3\", \"4\", \"5\"], answer: 2, difficulty: \"medium\" },\n      { question: \"Which prophet was known for his patience?\", options: [\"Prophet Yusuf ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Ayyub ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Dawud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Sulaiman ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the name of Prophet Muhammad's Ô∑∫ grandfather?\", options: [\"Abu Talib\", \"Abdul Muttalib\", \"Abu Lahab\", \"Hashim\"], answer: 1, difficulty: \"medium\" },\n      { question: \"Which surah mentions the story of Yusuf ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ?\", options: [\"Surah Yusuf\", \"Surah Maryam\", \"Surah Al-Kahf\", \"Surah Al-Anbiya\"], answer: 0, difficulty: \"easy\" },\n      { question: \"What is the meaning of 'La ilaha illallah'?\", options: [\"God is Great\", \"There is no god but Allah\", \"All praise to Allah\", \"In the name of Allah\"], answer: 1, difficulty: \"easy\" },\n      { question: \"How many gates does Jannah have?\", options: [\"4\", \"7\", \"8\", \"12\"], answer: 2, difficulty: \"hard\" },\n      { question: \"Which prophet could speak to animals?\", options: [\"Prophet Dawud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Sulaiman ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the Arabic word for prayer?\", options: [\"Sawm\", \"Salah\", \"Zakat\", \"Hajj\"], answer: 1, difficulty: \"easy\" },\n      { question: \"Which companion was known as 'Al-Farooq'?\", options: [\"Abu Bakr\", \"Umar ibn al-Khattab\", \"Uthman\", \"Ali\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the last surah of the Qur'an?\", options: [\"Al-Fatiha\", \"Al-Ikhlas\", \"An-Nas\", \"Al-Falaq\"], answer: 2, difficulty: \"easy\" },\n      { question: \"How many rakats are in Zuhr prayer?\", options: [\"2\", \"3\", \"4\", \"5\"], answer: 2, difficulty: \"medium\" },\n      { question: \"Which prophet was given the Zabur (Psalms)?\", options: [\"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Dawud ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the meaning of 'insha'Allah'?\", options: [\"God willing\", \"God is Great\", \"Praise be to God\", \"In the name of God\"], answer: 0, difficulty: \"easy\" },\n      { question: \"Which prophet is known as 'Ruhullah' (Spirit of Allah)?\", options: [\"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Adam ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 2, difficulty: \"hard\" },\n      { question: \"What is the name of the angel of death?\", options: [\"Jibreel\", \"Mikael\", \"Israfil\", \"Azrael\"], answer: 3, difficulty: \"medium\" },\n      { question: \"How many prophets are considered 'Ulul Azm' (resolute)?\", options: [\"3\", \"4\", \"5\", \"6\"], answer: 2, difficulty: \"hard\" },\n      { question: \"Which surah is also called 'Al-Hamd'?\", options: [\"Al-Baqarah\", \"Al-Fatiha\", \"Al-Ikhlas\", \"Ya-Sin\"], answer: 1, difficulty: \"medium\" },\n      { question: \"What is the Arabic word for pilgrimage?\", options: [\"Sawm\", \"Salah\", \"Zakat\", \"Hajj\"], answer: 3, difficulty: \"easy\" },\n      { question: \"Which prophet built the Ark?\", options: [\"Prophet Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Nuh ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Prophet Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 2, difficulty: \"easy\" }\n    ];\n  },\n\n  getBossLevelQuestionPool: () => {\n    const allPathsData = [\n      namesOfAllahQuizzesData, foundationsQuizzesData, prophetsQuizzesData,\n      prophetLifeQuizzesData, wivesQuizzesData, tenPromisedQuizzesData,\n      greatestWomenQuizzesData, companionsQuizzesData, angelsQuizzesData,\n      endTimesQuizzesData, graveQuizzesData, judgementQuizzesData,\n      hellfireQuizzesData, paradiseQuizzesData\n    ];\n\n    const bossPool = [];\n    allPathsData.forEach((pathData, pathIndex) => {\n      const allPathQuestions = [];\n      pathData.forEach(lessonData => {\n        if (lessonData.questions && Array.isArray(lessonData.questions)) {\n          lessonData.questions.forEach(q => {\n            allPathQuestions.push({\n              question: q.question,\n              options: q.options,\n              answer: q.answer,\n              difficulty: 'hard',\n              sourcePath: pathIndex + 1,\n              sourceLesson: lessonData.lessonId\n            });\n          });\n        }\n      });\n      const totalQuestions = allPathQuestions.length;\n      const lastThirdStart = Math.max(0, totalQuestions - Math.ceil(totalQuestions / 3));\n      const lastThirdQuestions = allPathQuestions.slice(lastThirdStart);\n      bossPool.push(...lastThirdQuestions);\n    });\n\n    return bossPool;\n  },\n\n  getBossLevelQuestions: () => {\n    let allQuestions = get().getBossLevelQuestionPool();\n    \n    if (allQuestions.length === 0) {\n      allQuestions = get().getBossLevelFallbackQuestions();\n    }\n    \n    // Filter out recently shown questions to avoid repetition\n    allQuestions = get().filterRecentQuestions(allQuestions);\n    \n    const targetCount = BOSS_LEVEL.questionCount || 12;\n    if (allQuestions.length < targetCount) {\n      if (allQuestions.length === 0) {\n        allQuestions = get().getBossLevelFallbackQuestions();\n      } else {\n        allQuestions = get().expandQuestionPool(allQuestions, targetCount);\n      }\n    }\n    \n    const shuffled = allQuestions.sort(() => Math.random() - 0.5);\n    const selected = shuffled.slice(0, targetCount);\n    \n    // Track shown questions and shuffle options to remove obvious clues\n    const normalizedQuestions = selected.map(q => {\n      get().trackShownQuestion(q.question);\n      return get().normalizeAndShuffleOptions(q);\n    });\n    \n    return normalizedQuestions;\n  },\n\n  getBossLevelFallbackQuestions: () => {\n    return [\n      { question: \"Which name of Allah means 'The All-Knowing'?\", options: [\"Al-Aleem\", \"Al-Hakeem\", \"Al-Baseer\", \"Al-Samee\"], answer: 0, difficulty: \"hard\" },\n      { question: \"How many prophets are mentioned by name in the Qur'an?\", options: [\"13\", \"25\", \"40\", \"124,000\"], answer: 1, difficulty: \"hard\" },\n      { question: \"What is the last verse revealed in the Qur'an?\", options: [\"Ayat al-Kursi\", \"The verse about debt in Surah Al-Baqarah\", \"The final verse of Surah Al-Baqarah\", \"Surah An-Nasr\"], answer: 1, difficulty: \"hard\" },\n      { question: \"Which companion was known as 'The Sword of Allah'?\", options: [\"Ali ibn Abi Talib\", \"Umar ibn al-Khattab\", \"Khalid ibn al-Walid\", \"Abu Bakr as-Siddiq\"], answer: 2, difficulty: \"hard\" },\n      { question: \"What was the first masjid built by Prophet Muhammad Ô∑∫?\", options: [\"Masjid al-Haram\", \"Masjid an-Nabawi\", \"Masjid Quba\", \"Masjid al-Aqsa\"], answer: 2, difficulty: \"hard\" },\n      { question: \"How many times is Prophet Muhammad Ô∑∫ mentioned by name in the Qur'an?\", options: [\"3\", \"4\", \"5\", \"7\"], answer: 1, difficulty: \"hard\" },\n      { question: \"Which surah is called 'the heart of the Qur'an'?\", options: [\"Al-Fatiha\", \"Ya-Sin\", \"Al-Mulk\", \"Ar-Rahman\"], answer: 1, difficulty: \"hard\" },\n      { question: \"In which year of Hijrah did the Battle of Badr take place?\", options: [\"1st year\", \"2nd year\", \"3rd year\", \"4th year\"], answer: 1, difficulty: \"hard\" },\n      { question: \"How many angels are mentioned by name in the Qur'an?\", options: [\"1\", \"2\", \"3\", \"4\"], answer: 2, difficulty: \"hard\" },\n      { question: \"What is the longest surah in the Qur'an?\", options: [\"Al-Baqarah\", \"Aal-e-Imran\", \"An-Nisa\", \"Al-An'am\"], answer: 0, difficulty: \"hard\" },\n      { question: \"Which prophet is mentioned the most in the Qur'an?\", options: [\"Muhammad Ô∑∫\", \"Ibrahim ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Musa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\", \"Isa ÿπŸÑŸäŸá ÿßŸÑÿ≥ŸÑÿßŸÖ\"], answer: 2, difficulty: \"hard\" },\n      { question: \"How many years did it take for the Qur'an to be revealed?\", options: [\"10 years\", \"15 years\", \"23 years\", \"30 years\"], answer: 2, difficulty: \"hard\" },\n      { question: \"Which sahabi was given the title 'Al-Farooq' (The Criterion)?\", options: [\"Abu Bakr\", \"Umar ibn al-Khattab\", \"Uthman ibn Affan\", \"Ali ibn Abi Talib\"], answer: 1, difficulty: \"hard\" },\n      { question: \"In which cave did Prophet Muhammad Ô∑∫ receive the first revelation?\", options: [\"Cave of Thawr\", \"Cave of Hira\", \"Cave of Uhud\", \"Cave of Safa\"], answer: 1, difficulty: \"hard\" },\n      { question: \"What was the name of Prophet Muhammad's Ô∑∫ mother?\", options: [\"Khadijah\", \"Aminah\", \"Fatimah\", \"Aisha\"], answer: 1, difficulty: \"hard\" }\n    ];\n  },\n\n  awardRewards: (mode, result) => {\n    const config = mode === \"boss_level\" ? BOSS_LEVEL : CHALLENGE_MODES[mode];\n    let rewards = { xp: 0, coins: 0 };\n    if (config?.rewards) {\n      if (result && config.rewards[result]) {\n        rewards = config.rewards[result];\n      } else if (config.rewards.lose) {\n        rewards = config.rewards.lose;\n      }\n    }\n    const { addXPAndCoins } = useProgressStore.getState();\n    addXPAndCoins(rewards.xp, rewards.coins);\n    \n    // Log XP event for challenge\n    if (rewards.xp > 0) {\n      (async () => {\n        const { data } = await supabase.auth.getUser();\n        const userId = data?.user?.id;\n        if (userId) {\n          logXpEvent(userId, rewards.xp, \"challenge\");\n        }\n      })();\n    }\n    \n    return rewards;\n  },\n\n  checkExpiredChallenges: () => {\n    const now = Date.now();\n    set(state => ({\n      challenges: state.challenges.map(c => {\n        if (c.status !== \"completed\" && new Date(c.expiresAt).getTime() < now) {\n          let winner = null;\n          if (c.challengerScore !== null && c.opponentScore === null) {\n            winner = c.challengerId;\n          } else if (c.opponentScore !== null && c.challengerScore === null) {\n            winner = c.opponentId;\n          }\n          return { ...c, status: \"expired\", winner };\n        }\n        return c;\n      })\n    }));\n    get().saveToStorage();\n  },\n\n  getPendingChallenges: () => {\n    get().checkExpiredChallenges();\n    return get().challenges.filter(c => c.status === \"pending\");\n  },\n\n  getActiveChallenges: () => {\n    get().checkExpiredChallenges();\n    return get().challenges.filter(c => c.status === \"active\");\n  },\n\n  getCompletedChallenges: () => {\n    return get().challenges.filter(c => \n      c.status === \"completed\" || c.status === \"expired\"\n    );\n  },\n\n  selectRandomQuestions: (count) => {\n    let allQuestions = get().getQuestionPool();\n    if (allQuestions.length === 0) {\n      allQuestions = get().getFallbackQuestions();\n    }\n    \n    const freshQuestions = get().filterRecentQuestions(allQuestions);\n    let pool = freshQuestions.length > 0 ? freshQuestions : allQuestions;\n    \n    if (pool.length < count) {\n      pool = get().expandQuestionPool(pool, count);\n    }\n    \n    const shuffled = pool.sort(() => Math.random() - 0.5);\n    const selected = shuffled.slice(0, count);\n    \n    // Track shown questions and shuffle options to remove obvious clues\n    const normalizedQuestions = selected.map(q => {\n      get().trackShownQuestion(q.question);\n      return get().normalizeAndShuffleOptions(q);\n    });\n    \n    return normalizedQuestions;\n  },\n\n  getSharedLessons: (userId, friendId) => {\n    const { completedLessons } = useProgressStore.getState();\n    if (!completedLessons || !Array.isArray(completedLessons) || completedLessons.length === 0) {\n      return [];\n    }\n    \n    const userCompletedSet = new Set(\n      completedLessons.map(l => `${l.pathId}-${l.lessonId}`)\n    );\n    \n    return completedLessons.filter(lesson => \n      userCompletedSet.has(`${lesson.pathId}-${lesson.lessonId}`)\n    );\n  },\n}));\n","path":null,"size_bytes":38887,"size_tokens":null},"src/components/challenges/ChallengeExplainerModal.jsx":{"content":"import mascot_quiz from \"../../assets/mascots/mascot_quiz.webp\";\nimport mascot_power from \"../../assets/mascots/mascot_power.webp\";\nimport mascot_running from \"../../assets/mascots/mascot_running.webp\";\nimport mascot_locked from \"../../assets/mascots/mascot_locked.webp\";\nimport mascot_boss from \"../../assets/mascots/mascot_boss.webp\";\nimport \"./ChallengeModals.css\";\n\nconst getMascotForMode = (modeId) => {\n  switch (modeId) {\n    case \"mind_battle\":\n      return mascot_quiz;\n    case \"lightning_round\":\n      return mascot_power;\n    case \"speed_run\":\n      return mascot_running;\n    case \"sudden_death\":\n      return mascot_locked;\n    case \"boss_level\":\n      return mascot_boss;\n    default:\n      return mascot_quiz;\n  }\n};\n\nexport default function ChallengeExplainerModal({ mode, onStart, onCancel }) {\n  const mascot = getMascotForMode(mode?.id);\n\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-modal\">\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={mascot} \n            alt={mode?.name || \"Challenge\"} \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n        </div>\n\n        <h2 className=\"challenge-modal-title\">{mode.name}</h2>\n        <p className=\"challenge-modal-subtitle\">{mode.description}</p>\n\n        <div className=\"challenge-details\">\n          {mode.questionCount && (\n            <div className=\"challenge-detail-item\">\n              <span className=\"detail-icon\">üìã</span>\n              <span>{mode.questionCount} Questions</span>\n            </div>\n          )}\n          \n          {mode.timePerQuestion && (\n            <div className=\"challenge-detail-item\">\n              <span className=\"detail-icon\">‚è±Ô∏è</span>\n              <span>{mode.timePerQuestion}s per question</span>\n            </div>\n          )}\n          \n          {mode.totalTime && (\n            <div className=\"challenge-detail-item\">\n              <span className=\"detail-icon\">‚ö°</span>\n              <span>{mode.totalTime}s total time</span>\n            </div>\n          )}\n        </div>\n\n        <div className=\"challenge-rewards\">\n          <h4 style={{ color: \"#d4af37\", marginBottom: 8 }}>Rewards</h4>\n          <div className=\"reward-grid\">\n            {mode.rewards.win && (\n              <div className=\"reward-item\">\n                <span className=\"reward-label\">Win</span>\n                <span className=\"reward-value\">\n                  +{mode.rewards.win.xp} XP ‚Ä¢ +{mode.rewards.win.coins} coins\n                </span>\n              </div>\n            )}\n            {mode.rewards.lose && (\n              <div className=\"reward-item\">\n                <span className=\"reward-label\">Lose</span>\n                <span className=\"reward-value\">+{mode.rewards.lose.xp} XP</span>\n              </div>\n            )}\n            {mode.rewards.draw && (\n              <div className=\"reward-item\">\n                <span className=\"reward-label\">Draw</span>\n                <span className=\"reward-value\">+{mode.rewards.draw.xp} XP each</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"challenge-modal-actions\">\n          <button \n            className=\"challenge-btn-secondary\"\n            onClick={onCancel}\n          >\n            Cancel\n          </button>\n          <button \n            className=\"challenge-btn-primary\"\n            style={{\n              background: mode.gradient,\n              boxShadow: mode.glow\n            }}\n            onClick={onStart}\n          >\n            Let's Go! üöÄ\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3682,"size_tokens":null},"src/components/challenges/BossLockedModal.jsx":{"content":"import ZaydChallenge from \"../../assets/mascots/mascot_boss.webp\";\nimport { DiamondIcon } from \"../DiamondIcon\";\nimport \"./ChallengeModals.css\";\n\nexport default function BossLockedModal({ currentLevel, onClose }) {\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-modal\">\n        {/* Zayd Mascot */}\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={ZaydChallenge} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            Boss Level is only for the most advanced students! Keep learning to unlock it!\n          </div>\n        </div>\n\n        {/* Lock Icon */}\n        <div \n          className=\"challenge-mode-icon\"\n          style={{\n            background: \"linear-gradient(135deg, #6b7280, #4b5563)\",\n            boxShadow: \"0 0 20px rgba(107, 114, 128, 0.5)\"\n          }}\n        >\n          üîí\n        </div>\n\n        {/* Title */}\n        <h2 className=\"challenge-modal-title\" style={{ color: \"#94a3b8\" }}>\n          Boss Level Locked\n        </h2>\n\n        <p style={{ color: \"#cbd5e1\", fontSize: \"0.95rem\", lineHeight: 1.6, marginBottom: 16 }}>\n          You need to reach <strong style={{ color: \"#d4af37\" }}>Level 8</strong> to unlock the Boss Level challenge.\n        </p>\n\n        {/* Current Level Display */}\n        <div style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          gap: 12,\n          padding: 16,\n          background: \"rgba(255, 255, 255, 0.03)\",\n          borderRadius: 12,\n          marginBottom: 20\n        }}>\n          <span style={{ color: \"#94a3b8\", fontSize: \"0.9rem\" }}>Your Level:</span>\n          <DiamondIcon level={currentLevel} size={40} />\n          <span style={{ color: \"#fff\", fontSize: \"1.2rem\", fontWeight: 700 }}>Level {currentLevel}</span>\n        </div>\n\n        <p style={{ color: \"#94a3b8\", fontSize: \"0.85rem\", marginBottom: 20 }}>\n          Complete more lessons and challenges to level up!\n        </p>\n\n        {/* Close Button */}\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={onClose}\n          style={{\n            background: \"linear-gradient(135deg, #6b7280, #4b5563)\",\n            boxShadow: \"0 4px 15px rgba(107, 114, 128, 0.3)\"\n          }}\n        >\n          Keep Learning üìö\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2499,"size_tokens":null},"src/components/challenges/NoSharedLessonsModal.jsx":{"content":"import ZaydChallenge from \"../../assets/mascots/mascot_boss.webp\";\nimport \"./ChallengeModals.css\";\n\nexport default function NoSharedLessonsModal({ friendName, onClose }) {\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-modal\">\n        {/* Zayd Mascot */}\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={ZaydChallenge} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            You both need to learn more lessons first before challenging each other!\n          </div>\n        </div>\n\n        {/* Title */}\n        <h2 className=\"challenge-modal-title\" style={{ color: \"#f59e0b\" }}>\n          Not Enough Learning Yet\n        </h2>\n\n        <p style={{ color: \"#cbd5e1\", fontSize: \"0.95rem\", lineHeight: 1.6, marginBottom: 20 }}>\n          You and {friendName || \"your friend\"} don't have any completed lessons in common yet. \n          Complete more lessons together to unlock challenges!\n        </p>\n\n        {/* Close Button */}\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={onClose}\n          style={{\n            background: \"linear-gradient(135deg, #f59e0b, #d97706)\",\n            boxShadow: \"0 4px 15px rgba(245, 158, 11, 0.3)\"\n          }}\n        >\n          Got it! üëç\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1475,"size_tokens":null},"src/pages/challenges/ChallengeGame.css":{"content":"/* Challenge Game Container */\n.challenge-game-container {\n  background: linear-gradient(to bottom, #081426, #0e2340);\n  padding: 16px;\n  color: white;\n}\n\n.challenge-loading {\n  text-align: center;\n  padding: 40px 20px;\n  font-size: 1.2rem;\n  color: #d4af37;\n}\n\n/* Header */\n.challenge-game-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 16px;\n  margin-bottom: 16px;\n  border: 1px solid rgba(212, 175, 55, 0.2);\n}\n\n.challenge-game-title {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: #d4af37;\n  font-size: 1.2rem;\n  font-weight: 700;\n}\n\n.challenge-game-timer {\n  font-size: 1.3rem;\n  font-weight: 700;\n  padding: 8px 16px;\n  background: rgba(0, 0, 0, 0.5);\n  border-radius: 12px;\n  border: 2px solid currentColor;\n  box-shadow: 0 0 15px currentColor;\n  transition: all 0.3s ease;\n}\n\n/* Progress Bar */\n.challenge-progress-container {\n  width: 100%;\n  height: 8px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 4px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.challenge-progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, #10b981, #d4af37);\n  transition: width 0.3s ease;\n  border-radius: 4px;\n}\n\n.challenge-progress-text {\n  text-align: center;\n  color: #cbd5e1;\n  font-size: 0.9rem;\n  margin-bottom: 20px;\n}\n\n/* Question Card */\n.challenge-question-card {\n  background: linear-gradient(135deg, rgba(212,175,55,0.1), rgba(16,185,129,0.05));\n  border: 2px solid rgba(212, 175, 55, 0.3);\n  border-radius: 20px;\n  padding: 24px;\n  box-shadow: 0 0 30px rgba(212, 175, 55, 0.2);\n  max-width: 600px;\n  margin: 0 auto;\n}\n\n.challenge-question-text {\n  color: #fff;\n  font-size: 1.3rem;\n  font-weight: 700;\n  margin-bottom: 24px;\n  line-height: 1.5;\n  text-align: center;\n}\n\n/* Answer Options */\n.challenge-options {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.challenge-option {\n  background: rgba(255, 255, 255, 0.05);\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 16px;\n  padding: 16px 20px;\n  color: white;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  position: relative;\n  min-height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.challenge-option:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  transform: translateY(-2px);\n}\n\n.challenge-option:disabled {\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.challenge-option.selected {\n  border-color: #d4af37;\n  background: rgba(212, 175, 55, 0.15);\n  box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);\n}\n\n.challenge-option.correct {\n  border-color: #10b981;\n  background: rgba(16, 185, 129, 0.15);\n  box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);\n}\n\n.challenge-option.wrong {\n  border-color: #ef4444;\n  background: rgba(239, 68, 68, 0.15);\n  box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);\n}\n\n.option-icon {\n  font-size: 1.5rem;\n  font-weight: 700;\n  margin-left: 10px;\n}\n\n/* Chain Display (Sudden Death) */\n.chain-display {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 10px;\n  margin-top: 20px;\n  padding: 14px 24px;\n  background: linear-gradient(135deg, #ef4444, #dc2626);\n  border-radius: 20px;\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: white;\n  box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);\n  animation: pulse-chain 1s ease-in-out infinite;\n}\n\n@keyframes pulse-chain {\n  0%, 100% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.05);\n  }\n}\n\n/* Time Up Overlay */\n.challenge-time-up-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.9);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 999;\n  animation: fadeIn 0.3s ease;\n}\n\n.time-up-message {\n  font-size: 3rem;\n  font-weight: 800;\n  color: #ef4444;\n  text-shadow: 0 0 30px rgba(239, 68, 68, 0.8);\n  animation: bounceIn 0.5s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes bounceIn {\n  0% {\n    transform: scale(0.5);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.1);\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n/* Islamic Match Game Styles */\n.match-game-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.match-instructions {\n  text-align: center;\n  color: #d4af37;\n  font-size: 1rem;\n  font-weight: 600;\n  margin-bottom: 8px;\n}\n\n.match-columns {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 16px;\n}\n\n.match-column {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.match-item {\n  padding: 14px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 2px solid rgba(212, 175, 55, 0.3);\n  border-radius: 12px;\n  color: white;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  text-align: left;\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  min-height: 60px;\n}\n\n.match-item:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  transform: translateX(4px);\n}\n\n.match-item:disabled {\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.match-item.selected {\n  border-color: #d4af37;\n  background: rgba(212, 175, 55, 0.15);\n  box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);\n  transform: scale(1.05);\n}\n\n.match-item.matched-correct {\n  border-color: #10b981;\n  background: rgba(16, 185, 129, 0.15);\n  box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);\n}\n\n.match-item.matched-wrong {\n  border-color: #ef4444;\n  background: rgba(239, 68, 68, 0.15);\n  box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);\n}\n\n.match-icon {\n  font-size: 1.3rem;\n  flex-shrink: 0;\n}\n\n.match-check {\n  position: absolute;\n  right: 12px;\n  font-size: 1.3rem;\n  color: #10b981;\n  font-weight: 700;\n}\n\n.match-cross {\n  position: absolute;\n  right: 12px;\n  font-size: 1.3rem;\n  color: #ef4444;\n  font-weight: 700;\n}\n\n.match-result {\n  padding: 16px 20px;\n  border-radius: 16px;\n  font-size: 1.1rem;\n  font-weight: 700;\n  text-align: center;\n  animation: slideIn 0.3s ease;\n  margin-top: 8px;\n}\n\n.match-result.correct {\n  background: rgba(16, 185, 129, 0.15);\n  border: 2px solid #10b981;\n  color: #10b981;\n  box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);\n}\n\n.match-result.wrong {\n  background: rgba(239, 68, 68, 0.15);\n  border: 2px solid #ef4444;\n  color: #ef4444;\n  box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);\n}\n\n/* Fill-the-Gap Input Styles */\n.fill-gap-input-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.fill-gap-input {\n  width: 100%;\n  padding: 16px 20px;\n  font-size: 1.1rem;\n  color: white;\n  background: rgba(255, 255, 255, 0.05);\n  border: 2px solid rgba(212, 175, 55, 0.5);\n  border-radius: 16px;\n  outline: none;\n  transition: all 0.3s ease;\n  font-family: inherit;\n}\n\n.fill-gap-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n.fill-gap-input:focus {\n  border-color: #d4af37;\n  background: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);\n}\n\n.fill-gap-input:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.fill-gap-submit-btn {\n  padding: 14px 28px;\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: white;\n  background: linear-gradient(135deg, #10b981, #059669);\n  border: 2px solid #10b981;\n  border-radius: 16px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);\n}\n\n.fill-gap-submit-btn:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);\n}\n\n.fill-gap-submit-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.fill-gap-result {\n  padding: 16px 20px;\n  border-radius: 16px;\n  font-size: 1.1rem;\n  font-weight: 700;\n  text-align: center;\n  animation: slideIn 0.3s ease;\n}\n\n.fill-gap-result.correct {\n  background: rgba(16, 185, 129, 0.15);\n  border: 2px solid #10b981;\n  color: #10b981;\n  box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);\n}\n\n.fill-gap-result.wrong {\n  background: rgba(239, 68, 68, 0.15);\n  border: 2px solid #ef4444;\n  color: #ef4444;\n  box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);\n}\n\n@keyframes slideIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* Responsive */\n@media (max-width: 480px) {\n  .challenge-question-text {\n    font-size: 1.1rem;\n  }\n\n  .challenge-option {\n    padding: 14px 16px;\n    font-size: 0.95rem;\n    min-height: 55px;\n  }\n\n  .challenge-game-header {\n    padding: 12px;\n  }\n\n  .challenge-game-title {\n    font-size: 1rem;\n  }\n\n  .challenge-game-timer {\n    font-size: 1rem;\n  }\n\n  .fill-gap-input {\n    font-size: 1rem;\n    padding: 14px 16px;\n  }\n\n  .fill-gap-submit-btn {\n    font-size: 1rem;\n    padding: 12px 24px;\n  }\n\n  .fill-gap-result {\n    font-size: 1rem;\n    padding: 14px 16px;\n  }\n\n  .match-columns {\n    grid-template-columns: 1fr;\n    gap: 12px;\n  }\n\n  .match-item {\n    font-size: 0.9rem;\n    padding: 12px 14px;\n    min-height: 55px;\n  }\n\n  .match-instructions {\n    font-size: 0.95rem;\n  }\n\n  .match-result {\n    font-size: 1rem;\n    padding: 14px 16px;\n  }\n}\n","path":null,"size_bytes":9066,"size_tokens":null},"src/components/challenges/ChallengeResultsModal.jsx":{"content":"import { useRef, useEffect } from \"react\";\nimport { useRewards } from \"../../hooks/useRewards\";\nimport { useVibration } from \"../../hooks/useVibration\";\nimport mascotCongrats from \"../../assets/mascots/mascot_congratulation.webp\";\nimport mascotSittingV2 from \"../../assets/mascots/mascot_sitting_v2.webp\";\nimport mascotDefeated from \"../../assets/mascots/mascot_defeated.webp\";\nimport mascotBoss from \"../../assets/mascots/mascot_boss.webp\";\nimport avatarManLantern from \"../../assets/avatars/avatar_man_lantern.webp\";\nimport \"./ChallengeModals.css\";\n\nexport default function ChallengeResultsModal({ \n  mode, \n  score, \n  totalQuestions,\n  result, // \"win\", \"lose\", \"draw\"\n  rewards,\n  xpEarned,\n  coinsEarned,\n  opponentName,\n  opponentScore,\n  answeredCount, // Number of questions answered by user (for Speed Run)\n  opponentAnsweredCount, // Number of questions answered by opponent (for Speed Run)\n  userChain, // Longest chain for Sudden Death\n  opponentChain, // Opponent's longest chain for Sudden Death\n  onApplyRewards,\n  onClose \n}) {\n  const { addRewards } = useRewards();\n  const { vibrate } = useVibration();\n  const hasAppliedRewards = useRef(false);\n  \n  // Trigger haptic feedback when modal appears\n  useEffect(() => {\n    if (result === \"win\") {\n      vibrate([100, 50, 100, 50, 100]); // Victory pattern\n    } else if (result === \"lose\") {\n      vibrate([200, 100, 200]); // Failure pattern\n    } else {\n      // Draw - use selection pattern (neutral outcome)\n      vibrate(50);\n    }\n  }, [result, vibrate]);\n  \n  const handleClose = () => {\n    // Apply rewards exactly once when closing\n    if (!hasAppliedRewards.current) {\n      hasAppliedRewards.current = true;\n      const rewardData = { xp: xpEarned || rewards?.xp || 0, coins: coinsEarned || rewards?.coins || 0 };\n      addRewards(rewardData);\n      if (onApplyRewards) {\n        onApplyRewards(rewardData);\n      }\n    }\n    if (onClose) {\n      onClose();\n    }\n  };\n  // Determine mode types\n  const isSpeedRun = mode === \"speed_run\" || mode?.id === \"speed_run\";\n  const isSuddenDeath = mode === \"sudden_death\" || mode?.id === \"sudden_death\";\n  const isBossLevel = mode === \"boss_level\" || mode?.id === \"boss_level\" || mode?.name?.includes(\"Boss\");\n  \n  // For Speed Run, use answered count; otherwise use total questions\n  const userTotal = isSpeedRun && answeredCount ? answeredCount : totalQuestions;\n  const opponentTotal = isSpeedRun && opponentAnsweredCount ? opponentAnsweredCount : totalQuestions;\n  \n  // Guard against division by zero (if user answered no questions)\n  const percentage = userTotal > 0 ? Math.round((score / userTotal) * 100) : 0;\n  \n  // Handle mode as either string or object\n  const modeGradient = typeof mode === \"object\" ? mode.gradient : \"linear-gradient(135deg, #D4AF37 0%, #F4D03F 100%)\";\n  const modeGlow = typeof mode === \"object\" ? mode.glow : \"0 0 20px rgba(212, 175, 55, 0.5)\";\n  \n  const getMessage = () => {\n    if (result === \"win\") return \"You Won! üéâ\";\n    if (result === \"lose\") {\n      if (isBossLevel) {\n        return \"Keep going! You're improving every time!\";\n      }\n      return \"Better luck next time! üí™\";\n    }\n    if (result === \"draw\") return \"It's a Draw! ü§ù\";\n    return \"Challenge Complete!\";\n  };\n\n  const getZaydMessage = () => {\n    if (result === \"win\") return \"masha'Allah! You dominated that challenge!\";\n    if (result === \"lose\") return \"Don't give up! Learn from your mistakes!\";\n    if (result === \"draw\") return \"Evenly matched! Both of you are strong!\";\n    return \"Great effort!\";\n  };\n\n  const getMascot = () => {\n    // Boss level shows appropriate mascot based on result\n    if (isBossLevel) {\n      if (result === \"win\") return mascotCongrats;\n      if (result === \"lose\") return avatarManLantern;\n      return mascotBoss;\n    }\n    \n    // Regular challenges show result-based mascots\n    if (result === \"win\") return mascotCongrats;\n    if (result === \"lose\") return mascotDefeated;\n    if (result === \"draw\") return mascotSittingV2;\n    \n    // Default fallback\n    return mascotCongrats;\n  };\n\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-modal challenge-results-modal\">\n        {/* Zayd with Speech */}\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={getMascot()} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">{getZaydMessage()}</div>\n        </div>\n\n        {/* Result Title */}\n        <h2 \n          className=\"challenge-modal-title\"\n          style={{\n            color: result === \"win\" ? \"#10b981\" : result === \"lose\" ? \"#ef4444\" : \"#f59e0b\"\n          }}\n        >\n          {getMessage()}\n        </h2>\n\n        {/* Score Display */}\n        <div className=\"challenge-score-display\" style={{ minHeight: \"100px\" }}>\n          <div className=\"score-section\">\n            <span className=\"score-label\">You</span>\n            {isSuddenDeath ? (\n              <>\n                <span className=\"score-value\" style={{ wordBreak: \"break-word\" }}>Chain: {userChain ?? 0}</span>\n              </>\n            ) : (\n              <>\n                <span className=\"score-value\" style={{ wordBreak: \"break-word\" }}>{score ?? 0}/{userTotal}</span>\n                <span className=\"score-percentage\">{percentage ?? 0}%</span>\n              </>\n            )}\n          </div>\n          \n          <div className=\"score-vs\">VS</div>\n          \n          <div className=\"score-section\">\n            <span className=\"score-label\" style={{ \n              wordBreak: \"break-word\",\n              maxWidth: \"120px\",\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\",\n              whiteSpace: \"normal\",\n              lineHeight: \"1.2\"\n            }}>{isBossLevel ? \"The Boss üëë\" : (opponentName || \"Opponent\")}</span>\n            {isSuddenDeath ? (\n              <span className=\"score-value\" style={{ wordBreak: \"break-word\" }}>\n                {opponentChain !== null && opponentChain !== undefined ? `Chain: ${opponentChain}` : \"Pending\"}\n              </span>\n            ) : isBossLevel ? (\n              <>\n                <span className=\"score-value\" style={{ wordBreak: \"break-word\" }}>11/{totalQuestions}</span>\n                <span className=\"score-percentage\">{Math.round((11 / totalQuestions) * 100)}%</span>\n              </>\n            ) : (\n              <>\n                <span className=\"score-value\" style={{ wordBreak: \"break-word\" }}>\n                  {opponentScore !== null && opponentScore !== undefined ? `${opponentScore}/${opponentTotal}` : \"‚Äî\"}\n                </span>\n                {opponentScore !== null && opponentScore !== undefined && (\n                  <span className=\"score-percentage\">\n                    {opponentTotal > 0 ? Math.round((opponentScore / opponentTotal) * 100) : 0}%\n                  </span>\n                )}\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Rewards Earned */}\n        <div className=\"challenge-rewards-earned\">\n          <h4 style={{ color: \"#d4af37\", marginBottom: 8 }}>Rewards Earned</h4>\n          <div className=\"rewards-display\">\n            <div className=\"reward-badge\">\n              <span className=\"reward-icon\">‚≠ê</span>\n              <span className=\"reward-text\">+{rewards.xp} XP</span>\n            </div>\n            {rewards.coins > 0 && (\n              <div className=\"reward-badge\">\n                <span className=\"reward-icon\">üí∞</span>\n                <span className=\"reward-text\">+{rewards.coins} Coins</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Close Button */}\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={() => {\n            vibrate(50);\n            handleClose();\n          }}\n          style={{\n            background: modeGradient,\n            boxShadow: modeGlow,\n            marginTop: 12\n          }}\n        >\n          Awesome! üéØ\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8109,"size_tokens":null},"src/components/challenges/ChallengeCountdown.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport mascotCountdown from \"../../assets/mascots/mascot_countdown.webp\";\nimport \"./ChallengeModals.css\";\n\nexport default function ChallengeCountdown({ onComplete }) {\n  const [count, setCount] = useState(3);\n\n  useEffect(() => {\n    if (count > 0) {\n      const timer = setTimeout(() => setCount(count - 1), 1000);\n      return () => clearTimeout(timer);\n    } else {\n      const timer = setTimeout(onComplete, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [count, onComplete]);\n\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-countdown-modal\">\n        <div className=\"countdown-mascot\">\n          <img \n            src={mascotCountdown}\n            alt=\"Countdown Rocket\" \n            className=\"countdown-rocket\"\n          />\n        </div>\n        <div className=\"countdown-number\">\n          {count > 0 ? count : \"GO!\"}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":969,"size_tokens":null},"src/components/challenges/ChallengeModals.css":{"content":"/* Challenge Modal Overlay */\n.challenge-modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.95);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 16px;\n  padding-top: max(16px, env(safe-area-inset-top, 16px));\n  padding-right: max(16px, env(safe-area-inset-right, 16px));\n  padding-bottom: max(16px, env(safe-area-inset-bottom, 16px));\n  padding-left: max(16px, env(safe-area-inset-left, 16px));\n  animation: fadeIn 0.2s ease;\n}\n\n.challenge-modal {\n  background: linear-gradient(to bottom, #0e2340, #081426);\n  border: 2px solid rgba(212, 175, 55, 0.3);\n  border-radius: 20px;\n  padding: 24px;\n  max-width: 450px;\n  width: 100%;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);\n  animation: slideUp 0.3s ease;\n  text-align: center;\n}\n\n/* Zayd Mascot */\n.challenge-zayd-container {\n  position: relative;\n  margin-bottom: 16px;\n}\n\n.challenge-zayd-bounce {\n  animation: bounceY 1.6s ease-in-out infinite;\n  filter: drop-shadow(0 6px 10px rgba(0,0,0,0.35));\n}\n\n@keyframes bounceY {\n  0%, 100% { transform: translateY(0) scale(1); }\n  30% { transform: translateY(-10px) scale(1.02); }\n  60% { transform: translateY(-4px) scale(1.01); }\n}\n\n.zayd-speech-bubble {\n  background: rgba(212, 175, 55, 0.15);\n  border: 1px solid rgba(212, 175, 55, 0.4);\n  border-radius: 16px;\n  padding: 10px 16px;\n  margin-top: 12px;\n  color: #fff;\n  font-size: 0.9rem;\n  line-height: 1.4;\n  position: relative;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  hyphens: auto;\n}\n\n.zayd-speech-bubble::before {\n  content: \"\";\n  position: absolute;\n  top: -8px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 0;\n  height: 0;\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  border-bottom: 8px solid rgba(212, 175, 55, 0.4);\n}\n\n/* Mode Icon */\n.challenge-mode-icon {\n  width: 70px;\n  height: 70px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 2.5rem;\n  margin: 0 auto 16px;\n}\n\n/* Modal Text */\n.challenge-modal-title {\n  color: #d4af37;\n  font-size: 1.6rem;\n  font-weight: 700;\n  margin: 0 0 8px;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n}\n\n.challenge-modal-subtitle {\n  color: #cbd5e1;\n  font-size: 0.95rem;\n  margin: 0 0 20px;\n  opacity: 0.9;\n}\n\n/* Challenge Details */\n.challenge-details {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  margin-bottom: 20px;\n  background: rgba(255, 255, 255, 0.03);\n  border-radius: 12px;\n  padding: 14px;\n}\n\n.challenge-detail-item {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  color: #e2e8f0;\n  font-size: 0.95rem;\n}\n\n.detail-icon {\n  font-size: 1.2rem;\n}\n\n/* Rewards Section */\n.challenge-rewards {\n  background: rgba(212, 175, 55, 0.08);\n  border: 1px solid rgba(212, 175, 55, 0.2);\n  border-radius: 12px;\n  padding: 14px;\n  margin-bottom: 20px;\n}\n\n.reward-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.reward-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 6px 0;\n}\n\n.reward-label {\n  color: #94a3b8;\n  font-size: 0.85rem;\n  font-weight: 600;\n}\n\n.reward-value {\n  color: #10b981;\n  font-size: 0.9rem;\n  font-weight: 700;\n}\n\n/* Modal Actions */\n.challenge-modal-actions {\n  display: flex;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.challenge-btn-primary,\n.challenge-btn-secondary {\n  flex: 1;\n  padding: 14px 20px;\n  border-radius: 12px;\n  font-weight: 700;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n  color: white;\n}\n\n.challenge-btn-primary {\n  background: linear-gradient(135deg, #10b981, #059669);\n  box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);\n}\n\n.challenge-btn-primary:active {\n  transform: scale(0.98);\n}\n\n.challenge-btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.challenge-btn-secondary:active {\n  background: rgba(255, 255, 255, 0.15);\n}\n\n/* Countdown Modal */\n.challenge-countdown-modal {\n  background: transparent;\n  border: none;\n  box-shadow: none;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 30px;\n  width: 100%;\n  height: 100%;\n}\n\n.challenge-countdown-modal .countdown-mascot {\n  width: 200px;\n  height: 200px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: radial-gradient(circle, rgba(212, 175, 55, 0.15) 0%, transparent 70%);\n  border-radius: 50%;\n  padding: 20px;\n}\n\n.challenge-countdown-modal .countdown-rocket {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  filter: drop-shadow(0 10px 25px rgba(212, 175, 55, 0.5));\n}\n\n.challenge-countdown-modal .countdown-number {\n  font-size: 10rem;\n  font-weight: 900;\n  color: #d4af37;\n  text-shadow: 0 0 50px rgba(212, 175, 55, 0.9);\n  line-height: 1;\n}\n\n/* Results Modal Specific */\n.challenge-results-modal {\n  max-width: 500px;\n}\n\n.challenge-score-display {\n  display: grid;\n  grid-template-columns: 1fr auto 1fr;\n  gap: 16px;\n  align-items: center;\n  margin: 20px 0;\n  padding: 20px;\n  background: rgba(255, 255, 255, 0.03);\n  border-radius: 16px;\n}\n\n.score-section {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  text-align: center;\n}\n\n.score-label {\n  color: #94a3b8;\n  font-size: 0.85rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n.score-value {\n  color: #fff;\n  font-size: 2rem;\n  font-weight: 800;\n}\n\n.score-percentage {\n  color: #10b981;\n  font-size: 0.9rem;\n  font-weight: 600;\n}\n\n.score-vs {\n  color: #d4af37;\n  font-size: 1.2rem;\n  font-weight: 700;\n}\n\n/* Rewards Earned */\n.challenge-rewards-earned {\n  background: rgba(212, 175, 55, 0.08);\n  border: 1px solid rgba(212, 175, 55, 0.2);\n  border-radius: 12px;\n  padding: 14px;\n  margin-top: 16px;\n}\n\n.rewards-display {\n  display: flex;\n  justify-content: center;\n  gap: 12px;\n  flex-wrap: wrap;\n}\n\n.reward-badge {\n  background: rgba(16, 185, 129, 0.15);\n  border: 1px solid rgba(16, 185, 129, 0.3);\n  border-radius: 20px;\n  padding: 8px 16px;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.reward-icon {\n  font-size: 1.2rem;\n}\n\n.reward-text {\n  color: #10b981;\n  font-weight: 700;\n  font-size: 0.95rem;\n}\n\n/* Animations */\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slideUp {\n  from {\n    transform: translateY(30px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n","path":null,"size_bytes":6456,"size_tokens":null},"src/pages/challenges/ChallengeGame.jsx":{"content":"import { useState, useEffect, useRef, useMemo } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../../hooks/useNavigate\";\nimport { useChallengeStore, CHALLENGE_MODES, BOSS_LEVEL, calculateLongestChain } from \"../../store/challengeStore\";\nimport { useModalStore, MODAL_TYPES } from \"../../store/modalStore\";\nimport { useRewards } from \"../../hooks/useRewards\";\nimport { useAnalytics } from \"../../hooks/useAnalytics\";\nimport { useVibration } from \"../../hooks/useVibration\";\nimport assets from \"../../assets/assets\";\nimport mascot_running from \"../../assets/mascots/mascot_running.webp\";\nimport { avatarIndexToKey } from \"../../utils/avatarUtils\";\nimport { logChallengeResult } from \"../../backend/challengeLogs\";\nimport { supabase } from \"../../lib/supabaseClient\";\nimport \"./ChallengeGame.css\";\n\n// Helper function to normalize mode from any format to config object\nconst getModeConfig = (modeInput) => {\n  if (!modeInput) return null;\n  \n  // Already a config object\n  if (typeof modeInput === 'object' && modeInput.id) {\n    return modeInput;\n  }\n  \n  // String ID (like \"mind_battle\") - find by ID\n  if (typeof modeInput === 'string') {\n    // First try: find by ID\n    const foundById = Object.values(CHALLENGE_MODES).find(m => m.id === modeInput);\n    if (foundById) return foundById;\n    \n    // Second try: convert to uppercase key and lookup\n    const modeKey = modeInput.toUpperCase();\n    if (CHALLENGE_MODES[modeKey]) {\n      return CHALLENGE_MODES[modeKey];\n    }\n    \n    // Third try: if it's already a key like \"MIND_BATTLE\"\n    if (CHALLENGE_MODES[modeInput]) {\n      return CHALLENGE_MODES[modeInput];\n    }\n  }\n  \n  console.error('Failed to normalize mode:', modeInput);\n  return null;\n};\n\nexport default function ChallengeGame() {\n  const navigate = useNavigate();\n  const { challengeId } = useParams();\n  const { showModal } = useModalStore();\n  const { addRewards } = useRewards();\n  const analytics = useAnalytics();\n  const { vibrate } = useVibration();\n  \n  const [questions, setQuestions] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [timeLeft, setTimeLeft] = useState(0);\n  const [isTimeUp, setIsTimeUp] = useState(false);\n  const [score, setScore] = useState(0);\n  const [chainLength, setChainLength] = useState(0);\n  const [gameEnded, setGameEnded] = useState(false);\n  const [textInput, setTextInput] = useState(\"\");\n  const [selectedLeft, setSelectedLeft] = useState(null);\n  const [selectedRight, setSelectedRight] = useState(null);\n  const [matches, setMatches] = useState([]);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  \n  const timerRef = useRef(null);\n  const elapsedTimerRef = useRef(null);\n  const selectedAnswerRef = useRef(null);\n  const isCompletingRef = useRef(false);\n  const startTimeRef = useRef(null);\n  const completionTimeRef = useRef(null);\n\n  // Determine if it's a boss level or friend challenge\n  const isBoss = challengeId === \"boss\";\n  \n  // For friend challenges, get the challenge data (use useMemo to prevent infinite loop)\n  const { challenges } = useChallengeStore();\n  const challenge = useMemo(() => \n    isBoss ? null : challenges.find(c => c.id === challengeId),\n    [isBoss, challenges, challengeId]\n  );\n  \n  // Get mode configuration using robust normalization\n  const mode = useMemo(() => {\n    if (isBoss) return BOSS_LEVEL;\n    if (challenge) return getModeConfig(challenge.mode);\n    return null;\n  }, [isBoss, challenge]);\n\n  useEffect(() => {\n    console.log('üéÆ Loading challenge questions', { isBoss, challengeId, mode });\n    \n    // Track challenge started for analytics\n    if (isBoss) {\n      analytics('challenge_started', { mode: 'boss_level' });\n    } else if (challenge && mode) {\n      analytics('challenge_started', { mode: mode.id, opponent: challenge.opponentId });\n    }\n    \n    // Start tracking time when game begins\n    startTimeRef.current = Date.now();\n    \n    // Load questions based on challenge type\n    if (isBoss) {\n      const bossQuestions = useChallengeStore.getState().getBossLevelQuestions();\n      if (bossQuestions.length === 0) {\n        alert(\"Complete some lessons first to unlock Boss Level questions!\");\n        navigate(\"/challenge\");\n        return;\n      }\n      setQuestions(bossQuestions);\n      setTimeLeft(BOSS_LEVEL.totalTime);\n    } else if (challenge && mode) {\n      let gameQuestions = [...challenge.questions];\n      \n      // For Sudden Death with 25 questions or Speed Run with 40, recycle if needed\n      if ((mode.id === 'sudden_death' && mode.questionCount) || \n          (mode.id === 'speed_run' && mode.questionCount)) {\n        const targetCount = mode.questionCount;\n        while (gameQuestions.length < targetCount) {\n          // Recycle questions with unique IDs\n          const recycledQuestions = challenge.questions.map((q, idx) => ({\n            ...q,\n            id: `${q.id || idx}_recycled_${Math.floor(gameQuestions.length / challenge.questions.length)}`\n          }));\n          gameQuestions = [...gameQuestions, ...recycledQuestions];\n        }\n        gameQuestions = gameQuestions.slice(0, targetCount); // Ensure exact count\n      }\n      \n      setQuestions(gameQuestions);\n      // Only set timer for modes with totalTime (Lightning Round, Boss)\n      if (mode.totalTime) {\n        setTimeLeft(mode.totalTime);\n      } else if (mode.timePerQuestion) {\n        setTimeLeft(mode.timePerQuestion);\n      }\n    }\n  }, [challengeId, isBoss, navigate, challenge, mode]);\n\n  useEffect(() => {\n    // Start countdown timer for modes with totalTime\n    if (questions.length > 0 && timeLeft > 0 && !gameEnded) {\n      timerRef.current = setInterval(() => {\n        setTimeLeft(prev => {\n          if (prev <= 1) {\n            handleTimeUp();\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n    }\n\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [questions, timeLeft, gameEnded]);\n\n  useEffect(() => {\n    // Start elapsed timer for Mind Battle only\n    if (questions.length > 0 && mode?.id === 'mind_battle' && !gameEnded) {\n      elapsedTimerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    }\n\n    return () => {\n      if (elapsedTimerRef.current) clearInterval(elapsedTimerRef.current);\n    };\n  }, [questions, gameEnded, mode]);\n\n  const handleTimeUp = () => {\n    setIsTimeUp(true);\n    setGameEnded(true);\n    if (timerRef.current) clearInterval(timerRef.current);\n    \n    // Auto-submit with current answers\n    setTimeout(() => {\n      handleGameComplete();\n    }, 1000);\n  };\n\n  const handleMatchSelect = (side, index) => {\n    if (selectedAnswer !== null || gameEnded) return;\n    \n    if (side === 'left') {\n      if (selectedLeft === index) {\n        setSelectedLeft(null);\n      } else {\n        setSelectedLeft(index);\n        // Auto-check if both sides selected\n        if (selectedRight !== null) {\n          checkMatch(index, selectedRight);\n        }\n      }\n    } else {\n      if (selectedRight === index) {\n        setSelectedRight(null);\n      } else {\n        setSelectedRight(index);\n        // Auto-check if both sides selected\n        if (selectedLeft !== null) {\n          checkMatch(selectedLeft, index);\n        }\n      }\n    }\n  };\n\n  const checkMatch = (leftIdx, rightIdx) => {\n    const currentQ = questions[currentIndex];\n    const isCorrect = rightIdx === currentQ.answer;\n    \n    // Haptic feedback for matching\n    if (isCorrect) {\n      vibrate([100, 50, 100, 50, 100]); // Success pattern\n    } else {\n      vibrate([200, 100, 200]); // Failure pattern\n    }\n    \n    setMatches([...matches, { left: leftIdx, right: rightIdx, correct: isCorrect }]);\n    setSelectedAnswer(isCorrect ? rightIdx : -1);\n    \n    const newAnswer = {\n      questionId: currentQ.id || currentIndex,\n      selectedAnswer: rightIdx,\n      correct: isCorrect\n    };\n    \n    const updatedAnswers = [...answers, newAnswer];\n    setAnswers(updatedAnswers);\n    \n    setTimeout(() => {\n      if (currentIndex < questions.length - 1) {\n        setCurrentIndex(currentIndex + 1);\n        setSelectedAnswer(null);\n        setSelectedLeft(null);\n        setSelectedRight(null);\n        setMatches([]);\n        if (mode?.timePerQuestion) {\n          setTimeLeft(mode.timePerQuestion);\n        }\n      } else {\n        setGameEnded(true);\n        setTimeout(() => handleGameComplete(updatedAnswers), 1000);\n      }\n    }, 1500);\n  };\n\n  const handleAnswerSelect = (answerIndex) => {\n    if (selectedAnswer !== null || gameEnded) return;\n    \n    vibrate(50); // Quick haptic feedback on answer selection\n    setSelectedAnswer(answerIndex);\n    selectedAnswerRef.current = answerIndex;\n\n    // For Sudden Death, check if answer is correct\n    if (mode?.id === \"sudden_death\") {\n      const currentQ = questions[currentIndex];\n      const correctAnswer = currentQ.answer ?? currentQ.correctIndex ?? currentQ.correct;\n      const isCorrect = answerIndex === correctAnswer;\n      \n      const newAnswer = {\n        questionId: questions[currentIndex].id || currentIndex,\n        selectedAnswer: answerIndex,\n        correct: isCorrect\n      };\n\n      const updatedAnswers = [...answers, newAnswer];\n      setAnswers(updatedAnswers);\n      \n      // Calculate and update longest chain from all answers\n      const longestChain = calculateLongestChain(updatedAnswers);\n      setChainLength(longestChain);\n\n      if (!isCorrect) {\n        // Chain broken! End game\n        setGameEnded(true);\n        setTimeout(() => handleGameComplete(updatedAnswers), 1500);\n      } else {\n        // Continue chain\n        setTimeout(() => {\n          if (currentIndex < questions.length - 1) {\n            setCurrentIndex(currentIndex + 1);\n            setSelectedAnswer(null);\n            selectedAnswerRef.current = null;\n            if (mode.timePerQuestion) {\n              setTimeLeft(mode.timePerQuestion);\n            }\n          } else {\n            // Completed all questions successfully!\n            setGameEnded(true);\n            setTimeout(() => handleGameComplete(updatedAnswers), 1500);\n          }\n        }, 800);\n      }\n    } else if (mode?.id === \"speed_run\") {\n      // Speed Run - Continue immediately, wrong answers don't end game\n      setTimeout(() => handleNextQuestion(), 200);\n    } else {\n      // Regular modes\n      setTimeout(() => handleNextQuestion(), 800);\n    }\n  };\n\n  const handleNextQuestion = () => {\n    const answerIndex = selectedAnswerRef.current;\n    if (answerIndex === null) return;\n\n    const currentQ = questions[currentIndex];\n    const correctAnswer = currentQ.answer ?? currentQ.correctIndex ?? currentQ.correct;\n    const isCorrect = answerIndex === correctAnswer;\n    const newAnswer = {\n      questionId: questions[currentIndex].id || currentIndex,\n      selectedAnswer: answerIndex,\n      correct: isCorrect\n    };\n\n    const updatedAnswers = [...answers, newAnswer];\n    setAnswers(updatedAnswers);\n\n    if (currentIndex < questions.length - 1) {\n      setCurrentIndex(currentIndex + 1);\n      setSelectedAnswer(null);\n      selectedAnswerRef.current = null;\n\n      // Reset timer for per-question modes\n      if (mode?.timePerQuestion && mode?.id !== \"lightning_round\") {\n        setTimeLeft(mode.timePerQuestion);\n      }\n    } else {\n      // Last question answered - pass complete answers to handleGameComplete\n      setGameEnded(true);\n      setTimeout(() => handleGameComplete(updatedAnswers), 1000);\n    }\n  };\n\n  const handleGameComplete = async (finalAnswers = answers) => {\n    // Prevent double-completion\n    if (isCompletingRef.current) return;\n    isCompletingRef.current = true;\n    \n    if (timerRef.current) clearInterval(timerRef.current);\n    setGameEnded(true);\n    \n    // Calculate completion time\n    if (startTimeRef.current) {\n      completionTimeRef.current = (Date.now() - startTimeRef.current) / 1000; // in seconds\n    }\n    \n    console.log('üèÅ handleGameComplete called', { isBoss, mode, challenge, finalAnswers, completionTime: completionTimeRef.current });\n    \n    // Calculate final score from passed-in answers (includes last answer)\n    const finalScore = finalAnswers.filter(a => a.correct).length;\n    setScore(finalScore);\n    \n    // For Sudden Death, calculate chain length\n    const chainLength = mode?.id === 'sudden_death' ? calculateLongestChain(finalAnswers) : null;\n    \n    console.log('üìä Final score calculated', { finalScore, totalQuestions: questions.length, finalAnswers, chainLength });\n\n    let result = \"pending\";\n    let updatedChallenge = null;\n\n    // Save results locally and apply rewards\n    if (isBoss) {\n      // Use local boss attempt saving\n      const bossResult = useChallengeStore.getState().saveBossAttempt(\n        finalScore, \n        finalAnswers, \n        completionTimeRef.current\n      );\n      \n      if (bossResult.success) {\n        console.log('‚úÖ Boss attempt saved locally', bossResult);\n        \n        result = bossResult.attempt?.passed ? \"win\" : \"lose\";\n        \n        useChallengeStore.getState().awardRewards(\"boss_level\", result);\n        \n        const xpEarned = result === \"win\" ? BOSS_LEVEL.rewards.win.xp : BOSS_LEVEL.rewards.lose.xp;\n        \n        (async () => {\n          const { data } = await supabase.auth.getUser();\n          const userId = data?.user?.id;\n          if (userId) {\n            logChallengeResult(userId, \"boss_level\", result, xpEarned);\n          }\n        })();\n        \n        if (result === \"win\") {\n          analytics('boss_win', { score: finalScore, total: BOSS_LEVEL.questionCount });\n        }\n      } else {\n        console.error('‚ùå Boss save failed:', bossResult.error);\n        \n        if (bossResult.error === \"ALREADY_ATTEMPTED_TODAY\") {\n          showModal(MODAL_TYPES.ALERT, {\n            title: \"Already Played Today\",\n            message: \"You've already completed the Boss Level today. Come back tomorrow for another attempt!\",\n            onClose: () => navigate(\"/challenge\")\n          });\n          return;\n        }\n      }\n    } else if (challenge) {\n      // Use local challenge submission\n      const submitResult = useChallengeStore.getState().submitChallengeAttempt(\n        challengeId,\n        finalScore,\n        finalAnswers,\n        completionTimeRef.current,\n        chainLength\n      );\n      \n      if (submitResult.success) {\n        console.log('‚úÖ Challenge attempt submitted locally', submitResult);\n        updatedChallenge = submitResult.challenge;\n        \n        if (updatedChallenge?.status === 'completed') {\n          if (updatedChallenge.isDraw) {\n            result = \"draw\";\n          } else if (updatedChallenge.winner === 'current_user') {\n            result = \"win\";\n          } else {\n            result = \"lose\";\n          }\n          \n          useChallengeStore.getState().awardRewards(updatedChallenge.mode, result);\n          \n          const modeConfig = getModeConfig(updatedChallenge.mode);\n          const xpEarned = modeConfig?.rewards?.[result]?.xp || 0;\n          \n          (async () => {\n            const { data } = await supabase.auth.getUser();\n            const userId = data?.user?.id;\n            if (userId) {\n              logChallengeResult(userId, updatedChallenge.mode, result, xpEarned, updatedChallenge.opponentId);\n            }\n          })();\n          \n          if (result === \"win\") {\n            analytics('challenge_won', { mode: updatedChallenge.mode, opponent: updatedChallenge.opponentId });\n          }\n        } else {\n          result = \"pending\";\n        }\n      } else {\n        console.log('‚ö†Ô∏è Challenge submit failed:', submitResult.error);\n        result = \"pending\";\n      }\n    }\n\n    // Use the mode from component scope (already normalized)\n    console.log('üéØ Using mode for rewards', { mode, result });\n    \n    if (!mode) {\n      console.error('‚ùå Mode is undefined! Cannot show results.');\n      return;\n    }\n    \n    console.log('üèÜ Result determined', { result, mode, rewards: mode?.rewards });\n    \n    // Calculate rewards safely - handle \"pending\" result\n    let rewards = { xp: 0, coins: 0 };\n    if (mode?.rewards) {\n      if (result && mode.rewards[result]) {\n        rewards = mode.rewards[result];\n      } else if (mode.rewards.lose) {\n        rewards = mode.rewards.lose;\n      }\n    }\n    \n    console.log('üí∞ Showing results modal', { finalScore, result, rewards });\n    \n    // For Speed Run, track how many questions were actually answered\n    const isSpeedRun = mode?.id === \"speed_run\";\n    const userAnsweredCount = isSpeedRun ? finalAnswers.length : questions.length;\n    const opponentAnsweredCount = isSpeedRun && challenge?.opponentAnswers ? challenge.opponentAnswers.length : questions.length;\n    \n    // For Sudden Death, get chain lengths (recalculate from answers to ensure accuracy)\n    const isSuddenDeath = mode?.id === \"sudden_death\";\n    const userChain = isSuddenDeath ? calculateLongestChain(finalAnswers) : null;\n    const opponentChain = isSuddenDeath \n      ? (challenge?.opponentAnswers ? calculateLongestChain(challenge.opponentAnswers) : null)\n      : null;\n    \n    showModal(MODAL_TYPES.CHALLENGE_RESULTS, {\n      mode,\n      score: finalScore,\n      totalQuestions: questions.length,\n      answeredCount: userAnsweredCount,\n      opponentAnsweredCount: opponentAnsweredCount,\n      result,\n      rewards,\n      xpEarned: rewards.xp,\n      coinsEarned: rewards.coins,\n      opponentName: isBoss ? \"Boss\" : challenge?.opponentId,\n      opponentScore: challenge?.opponentScore,\n      userChain,\n      opponentChain,\n      onApplyRewards: (rewardData) => addRewards(rewardData),\n      onClose: () => navigate(\"/challenge\")\n    });\n  };\n\n  if (questions.length === 0) {\n    return (\n      <div className=\"screen no-extra-space challenge-game-container\">\n        <div className=\"challenge-loading\">Loading questions...</div>\n      </div>\n    );\n  }\n\n  const currentQuestion = questions[currentIndex];\n  const progress = ((currentIndex + 1) / questions.length) * 100;\n\n  return (\n    <div className=\"screen no-extra-space challenge-game-container\">\n      {/* Header */}\n      <div className=\"challenge-game-header\">\n        <div className=\"challenge-game-title\">\n          {mode?.id === \"speed_run\" ? (\n            <img \n              src={mascot_running} \n              alt=\"Speed Run\" \n              style={{ width: \"40px\", height: \"auto\" }}\n            />\n          ) : (\n            <span style={{ fontSize: \"1.5rem\" }}>{mode?.icon}</span>\n          )}\n          <span>{mode?.name}</span>\n        </div>\n        {/* Countdown timer for modes with totalTime (Lightning Round, Boss, Speed Run) */}\n        {mode?.totalTime && (\n          <div \n            className=\"challenge-game-timer\"\n            style={{\n              color: timeLeft <= 10 ? \"#ef4444\" : \"#10b981\"\n            }}\n          >\n            ‚è±Ô∏è {timeLeft}s\n          </div>\n        )}\n        {/* Elapsed timer for Mind Battle only */}\n        {mode?.id === 'mind_battle' && (\n          <div \n            className=\"challenge-game-timer\"\n            style={{\n              color: \"#8b5cf6\"\n            }}\n          >\n            üïê {Math.floor(elapsedTime / 60).toString().padStart(2, '0')}:{(elapsedTime % 60).toString().padStart(2, '0')}\n          </div>\n        )}\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"challenge-progress-container\">\n        <div className=\"challenge-progress-bar\" style={{ width: `${progress}%` }} />\n      </div>\n      <p className=\"challenge-progress-text\">\n        {mode?.id === \"speed_run\" ? `Question ${currentIndex + 1}` : `Question ${currentIndex + 1} of ${questions.length}`}\n      </p>\n\n      {/* Thinking Mascot - Show opponent's avatar for friend challenges, boss mascot for boss */}\n      <div style={{ textAlign: \"center\", marginBottom: \"20px\" }}>\n        <img \n          src={\n            isBoss \n              ? assets.mascots.mascot_pointing_v2 \n              : (challenge?.opponentAvatar ? assets.avatars[challenge.opponentAvatar] : assets.mascots.mascot_pointing_v2)\n          }\n          alt={isBoss ? \"Boss\" : \"Opponent\"}\n          style={{\n            width: \"80px\",\n            height: \"auto\"\n          }}\n        />\n      </div>\n\n      {/* Question Card */}\n      <div className=\"challenge-question-card\">\n        <h2 className=\"challenge-question-text\">{currentQuestion.question}</h2>\n        \n        {/* MCQ Options */}\n        <div className=\"challenge-options\">\n          {currentQuestion.options.map((option, index) => {\n            const isSelected = selectedAnswer === index;\n            const correctAnswerIndex = currentQuestion.answer ?? currentQuestion.correctIndex ?? currentQuestion.correct;\n            const isCorrect = index === correctAnswerIndex;\n            const showResult = selectedAnswer !== null;\n\n            return (\n              <button\n                key={index}\n                className={`challenge-option ${isSelected ? 'selected' : ''} ${\n                  showResult && isSelected && isCorrect ? 'correct' : ''\n                } ${showResult && isSelected && !isCorrect ? 'wrong' : ''}`}\n                onClick={() => handleAnswerSelect(index)}\n                disabled={selectedAnswer !== null}\n                style={{\n                  borderColor: isSelected ? (showResult && isCorrect ? '#10b981' : showResult && !isCorrect ? '#ef4444' : '#d4af37') : 'rgba(255,255,255,0.2)'\n                }}\n              >\n                {option}\n                {showResult && isSelected && isCorrect && <span className=\"option-icon\">‚úì</span>}\n                {showResult && isSelected && !isCorrect && <span className=\"option-icon\">‚úó</span>}\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Chain Length Display (Sudden Death only) */}\n        {mode?.id === \"sudden_death\" && answers.length > 0 && (\n          <div className=\"chain-display\">\n            <span>Chain: {answers.length}</span>\n            <span>üî•</span>\n          </div>\n        )}\n      </div>\n\n      {/* Time Up Overlay */}\n      {isTimeUp && (\n        <div className=\"challenge-time-up-overlay\">\n          <div className=\"time-up-message\">‚è∞ Time's Up!</div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":22388,"size_tokens":null},"src/store/dailyQuestStore.js":{"content":"import { create } from \"zustand\";\nimport { useProgressStore } from \"./progressStore\";\nimport {\n  getQuizForLesson\n} from \"../data/quizEngine\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { logXpEvent } from \"../backend/xpLogs\";\n\nconst STORAGE_KEY = \"islamQuestDailyQuest\";\n\n// Helper: Check if date is today (GMT)\nfunction isToday(dateStr) {\n  if (!dateStr) return false;\n  const today = new Date().toISOString().split(\"T\")[0];\n  return dateStr === today;\n}\n\n// Helper: Get today's date in YYYY-MM-DD (GMT)\nfunction getTodayGMT() {\n  return new Date().toISOString().split(\"T\")[0];\n}\n\n// Helper: Shuffle array (Fisher-Yates)\nfunction shuffle(array) {\n  const arr = [...array];\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr;\n}\n\n// Helper: Generate 8 random MCQs from user's completed lessons\n// Slightly harder: pull from all paths, mix difficulty\nfunction generateDailyQuestions() {\n  const { lessonStates } = useProgressStore.getState();\n  \n  // Get all completed lessons\n  // lessonStates structure: { [pathId]: { [lessonId]: { passed: true } } }\n  const completedLessons = [];\n  Object.keys(lessonStates).forEach(pathId => {\n    const pathState = lessonStates[pathId];\n    // Defensive guard: skip if pathState is undefined/null\n    if (!pathState || typeof pathState !== 'object') return;\n    \n    Object.keys(pathState).forEach(lessonId => {\n      if (pathState[lessonId]?.passed === true) {\n        completedLessons.push({ \n          pathId: parseInt(pathId), \n          lessonId: parseInt(lessonId) \n        });\n      }\n    });\n  });\n\n  if (completedLessons.length === 0) {\n    return [];\n  }\n\n  // Collect ALL questions from completed lessons\n  const allQuestions = [];\n  completedLessons.forEach(({ pathId, lessonId }) => {\n    const quizData = getQuizForLesson(lessonId, pathId);\n    // getQuizForLesson returns array directly, not object with questions property\n    if (quizData && Array.isArray(quizData) && quizData.length > 0) {\n      quizData.forEach(q => {\n        // Normalize different quiz schema formats\n        const text = q.text || q.question || q.prompt;\n        const options = q.options || q.choices;\n        const correctIndex = q.correctIndex !== undefined ? q.correctIndex : \n                           (q.answer !== undefined ? q.answer : q.correctChoice);\n        \n        // Only add if we have valid data\n        if (text && options && Array.isArray(options) && correctIndex !== undefined) {\n          allQuestions.push({\n            ...q,\n            pathId,\n            lessonId,\n            text,\n            options,\n            correctIndex,\n          });\n        }\n      });\n    }\n  });\n\n  if (allQuestions.length === 0) {\n    return [];\n  }\n\n  // Shuffle and pick 8 questions\n  const shuffled = shuffle(allQuestions);\n  const selected = shuffled.slice(0, Math.min(8, shuffled.length));\n\n  // Shuffle options for each question\n  return selected.map((q, index) => {\n    const indexedOptions = q.options.map((opt, i) => ({ opt, i }));\n    const shuffledOptions = shuffle(indexedOptions);\n    const newOptions = shuffledOptions.map(x => x.opt);\n    const newCorrectIndex = shuffledOptions.findIndex(x => x.i === q.correctIndex);\n\n    return {\n      id: `dq_${index + 1}`,\n      text: q.text,\n      options: newOptions,\n      correctIndex: newCorrectIndex,\n    };\n  });\n}\n\nexport const useDailyQuestStore = create((set, get) => ({\n  // Daily Quest state\n  date: null,\n  questions: [],\n  completed: false,\n  rewardGiven: false,\n\n  // Load from LocalStorage\n  loadDailyQuest: () => {\n    try {\n      const saved = localStorage.getItem(STORAGE_KEY);\n      if (saved) {\n        const data = JSON.parse(saved);\n        set({\n          date: data.date || null,\n          questions: Array.isArray(data.questions) ? data.questions : [],\n          completed: Boolean(data.completed),\n          rewardGiven: Boolean(data.rewardGiven),\n        });\n      }\n    } catch (e) {\n      console.warn(\"[DailyQuestStore] loadDailyQuest error:\", e.message);\n      set({ date: null, questions: [], completed: false, rewardGiven: false });\n    }\n  },\n\n  // Save to LocalStorage\n  saveDailyQuest: () => {\n    const data = get();\n    const toSave = {\n      date: data.date,\n      questions: data.questions,\n      completed: data.completed,\n      rewardGiven: data.rewardGiven,\n    };\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(toSave));\n  },\n\n  // Set daily quest from sync (cloud ‚Üí local)\n  setDailyQuestFromSync: (data) => {\n    if (!data) return;\n    \n    let questions = [];\n    try {\n      if (data.questions) {\n        if (typeof data.questions === \"string\") {\n          questions = JSON.parse(data.questions);\n        } else if (Array.isArray(data.questions)) {\n          questions = data.questions;\n        }\n      }\n    } catch (e) {\n      console.warn(\"[DailyQuestStore] Failed to parse questions:\", e.message);\n      questions = [];\n    }\n\n    if (!Array.isArray(questions)) questions = [];\n\n    set({\n      date: data.quest_date || null,\n      questions: questions,\n      completed: Boolean(data.completed),\n      rewardGiven: Boolean(data.reward_given),\n    });\n    get().saveDailyQuest();\n  },\n\n  // Check if Daily Quest is ready for today\n  // If new day, generate fresh questions\n  // Returns true if quest is available\n  // Phase 4: Now syncs new quest to Supabase cloud\n  checkAndGenerateDailyQuest: async () => {\n    const today = getTodayGMT();\n    const state = get();\n    \n    // If already today's quest, no need to regenerate\n    if (isToday(state.date)) {\n      return true;\n    }\n\n    // New day - generate new quest\n    const questions = generateDailyQuestions();\n\n    if (questions.length === 0) {\n      // User hasn't completed any lessons yet\n      return false;\n    }\n\n    set({\n      date: today,\n      questions,\n      completed: false,\n      rewardGiven: false,\n    });\n\n    get().saveDailyQuest();\n\n    // üåê Phase 4: Sync new quest to Supabase cloud\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (auth && auth.user) {\n        await get().saveDailyQuestToCloud(auth.user.id, {\n          date: today,\n          questions,\n          completed: false,\n          rewardGiven: false,\n        });\n      }\n    } catch (err) {\n      console.log(\"‚ùå Cloud sync after quest generation failed:\", err);\n    }\n\n    return true;\n  },\n\n  // Complete Daily Quest and award rewards\n  // Phase 4: Now syncs completion to Supabase cloud\n  completeDailyQuest: async (correctCount) => {\n    const state = get();\n\n    if (state.completed || !isToday(state.date)) {\n      return;\n    }\n\n    // Award rewards\n    const xp = 60;\n    const coins = 20;\n\n    useProgressStore.getState().addXPAndCoins(xp, coins);\n    \n    // Log XP event for daily quest\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n      const userId = data?.user?.id;\n      if (userId) {\n        logXpEvent(userId, xp, \"daily_quest\");\n      }\n    })();\n    \n    // üõ°Ô∏è Mark day as complete for streak tracking\n    useProgressStore.getState().markDayComplete();\n\n    set({\n      completed: true,\n      rewardGiven: true,\n    });\n\n    get().saveDailyQuest();\n\n    // üåê Phase 4: Sync completion to Supabase cloud\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (auth && auth.user) {\n        await get().markDailyQuestCompleted(auth.user.id);\n      }\n    } catch (err) {\n      console.log(\"‚ùå Cloud sync after quest completion failed:\", err);\n    }\n  },\n  \n  // Track daily quest completion for analytics\n  setQuestAnalyticsEvent: () => {\n    // Analytics event will be called from component using useAnalytics\n  },\n\n  // Check if quest is available (user has completed lessons)\n  isQuestAvailable: () => {\n    const { lessonStates } = useProgressStore.getState();\n    // Count all completed lessons across all paths\n    let completedCount = 0;\n    Object.keys(lessonStates).forEach(pathId => {\n      const pathState = lessonStates[pathId];\n      // Defensive guard: skip if pathState is undefined/null\n      if (!pathState || typeof pathState !== 'object') return;\n      \n      Object.keys(pathState).forEach(lessonId => {\n        if (pathState[lessonId]?.passed === true) {\n          completedCount++;\n        }\n      });\n    });\n    return completedCount > 0;\n  },\n\n  // Get quest status\n  getQuestStatus: () => {\n    const state = get();\n    const today = getTodayGMT();\n\n    if (!isToday(state.date)) {\n      return \"new_day\"; // Fresh quest can be generated\n    }\n\n    if (state.completed) {\n      return \"completed\"; // Come back tomorrow\n    }\n\n    if (state.questions.length > 0) {\n      return \"ready\"; // Ready to play\n    }\n\n    return \"unavailable\"; // No completed lessons\n  },\n\n  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n  // üåê PHASE 4: SUPABASE CLOUD SYNC FUNCTIONS\n  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n  // Load daily quest from Supabase cloud\n  loadDailyQuestFromCloud: async (userId) => {\n    if (!userId) {\n      console.log(\"‚ùå loadDailyQuestFromCloud: No userId provided\");\n      return;\n    }\n\n    try {\n      const { data, error } = await supabase\n        .from(\"daily_quests\")\n        .select(\"*\")\n        .eq(\"user_id\", userId)\n        .maybeSingle();\n\n      if (error) {\n        console.log(\"‚ùå loadDailyQuestFromCloud error:\", error.message);\n        return;\n      }\n\n      if (!data) {\n        console.log(\"üì• No cloud quest found - checking local quest\");\n        let state = get();\n        \n        if (!state.date || state.questions.length === 0) {\n          console.log(\"üîÑ No local quest - generating new quest\");\n          const hasQuest = await get().checkAndGenerateDailyQuest();\n          if (!hasQuest) {\n            console.log(\"‚ö†Ô∏è Cannot generate quest - no completed lessons\");\n            return;\n          }\n          state = get();\n        }\n        \n        if (state.date && state.questions.length > 0) {\n          console.log(\"üì§ Uploading quest to cloud...\");\n          await get().saveDailyQuestToCloud(userId, {\n            date: state.date,\n            questions: state.questions,\n            completed: state.completed,\n            rewardGiven: state.rewardGiven,\n          });\n        }\n        return;\n      }\n\n      const today = getTodayGMT();\n      const cloudDate = data.quest_date;\n\n      if (cloudDate !== today) {\n        console.log(\"üîÑ Cloud quest expired - generating new local quest\");\n        const hasQuest = await get().checkAndGenerateDailyQuest();\n        if (hasQuest) {\n          const state = get();\n          await get().saveDailyQuestToCloud(userId, {\n            date: state.date,\n            questions: state.questions,\n            completed: state.completed,\n            rewardGiven: state.rewardGiven,\n          });\n        }\n        return;\n      }\n\n      console.log(\"‚úÖ Restoring daily quest from cloud\");\n      const questions = data.questions ? JSON.parse(data.questions) : [];\n      \n      set({\n        date: data.quest_date,\n        questions: questions,\n        completed: data.completed || false,\n        rewardGiven: data.reward_given || false,\n      });\n\n      get().saveDailyQuest();\n\n    } catch (err) {\n      console.log(\"‚ùå loadDailyQuestFromCloud failed:\", err);\n    }\n  },\n\n  // Save daily quest to Supabase cloud\n  saveDailyQuestToCloud: async (userId, questData) => {\n    if (!userId) {\n      console.log(\"‚ùå saveDailyQuestToCloud: No userId provided\");\n      return;\n    }\n\n    try {\n      const payload = {\n        user_id: userId,\n        quest_date: questData.date,\n        questions: JSON.stringify(questData.questions),\n        completed: questData.completed || false,\n        reward_given: questData.rewardGiven || false,\n        updated_at: new Date().toISOString(),\n      };\n\n      // Upsert (insert or update if exists)\n      const { error } = await supabase\n        .from(\"daily_quests\")\n        .upsert(payload, { onConflict: \"user_id\" });\n\n      if (error) {\n        console.log(\"‚ùå saveDailyQuestToCloud error:\", error.message);\n        return;\n      }\n\n      console.log(\"‚úÖ Daily quest saved to cloud\");\n\n    } catch (err) {\n      console.log(\"‚ùå saveDailyQuestToCloud failed:\", err);\n    }\n  },\n\n  // Mark daily quest as completed in cloud\n  markDailyQuestCompleted: async (userId) => {\n    if (!userId) {\n      console.log(\"‚ùå markDailyQuestCompleted: No userId provided\");\n      return;\n    }\n\n    try {\n      const state = get();\n      \n      const { error } = await supabase\n        .from(\"daily_quests\")\n        .update({\n          completed: true,\n          reward_given: true,\n          updated_at: new Date().toISOString(),\n        })\n        .eq(\"user_id\", userId);\n\n      if (error) {\n        console.log(\"‚ùå markDailyQuestCompleted error:\", error.message);\n        return;\n      }\n\n      console.log(\"‚úÖ Daily quest completion synced to cloud\");\n\n    } catch (err) {\n      console.log(\"‚ùå markDailyQuestCompleted failed:\", err);\n    }\n  },\n\n  // Create or update daily quest in cloud (wrapper for flexibility)\n  createOrUpdateDailyQuest: async (userId, quest) => {\n    if (!userId) {\n      console.log(\"‚ùå createOrUpdateDailyQuest: No userId provided\");\n      return;\n    }\n\n    await get().saveDailyQuestToCloud(userId, quest);\n  },\n\n  // Sync current local state to cloud (convenience wrapper)\n  syncToSupabase: async () => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth || !auth.user) return;\n\n      const state = get();\n      if (state.date && state.questions.length > 0) {\n        await get().saveDailyQuestToCloud(auth.user.id, {\n          date: state.date,\n          questions: state.questions,\n          completed: state.completed,\n          rewardGiven: state.rewardGiven,\n        });\n      }\n    } catch (err) {\n      console.log(\"‚ùå syncToSupabase failed:\", err);\n    }\n  },\n\n  // Load from cloud (convenience wrapper)\n  loadFromSupabase: async () => {\n    try {\n      const { data: auth } = await supabase.auth.getUser();\n      if (!auth || !auth.user) return;\n\n      await get().loadDailyQuestFromCloud(auth.user.id);\n    } catch (err) {\n      console.log(\"‚ùå loadFromSupabase failed:\", err);\n    }\n  },\n}));\n","path":null,"size_bytes":14620,"size_tokens":null},"src/components/dailyquest/DailyQuestCard.jsx":{"content":"import { useState } from \"react\";\nimport { useNavigate } from \"../../hooks/useNavigate\";\nimport { useDailyQuestStore } from \"../../store/dailyQuestStore\";\nimport DailyQuestExplainerModal from \"./DailyQuestExplainerModal\";\nimport DailyQuestCountdown from \"./DailyQuestCountdown\";\nimport DailyQuestMascot from \"../../assets/avatars/avatar_man_lantern.webp\";\n\nexport default function DailyQuestCard() {\n  const navigate = useNavigate();\n  const [showExplainer, setShowExplainer] = useState(false);\n  const [showCountdown, setShowCountdown] = useState(false);\n  const { checkAndGenerateDailyQuest, getQuestStatus, isQuestAvailable } = useDailyQuestStore();\n\n  const questStatus = getQuestStatus();\n  const available = isQuestAvailable();\n\n  const handleQuestClick = () => {\n    if (questStatus === \"completed\") {\n      return;\n    }\n\n    // Only generate new quest if it's a new day, otherwise use existing\n    if (questStatus === \"new_day\") {\n      checkAndGenerateDailyQuest();\n    }\n\n    if (questStatus === \"ready\" || questStatus === \"new_day\") {\n      setShowExplainer(true);\n    }\n  };\n\n  const handleStartQuest = () => {\n    setShowExplainer(false);\n    setShowCountdown(true);\n  };\n\n  const handleCountdownComplete = () => {\n    navigate(\"/daily-quest\");\n  };\n\n  let buttonText = \"Let's Go!\";\n  let buttonDisabled = false;\n  let cardMessage = \"Earn XP with today's mini challenge!\";\n\n  if (!available) {\n    buttonText = \"Complete Lessons First\";\n    buttonDisabled = true;\n    cardMessage = \"Complete your first lesson to unlock!\";\n  } else if (questStatus === \"completed\") {\n    buttonText = \"Come Back Tomorrow!\";\n    buttonDisabled = true;\n    cardMessage = \"You've completed today's quest!\";\n  }\n\n  return (\n    <>\n      <div\n        style={{\n          background:\n            \"linear-gradient(135deg, rgba(0,255,209,0.3), rgba(255,215,0,0.3))\",\n          borderRadius: 18,\n          padding: 16,\n          margin: \"6px 0 18px\",\n          display: \"grid\",\n          gridTemplateColumns: \"1fr auto\",\n          alignItems: \"center\",\n          opacity: buttonDisabled ? 0.7 : 1,\n        }}\n      >\n        <div>\n          <h3 style={{ color: \"gold\", margin: \"0 0 6px\" }}>Daily Quest</h3>\n          <p style={{ margin: 0, color: \"#e6f7ff\" }}>\n            {cardMessage}\n          </p>\n\n          <button\n            onClick={handleQuestClick}\n            disabled={buttonDisabled}\n            style={{\n              marginTop: 10,\n              background: buttonDisabled ? \"#6b7280\" : \"gold\",\n              border: \"none\",\n              padding: \"10px 18px\",\n              borderRadius: 10,\n              fontWeight: \"bold\",\n              cursor: buttonDisabled ? \"not-allowed\" : \"pointer\",\n              transition: \"all 0.2s\",\n            }}\n            onMouseEnter={(e) => {\n              if (!buttonDisabled) {\n                e.currentTarget.style.background = \"#ffdd33\";\n              }\n            }}\n            onMouseLeave={(e) => {\n              if (!buttonDisabled) {\n                e.currentTarget.style.background = \"gold\";\n              }\n            }}\n          >\n            {buttonText}\n          </button>\n        </div>\n\n        <img\n          src={DailyQuestMascot}\n          alt=\"Daily Quest Mascot\"\n          style={{\n            width: 90,\n            height: \"auto\",\n            marginLeft: 10,\n          }}\n        />\n      </div>\n\n      {showExplainer && (\n        <DailyQuestExplainerModal\n          onStart={handleStartQuest}\n          onCancel={() => setShowExplainer(false)}\n        />\n      )}\n      {showCountdown && (\n        <DailyQuestCountdown onComplete={handleCountdownComplete} />\n      )}\n    </>\n  );\n}\n","path":null,"size_bytes":3653,"size_tokens":null},"src/components/dailyquest/DailyQuestCountdown.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport mascotCountdown from \"../../assets/mascots/mascot_countdown.webp\";\nimport \"../challenges/ChallengeModals.css\";\n\nexport default function DailyQuestCountdown({ onComplete }) {\n  const [count, setCount] = useState(3);\n  const [fadeOut, setFadeOut] = useState(false);\n\n  useEffect(() => {\n    document.body.style.overflow = \"hidden\";\n    return () => {\n      document.body.style.overflow = \"\";\n    };\n  }, []);\n\n  useEffect(() => {\n    if (count > 0) {\n      const timer = setTimeout(() => setCount(count - 1), 1000);\n      return () => clearTimeout(timer);\n    } else {\n      const fadeTimer = setTimeout(() => setFadeOut(true), 300);\n      const completeTimer = setTimeout(onComplete, 500);\n      return () => {\n        clearTimeout(fadeTimer);\n        clearTimeout(completeTimer);\n      };\n    }\n  }, [count, onComplete]);\n\n  return (\n    <div \n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: \"rgba(0, 0, 0, 0.95)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"flex-start\",\n        paddingTop: \"15vh\",\n        zIndex: 10000,\n        opacity: fadeOut ? 0 : 1,\n        transition: \"opacity 0.2s ease-out\",\n        touchAction: \"none\",\n        overscrollBehavior: \"none\",\n      }}\n    >\n      <div \n        style={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          gap: \"20px\",\n        }}\n      >\n        <div \n          style={{\n            width: \"160px\",\n            height: \"160px\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            background: \"radial-gradient(circle, rgba(212, 175, 55, 0.15) 0%, transparent 70%)\",\n            borderRadius: \"50%\",\n          }}\n        >\n          <img \n            src={mascotCountdown}\n            alt=\"Countdown\" \n            style={{\n              width: \"120px\",\n              height: \"auto\",\n              filter: \"drop-shadow(0 10px 25px rgba(212, 175, 55, 0.5))\",\n            }}\n          />\n        </div>\n        <div \n          style={{\n            fontSize: \"8rem\",\n            fontWeight: 900,\n            color: \"#d4af37\",\n            textShadow: \"0 0 50px rgba(212, 175, 55, 0.9)\",\n            lineHeight: 1,\n          }}\n        >\n          {count > 0 ? count : \"GO!\"}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2525,"size_tokens":null},"src/components/dailyquest/DailyQuestExplainerModal.jsx":{"content":"import avatarManLantern from \"../../assets/avatars/avatar_man_lantern.webp\";\n\nexport default function DailyQuestExplainerModal({ onStart, onCancel }) {\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        inset: 0,\n        background: \"rgba(0, 0, 0, 0.85)\",\n        zIndex: 9998,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n      }}\n      onClick={onCancel}\n    >\n      <style>\n        {`\n          @keyframes gentleFloat {\n            0%, 100% { transform: translateY(0); }\n            50% { transform: translateY(-8px); }\n          }\n        `}\n      </style>\n      <div\n        className=\"quest-modal\"\n        style={{\n          zIndex: 9999,\n          background: \"linear-gradient(145deg, #0B1E2D 0%, #1a3a52 100%)\",\n          borderRadius: \"16px\",\n          padding: \"24px 20px\",\n          maxWidth: \"340px\",\n          width: \"calc(100% - 40px)\",\n          boxShadow: \"0 10px 40px rgba(212, 175, 55, 0.3)\",\n          border: \"2px solid #D4AF37\",\n          textAlign: \"center\",\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <img\n          src={avatarManLantern}\n          alt=\"Daily Quest\"\n          style={{\n            width: \"80px\",\n            height: \"auto\",\n            margin: \"0 auto 12px\",\n            display: \"block\",\n            animation: \"gentleFloat 2.5s ease-in-out infinite\",\n          }}\n        />\n\n        <h2\n          style={{\n            fontSize: \"1.5rem\",\n            fontWeight: 700,\n            color: \"#D4AF37\",\n            marginBottom: \"8px\",\n          }}\n        >\n          Daily Quest üåô\n        </h2>\n\n        <p\n          style={{\n            fontSize: \"0.9rem\",\n            lineHeight: 1.5,\n            color: \"#cbd5e1\",\n            marginBottom: \"16px\",\n          }}\n        >\n          Test your knowledge with 8 questions from all the lessons you've completed!\n        </p>\n\n        <div\n          style={{\n            background: \"rgba(212, 175, 55, 0.08)\",\n            borderRadius: \"10px\",\n            padding: \"12px\",\n            marginBottom: \"16px\",\n            border: \"1px solid rgba(212, 175, 55, 0.2)\",\n            textAlign: \"left\",\n          }}\n        >\n          <p style={{ fontSize: \"0.85rem\", color: \"#D4AF37\", marginBottom: \"6px\" }}>\n            ‚≠ê No timer - take your time\n          </p>\n          <p style={{ fontSize: \"0.85rem\", color: \"#10B981\", marginBottom: \"6px\" }}>\n            ü™ô Rewards: <strong>+60 XP</strong> and <strong>+20 coins</strong>\n          </p>\n          <p style={{ fontSize: \"0.85rem\", color: \"#94a3b8\", margin: 0 }}>\n            üìÖ One quest per day\n          </p>\n        </div>\n\n        <div style={{ display: \"flex\", gap: \"10px\" }}>\n          <button\n            onClick={onCancel}\n            style={{\n              flex: 1,\n              padding: \"10px 16px\",\n              fontSize: \"0.9rem\",\n              fontWeight: 600,\n              borderRadius: \"10px\",\n              border: \"1px solid #4b5563\",\n              background: \"rgba(75, 85, 99, 0.2)\",\n              color: \"#9ca3af\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n            }}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={onStart}\n            style={{\n              flex: 1,\n              padding: \"10px 16px\",\n              fontSize: \"0.9rem\",\n              fontWeight: 600,\n              borderRadius: \"10px\",\n              border: \"none\",\n              background: \"linear-gradient(135deg, #D4AF37, #b8941f)\",\n              color: \"#0B1E2D\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n              boxShadow: \"0 3px 10px rgba(212, 175, 55, 0.3)\",\n            }}\n          >\n            Let's Go! üöÄ\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3828,"size_tokens":null},"src/pages/DailyQuestGame.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useDailyQuestStore } from \"../store/dailyQuestStore\";\nimport { useAnalytics } from \"../hooks/useAnalytics\";\nimport { useVibration } from \"../hooks/useVibration\";\nimport QuestionCard from \"../components/quiz/QuestionCard\";\nimport PointingMascot from \"../assets/mascots/mascot_pointing_v2.webp\";\nimport SittingMascot from \"../assets/mascots/mascot_sitting_v2.webp\";\nimport CongratsMascot from \"../assets/mascots/mascot_congratulation.webp\";\n\nexport default function DailyQuestGame() {\n  const navigate = useNavigate();\n  const { questions, completeDailyQuest, getQuestStatus } = useDailyQuestStore();\n  const analytics = useAnalytics();\n  const { vibrate } = useVibration();\n\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [selected, setSelected] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [showResults, setShowResults] = useState(false);\n\n  // Guard: Prevent entry if quest isn't ready or questions not loaded\n  useEffect(() => {\n    const status = getQuestStatus();\n    if (status !== \"ready\" || questions.length === 0) {\n      navigate(\"/\");\n    }\n  }, [navigate, getQuestStatus, questions.length]);\n\n  // Additional guard for direct navigation attempts\n  if (questions.length === 0) {\n    return null;\n  }\n\n  const currentQuestion = questions[currentIndex];\n  const totalQuestions = questions.length;\n\n  const handleSelect = (optionIndex) => {\n    setSelected(optionIndex);\n  };\n\n  const handleNext = () => {\n    const isCorrect = selected === currentQuestion.correctIndex;\n    const newAnswers = [...answers, { questionIndex: currentIndex, correct: isCorrect }];\n    setAnswers(newAnswers);\n\n    // Haptic feedback based on answer correctness\n    if (isCorrect) {\n      vibrate([100, 50, 100, 50, 100]); // Success pattern\n    } else {\n      vibrate([200, 100, 200]); // Failure pattern\n    }\n\n    if (currentIndex < totalQuestions - 1) {\n      setCurrentIndex(currentIndex + 1);\n      setSelected(null);\n    } else {\n      const correctCount = newAnswers.filter(a => a.correct).length;\n      completeDailyQuest(correctCount);\n      \n      // Track daily quest completion for analytics\n      analytics('daily_quiz_completed', {\n        score: correctCount,\n        total: totalQuestions,\n        xpEarned: 60,\n        coinsEarned: 20\n      });\n      \n      setShowResults(true);\n    }\n  };\n\n  if (showResults) {\n    const correctCount = answers.filter(a => a.correct).length;\n    // Use dynamic 60% threshold based on actual question count\n    const passThreshold = Math.ceil(totalQuestions * 0.6);\n    const passed = correctCount >= passThreshold;\n\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n          color: \"#ffffff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          paddingLeft: \"20px\",\n          paddingRight: \"20px\",\n          paddingTop: \"20px\",\n        }}\n      >\n        <div\n          style={{\n            background: \"rgba(255, 255, 255, 0.05)\",\n            borderRadius: \"20px\",\n            padding: \"40px\",\n            maxWidth: \"500px\",\n            width: \"100%\",\n            textAlign: \"center\",\n            border: \"2px solid #D4AF37\",\n            boxShadow: \"0 10px 40px rgba(212, 175, 55, 0.3)\",\n          }}\n        >\n          {/* Title */}\n          <h1\n            style={{\n              fontSize: \"2rem\",\n              fontWeight: 700,\n              color: passed ? \"#10B981\" : \"#D4AF37\",\n              marginBottom: \"20px\",\n            }}\n          >\n            {passed ? \"MASHAA ALLAH! üéâ\" : \"Try Again! üí™\"}\n          </h1>\n\n          {/* Score */}\n          <div\n            style={{\n              fontSize: \"3rem\",\n              fontWeight: 900,\n              color: \"#D4AF37\",\n              marginBottom: \"30px\",\n            }}\n          >\n            {correctCount}/{totalQuestions}\n          </div>\n\n          {/* Rewards */}\n          <div\n            style={{\n              background: \"rgba(212, 175, 55, 0.1)\",\n              borderRadius: \"16px\",\n              padding: \"20px\",\n              marginBottom: \"30px\",\n              border: \"1px solid rgba(212, 175, 55, 0.3)\",\n            }}\n          >\n            <p\n              style={{\n                fontSize: \"1.2rem\",\n                fontWeight: 600,\n                color: \"#D4AF37\",\n                marginBottom: \"12px\",\n              }}\n            >\n              Daily Quest Rewards\n            </p>\n            <div style={{ display: \"flex\", justifyContent: \"center\", gap: \"20px\" }}>\n              <div>\n                <div style={{ fontSize: \"1.5rem\", fontWeight: 700, color: \"#10B981\" }}>\n                  +60 XP\n                </div>\n              </div>\n              <div>\n                <div style={{ fontSize: \"1.5rem\", fontWeight: 700, color: \"#D4AF37\" }}>\n                  +20 Coins\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Mascot */}\n          <img \n            src={passed ? CongratsMascot : SittingMascot} \n            alt=\"Mascot\"\n            style={{\n              width: \"100px\",\n              height: \"auto\",\n              margin: \"0 auto 20px\",\n              animation: \"bounce 1.5s infinite\"\n            }}\n          />\n\n          {/* Come back tomorrow message */}\n          <p\n            style={{\n              fontSize: \"1.1rem\",\n              color: \"#f3f4f6\",\n              marginBottom: \"30px\",\n            }}\n          >\n            Come back tomorrow for a new Daily Quest! üåô\n          </p>\n          \n          <style>{`\n            @keyframes bounce {\n              0%, 100% { transform: translateY(0); }\n              50% { transform: translateY(-10px); }\n            }\n          `}</style>\n\n          {/* Continue button */}\n          <button\n            onClick={() => navigate(\"/\")}\n            style={{\n              padding: \"14px 40px\",\n              fontSize: \"1.1rem\",\n              fontWeight: 600,\n              borderRadius: \"12px\",\n              border: \"2px solid #D4AF37\",\n              background: \"linear-gradient(145deg, #D4AF37, #b8941f)\",\n              color: \"#0B1E2D\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n              boxShadow: \"0 4px 12px rgba(212, 175, 55, 0.4)\",\n            }}\n            onMouseEnter={(e) => {\n              e.target.style.transform = \"scale(1.05)\";\n              e.target.style.boxShadow = \"0 6px 16px rgba(212, 175, 55, 0.6)\";\n            }}\n            onMouseLeave={(e) => {\n              e.target.style.transform = \"scale(1)\";\n              e.target.style.boxShadow = \"0 4px 12px rgba(212, 175, 55, 0.4)\";\n            }}\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n        color: \"#ffffff\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n        paddingTop: \"20px\",\n      }}\n    >\n      {/* Header */}\n      <div\n        style={{\n          maxWidth: \"600px\",\n          margin: \"0 auto 30px\",\n          textAlign: \"center\",\n        }}\n      >\n        <h1\n          style={{\n            fontSize: \"1.8rem\",\n            fontWeight: 700,\n            color: \"#D4AF37\",\n            marginBottom: \"8px\",\n          }}\n        >\n          Daily Quest üåô\n        </h1>\n        <div\n          style={{\n            fontSize: \"0.95rem\",\n            color: \"#f3f4f6\",\n            marginBottom: \"20px\",\n          }}\n        >\n          Question {currentIndex + 1} of {totalQuestions}\n        </div>\n\n        {/* Progress bar */}\n        <div\n          style={{\n            width: \"100%\",\n            height: \"8px\",\n            background: \"rgba(255, 255, 255, 0.1)\",\n            borderRadius: \"4px\",\n            overflow: \"hidden\",\n          }}\n        >\n          <div\n            style={{\n              width: `${((currentIndex + 1) / totalQuestions) * 100}%`,\n              height: \"100%\",\n              background: \"linear-gradient(90deg, #D4AF37, #10B981)\",\n              transition: \"width 0.3s ease\",\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Mascot - Always show pointing_v2 during quiz */}\n      <div style={{ textAlign: \"center\", marginBottom: \"20px\" }}>\n        <img \n          src={PointingMascot} \n          alt=\"Mascot\"\n          style={{\n            width: \"80px\",\n            height: \"auto\"\n          }}\n        />\n      </div>\n\n      {/* Question Card */}\n      <QuestionCard\n        question={currentQuestion}\n        currentQ={currentIndex}\n        totalQ={totalQuestions}\n        selected={selected}\n        onSelect={handleSelect}\n      />\n\n      {/* Next Button */}\n      {selected !== null && (\n        <div\n          style={{\n            maxWidth: \"600px\",\n            margin: \"30px auto 0\",\n            textAlign: \"center\",\n          }}\n        >\n          <button\n            onClick={handleNext}\n            style={{\n              padding: \"14px 40px\",\n              fontSize: \"1.1rem\",\n              fontWeight: 600,\n              borderRadius: \"12px\",\n              border: \"2px solid #D4AF37\",\n              background: \"linear-gradient(145deg, #D4AF37, #b8941f)\",\n              color: \"#0B1E2D\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n              boxShadow: \"0 4px 12px rgba(212, 175, 55, 0.4)\",\n            }}\n            onMouseEnter={(e) => {\n              e.target.style.transform = \"scale(1.05)\";\n              e.target.style.boxShadow = \"0 6px 16px rgba(212, 175, 55, 0.6)\";\n            }}\n            onMouseLeave={(e) => {\n              e.target.style.transform = \"scale(1)\";\n              e.target.style.boxShadow = \"0 4px 12px rgba(212, 175, 55, 0.4)\";\n            }}\n          >\n            {currentIndex < totalQuestions - 1 ? \"Next Question ‚Üí\" : \"See Results üéâ\"}\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":10133,"size_tokens":null},"src/store/reviseStore.js":{"content":"import { create } from \"zustand\";\n\nconst STORAGE_KEY = \"islamQuestRevise\";\n\nconst useReviseStore = create((set, get) => ({\n  weakPool: [],\n  needsSync: false,\n\n  loadReviseData: () => {\n    try {\n      const saved = localStorage.getItem(STORAGE_KEY);\n      if (saved) {\n        const data = JSON.parse(saved);\n        set({ weakPool: Array.isArray(data.weakPool) ? data.weakPool : [] });\n      }\n    } catch (e) {\n      console.warn(\"[ReviseStore] loadReviseData error:\", e.message);\n      set({ weakPool: [] });\n    }\n  },\n\n  saveReviseData: () => {\n    const { weakPool } = get();\n    localStorage.setItem(STORAGE_KEY, JSON.stringify({ weakPool }));\n  },\n\n  getWeakPool: () => {\n    const pool = get().weakPool;\n    return Array.isArray(pool) ? pool : [];\n  },\n\n  setWeakPool: (arr) => {\n    const safeArr = Array.isArray(arr) ? arr : [];\n    set({ weakPool: safeArr, needsSync: false });\n    get().saveReviseData();\n  },\n\n  saveWrongQuestion: (cardId, lessonId, unlockCallback) => {\n    const pool = [...get().weakPool];\n    const existing = pool.find(\n      (i) => i.cardId === cardId && i.lessonId === lessonId\n    );\n\n    const now = Date.now();\n\n    if (!existing) {\n      pool.push({\n        cardId,\n        lessonId,\n        timesCorrect: 0,\n        timesWrong: 1,\n        reviewedOnce: false,\n        firstWrongAt: now,\n        lastReviewedAt: null,\n        nextReviewAt: now,\n        updatedAt: now,\n      });\n    } else {\n      existing.timesWrong += 1;\n      existing.updatedAt = now;\n    }\n\n    set({ weakPool: pool, needsSync: true });\n    get().saveReviseData();\n    \n    if (unlockCallback) {\n      unlockCallback();\n    }\n  },\n\n  markQuestionReviewed: (cardId, lessonId, wasCorrect) => {\n    const pool = [...get().weakPool];\n    const item = pool.find(\n      (i) => i.cardId === cardId && i.lessonId === lessonId\n    );\n    if (item) {\n      item.reviewedOnce = true;\n      item.lastReviewedAt = Date.now();\n      item.updatedAt = Date.now();\n      if (wasCorrect) {\n        item.timesCorrect += 1;\n      } else {\n        item.timesWrong += 1;\n      }\n    }\n    set({ weakPool: pool, needsSync: true });\n    get().saveReviseData();\n  },\n\n  clearCorrectQuestion: (cardId, lessonId) => {\n    const pool = [...get().weakPool];\n    const item = pool.find(\n      (i) => i.cardId === cardId && i.lessonId === lessonId\n    );\n    if (item) {\n      item.timesCorrect += 1;\n      item.reviewedOnce = true;\n      item.lastReviewedAt = Date.now();\n      item.updatedAt = Date.now();\n    }\n    set({ weakPool: pool, needsSync: true });\n    get().saveReviseData();\n  },\n}));\n\nexport default useReviseStore;\nexport { useReviseStore };\n","path":null,"size_bytes":2640,"size_tokens":null},"src/components/RepairStreakModal.jsx":{"content":"import React from \"react\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport assets from \"../assets/assets\";\nimport \"./events/EventModals.css\";\n\nexport default function RepairStreakModal({ onClose }) {\n  const { coins, brokenStreakValue, repairStreak, skipRepair } = useProgressStore();\n  const REPAIR_COST = 200;\n\n  const handleRepair = async () => {\n    const result = await repairStreak();\n\n    if (result.success) {\n      onClose?.();\n    } else if (result.reason === \"insufficient_coins\") {\n      alert(\"Not enough coins! You need 200 coins to repair your streak.\");\n    }\n  };\n\n  const handleSkip = () => {\n    skipRepair();\n    onClose?.();\n  };\n\n  return (\n    <div className=\"event-modal-overlay\" onClick={(e) => e.stopPropagation()}>\n      <div className=\"event-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"modal-mascot-header\">\n          <img\n            src={assets.mascots.mascot_sitting_v2}\n            alt=\"Mascot\"\n            className=\"modal-zayd\"\n            style={{ animation: \"float 3s ease-in-out infinite\" }}\n          />\n        </div>\n\n        <h2 className=\"modal-title\" style={{ \n          background: \"linear-gradient(90deg, #ef4444 0%, #f97316 100%)\",\n          WebkitBackgroundClip: \"text\",\n          WebkitTextFillColor: \"transparent\"\n        }}>\n          Your Streak Broke! üíî\n        </h2>\n        \n        <div style={{\n          background: \"rgba(239, 68, 68, 0.15)\",\n          borderRadius: \"12px\",\n          padding: \"12px 16px\",\n          marginBottom: \"14px\",\n          border: \"2px solid rgba(239, 68, 68, 0.4)\",\n          textAlign: \"center\"\n        }}>\n          <div style={{ fontSize: \"1.4rem\", fontWeight: \"700\", color: \"#ef4444\" }}>\n            {brokenStreakValue} day streak\n          </div>\n          <div style={{ fontSize: \"0.85rem\", color: \"#94a3b8\", marginTop: \"4px\" }}>\n            Lost due to missed day\n          </div>\n        </div>\n\n        <p style={{ \n          color: \"#e2e8f0\", \n          fontSize: \"0.9rem\", \n          textAlign: \"center\",\n          marginBottom: \"14px\",\n          lineHeight: 1.5\n        }}>\n          Don't worry! You can repair your streak and get it back to where it was.\n        </p>\n\n        <div style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          gap: \"10px\",\n          padding: \"14px\",\n          background: \"rgba(212, 175, 55, 0.15)\",\n          border: \"1px solid rgba(212, 175, 55, 0.3)\",\n          borderRadius: \"12px\",\n          fontSize: \"1.2rem\",\n          fontWeight: \"700\"\n        }}>\n          <span>üí∞</span>\n          <span style={{ color: \"#d4af37\" }}>200 coins</span>\n        </div>\n\n        <div style={{\n          marginTop: \"10px\",\n          fontSize: \"0.85rem\",\n          color: \"#94a3b8\",\n          textAlign: \"center\"\n        }}>\n          Your balance: {coins} coins\n        </div>\n\n        <div className=\"modal-note\" style={{ marginTop: \"16px\" }}>\n          <p>üõ°Ô∏è Includes 1 free Streak Freeze Shield!</p>\n        </div>\n\n        <div className=\"modal-actions\">\n          <button \n            className=\"modal-btn-secondary\" \n            onClick={handleSkip}\n          >\n            Skip\n          </button>\n          <button \n            className=\"modal-btn-primary\" \n            onClick={handleRepair}\n            disabled={coins < REPAIR_COST}\n            style={{ \n              background: coins >= REPAIR_COST \n                ? \"linear-gradient(135deg, #10b981 0%, #d4af37 100%)\"\n                : \"rgba(100, 100, 100, 0.5)\",\n              opacity: coins < REPAIR_COST ? 0.6 : 1,\n              cursor: coins < REPAIR_COST ? \"not-allowed\" : \"pointer\"\n            }}\n          >\n            {coins >= REPAIR_COST ? `Repair for ${REPAIR_COST} ü™ô` : \"Not Enough Coins\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3865,"size_tokens":null},"src/components/PurchaseStreakFreezeModal.jsx":{"content":"import React from \"react\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport ModalBase from \"./ModalBase\";\nimport assets from \"../assets/assets\";\nimport \"./PurchaseStreakFreezeModal.css\";\n\nexport default function PurchaseStreakFreezeModal({ onClose, onSuccess }) {\n  const { coins, shieldCount, purchaseShield } = useProgressStore();\n  const SHIELD_COST = 250;\n  const MAX_SHIELDS = 3;\n\n  const handlePurchase = () => {\n    const result = purchaseShield();\n\n    if (result.success) {\n      onSuccess?.();\n    } else if (result.reason === \"max\") {\n      alert(\"You already have the maximum streak protection equipped.\");\n    } else if (result.reason === \"insufficient_coins\") {\n      alert(\"Not enough coins! You need 250 coins to buy a Streak Freeze.\");\n    }\n  };\n\n  return (\n    <ModalBase \n      title=\"Buy Streak Freeze\" \n      onClose={onClose}\n      showMascot={assets.mascots.mascot_streak_freeze}\n      mascotAnimation=\"float\"\n    >\n      <div className=\"streak-freeze-content\">\n        {/* Shield Info Card */}\n        <div className=\"info-card\">\n          <div className=\"shield-info\">\n            <span className=\"shield-emoji\">üõ°Ô∏è</span>\n            <div className=\"shield-text\">\n              <div className=\"shield-title\">Streak Freeze Shield</div>\n              <div className=\"shield-count\">{shieldCount} / {MAX_SHIELDS} equipped</div>\n            </div>\n          </div>\n        </div>\n\n        {/* Description */}\n        <p className=\"description\">\n          Protect your streak for up to <strong>3 days</strong> if you miss a day!\n        </p>\n        <p className=\"description\">\n          A shield automatically activates when you miss a day, preserving your streak without breaking it.\n        </p>\n\n        {/* Cost Display */}\n        <div className=\"cost-display\">\n          <span>üí∞</span>\n          <span className=\"cost-amount\">250 coins</span>\n        </div>\n\n        {/* Balance */}\n        <div className=\"balance-text\">\n          Your balance: {coins} coins\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"modal-actions\">\n          <button \n            className=\"btn-secondary\" \n            onClick={onClose}\n          >\n            Cancel\n          </button>\n          <button \n            className=\"btn-primary\" \n            onClick={handlePurchase}\n            disabled={shieldCount >= MAX_SHIELDS || coins < SHIELD_COST}\n          >\n            {shieldCount >= MAX_SHIELDS ? \"Max Shields\" : `Buy for ${SHIELD_COST} ü™ô`}\n          </button>\n        </div>\n      </div>\n    </ModalBase>\n  );\n}\n","path":null,"size_bytes":2577,"size_tokens":null},"src/pages/LockDiagnostics.jsx":{"content":"import React from \"react\";\nimport { useProgressStore } from \"../store/progressStore\";\n\nexport default function LockDiagnostics() {\n  const { hasPremium, lockedLessons, lessonStates } = useProgressStore();\n  \n  return (\n    <div className=\"screen no-extra-space\" style={{ paddingLeft: \"20px\", paddingRight: \"20px\", paddingTop: \"20px\", background: \"#0B1E2D\", color: \"white\" }}>\n      <h1>üîí Lock Diagnostics</h1>\n      \n      <div style={{ background: \"#1a2337\", padding: \"20px\", borderRadius: \"8px\", marginBottom: \"20px\" }}>\n        <h2>Premium Status</h2>\n        <p><strong>hasPremium:</strong> {hasPremium ? \"‚úÖ TRUE (ALL LESSONS UNLOCKED)\" : \"‚ùå FALSE\"}</p>\n      </div>\n      \n      <div style={{ background: \"#1a2337\", padding: \"20px\", borderRadius: \"8px\", marginBottom: \"20px\" }}>\n        <h2>Locked Lessons Structure</h2>\n        <pre style={{ background: \"#0a1520\", padding: \"10px\", borderRadius: \"4px\", overflow: \"auto\" }}>\n          {JSON.stringify(lockedLessons, null, 2)}\n        </pre>\n      </div>\n      \n      <div style={{ background: \"#1a2337\", padding: \"20px\", borderRadius: \"8px\", marginBottom: \"20px\" }}>\n        <h2>Lesson States (Completed Lessons)</h2>\n        <pre style={{ background: \"#0a1520\", padding: \"10px\", borderRadius: \"4px\", overflow: \"auto\", maxHeight: \"400px\" }}>\n          {JSON.stringify(lessonStates, null, 2)}\n        </pre>\n      </div>\n      \n      <div style={{ background: \"#1a2337\", padding: \"20px\", borderRadius: \"8px\" }}>\n        <h2>Path-by-Path Lock Status</h2>\n        {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].map(pathId => {\n          const pathLocks = lockedLessons[pathId] || {};\n          const unlockedLessons = Object.keys(pathLocks).filter(\n            lessonId => pathLocks[lessonId]?.unlocked\n          );\n          \n          return (\n            <div key={pathId} style={{ marginBottom: \"10px\", padding: \"10px\", background: \"#0a1520\", borderRadius: \"4px\" }}>\n              <strong>Path {pathId}:</strong> {unlockedLessons.length} lessons unlocked\n              <br />\n              <span style={{ fontSize: \"0.9em\", color: \"#D4AF37\" }}>\n                Unlocked lessons: {unlockedLessons.length > 0 ? unlockedLessons.join(\", \") : \"None\"}\n              </span>\n            </div>\n          );\n        })}\n      </div>\n      \n      <div style={{ marginTop: \"20px\" }}>\n        <button\n          onClick={() => {\n            localStorage.clear();\n            window.location.reload();\n          }}\n          style={{\n            padding: \"12px 24px\",\n            background: \"#D4AF37\",\n            color: \"#0B1E2D\",\n            border: \"none\",\n            borderRadius: \"8px\",\n            fontSize: \"1rem\",\n            fontWeight: \"bold\",\n            cursor: \"pointer\"\n          }}\n        >\n          Clear All Data & Reload\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2844,"size_tokens":null},"src/store/premiumConfig.js":{"content":"// Premium lesson limits configuration\n// Defines how many lessons are free per learning path\n// Supabase-ready: This config will eventually be synced from backend\n\nexport const FREE_LESSON_LIMITS = {\n  1: 3,   // Names of Allah\n  2: 3,   // Foundations of Islam\n  3: 3,   // Stories of Prophets\n  4: 3,   // Life of Muhammad Ô∑∫ (Seerah)\n  5: 2,   // Wives of the Prophet Ô∑∫\n  6: 2,   // Ten Promised Jannah\n  7: 2,   // Four Greatest Women\n  8: 3,   // Stories of the Companions\n  9: 3,   // Angels\n  10: 3,  // The End Times\n  11: 0,  // The Grave (PREMIUM ONLY)\n  12: 0,  // Day of Judgement (PREMIUM ONLY)\n  13: 0,  // Hellfire (PREMIUM ONLY)\n  14: 0,  // Paradise (PREMIUM ONLY)\n};\n\n// Premium-only paths (paths 11-14)\nexport const PREMIUM_ONLY_PATHS = [11, 12, 13, 14];\n\n// Check if a path is premium-only\nexport const isPremiumOnlyPath = (pathId) => {\n  return PREMIUM_ONLY_PATHS.includes(pathId);\n};\n","path":null,"size_bytes":910,"size_tokens":null},"src/components/ModalController.jsx":{"content":"import React from 'react';\nimport { useModalStore, MODAL_TYPES } from '../store/modalStore';\n\nimport RewardModal from './quiz/RewardModal';\nimport { ZaydLevelUpPopup } from './ZaydLevelUpPopup';\nimport PurchaseModal from './PurchaseModal';\nimport PurchaseStreakFreezeModal from './PurchaseStreakFreezeModal';\nimport RepairStreakModal from './RepairStreakModal';\nimport EditNameInput from './EditNameInput';\nimport EditAvatarModal from './EditAvatarModal';\nimport { ViewAllLevelsModal } from './ViewAllLevelsModal';\nimport LevelDetailModal from './LevelDetailModal';\n\nimport ChallengeExplainerModal from './challenges/ChallengeExplainerModal';\nimport ChallengeCountdown from './challenges/ChallengeCountdown';\nimport ChallengeResultsModal from './challenges/ChallengeResultsModal';\nimport NoSharedLessonsModal from './challenges/NoSharedLessonsModal';\nimport BossLockedModal from './challenges/BossLockedModal';\nimport BossPlayedTodayModal from './challenges/BossPlayedTodayModal';\nimport FriendChallengeSentModal from './challenges/FriendChallengeSentModal';\nimport FriendChallengeReceivedModal from './challenges/FriendChallengeReceivedModal';\nimport FriendChallengeResultsModal from './challenges/FriendChallengeResultsModal';\nimport FriendChallengeWaitingModal from './challenges/FriendChallengeWaitingModal';\n\nimport EventInfoModal from './events/EventInfoModal';\nimport CountdownModal from './events/CountdownModal';\nimport ProvisionalResultsModal from './events/ProvisionalResultsModal';\nimport FinalResultsModal from './events/FinalResultsModal';\nimport InsufficientCoinsModal from './events/InsufficientCoinsModal';\n\nimport DailyQuestExplainerModal from './dailyquest/DailyQuestExplainerModal';\n\nimport ExitConfirmationModal from './ExitConfirmationModal';\n\nimport mascotRocket from '../assets/mascots/mascot_countdown.webp';\n\nexport default function ModalController() {\n  const { activeModal, modalData, hideModal, replaceModal } = useModalStore();\n\n  if (!activeModal) return null;\n\n  const renderModal = () => {\n    switch (activeModal) {\n      case MODAL_TYPES.CONFIRM:\n        return (\n          <div\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              background: 'rgba(0, 0, 0, 0.8)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              zIndex: 9999,\n            }}\n            onClick={hideModal}\n          >\n            <div\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                background: 'linear-gradient(135deg, #0a2a43 0%, #000814 100%)',\n                border: '2px solid rgba(255, 215, 0, 0.4)',\n                borderRadius: '24px',\n                padding: '32px 24px',\n                maxWidth: '400px',\n                width: '90%',\n                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 215, 0, 0.2)',\n                textAlign: 'center',\n              }}\n            >\n              <h2\n                style={{\n                  fontSize: '1.3rem',\n                  fontWeight: 700,\n                  color: '#FFD700',\n                  margin: '0 0 16px 0',\n                }}\n              >\n                {modalData.title || 'Confirm'}\n              </h2>\n\n              <p\n                style={{\n                  fontSize: '1rem',\n                  color: '#e8e8e8',\n                  margin: '0 0 24px 0',\n                  lineHeight: 1.5,\n                }}\n              >\n                {modalData.message || 'Are you sure?'}\n              </p>\n\n              <div style={{ display: 'flex', gap: '12px' }}>\n                <button\n                  onClick={hideModal}\n                  style={{\n                    flex: 1,\n                    padding: '14px',\n                    background: 'rgba(255, 255, 255, 0.1)',\n                    border: '1px solid rgba(255, 255, 255, 0.2)',\n                    borderRadius: '12px',\n                    color: '#ffffff',\n                    fontSize: '1rem',\n                    fontWeight: 600,\n                    cursor: 'pointer',\n                  }}\n                >\n                  {modalData.cancelText || 'Cancel'}\n                </button>\n                <button\n                  onClick={() => {\n                    hideModal();\n                    modalData.onConfirm?.();\n                  }}\n                  style={{\n                    flex: 1,\n                    padding: '14px',\n                    background: 'linear-gradient(135deg, #ef4444 0%, #b91c1c 100%)',\n                    border: 'none',\n                    borderRadius: '12px',\n                    color: '#ffffff',\n                    fontSize: '1rem',\n                    fontWeight: 700,\n                    cursor: 'pointer',\n                  }}\n                >\n                  {modalData.confirmText || 'Confirm'}\n                </button>\n              </div>\n            </div>\n          </div>\n        );\n\n      case MODAL_TYPES.SUCCESS:\n        return (\n          <div\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              background: 'rgba(0, 0, 0, 0.8)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              zIndex: 9999,\n            }}\n            onClick={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          >\n            <div\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                background: 'linear-gradient(135deg, #0a2a43 0%, #000814 100%)',\n                border: '2px solid rgba(34, 197, 94, 0.4)',\n                borderRadius: '24px',\n                padding: '32px 24px',\n                maxWidth: '400px',\n                width: '90%',\n                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.5), 0 0 40px rgba(34, 197, 94, 0.2)',\n                textAlign: 'center',\n              }}\n            >\n              <div\n                style={{\n                  width: '60px',\n                  height: '60px',\n                  borderRadius: '50%',\n                  background: 'rgba(34, 197, 94, 0.2)',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  margin: '0 auto 16px',\n                }}\n              >\n                <span style={{ fontSize: '2rem' }}>‚úì</span>\n              </div>\n\n              <p\n                style={{\n                  fontSize: '1rem',\n                  color: '#e8e8e8',\n                  margin: '0 0 24px 0',\n                  lineHeight: 1.5,\n                }}\n              >\n                {modalData.message || 'Success!'}\n              </p>\n\n              <button\n                onClick={() => {\n                  hideModal();\n                  modalData.onClose?.();\n                }}\n                style={{\n                  width: '100%',\n                  padding: '14px',\n                  background: 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\n                  border: 'none',\n                  borderRadius: '12px',\n                  color: '#ffffff',\n                  fontSize: '1rem',\n                  fontWeight: 700,\n                  cursor: 'pointer',\n                }}\n              >\n                OK\n              </button>\n            </div>\n          </div>\n        );\n\n      case MODAL_TYPES.ERROR:\n        return (\n          <div\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              background: 'rgba(0, 0, 0, 0.8)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              zIndex: 9999,\n            }}\n            onClick={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          >\n            <div\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                background: 'linear-gradient(135deg, #0a2a43 0%, #000814 100%)',\n                border: '2px solid rgba(239, 68, 68, 0.4)',\n                borderRadius: '24px',\n                padding: '32px 24px',\n                maxWidth: '400px',\n                width: '90%',\n                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.5), 0 0 40px rgba(239, 68, 68, 0.2)',\n                textAlign: 'center',\n              }}\n            >\n              <div\n                style={{\n                  width: '60px',\n                  height: '60px',\n                  borderRadius: '50%',\n                  background: 'rgba(239, 68, 68, 0.2)',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  margin: '0 auto 16px',\n                }}\n              >\n                <span style={{ fontSize: '2rem' }}>‚úï</span>\n              </div>\n\n              <p\n                style={{\n                  fontSize: '1rem',\n                  color: '#e8e8e8',\n                  margin: '0 0 24px 0',\n                  lineHeight: 1.5,\n                }}\n              >\n                {modalData.message || 'Something went wrong'}\n              </p>\n\n              <button\n                onClick={() => {\n                  hideModal();\n                  modalData.onClose?.();\n                }}\n                style={{\n                  width: '100%',\n                  padding: '14px',\n                  background: 'linear-gradient(135deg, #ef4444 0%, #b91c1c 100%)',\n                  border: 'none',\n                  borderRadius: '12px',\n                  color: '#ffffff',\n                  fontSize: '1rem',\n                  fontWeight: 700,\n                  cursor: 'pointer',\n                }}\n              >\n                OK\n              </button>\n            </div>\n          </div>\n        );\n\n      case MODAL_TYPES.REWARD:\n        return (\n          <RewardModal\n            score={modalData.score}\n            totalQ={modalData.totalQ}\n            xp={modalData.xp || 0}\n            coins={modalData.coins || 0}\n            passed={modalData.passed}\n            mascotImg={modalData.mascotImg}\n            onRetry={() => {\n              hideModal();\n              modalData.onRetry?.();\n            }}\n            onContinue={() => {\n              hideModal();\n              modalData.onContinue?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.LEVEL_UP:\n        return (\n          <ZaydLevelUpPopup\n            levelUpData={modalData.levelUpData}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.PURCHASE:\n        return (\n          <PurchaseModal\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.PURCHASE_STREAK_FREEZE:\n        return (\n          <PurchaseStreakFreezeModal\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n            onPurchase={(amount) => {\n              modalData.onPurchase?.(amount);\n              hideModal();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.REPAIR_STREAK:\n        return (\n          <RepairStreakModal\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n            onRepair={() => {\n              modalData.onRepair?.();\n              hideModal();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EDIT_NAME:\n        return (\n          <EditNameInput\n            isOpen={true}\n            initialName={modalData.initialName || ''}\n            onSave={(name) => {\n              modalData.onSave?.(name);\n              hideModal();\n            }}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.EDIT_AVATAR:\n        return (\n          <EditAvatarModal\n            isOpen={true}\n            currentAvatar={modalData.currentAvatar}\n            onSave={(avatar) => {\n              modalData.onSave?.(avatar);\n              hideModal();\n            }}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.VIEW_ALL_LEVELS:\n        return (\n          <ViewAllLevelsModal\n            currentXP={modalData?.currentXP ?? 0}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.LEVEL_DETAIL:\n        return (\n          <LevelDetailModal\n            isOpen={true}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.CHALLENGE_EXPLAINER:\n        return (\n          <ChallengeExplainerModal\n            mode={modalData.mode}\n            onStart={() => {\n              hideModal();\n              modalData.onStart?.();\n            }}\n            onCancel={() => {\n              hideModal();\n              modalData.onCancel?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.CHALLENGE_COUNTDOWN:\n        return (\n          <ChallengeCountdown\n            onComplete={() => {\n              hideModal();\n              modalData.onComplete?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.CHALLENGE_RESULTS:\n        return (\n          <ChallengeResultsModal\n            mode={modalData.mode}\n            score={modalData.score}\n            totalQuestions={modalData.totalQuestions}\n            result={modalData.result}\n            rewards={modalData.rewards}\n            opponentName={modalData.opponentName}\n            opponentScore={modalData.opponentScore}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.NO_SHARED_LESSONS:\n        return (\n          <NoSharedLessonsModal\n            friendName={modalData.friendName}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.BOSS_LOCKED:\n        return (\n          <BossLockedModal\n            currentLevel={modalData.currentLevel}\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.BOSS_PLAYED_TODAY:\n        return (\n          <BossPlayedTodayModal\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.FRIEND_CHALLENGE_SENT:\n        return (\n          <FriendChallengeSentModal\n            friendName={modalData.friendName}\n            modeId={modalData.modeId}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.FRIEND_CHALLENGE_RECEIVED:\n        return (\n          <FriendChallengeReceivedModal\n            challenge={modalData.challenge}\n            senderName={modalData.senderName}\n            senderAvatar={modalData.senderAvatar}\n            onAccept={() => {\n              modalData.onAccept?.();\n            }}\n            onDecline={() => {\n              modalData.onDecline?.();\n            }}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.FRIEND_CHALLENGE_RESULTS:\n        return (\n          <FriendChallengeResultsModal\n            challenge={modalData.challenge}\n            currentUserId={modalData.currentUserId}\n            userScore={modalData.userScore}\n            opponentInfo={modalData.opponentInfo}\n            onChallengeAgain={(modeId) => {\n              hideModal();\n              modalData.onChallengeAgain?.(modeId);\n            }}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.FRIEND_CHALLENGE_WAITING:\n        return (\n          <FriendChallengeWaitingModal\n            friendName={modalData.friendName}\n            modeId={modalData.modeId}\n            score={modalData.score}\n            totalQuestions={modalData.totalQuestions}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EVENT_INFO:\n        return (\n          <EventInfoModal\n            event={modalData.event}\n            onStart={() => {\n              hideModal();\n              modalData.onStart?.();\n            }}\n            onCancel={() => {\n              hideModal();\n              modalData.onCancel?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EVENT_COUNTDOWN:\n        return (\n          <CountdownModal\n            onComplete={() => {\n              hideModal();\n              modalData.onComplete?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EVENT_PROVISIONAL_RESULTS:\n        return (\n          <ProvisionalResultsModal\n            event={modalData.event}\n            score={modalData.score}\n            totalQuestions={modalData.totalQuestions}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EVENT_FINAL_RESULTS:\n        return (\n          <FinalResultsModal\n            event={modalData.event}\n            entry={modalData.entry}\n            onClose={() => {\n              hideModal();\n              modalData.onClose?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.INSUFFICIENT_COINS:\n        return (\n          <InsufficientCoinsModal\n            onClose={hideModal}\n          />\n        );\n\n      case MODAL_TYPES.DAILY_QUEST_EXPLAINER:\n        return (\n          <DailyQuestExplainerModal\n            onClose={hideModal}\n            onStart={() => {\n              hideModal();\n              modalData.onStart?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.EXIT_CONFIRMATION:\n        return (\n          <ExitConfirmationModal\n            onCancel={hideModal}\n            onConfirm={() => {\n              hideModal();\n              modalData.onConfirm?.();\n            }}\n          />\n        );\n\n      case MODAL_TYPES.RAMADAN_COMING_SOON:\n        return (\n          <div\n            style={{\n              position: 'fixed',\n              inset: 0,\n              zIndex: 10000,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              background: 'rgba(0, 0, 0, 0.75)',\n              backdropFilter: 'blur(4px)',\n            }}\n            onClick={hideModal}\n          >\n            <div\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                background: 'linear-gradient(135deg, #0a2a43 0%, #000814 100%)',\n                border: '2px solid rgba(255, 215, 0, 0.4)',\n                borderRadius: '24px',\n                padding: '32px 24px',\n                maxWidth: '400px',\n                width: '90%',\n                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 215, 0, 0.2)',\n                textAlign: 'center',\n                animation: 'modalScaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)',\n              }}\n            >\n              <img \n                src={mascotRocket} \n                alt=\"Rocket\" \n                style={{ \n                  width: '80px', \n                  height: 'auto', \n                  marginBottom: '16px',\n                  filter: 'drop-shadow(0 0 12px rgba(255, 215, 0, 0.5))'\n                }} \n              />\n\n              <h2\n                style={{\n                  fontSize: '1.4rem',\n                  fontWeight: 700,\n                  color: '#FFD700',\n                  margin: '0 0 12px 0',\n                }}\n              >\n                Launching Ramadan 2026!\n              </h2>\n\n              <p\n                style={{\n                  fontSize: '0.95rem',\n                  color: '#e8e8e8',\n                  margin: '0 0 24px 0',\n                  lineHeight: 1.5,\n                }}\n              >\n                Coming soon with Global Events, in shƒÅ' AllƒÅh\n              </p>\n\n              <button\n                onClick={hideModal}\n                style={{\n                  width: '100%',\n                  padding: '14px',\n                  background: 'linear-gradient(135deg, #FFD700 0%, #b89600 100%)',\n                  border: 'none',\n                  borderRadius: '12px',\n                  color: '#000814',\n                  fontSize: '1rem',\n                  fontWeight: 700,\n                  cursor: 'pointer',\n                  boxShadow: '0 4px 12px rgba(255, 215, 0, 0.4)',\n                  transition: 'transform 0.2s ease, box-shadow 0.2s ease',\n                }}\n                onMouseDown={(e) => e.currentTarget.style.transform = 'scale(0.96)'}\n                onMouseUp={(e) => e.currentTarget.style.transform = 'scale(1)'}\n                onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}\n              >\n                OK\n              </button>\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div key={activeModal} style={{ position: 'relative', zIndex: 9999 }}>\n      {renderModal()}\n    </div>\n  );\n}\n","path":null,"size_bytes":21336,"size_tokens":null},"src/store/modalStore.js":{"content":"import { create } from 'zustand';\n\nconst MODAL_TYPES = {\n  NONE: null,\n  CONFIRM: 'CONFIRM',\n  SUCCESS: 'SUCCESS',\n  ERROR: 'ERROR',\n  REWARD: 'REWARD',\n  LEVEL_UP: 'LEVEL_UP',\n  PURCHASE: 'PURCHASE',\n  PURCHASE_STREAK_FREEZE: 'PURCHASE_STREAK_FREEZE',\n  REPAIR_STREAK: 'REPAIR_STREAK',\n  EDIT_NAME: 'EDIT_NAME',\n  EDIT_AVATAR: 'EDIT_AVATAR',\n  VIEW_ALL_LEVELS: 'VIEW_ALL_LEVELS',\n  LEVEL_DETAIL: 'LEVEL_DETAIL',\n  CHALLENGE_EXPLAINER: 'CHALLENGE_EXPLAINER',\n  CHALLENGE_COUNTDOWN: 'CHALLENGE_COUNTDOWN',\n  CHALLENGE_RESULTS: 'CHALLENGE_RESULTS',\n  NO_SHARED_LESSONS: 'NO_SHARED_LESSONS',\n  BOSS_LOCKED: 'BOSS_LOCKED',\n  BOSS_PLAYED_TODAY: 'BOSS_PLAYED_TODAY',\n  EVENT_INFO: 'EVENT_INFO',\n  EVENT_COUNTDOWN: 'EVENT_COUNTDOWN',\n  EVENT_PROVISIONAL_RESULTS: 'EVENT_PROVISIONAL_RESULTS',\n  EVENT_FINAL_RESULTS: 'EVENT_FINAL_RESULTS',\n  INSUFFICIENT_COINS: 'INSUFFICIENT_COINS',\n  DAILY_QUEST_EXPLAINER: 'DAILY_QUEST_EXPLAINER',\n  EXIT_CONFIRMATION: 'EXIT_CONFIRMATION',\n  RAMADAN_COMING_SOON: 'RAMADAN_COMING_SOON',\n  FRIEND_CHALLENGE_SENT: 'FRIEND_CHALLENGE_SENT',\n  FRIEND_CHALLENGE_RECEIVED: 'FRIEND_CHALLENGE_RECEIVED',\n  FRIEND_CHALLENGE_ACCEPTED: 'FRIEND_CHALLENGE_ACCEPTED',\n  FRIEND_CHALLENGE_DECLINED: 'FRIEND_CHALLENGE_DECLINED',\n  FRIEND_CHALLENGE_CANCELLED: 'FRIEND_CHALLENGE_CANCELLED',\n  FRIEND_CHALLENGE_RESULTS: 'FRIEND_CHALLENGE_RESULTS',\n  FRIEND_CHALLENGE_WAITING: 'FRIEND_CHALLENGE_WAITING',\n};\n\nexport const useModalStore = create((set, get) => ({\n  activeModal: null,\n  modalData: {},\n  previousModal: null,\n\n  showModal: (type, data = {}) => {\n    const current = get().activeModal;\n    set({ \n      activeModal: type,\n      modalData: data,\n      previousModal: current\n    });\n  },\n\n  hideModal: () => {\n    set({ \n      activeModal: null,\n      modalData: {},\n      previousModal: null\n    });\n  },\n\n  replaceModal: (type, data = {}) => {\n    set({ \n      activeModal: type,\n      modalData: data\n    });\n  },\n\n  isModalActive: () => {\n    return get().activeModal !== null;\n  },\n\n  getActiveModal: () => {\n    return get().activeModal;\n  },\n\n  getModalData: () => {\n    return get().modalData;\n  }\n}));\n\nexport { MODAL_TYPES };\n","path":null,"size_bytes":2152,"size_tokens":null},"src/assets/lazyAssets.js":{"content":"// src/assets/lazyAssets.js\n// Lazy-loaded assets - only loaded when needed\n\n// Lazy load less frequently used mascots\nexport const loadMascotAssets = () => ({\n  mascot_zayd_thinking: () => import(\"./mascots/mascot_zayd_thinking.webp\"),\n  mascot_zayd_teaching: () => import(\"./mascots/mascot_zayd_teaching.webp\"),\n  mascot_zayd_teaching_alt: () => import(\"./mascots/mascot_zayd_teaching_alt.webp\"),\n  mascot_zayd_trophy: () => import(\"./mascots/mascot_zayd_trophy.webp\"),\n  mascot_zayd_wink: () => import(\"./mascots/mascot_zayd_wink.webp\"),\n  mascot_zayd_shield: () => import(\"./mascots/mascot_zayd_shield.webp\"),\n  mascot_zayd_certificate: () => import(\"./mascots/mascot_zayd_certificate.webp\"),\n  mascot_zayd_challenge: () => import(\"./mascots/mascot_zayd_challenge.webp\"),\n  mascot_zayd_cheer: () => import(\"./mascots/mascot_zayd_cheer.webp\"),\n  mascot_zayd_clap: () => import(\"./mascots/mascot_zayd_clap.webp\"),\n  mascot_zayd_happy: () => import(\"./mascots/mascot_zayd_happy.webp\"),\n  mascot_zayd_jump: () => import(\"./mascots/mascot_zayd_jump.webp\"),\n  mascot_zayd_lantern: () => import(\"./mascots/mascot_zayd_lantern.webp\"),\n  mascot_zayd_reading: () => import(\"./mascots/mascot_zayd_reading.webp\"),\n  mascot_zayd_book: () => import(\"./mascots/mascot_zayd_book.webp\"),\n  mascot_path_main: () => import(\"./mascots/mascot_path_main.png\"),\n  mascot_quiz_thinking: () => import(\"./mascots/mascot_quiz_thinking.webp\"),\n  mascot_quiz_cheering: () => import(\"./mascots/mascot_quiz_cheering.webp\"),\n  mascot_daily_quest: () => import(\"./mascots/mascot_daily_quest.png\"),\n  mascot_boss_level: () => import(\"./mascots/mascot_boss_level.png\"),\n});\n\n// Lazy load certificates (only when path completed)\nexport const loadCertificateAssets = () => ({\n  certificate_allahs_names: () => import(\"./certificates/certificate_allahs_names.webp\"),\n  certificate_four_greatest_women: () => import(\"./certificates/certificate_four_greatest_women.webp\"),\n  certificate_life_of_muhammad: () => import(\"./certificates/certificate_life_of_muhammad.webp\"),\n  certificate_six_pillars: () => import(\"./certificates/certificate_six_pillars.webp\"),\n  certificate_stories_of_prophets: () => import(\"./certificates/certificate_stories_of_prophets.webp\"),\n  certificate_ten_promised_paradise: () => import(\"./certificates/certificate_ten_promised_paradise.webp\"),\n});\n\n// Helper to load a specific asset\nexport async function loadAsset(assetLoader) {\n  const module = await assetLoader();\n  return module.default;\n}\n","path":null,"size_bytes":2487,"size_tokens":null},"src/assets/criticalAssets.js":{"content":"// src/assets/criticalAssets.js\n// Critical assets loaded immediately for faster initial render\n\n// UI icons (always visible)\nimport ui_coin from \"./ui/ui_coin.webp\";\nimport ui_shield from \"./ui/ui_shield.webp\";\nimport ui_streak from \"./ui/ui_streak.webp\";\nimport ui_xp from \"./ui/ui_xp.webp\";\n\n// Home/Main mascots (frequently used)\nimport mascot_home_main from \"./mascots/mascot_home_main.png\";\nimport mascot_zayd_default from \"./mascots/mascot_zayd_default.webp\";\nimport mascot_zayd_thumbsup from \"./mascots/mascot_zayd_thumbsup.webp\";\n\n// Critical UI assets\nexport const criticalAssets = {\n  ui: {\n    ui_coin,\n    ui_shield,\n    ui_streak,\n    ui_xp,\n  },\n  mascots: {\n    mascot_home_main,\n    mascot_zayd_default,\n    mascot_zayd_thumbsup,\n  },\n};\n\nexport default criticalAssets;\n","path":null,"size_bytes":787,"size_tokens":null},"MODAL_SYSTEM.md":{"content":"# üé≠ Modal Architecture - IslamQuest\n\n## Overview\nIslamQuest now features a unified modal architecture with global state management, smooth animations, and optimized rendering for mobile devices.\n\n---\n\n## üìÅ File Structure\n\n```\nsrc/\n‚îú‚îÄ‚îÄ providers/\n‚îÇ   ‚îî‚îÄ‚îÄ ModalProvider.jsx          # Global modal provider with animations\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ ModalController.jsx         # Existing modal router (kept for compatibility)\n‚îÇ   ‚îî‚îÄ‚îÄ ShimmerLoader.jsx           # Skeleton loading components\n‚îî‚îÄ‚îÄ store/\n    ‚îî‚îÄ‚îÄ modalStore.js               # Zustand store for modal state\n```\n\n---\n\n## üéØ Key Features\n\n### 1. **Global Modal Provider**\n- Centralized modal state management via React Context\n- Supports both inline and portal rendering\n- Automatic animation handling\n\n### 2. **Smooth Animations**\n- **Duolingo-style fade + scale**: `opacity: 0‚Üí1` and `scale: 0.93‚Üí1.0`\n- Optimized for 60fps on low-end Android devices\n- GPU-accelerated with `transform` and `opacity` only\n\n### 3. **Rendering Strategy**\n- **Light modals**: Rendered inline (EditName, EditAvatar)\n- **Heavy modals**: Rendered via portal (Reward, LevelUp, Purchase)\n- Automatic DOM portal creation at `<div id=\"modal-root\" />`\n\n### 4. **Loading UX**\n- Shimmer skeleton loaders for page transitions\n- Contextual loading states (header, cards, images)\n- Smooth 2s shimmer animation\n\n---\n\n## üöÄ Usage Guide\n\n### Using the Modal Provider (New API)\n\n```jsx\nimport { useModal } from '../providers/ModalProvider';\n\nfunction MyComponent() {\n  const { openModal, closeModal } = useModal();\n\n  const handleShowModal = () => {\n    openModal(\n      'success',           // type\n      MyModalComponent,    // component\n      { message: 'Done!' }, // data\n      false,               // usePortal (false = inline, true = portal)\n      () => console.log('Modal closed') // onClose callback\n    );\n  };\n\n  return <button onClick={handleShowModal}>Show Modal</button>;\n}\n```\n\n### Using the Existing System (Legacy API)\n\n```jsx\nimport { useModalStore, MODAL_TYPES } from '../store/modalStore';\n\nfunction MyComponent() {\n  const { showModal, hideModal } = useModalStore();\n\n  const handleShowReward = () => {\n    showModal(MODAL_TYPES.REWARD, {\n      xp: 100,\n      coins: 20,\n      mascotImg: zaydCheerMascot,\n      onContinue: () => {\n        hideModal();\n        navigate('/');\n      }\n    });\n  };\n\n  return <button onClick={handleShowReward}>Show Reward</button>;\n}\n```\n\n---\n\n## üé® Shimmer Loader Components\n\n### Basic Shimmer\n```jsx\nimport { ShimmerLoader } from '../components/ShimmerLoader';\n\n<ShimmerLoader width=\"100%\" height=\"20px\" borderRadius=\"8px\" />\n```\n\n### Shimmer Card\n```jsx\nimport { ShimmerCard } from '../components/ShimmerLoader';\n\n<ShimmerCard style={{ marginBottom: '16px' }} />\n```\n\n### Shimmer Image\n```jsx\nimport { ShimmerImage } from '../components/ShimmerLoader';\n\n<ShimmerImage width=\"80px\" height=\"80px\" borderRadius=\"50%\" />\n```\n\n---\n\n## üìä Modal Types Reference\n\n### Current Modal Types (21 total)\n- `REWARD` - Quiz completion rewards\n- `LEVEL_UP` - Diamond level progression\n- `PURCHASE` - Premium plan upgrades\n- `PURCHASE_STREAK_FREEZE` - Streak freeze shields\n- `REPAIR_STREAK` - Broken streak recovery\n- `EDIT_NAME` - User name editing\n- `EDIT_AVATAR` - Avatar selection\n- `VIEW_ALL_LEVELS` - Diamond levels overview\n- `LEVEL_DETAIL` - Individual level details\n- `INVITE_FAMILY` - Family plan invites\n- `CHALLENGE_EXPLAINER` - Challenge rules\n- `CHALLENGE_COUNTDOWN` - 3-2-1 countdown\n- `CHALLENGE_RESULTS` - Challenge outcomes\n- `NO_SHARED_LESSONS` - Error: no shared lessons\n- `BOSS_LOCKED` - Boss level requirements\n- `EVENT_INFO` - Global event details\n- `EVENT_COUNTDOWN` - Event quiz countdown\n- `EVENT_PROVISIONAL_RESULTS` - Provisional rankings\n- `EVENT_FINAL_RESULTS` - Final event rankings\n- `INSUFFICIENT_COINS` - Error: not enough coins\n- `DAILY_QUEST_EXPLAINER` - Daily quest rules\n\n---\n\n## üé≠ Animation CSS Classes\n\n### Overlay Animations\n- `.modal-overlay-enter` - Fade in (0.2s)\n- `.modal-overlay-exit` - Fade out (0.2s)\n\n### Content Animations\n- `.modal-content-enter` - Scale in (0.25s cubic-bezier)\n- `.modal-content-exit` - Scale out (0.2s)\n\n---\n\n## üèóÔ∏è Architecture Decisions\n\n### Why Both Systems Coexist?\n\n1. **Backward Compatibility**: Existing `ModalController` kept to avoid breaking changes\n2. **Gradual Migration**: New modals can use `ModalProvider` API\n3. **Flexibility**: Developers choose inline vs. portal rendering\n4. **Safety**: No rewrites, no removals, incremental improvements\n\n### Portal vs. Inline Rendering\n\n**Use Portal (`usePortal: true`) for:**\n- Heavy modals with complex animations (RewardModal, ZaydLevelUpPopup)\n- Modals that need highest z-index (PurchaseModal)\n- Modals with complex layouts (FinalResultsModal)\n\n**Use Inline (`usePortal: false`) for:**\n- Simple modals (EditName, EditAvatar)\n- Quick interactions (confirmation dialogs)\n- Lightweight UI (info modals)\n\n---\n\n## üîß Performance Optimizations\n\n### GPU Acceleration\n- All animations use `transform` and `opacity` only\n- Avoid `width`, `height`, `margin`, `padding` in animations\n- 60fps guaranteed on low-end devices\n\n### Code Splitting\n- Modal components lazy-loaded where possible\n- Routes split with `React.lazy()` and `Suspense`\n- Shimmer loaders reduce perceived load time\n\n### Rendering Strategy\n- Portal modals rendered outside main DOM tree\n- Inline modals rendered in component tree\n- Automatic cleanup on unmount\n\n---\n\n## üìù Best Practices\n\n### 1. **Always Use ShimmerLoader for Loading States**\n```jsx\n// ‚úÖ Good - Contextual loading\n<Suspense fallback={<ShimmerCard />}>\n  <MyComponent />\n</Suspense>\n\n// ‚ùå Bad - Generic spinner\n<Suspense fallback={<Spinner />}>\n  <MyComponent />\n</Suspense>\n```\n\n### 2. **Choose Right Modal Type**\n```jsx\n// ‚úÖ Good - Heavy modal via portal\nopenModal('reward', RewardModal, data, true);\n\n// ‚úÖ Good - Light modal inline\nopenModal('info', InfoModal, data, false);\n```\n\n### 3. **Keep Existing Zayd Animations**\n```jsx\n// ‚úÖ Good - Preserve mascot animations\n<img src={mascotZaydCheer} className=\"challenge-zayd-bounce\" />\n\n// ‚ùå Bad - Remove animations\n<img src={mascotZaydCheer} />\n```\n\n---\n\n## üö¶ Migration Path (Future)\n\n### Phase 1: Foundation (‚úÖ Complete)\n- [x] Create ModalProvider\n- [x] Create ShimmerLoader\n- [x] Add fade+scale animations\n- [x] Integrate into App.jsx\n\n### Phase 2: Cleanup (Optional)\n- [ ] Migrate modals to new API gradually\n- [ ] Remove unused modal code\n- [ ] Consolidate CSS into modal themes\n\n### Phase 3: Enhancement (Future)\n- [ ] Add modal stacking support\n- [ ] Add custom animation presets\n- [ ] Add accessibility features (focus trap, ARIA)\n\n---\n\n## üéì Examples\n\n### Example 1: Success Modal\n```jsx\nimport { useModal } from '../providers/ModalProvider';\nimport SuccessModal from '../components/modals/SuccessModal';\n\nconst handleSuccess = () => {\n  openModal(\n    'success',\n    SuccessModal,\n    { \n      title: \"masha'Allah!\",\n      message: 'Lesson completed!',\n      xp: 100\n    },\n    false, // inline rendering\n    () => navigate('/')\n  );\n};\n```\n\n### Example 2: Heavy Reward Modal\n```jsx\nimport { useModalStore, MODAL_TYPES } from '../store/modalStore';\n\nconst handleQuizComplete = () => {\n  showModal(MODAL_TYPES.REWARD, {\n    score: 8,\n    totalQ: 10,\n    xp: 100,\n    coins: 20,\n    passed: true,\n    mascotImg: assets.mascots.mascot_zayd_cheer,\n    onContinue: () => {\n      hideModal();\n      navigate('/');\n    }\n  });\n};\n```\n\n---\n\n## üõ°Ô∏è Safety Guarantees\n\n- ‚úÖ **No breaking changes** - All existing modals work\n- ‚úÖ **No code removal** - Old system intact\n- ‚úÖ **No theme changes** - Navy + Gold preserved\n- ‚úÖ **No Zayd changes** - Mascot animations kept\n- ‚úÖ **No logic changes** - XP/coins/streaks untouched\n\n---\n\n## üìû Support\n\nFor questions or issues with the modal system:\n1. Check existing modal implementations in `/src/components`\n2. Review `ModalController.jsx` for modal routing\n3. Test with `<ShimmerCard />` for loading states\n\n---\n\n**Built with safety and performance in mind** üåô\n**masha'Allah, may Allah bless this work** ‚ú®\n","path":null,"size_bytes":8127,"size_tokens":null},"src/utils/imagePreloader.js":{"content":"// src/utils/imagePreloader.js\n// Comprehensive image preloader using Vite's import.meta.glob to automatically\n// capture ALL images in the project for instant Duolingo-style loading\n\nconst preloadedImages = new Set();\n\n// Automatically import ALL images from assets directory\nconst allImages = import.meta.glob('../assets/**/*.{webp,png,jpg,jpeg}', { \n  eager: true,\n  import: 'default'\n});\n\n// Extract all image URLs from the glob import\nconst allImageUrls = Object.values(allImages);\n\nexport function preloadImage(src) {\n  return new Promise((resolve) => {\n    if (preloadedImages.has(src)) {\n      resolve(src);\n      return;\n    }\n\n    const img = new Image();\n    img.onload = () => {\n      preloadedImages.add(src);\n      resolve(src);\n    };\n    img.onerror = () => {\n      // Resolve anyway to avoid breaking the promise chain\n      resolve(src);\n    };\n    img.src = src;\n  });\n}\n\nexport function preloadImages(srcArray) {\n  return Promise.all(srcArray.map(src => preloadImage(src)));\n}\n\n// Preload EVERYTHING immediately - all 81+ images\nexport async function preloadAllAssets() {\n  console.log(`üöÄ Preloading ${allImageUrls.length} images for instant rendering...`);\n  const startTime = performance.now();\n  \n  await preloadImages(allImageUrls);\n  \n  const endTime = performance.now();\n  console.log(`‚úÖ All ${allImageUrls.length} images preloaded in ${(endTime - startTime).toFixed(0)}ms`);\n}\n\nexport function isPreloaded(src) {\n  return preloadedImages.has(src);\n}\n\nexport function getPreloadedCount() {\n  return preloadedImages.size;\n}\n\nexport function getAllImageUrls() {\n  return allImageUrls;\n}\n","path":null,"size_bytes":1616,"size_tokens":null},"src/components/ShimmerLoader.jsx":{"content":"// src/components/ShimmerLoader.jsx\nimport React from 'react';\n\nconst shimmerKeyframes = `\n  @keyframes shimmer {\n    0% {\n      background-position: -1000px 0;\n    }\n    100% {\n      background-position: 1000px 0;\n    }\n  }\n`;\n\nexport function ShimmerLoader({ width = '100%', height = '20px', borderRadius = '8px', style = {} }) {\n  return (\n    <>\n      <style>{shimmerKeyframes}</style>\n      <div\n        style={{\n          width,\n          height,\n          borderRadius,\n          background: 'linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%)',\n          backgroundSize: '1000px 100%',\n          animation: 'shimmer 2s infinite linear',\n          ...style,\n        }}\n      />\n    </>\n  );\n}\n\nexport function ShimmerCard({ style = {} }) {\n  return (\n    <div\n      style={{\n        background: 'rgba(255, 255, 255, 0.03)',\n        borderRadius: '16px',\n        padding: '20px',\n        border: '1px solid rgba(255, 255, 255, 0.1)',\n        ...style,\n      }}\n    >\n      <ShimmerLoader width=\"60%\" height=\"24px\" style={{ marginBottom: '12px' }} />\n      <ShimmerLoader width=\"100%\" height=\"16px\" style={{ marginBottom: '8px' }} />\n      <ShimmerLoader width=\"80%\" height=\"16px\" />\n    </div>\n  );\n}\n\nexport function ShimmerImage({ width = '100px', height = '100px', borderRadius = '50%', style = {} }) {\n  return (\n    <ShimmerLoader\n      width={width}\n      height={height}\n      borderRadius={borderRadius}\n      style={style}\n    />\n  );\n}\n","path":null,"size_bytes":1507,"size_tokens":null},"src/hooks/useNavigate.js":{"content":"// src/hooks/useNavigate.js\n// Simple wrapper for React Router's useNavigate\n// Removed startTransition to eliminate input latency\nimport { useNavigate as useRouterNavigate } from 'react-router-dom';\n\nexport function useNavigate() {\n  return useRouterNavigate();\n}\n","path":null,"size_bytes":265,"size_tokens":null},"src/providers/ModalProvider.jsx":{"content":"// src/providers/ModalProvider.jsx\nimport React, { createContext, useContext, useState, useCallback, useRef } from 'react';\nimport { createPortal } from 'react-dom';\n\nconst ModalContext = createContext(null);\n\nexport const useModal = () => {\n  const context = useContext(ModalContext);\n  if (!context) {\n    throw new Error('useModal must be used within ModalProvider');\n  }\n  return context;\n};\n\nconst modalAnimationStyles = `\n  @keyframes modalFadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes modalScaleIn {\n    from {\n      opacity: 0;\n      transform: scale(0.93);\n    }\n    to {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  @keyframes modalFadeOut {\n    from {\n      opacity: 1;\n    }\n    to {\n      opacity: 0;\n    }\n  }\n\n  @keyframes modalScaleOut {\n    from {\n      opacity: 1;\n      transform: scale(1);\n    }\n    to {\n      opacity: 0;\n      transform: scale(0.93);\n    }\n  }\n\n  .modal-overlay-enter {\n    animation: modalFadeIn 0.2s ease-out forwards;\n  }\n\n  .modal-overlay-exit {\n    animation: modalFadeOut 0.2s ease-in forwards;\n  }\n\n  .modal-content-enter {\n    animation: modalScaleIn 0.25s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;\n  }\n\n  .modal-content-exit {\n    animation: modalScaleOut 0.2s ease-in forwards;\n  }\n`;\n\nexport function ModalProvider({ children }) {\n  const [modalState, setModalState] = useState({\n    isOpen: false,\n    type: null,\n    content: null,\n    data: {},\n    usePortal: false,\n    onClose: null,\n  });\n\n  const [isClosing, setIsClosing] = useState(false);\n  const closeTimeoutRef = useRef(null);\n  const modalIdRef = useRef(0);\n\n  const openModal = useCallback((type, content, data = {}, usePortal = false, onClose = null) => {\n    // Cancel any pending close timeout to prevent race condition\n    if (closeTimeoutRef.current) {\n      clearTimeout(closeTimeoutRef.current);\n      closeTimeoutRef.current = null;\n    }\n    \n    // Increment modal ID to track instances\n    modalIdRef.current += 1;\n    \n    setModalState({\n      isOpen: true,\n      type,\n      content,\n      data,\n      usePortal,\n      onClose,\n    });\n    setIsClosing(false);\n  }, []);\n\n  const closeModal = useCallback(() => {\n    const closingModalId = modalIdRef.current;\n    setIsClosing(true);\n    \n    // Cancel any existing timeout\n    if (closeTimeoutRef.current) {\n      clearTimeout(closeTimeoutRef.current);\n    }\n    \n    closeTimeoutRef.current = setTimeout(() => {\n      // Invoke onClose callback first (may trigger new modal)\n      if (modalState.onClose) {\n        modalState.onClose();\n      }\n      \n      // Only clear state if modal hasn't changed (no new modal opened in callback)\n      if (modalIdRef.current === closingModalId) {\n        setModalState({\n          isOpen: false,\n          type: null,\n          content: null,\n          data: {},\n          usePortal: false,\n          onClose: null,\n        });\n        setIsClosing(false);\n      }\n      closeTimeoutRef.current = null;\n    }, 250); // Match animation duration\n  }, [modalState]);\n\n  const replaceModal = useCallback((type, content, data = {}, usePortal = false, onClose = null) => {\n    // Cancel any pending close timeout\n    if (closeTimeoutRef.current) {\n      clearTimeout(closeTimeoutRef.current);\n      closeTimeoutRef.current = null;\n    }\n    \n    setModalState({\n      isOpen: true,\n      type,\n      content,\n      data,\n      usePortal,\n      onClose,\n    });\n    setIsClosing(false);\n  }, []);\n\n  const contextValue = {\n    isOpen: modalState.isOpen,\n    type: modalState.type,\n    data: modalState.data,\n    openModal,\n    closeModal,\n    replaceModal,\n  };\n\n  const renderModalContent = () => {\n    if (!modalState.isOpen || !modalState.content) return null;\n\n    const ModalContent = modalState.content;\n    const overlayClass = isClosing ? 'modal-overlay-exit' : 'modal-overlay-enter';\n    const contentClass = isClosing ? 'modal-content-exit' : 'modal-content-enter';\n\n    const modalElement = (\n      <div\n        className={overlayClass}\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          zIndex: 9999,\n        }}\n      >\n        <div className={contentClass}>\n          <ModalContent {...modalState.data} onClose={closeModal} />\n        </div>\n      </div>\n    );\n\n    // Use portal for heavy modals, inline for light modals\n    if (modalState.usePortal) {\n      const portalRoot = document.getElementById('modal-root');\n      if (portalRoot) {\n        return createPortal(modalElement, portalRoot);\n      }\n    }\n\n    return modalElement;\n  };\n\n  return (\n    <ModalContext.Provider value={contextValue}>\n      <style>{modalAnimationStyles}</style>\n      {children}\n      {renderModalContent()}\n    </ModalContext.Provider>\n  );\n}\n\nexport function ModalRoot() {\n  return <div id=\"modal-root\" />;\n}\n","path":null,"size_bytes":4870,"size_tokens":null},"src/utils/avatarUtils.js":{"content":"import assets from \"../assets/assets\";\nimport { useUserStore } from \"../store/useUserStore\";\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// ü•∑ HIDDEN NINJA AVATAR SYSTEM\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// These avatars are NEVER shown in the UI selection screen.\n// They can only be assigned internally or via Supabase dashboard.\n// Regular users cannot access, select, or change these avatars.\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n// Male Ninja - Reserved for \"The Dev\" NPC\nexport const NINJA_MALE_KEY = \"avatar_ninja_male\";\nexport const DEV_AVATAR_KEY = NINJA_MALE_KEY; // Alias for backward compatibility\nexport const DEV_USER_ID = \"the_dev_permanent\"; // The Dev NPC's unique ID (matches leaderboard)\n\n// Female Ninja - Reserved for special user (to be assigned via Supabase)\nexport const NINJA_FEMALE_KEY = \"avatar_ninja_female\";\nexport const SPECIAL_USER_ID = null; // Will be set after Supabase integration\n\n// All hidden ninja avatars (excluded from user selection)\nexport const HIDDEN_NINJA_AVATARS = [NINJA_MALE_KEY, NINJA_FEMALE_KEY];\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üë• AVAILABLE AVATARS (User Selection Only)\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Ordered: Male avatars ‚Üí Female avatars ‚Üí Other avatars\n// EXCLUDES all ninja avatars (they are hidden)\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// HISTORICAL AVATAR ORDER - DO NOT MODIFY!\n// This array maintains the exact original ordering for DB index mapping.\n// Existing users have avatar indices stored that depend on this order.\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nexport const HISTORICAL_AVATARS = [\n  // Male avatars (9 total)\n  \"avatar_man_lantern\",      // 0\n  \"avatar_man_tasbih\",       // 1\n  \"avatar_man_cup\",          // 2\n  \"avatar_man_spoon\",        // 3\n  \"avatar_man_soccer\",       // 4\n  \"avatar_man_sunglasses\",   // 5\n  \"avatar_man_construction\", // 6\n  \"avatar_man_thumbsup\",     // 7\n  \"avatar_man_scholar\",      // 8\n  // Women avatars - cartoon/neon/pixel styles (3 total)\n  \"avatar_woman_cartoon\",    // 9\n  \"avatar_woman_pixel\",      // 10\n  \"avatar_woman_neon\",       // 11\n  // Female avatars - hijab/traditional styles (13 total)\n  \"avatar_woman_hijab_book\",     // 12\n  \"avatar_woman_hijab_dua\",      // 13\n  \"avatar_woman_hijab_tasbih\",   // 14\n  \"avatar_woman_hijab_studying\", // 15\n  \"avatar_woman_hijab_beads\",    // 16\n  \"avatar_woman_niqab\",          // 17 - HIDDEN from selection\n  \"avatar_woman_crown\",          // 18\n  \"avatar_woman_cooking\",        // 19\n  \"avatar_woman_elder_cane\",     // 20\n  \"avatar_woman_hawa\",           // 21\n  \"avatar_woman_hijab_pink\",     // 22\n  \"avatar_woman_hijab_tan\",      // 23\n  \"avatar_woman_hijab_purse\",    // 24\n  // Other avatars (6 total)\n  \"avatar_dino\",             // 25\n  \"avatar_fox\",              // 26\n  \"avatar_panda\",            // 27 - HIDDEN from selection\n  \"avatar_rabbit\",           // 28\n  \"avatar_robot\",            // 29\n  \"avatar_unicorn\",          // 30\n];\n\n// Avatars hidden from user selection (but still valid in DB)\nexport const HIDDEN_AVATARS = [\"avatar_panda\"];\n\n// AVAILABLE_AVATARS = what users can select in UI (excludes hidden avatars)\nexport const AVAILABLE_AVATARS = HISTORICAL_AVATARS.filter(\n  (key) => !HIDDEN_AVATARS.includes(key) && !HIDDEN_NINJA_AVATARS.includes(key)\n);\n\n// Legacy avatar key mappings (for simulated friends and old data)\nconst LEGACY_AVATAR_MAP = {\n  avatar1: \"avatar_man_lantern\",\n  avatar2: \"avatar_woman_hijab_book\",\n  avatar3: \"avatar_man_soccer\",\n  avatar4: \"avatar_woman_hijab_dua\",\n  avatar5: \"avatar_fox\",\n  avatar6: \"avatar_rabbit\",\n  // Map removed avatars to safe alternatives\n  avatar_panda: \"avatar_fox\",\n  avatar_woman_niqab: \"avatar_woman_hijab_book\",\n};\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üîê SPECIAL USER DETECTION\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n/**\n * Check if a user is The Dev account (gets male ninja)\n * @param {string} userId - User ID\n * @param {string} nickname - User nickname (unused, kept for API compatibility)\n * @returns {boolean} True if this is The Dev NPC\n */\nexport function isDevAccount(userId, nickname) {\n  return userId === DEV_USER_ID;\n}\n\n/**\n * Check if a user is the special user (gets female ninja)\n * This will be activated after Supabase integration\n * @param {string} userId - User ID\n * @param {string} nickname - User nickname (unused, kept for future)\n * @returns {boolean} True if this is the special user\n */\nexport function isSpecialUser(userId, nickname) {\n  // Will be activated when SPECIAL_USER_ID is set via Supabase\n  if (!SPECIAL_USER_ID) return false;\n  return userId === SPECIAL_USER_ID;\n}\n\n/**\n * Check if an avatar key is a hidden ninja avatar\n * @param {string} avatarKey - Avatar key to check\n * @returns {boolean} True if this is a hidden ninja avatar\n */\nexport function isHiddenNinjaAvatar(avatarKey) {\n  return HIDDEN_NINJA_AVATARS.includes(avatarKey);\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üé≠ AVATAR IMAGE RETRIEVAL\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n/**\n * Get proper avatar image from any avatar key\n * Handles hidden ninja avatars, user selection, and fallbacks\n * @param {string} avatarKey - Avatar key (can be legacy or proper key)\n * @param {object} options - Options { userId, nickname, isDevCheck }\n * @returns {string} Avatar image path\n */\nexport function getAvatarImage(avatarKey, options = {}) {\n  const { userId, nickname, isDevCheck = true } = options;\n  \n  // PRIORITY 0: FORCE current user to always use their selected avatar from store\n  // This ensures the store is the single source of truth for the logged-in user\n  const { id: currentUserId, avatar: currentUserAvatar } = useUserStore.getState();\n  if (userId === currentUserId) {\n    // Current user must have their selected avatar, always\n    if (currentUserAvatar && assets.avatars[currentUserAvatar]) {\n      return assets.avatars[currentUserAvatar];\n    }\n    // Fallback: return a valid default if no avatar is set\n    return assets.avatars[AVAILABLE_AVATARS[0]];\n  }\n  \n  // PRIORITY 1: Check if this is The Dev (gets male ninja)\n  if (isDevCheck && isDevAccount(userId, nickname)) {\n    return assets.avatars[NINJA_MALE_KEY];\n  }\n  \n  // PRIORITY 2: Check if this is the special user (gets female ninja)\n  // This will automatically work when SPECIAL_USER_ID is set via Supabase\n  if (isDevCheck && isSpecialUser(userId, nickname)) {\n    return assets.avatars[NINJA_FEMALE_KEY];\n  }\n  \n  // PRIORITY 3: Map legacy avatar keys to proper keys\n  let properKey = avatarKey;\n  if (avatarKey && LEGACY_AVATAR_MAP[avatarKey]) {\n    properKey = LEGACY_AVATAR_MAP[avatarKey];\n  }\n  \n  // PRIORITY 4: HIDDEN NINJA PROTECTION\n  // If avatar is a hidden ninja but user is NOT authorized, assign fallback\n  if (isHiddenNinjaAvatar(properKey)) {\n    const isAuthorizedForNinja = \n      (properKey === NINJA_MALE_KEY && isDevAccount(userId, nickname)) ||\n      (properKey === NINJA_FEMALE_KEY && isSpecialUser(userId, nickname));\n    \n    if (!isAuthorizedForNinja) {\n      // Unauthorized user trying to use ninja avatar - assign deterministic fallback\n      properKey = getRandomAvatar(userId);\n    }\n  }\n  \n  // PRIORITY 5: Return avatar if it exists in assets\n  if (properKey && assets.avatars[properKey]) {\n    return assets.avatars[properKey];\n  }\n  \n  // PRIORITY 6: Final fallback - assign deterministic avatar\n  const deterministicKey = getRandomAvatar(userId);\n  return assets.avatars[deterministicKey];\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üé≤ DETERMINISTIC AVATAR ASSIGNMENT\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n/**\n * Get a deterministic avatar key based on userId (NOT random!)\n * Uses userId as seed to ensure same user always gets same avatar\n * Only returns avatars from AVAILABLE_AVATARS (excludes hidden ninjas)\n * @param {string} userId - User ID to use as seed\n * @returns {string} Deterministic avatar key\n */\nexport function getRandomAvatar(userId = null) {\n  if (!userId) {\n    // Fallback: return first avatar if no userId provided\n    return AVAILABLE_AVATARS[0];\n  }\n  \n  // Create deterministic seed from userId\n  let seed = 0;\n  for (let i = 0; i < userId.length; i++) {\n    seed += userId.charCodeAt(i);\n  }\n  \n  // Use seed to get consistent avatar index\n  // Only from AVAILABLE_AVATARS (excludes hidden ninjas)\n  const avatarIndex = seed % AVAILABLE_AVATARS.length;\n  return AVAILABLE_AVATARS[avatarIndex];\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üë• USER AVATAR ASSIGNMENT (Leaderboards & Lists)\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n/**\n * Assign avatars to users without proper avatars\n * Used for leaderboards, simulated friends, etc.\n * Handles hidden ninja avatars and special user detection\n * @param {Array} users - Array of user objects with avatar property\n * @param {object} options - Options { userIdKey, nicknameKey, avatarKey }\n * @returns {Array} Users with proper avatars assigned\n */\nexport function assignAvatarsToUsers(users, options = {}) {\n  const {\n    userIdKey = \"userId\",\n    nicknameKey = \"nickname\",\n    avatarKey = \"avatar\",\n  } = options;\n  \n  return users.map((user, index) => {\n    const userId = user[userIdKey];\n    const nickname = user[nicknameKey];\n    const currentAvatar = user[avatarKey];\n    \n    // Get proper avatar image key\n    let properAvatarKey = currentAvatar;\n    \n    // Check if The Dev (gets male ninja)\n    if (isDevAccount(userId, nickname)) {\n      properAvatarKey = NINJA_MALE_KEY;\n    }\n    // Check if special user (gets female ninja)\n    else if (isSpecialUser(userId, nickname)) {\n      properAvatarKey = NINJA_FEMALE_KEY;\n    }\n    // Map legacy keys\n    else if (currentAvatar && LEGACY_AVATAR_MAP[currentAvatar]) {\n      properAvatarKey = LEGACY_AVATAR_MAP[currentAvatar];\n    }\n    // Prevent unauthorized users from using hidden ninja avatars\n    else if (isHiddenNinjaAvatar(currentAvatar)) {\n      properAvatarKey = getRandomAvatar(userId);\n    }\n    // If no avatar or invalid avatar, assign deterministic fallback\n    else if (!currentAvatar || !assets.avatars[currentAvatar]) {\n      // Use deterministic assignment based on user index for consistency\n      const seed = userId ? userId.length + index : index;\n      const avatarIndex = seed % AVAILABLE_AVATARS.length;\n      properAvatarKey = AVAILABLE_AVATARS[avatarIndex];\n    }\n    \n    return {\n      ...user,\n      [avatarKey]: properAvatarKey,\n    };\n  });\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üî¢ AVATAR INDEX MAPPING (For Supabase integer column)\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// Supabase stores avatar as integer. These functions convert between\n// string keys (used in app) and integer indices (stored in DB).\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n// Complete list of ALL avatars including hidden ninjas (for DB mapping)\n// Uses HISTORICAL_AVATARS to maintain stable indices for existing DB records\nexport const ALL_AVATARS = [\n  ...HISTORICAL_AVATARS,\n  NINJA_MALE_KEY,\n  NINJA_FEMALE_KEY,\n];\n\n/**\n * Convert avatar string key to integer index for Supabase storage\n * Normalizes legacy keys and removed avatar keys before lookup\n * @param {string} avatarKey - Avatar key like \"avatar_woman_crown\"\n * @returns {number} Integer index (defaults to 0 if not found after normalization)\n */\nexport function avatarKeyToIndex(avatarKey) {\n  if (!avatarKey) {\n    console.warn(\"[avatarKeyToIndex] No avatar key provided, defaulting to index 0\");\n    return 0;\n  }\n  \n  // Normalize the key - check legacy mappings first\n  let normalizedKey = avatarKey;\n  if (LEGACY_AVATAR_MAP[avatarKey]) {\n    normalizedKey = LEGACY_AVATAR_MAP[avatarKey];\n    console.log(`[avatarKeyToIndex] Normalized legacy key ${avatarKey} ‚Üí ${normalizedKey}`);\n  }\n  \n  // Try to find in ALL_AVATARS\n  let index = ALL_AVATARS.indexOf(normalizedKey);\n  \n  // If still not found, try stripping any path or extension (for asset URLs)\n  if (index < 0 && normalizedKey.includes(\"/\")) {\n    const keyFromPath = normalizedKey.split(\"/\").pop()?.replace(/\\.(webp|png|jpg)$/i, \"\");\n    if (keyFromPath) {\n      index = ALL_AVATARS.indexOf(keyFromPath);\n      if (index >= 0) {\n        console.log(`[avatarKeyToIndex] Extracted key from path: ${keyFromPath}`);\n      }\n    }\n  }\n  \n  if (index < 0) {\n    console.warn(`[avatarKeyToIndex] Unknown avatar key \"${avatarKey}\", defaulting to index 0`);\n    return 0;\n  }\n  \n  return index;\n}\n\n/**\n * Convert integer index from Supabase to avatar string key\n * @param {number} index - Integer index from database\n * @returns {string|null} Avatar key or null if invalid index\n */\nexport function avatarIndexToKey(index) {\n  if (index === null || index === undefined || index < 0 || index >= ALL_AVATARS.length) {\n    return null;\n  }\n  return ALL_AVATARS[index];\n}\n\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n// üß™ SIMULATED FRIENDS (For Testing)\n// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n/**\n * Get avatar keys for simulated friends (6 different avatars)\n * Only returns non-hidden avatars\n * @returns {Array<string>} Array of 6 avatar keys\n */\nexport function getSimulatedFriendsAvatars() {\n  return [\n    \"avatar_man_cup\",\n    \"avatar_woman_hijab_pen\",\n    \"avatar_fox\",\n    \"avatar_woman_hijab_studying\",\n    \"avatar_robot\",\n    \"avatar_woman_hijab_tasbih\",\n  ];\n}\n","path":null,"size_bytes":16684,"size_tokens":null},"src/utils/avatarOverride.js":{"content":"import { useUserStore } from \"../store/useUserStore\";\nimport { getAvatarImage } from \"./avatarUtils\";\n\n// This function is used EVERYWHERE avatars are rendered (friends, leaderboard, events, etc.)\n// It ensures that whenever the \"current user\" is shown, we ALWAYS use the profile avatar.\nexport function applyAvatarOverride(player) {\n  const { id: currentUserId, name: currentUserName, avatar: currentAvatar } = useUserStore.getState();\n\n  // If nothing passed, just return current user's avatar\n  if (!player) {\n    return getAvatarImage(currentAvatar, { userId: currentUserId, nickname: currentUserName });\n  }\n\n  // Detect if this row/card is the logged-in user\n  const isCurrentUser =\n    player.id === currentUserId ||\n    player.id === \"current_user\" ||\n    player.name === currentUserName ||\n    player.name === \"You\";\n\n  const finalAvatarId = isCurrentUser ? currentAvatar : player.avatar;\n\n  return getAvatarImage(finalAvatarId, { userId: player.id, nickname: player.name });\n}\n","path":null,"size_bytes":987,"size_tokens":null},"src/hooks/useAnalytics.js":{"content":"import { logEvent, ANALYTICS_EVENTS } from \"../services/analyticsService\";\n\nexport { ANALYTICS_EVENTS };\n\nexport const useAnalytics = () => {\n  return logEvent;\n};\n","path":null,"size_bytes":164,"size_tokens":null},"src/hooks/useOnlineStatus.js":{"content":"import { useState, useEffect } from \"react\";\n\nexport function useOnlineStatus() {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener(\"online\", handleOnline);\n    window.addEventListener(\"offline\", handleOffline);\n\n    return () => {\n      window.removeEventListener(\"online\", handleOnline);\n      window.removeEventListener(\"offline\", handleOffline);\n    };\n  }, []);\n\n  return isOnline;\n}\n","path":null,"size_bytes":553,"size_tokens":null},"src/components/OfflineConnectionBanner.jsx":{"content":"import React from \"react\";\nimport { useOnlineStatus } from \"../hooks/useOnlineStatus\";\n\nexport default function OfflineConnectionBanner() {\n  const isOnline = useOnlineStatus();\n\n  if (isOnline) return null;\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        right: 0,\n        background: \"linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%)\",\n        color: \"white\",\n        padding: \"12px 16px\",\n        textAlign: \"center\",\n        fontSize: \"0.95rem\",\n        fontWeight: \"600\",\n        zIndex: 9998,\n        boxShadow: \"0 4px 12px rgba(0, 0, 0, 0.3)\",\n      }}\n    >\n      ‚ö†Ô∏è No connection ‚Äî some features may not work offline\n    </div>\n  );\n}\n","path":null,"size_bytes":739,"size_tokens":null},"src/components/ExitConfirmationModal.jsx":{"content":"import React from \"react\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\n\nexport default function ExitConfirmationModal({ onConfirm, onCancel }) {\n  const { showModal } = useModalStore();\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        background: \"rgba(0,0,0,0.6)\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        zIndex: 9999,\n        padding: \"20px\",\n      }}\n    >\n      <div\n        style={{\n          background: \"#0a2a43\",\n          border: \"1px solid rgba(212, 175, 55, 0.3)\",\n          borderRadius: \"16px\",\n          padding: \"32px 24px\",\n          maxWidth: \"320px\",\n          textAlign: \"center\",\n          boxShadow: \"0 8px 32px rgba(0,0,0,0.5)\",\n        }}\n      >\n        <p\n          style={{\n            color: \"rgba(255,255,255,0.9)\",\n            fontSize: \"1.05rem\",\n            marginBottom: \"28px\",\n            lineHeight: \"1.5\",\n            fontWeight: 500,\n          }}\n        >\n          Are you sure you want to exit mid-challenge? You'll lose your progress.\n        </p>\n\n        <div\n          style={{\n            display: \"flex\",\n            gap: \"12px\",\n          }}\n        >\n          <button\n            onClick={onCancel}\n            style={{\n              flex: 1,\n              background: \"transparent\",\n              border: \"1px solid rgba(212, 175, 55, 0.4)\",\n              color: \"#D4AF37\",\n              padding: \"12px 16px\",\n              borderRadius: \"8px\",\n              fontSize: \"0.95rem\",\n              fontWeight: \"600\",\n              cursor: \"pointer\",\n              transition: \"all 0.3s\",\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = \"rgba(212, 175, 55, 0.1)\";\n              e.currentTarget.style.borderColor = \"rgba(212, 175, 55, 0.6)\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = \"transparent\";\n              e.currentTarget.style.borderColor = \"rgba(212, 175, 55, 0.4)\";\n            }}\n          >\n            Cancel\n          </button>\n\n          <button\n            onClick={onConfirm}\n            style={{\n              flex: 1,\n              background: \"linear-gradient(135deg, #D4AF37 0%, #FFA500 100%)\",\n              color: \"#0a2a43\",\n              border: \"none\",\n              padding: \"12px 16px\",\n              borderRadius: \"8px\",\n              fontSize: \"0.95rem\",\n              fontWeight: \"700\",\n              cursor: \"pointer\",\n              transition: \"all 0.3s\",\n              boxShadow: \"0 4px 12px rgba(212, 175, 55, 0.3)\",\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.boxShadow = \"0 6px 16px rgba(212, 175, 55, 0.5)\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.boxShadow = \"0 4px 12px rgba(212, 175, 55, 0.3)\";\n            }}\n          >\n            Exit\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3055,"size_tokens":null},"src/config/versionConfig.js":{"content":"// Version configuration for update checking\nexport const LOCAL_VERSION = \"1.0.0\";\nexport const REMOTE_VERSION = \"1.0.0\"; // Can be updated to trigger update banner\n\nexport function shouldShowUpdateBanner() {\n  return REMOTE_VERSION > LOCAL_VERSION;\n}\n","path":null,"size_bytes":252,"size_tokens":null},"src/hooks/useRewards.js":{"content":"// src/hooks/useRewards.js\n// Centralized rewards management - single source of truth for XP and coin updates\nimport { useProgressStore } from '../store/progressStore';\nimport { useAnalytics } from './useAnalytics';\n\nexport const useRewards = () => {\n  const analytics = useAnalytics();\n\n  /**\n   * Add XP with automatic level-up checking\n   * @param {number} amount - XP to add\n   * @param {string} source - Where the XP came from (quiz, challenge, daily_quest, etc)\n   */\n  const addXP = (amount, source = 'unknown') => {\n    if (!amount || amount <= 0) return;\n    useProgressStore.getState().addXP(amount);\n    analytics('xp_earned', { amount, source });\n  };\n\n  /**\n   * Add coins\n   * @param {number} amount - Coins to add\n   * @param {string} source - Where the coins came from\n   */\n  const addCoins = (amount, source = 'unknown') => {\n    if (!amount || amount <= 0) return;\n    useProgressStore.getState().addCoins(amount);\n    analytics('coins_earned', { amount, source });\n  };\n\n  /**\n   * Add both XP and coins together (common reward pattern)\n   * @param {Object} rewards - { xp, coins }\n   * @param {string} source - Where the rewards came from\n   */\n  const addRewards = ({ xp, coins }, source = 'unknown') => {\n    if (xp) addXP(xp, source);\n    if (coins) addCoins(coins, source);\n  };\n\n  return {\n    addXP,\n    addCoins,\n    addRewards,\n  };\n};\n","path":null,"size_bytes":1365,"size_tokens":null},"src/components/ErrorBoundary.jsx":{"content":"import React from \"react\";\n\nexport default class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error(\"üî¥ Error Boundary caught:\", error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            height: \"100vh\",\n            background: \"#0a2a43\",\n            color: \"white\",\n            textAlign: \"center\",\n            padding: \"20px\",\n            flexDirection: \"column\",\n            gap: \"20px\",\n          }}\n        >\n          <h1 style={{ fontSize: \"1.5rem\", fontWeight: 600 }}>‚ö†Ô∏è Oops!</h1>\n          <p style={{ fontSize: \"1rem\", opacity: 0.9 }}>\n            Something went wrong ‚Äî please restart the app.\n          </p>\n          <button\n            onClick={() => window.location.reload()}\n            style={{\n              background: \"#D4AF37\",\n              color: \"#0a2a43\",\n              border: \"none\",\n              padding: \"12px 24px\",\n              borderRadius: \"8px\",\n              fontSize: \"0.95rem\",\n              fontWeight: 600,\n              cursor: \"pointer\",\n              marginTop: \"12px\",\n            }}\n          >\n            Restart\n          </button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"src/hooks/useVibration.js":{"content":"import { useProgressStore } from \"../store/progressStore\";\n\nexport function useVibration() {\n  const vibrationEnabled = useProgressStore((state) => state.vibrationEnabled);\n\n  const vibrate = (pattern) => {\n    if (!vibrationEnabled) return;\n    \n    try {\n      // Check for vibration API (standard and webkit prefixed)\n      const vibrationAPI = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate;\n      \n      if (vibrationAPI) {\n        // Call on navigator object to maintain context\n        if (navigator.vibrate) {\n          navigator.vibrate(pattern);\n        } else if (navigator.webkitVibrate) {\n          navigator.webkitVibrate(pattern);\n        } else if (navigator.mozVibrate) {\n          navigator.mozVibrate(pattern);\n        } else if (navigator.msVibrate) {\n          navigator.msVibrate(pattern);\n        }\n      }\n    } catch (e) {\n      // Silently fail - vibration API may not be available on all devices\n    }\n  };\n\n  return { vibrate, vibrationEnabled };\n}\n","path":null,"size_bytes":1022,"size_tokens":null},"src/components/ModalBase.css":{"content":"/* ModalBase Universal Styles */\n\n.modal-base-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.95);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 16px;\n  padding-top: max(16px, env(safe-area-inset-top, 16px));\n  padding-right: max(16px, env(safe-area-inset-right, 16px));\n  padding-bottom: max(16px, env(safe-area-inset-bottom, 16px));\n  padding-left: max(16px, env(safe-area-inset-left, 16px));\n  overflow-y: auto;\n  animation: fadeIn 0.2s ease;\n}\n\n.modal-base-card {\n  background: linear-gradient(135deg, #1a3a52 0%, #0B1E2D 100%);\n  border: 2px solid rgba(212, 175, 55, 0.3);\n  border-radius: 20px;\n  padding: 24px;\n  width: 100%;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 30px rgba(212, 175, 55, 0.2);\n  animation: slideUp 0.3s ease;\n  text-align: center;\n}\n\n.modal-base-mascot-container {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 16px;\n}\n\n.modal-base-mascot {\n  width: 100px;\n  height: auto;\n  filter: drop-shadow(0 6px 15px rgba(212, 175, 55, 0.3));\n}\n\n.modal-base-mascot.float {\n  animation: float 3s ease-in-out infinite;\n}\n\n.modal-base-mascot.bounce {\n  animation: bounce 0.6s ease-in-out infinite;\n}\n\n.modal-base-mascot.celebrate {\n  animation: celebrate 1s ease-in-out infinite;\n}\n\n.modal-base-title {\n  color: #fff;\n  font-size: 1.6rem;\n  font-weight: 700;\n  margin: 0 0 16px 0;\n  background: linear-gradient(90deg, #FFD700 0%, #FFA500 50%, #FFD700 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n}\n\n.modal-base-content {\n  color: #e2e8f0;\n  font-size: 0.95rem;\n  line-height: 1.6;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slideUp {\n  from {\n    transform: translateY(30px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n@keyframes float {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-10px); }\n}\n\n@keyframes bounce {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-15px); }\n}\n\n@keyframes celebrate {\n  0%, 100% { transform: rotate(-5deg) scale(1); }\n  50% { transform: rotate(5deg) scale(1.05); }\n}\n","path":null,"size_bytes":2295,"size_tokens":null},"src/pages/Settings.jsx":{"content":"import React, { useState } from \"react\";\nimport ScreenContainer from \"../components/ScreenContainer\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { ChevronLeft, Trash2 } from \"lucide-react\";\nimport DeleteAccountModal from \"../components/DeleteAccountModal\";\nimport { logEvent, ANALYTICS_EVENTS } from \"../services/analyticsService\";\n\nexport default function Settings() {\n  const navigate = useNavigate();\n  const { \n    vibrationEnabled, \n    setVibrationEnabled, \n    resetAllProgress\n  } = useProgressStore();\n  const { resetUserData, setOnboarded } = useUserStore();\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  const handleVibrationToggle = () => {\n    setVibrationEnabled(!vibrationEnabled);\n    if (!vibrationEnabled && navigator.vibrate) {\n      navigator.vibrate(50);\n    }\n  };\n\n  const handleLogout = async () => {\n    logEvent(ANALYTICS_EVENTS.LOGOUT, {});\n    \n    try {\n      await supabase.auth.signOut();\n    } catch (err) {\n      console.error(\"Logout failed:\", err);\n    }\n\n    resetUserData();\n    resetAllProgress();\n    setOnboarded(false);\n    \n    localStorage.setItem(\"iq_onboarding_step\", \"auth\");\n\n    navigate(\"/auth\", { replace: true });\n  };\n\n  const handleDeleteAccount = async () => {\n    setIsDeleting(true);\n    \n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      \n      if (!session?.user?.id) {\n        console.error(\"No active session for account deletion\");\n        setIsDeleting(false);\n        return;\n      }\n\n      const userId = session.user.id;\n      console.log(\"üóëÔ∏è Starting account deletion for user:\", userId);\n\n      // Delete user data from all tables (order matters for foreign key constraints)\n      const tablesToDelete = [\n        \"friend_challenges\",\n        \"event_entries\",\n        \"revision_items\",\n        \"daily_quests\",\n        \"lesson_progress\",\n        \"challenge_logs\",\n        \"xp_logs\",\n        \"streak_logs\",\n        \"leaderboard_snapshots\",\n        \"push_tokens\",\n        \"purchases\",\n        \"profiles\"\n      ];\n\n      for (const table of tablesToDelete) {\n        const { error } = await supabase\n          .from(table)\n          .delete()\n          .eq(\"user_id\", userId);\n        \n        if (error) {\n          console.warn(`Warning deleting from ${table}:`, error.message);\n          // Continue with other tables even if one fails\n        } else {\n          console.log(`‚úÖ Deleted from ${table}`);\n        }\n      }\n\n      // Log the deletion event before signing out\n      logEvent(ANALYTICS_EVENTS.ACCOUNT_DELETED, {});\n\n      // Sign out the user\n      await supabase.auth.signOut();\n      \n      // Clear all local data\n      resetUserData();\n      resetAllProgress();\n      setOnboarded(false);\n      \n      // Clear localStorage items\n      localStorage.removeItem(\"iq_hidden_identity_v1\");\n      localStorage.removeItem(\"iq_onboarding_step\");\n      localStorage.removeItem(\"iq_profile_complete\");\n      localStorage.removeItem(\"iq_user_store\");\n      localStorage.removeItem(\"iq_progress_store\");\n      localStorage.removeItem(\"iq_revise_store\");\n      localStorage.removeItem(\"iq_daily_quests\");\n      localStorage.removeItem(\"iq_challenge_store\");\n      \n      console.log(\"‚úÖ Account deletion complete\");\n      \n      setShowDeleteModal(false);\n      navigate(\"/goodbye\", { replace: true });\n      \n    } catch (err) {\n      console.error(\"Account deletion error:\", err);\n      setIsDeleting(false);\n    }\n  };\n\n  return (\n    <ScreenContainer>\n      <div\n        style={{\n          padding: \"20px 20px 90px\",\n          color: \"white\",\n        }}\n      >\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: 12,\n            marginBottom: 32,\n          }}\n        >\n          <button\n            onClick={() => navigate(\"/profile\")}\n            style={{\n              background: \"transparent\",\n              border: \"none\",\n              color: \"#4fd5ff\",\n              cursor: \"pointer\",\n              display: \"flex\",\n              alignItems: \"center\",\n              padding: 0,\n            }}\n          >\n            <ChevronLeft size={24} />\n          </button>\n          <h1\n            style={{\n              fontSize: \"1.6rem\",\n              fontWeight: 800,\n              margin: 0,\n              background: \"linear-gradient(90deg, #FFD700, #FFA500)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n            }}\n          >\n            Settings\n          </h1>\n        </div>\n\n        <div\n          style={{\n            maxWidth: 400,\n            margin: \"0 auto\",\n            padding: 20,\n            background: \"rgba(79, 213, 255, 0.05)\",\n            border: \"1px solid rgba(79, 213, 255, 0.2)\",\n            borderRadius: 16,\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: 12,\n          }}\n        >\n          <div\n            style={{\n              background: \"rgba(255, 255, 255, 0.03)\",\n              padding: 14,\n              borderRadius: 12,\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n            }}\n          >\n            <span style={{ color: \"#cbd5e1\", fontSize: \"0.9rem\" }}>\n              üîä Vibration (Haptics)\n            </span>\n            <button\n              onClick={handleVibrationToggle}\n              style={{\n                background: vibrationEnabled\n                  ? \"linear-gradient(135deg, #10b981, #059669)\"\n                  : \"rgba(255, 255, 255, 0.1)\",\n                border: \"1px solid rgba(79, 213, 255, 0.3)\",\n                borderRadius: 20,\n                padding: \"6px 14px\",\n                color: vibrationEnabled ? \"white\" : \"#4fd5ff\",\n                fontWeight: \"600\",\n                cursor: \"pointer\",\n                fontSize: \"0.85rem\",\n                transition: \"all 0.3s\",\n              }}\n            >\n              {vibrationEnabled ? \"ON\" : \"OFF\"}\n            </button>\n          </div>\n\n          <div\n            style={{\n              background: \"rgba(255, 255, 255, 0.03)\",\n              padding: 14,\n              borderRadius: 12,\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n            }}\n          >\n            <span style={{ color: \"#cbd5e1\", fontSize: \"0.9rem\" }}>\n              App Version\n            </span>\n            <span style={{ color: \"#d4af37\", fontSize: \"0.9rem\", fontWeight: 600 }}>\n              Islam Quest v1.0.0\n            </span>\n          </div>\n        </div>\n\n        <div\n          style={{\n            maxWidth: 400,\n            margin: \"20px auto 0\",\n            padding: 20,\n            background: \"rgba(79, 213, 255, 0.05)\",\n            border: \"1px solid rgba(79, 213, 255, 0.2)\",\n            borderRadius: 16,\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: 12,\n          }}\n        >\n          <a\n            href=\"https://play.google.com/store\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            style={{ textDecoration: \"none\", display: \"block\" }}\n          >\n            <button\n              style={{\n                background: \"linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(244, 208, 63, 0.1) 100%)\",\n                border: \"1px solid rgba(212, 175, 55, 0.3)\",\n                borderRadius: 12,\n                padding: \"12px 16px\",\n                color: \"#d4af37\",\n                fontWeight: \"600\",\n                fontSize: \"0.9rem\",\n                width: \"100%\",\n                cursor: \"pointer\",\n                transition: \"all 0.2s ease\",\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.background = \"linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(244, 208, 63, 0.2) 100%)\";\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.background = \"linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(244, 208, 63, 0.1) 100%)\";\n              }}\n            >\n              ‚≠ê Rate this App\n            </button>\n          </a>\n\n          <button\n            onClick={handleLogout}\n            style={{\n              background: \"linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(185, 28, 28, 0.1) 100%)\",\n              border: \"1px solid rgba(239, 68, 68, 0.3)\",\n              borderRadius: 12,\n              padding: \"12px 16px\",\n              color: \"#ef4444\",\n              fontWeight: \"600\",\n              fontSize: \"0.9rem\",\n              width: \"100%\",\n              cursor: \"pointer\",\n              marginTop: \"8px\",\n              transition: \"all 0.2s ease\",\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = \"linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(185, 28, 28, 0.2) 100%)\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = \"linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(185, 28, 28, 0.1) 100%)\";\n            }}\n          >\n            Log Out\n          </button>\n        </div>\n\n        <div\n          style={{\n            maxWidth: 400,\n            margin: \"32px auto 0\",\n            padding: \"0 20px\",\n          }}\n        >\n          <div\n            style={{\n              height: 1,\n              background: \"linear-gradient(90deg, transparent 0%, rgba(239, 68, 68, 0.3) 50%, transparent 100%)\",\n              marginBottom: 20,\n            }}\n          />\n          \n          <button\n            onClick={() => setShowDeleteModal(true)}\n            style={{\n              background: \"transparent\",\n              border: \"1px solid rgba(239, 68, 68, 0.2)\",\n              borderRadius: 12,\n              padding: \"14px 16px\",\n              color: \"rgba(239, 68, 68, 0.7)\",\n              fontWeight: \"500\",\n              fontSize: \"0.9rem\",\n              width: \"100%\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s ease\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              gap: 8,\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = \"rgba(239, 68, 68, 0.05)\";\n              e.currentTarget.style.borderColor = \"rgba(239, 68, 68, 0.3)\";\n              e.currentTarget.style.color = \"#ef4444\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = \"transparent\";\n              e.currentTarget.style.borderColor = \"rgba(239, 68, 68, 0.2)\";\n              e.currentTarget.style.color = \"rgba(239, 68, 68, 0.7)\";\n            }}\n          >\n            <Trash2 size={16} />\n            Delete My Account\n          </button>\n        </div>\n      </div>\n\n      <DeleteAccountModal\n        isOpen={showDeleteModal}\n        onClose={() => setShowDeleteModal(false)}\n        onConfirm={handleDeleteAccount}\n        isDeleting={isDeleting}\n      />\n    </ScreenContainer>\n  );\n}\n","path":null,"size_bytes":11268,"size_tokens":null},"src/components/ModalBase.jsx":{"content":"import React from \"react\";\nimport \"./ModalBase.css\";\n\nexport default function ModalBase({\n  children,\n  onClose,\n  title,\n  maxWidth = \"500px\",\n  showMascot = null,\n  mascotAnimation = \"float\",\n}) {\n  return (\n    <div className=\"modal-base-overlay\" onClick={onClose}>\n      <div \n        className=\"modal-base-card\" \n        onClick={(e) => e.stopPropagation()}\n        style={{ maxWidth }}\n      >\n        {/* Mascot Header (optional) */}\n        {showMascot && (\n          <div className=\"modal-base-mascot-container\">\n            <img\n              src={showMascot}\n              alt=\"Mascot\"\n              className={`modal-base-mascot ${mascotAnimation}`}\n            />\n          </div>\n        )}\n\n        {/* Title (optional) */}\n        {title && <h2 className=\"modal-base-title\">{title}</h2>}\n\n        {/* Content */}\n        <div className=\"modal-base-content\">\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":941,"size_tokens":null},"src/components/PurchaseStreakFreezeModal.css":{"content":"/* Streak Freeze Modal Styles */\n\n.streak-freeze-content {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.info-card {\n  background: rgba(212, 175, 55, 0.1);\n  border: 1px solid rgba(212, 175, 55, 0.3);\n  border-radius: 16px;\n  padding: 18px;\n  margin-bottom: 8px;\n}\n\n.shield-info {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 14px;\n}\n\n.shield-emoji {\n  font-size: 2.5rem;\n  flex-shrink: 0;\n}\n\n.shield-text {\n  text-align: left;\n}\n\n.shield-title {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: #d4af37;\n  margin-bottom: 4px;\n}\n\n.shield-count {\n  font-size: 0.85rem;\n  opacity: 0.8;\n  color: #cbd5e1;\n}\n\n.description {\n  font-size: 0.95rem;\n  color: #e2e8f0;\n  line-height: 1.6;\n  margin: 0;\n}\n\n.cost-display {\n  background: rgba(16, 185, 129, 0.1);\n  border: 1px solid rgba(16, 185, 129, 0.3);\n  border-radius: 12px;\n  padding: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 10px;\n  margin: 12px 0;\n}\n\n.cost-amount {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: #d4af37;\n}\n\n.balance-text {\n  font-size: 0.85rem;\n  opacity: 0.7;\n  color: #cbd5e1;\n  text-align: center;\n}\n\n.modal-actions {\n  display: flex;\n  gap: 12px;\n  margin-top: 20px;\n}\n\n.btn-primary,\n.btn-secondary {\n  flex: 1;\n  padding: 14px 20px;\n  border-radius: 12px;\n  font-weight: 700;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n  color: white;\n  text-align: center;\n  white-space: nowrap;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #D4AF37, #FFA500);\n  box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);\n  color: #0a2a43;\n  font-weight: 700;\n}\n\n.btn-primary:not(:disabled):active {\n  transform: scale(0.98);\n}\n\n.btn-primary:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.btn-secondary:active {\n  background: rgba(255, 255, 255, 0.15);\n}\n","path":null,"size_bytes":1947,"size_tokens":null},"src/pages/FriendProfile.jsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { useFriendsStore } from \"../store/friendsStore\";\nimport { useModalStore, MODAL_TYPES } from \"../store/modalStore\";\nimport { motion } from \"framer-motion\";\nimport { ArrowLeft, UserMinus, Trophy, Flame, Coins, Shield } from \"lucide-react\";\nimport { LevelBadgeCompact } from \"../components/LevelBadge\";\nimport { getAvatarImage } from \"../utils/avatarUtils\";\nimport { getCurrentLevel } from \"../utils/diamondLevels\";\n\nexport default function FriendProfile() {\n  const { userId } = useParams();\n  const navigate = useNavigate();\n  const { getProfileById, removeFriend, isFriend } = useFriendsStore();\n  const { showModal } = useModalStore();\n\n  const [user, setUser] = useState(null);\n  const [isUserFriend, setIsUserFriend] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const loadProfile = async () => {\n      if (!userId) {\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      try {\n        const profile = await getProfileById(userId);\n        setUser(profile);\n        setIsUserFriend(isFriend(userId));\n      } catch (err) {\n        console.warn(\"Failed to load profile:\", err);\n        setUser(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadProfile();\n  }, [userId, getProfileById, isFriend]);\n\n  const handleRemoveFriend = () => {\n    showModal(MODAL_TYPES.CONFIRM, {\n      title: \"Remove Friend?\",\n      message: `Are you sure you want to remove ${user.username || user.handle || \"this user\"} from your friends?`,\n      confirmText: \"Remove\",\n      cancelText: \"Cancel\",\n      onConfirm: async () => {\n        const result = await removeFriend(userId);\n        if (result.success) {\n          showModal(MODAL_TYPES.SUCCESS, {\n            message: result.message,\n            onClose: () => navigate(\"/friends\"),\n          });\n        } else {\n          showModal(MODAL_TYPES.ERROR, {\n            message: result.error,\n          });\n        }\n      },\n    });\n  };\n\n  if (loading) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"#0B1E2D\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          color: \"white\",\n          minHeight: \"100vh\",\n        }}\n      >\n        <p>Loading profile...</p>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div\n        className=\"screen no-extra-space\"\n        style={{\n          background: \"#0B1E2D\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          color: \"white\",\n          minHeight: \"100vh\",\n          gap: \"16px\",\n        }}\n      >\n        <p>User not found</p>\n        <motion.button\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          onClick={() => navigate(\"/friends\")}\n          style={{\n            padding: \"12px 24px\",\n            background: \"#D4AF37\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            fontWeight: \"600\",\n            cursor: \"pointer\",\n          }}\n        >\n          Back to Friends\n        </motion.button>\n      </div>\n    );\n  }\n\n  const userLevel = getCurrentLevel(user.xp || 0);\n  const avatarSrc = getAvatarImage(user.avatar, {\n    userId: user.user_id || user.id,\n    nickname: user.nickname || user.username,\n  });\n  const displayName = user.username || user.handle || user.nickname || \"User\";\n\n  return (\n    <div\n      className=\"screen no-extra-space\"\n      style={{\n        background: \"#0B1E2D\",\n        minHeight: \"100vh\",\n        paddingBottom: \"80px\",\n      }}\n    >\n      <div\n        style={{\n          background: \"linear-gradient(135deg, #0B1E2D 0%, #1a3a52 100%)\",\n          padding: \"20px\",\n          borderBottom: \"1px solid rgba(212, 175, 55, 0.2)\",\n        }}\n      >\n        <button\n          onClick={() => navigate(\"/friends\")}\n          style={{\n            background: \"transparent\",\n            border: \"none\",\n            color: \"#D4AF37\",\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"8px\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            padding: \"8px\",\n            marginBottom: \"16px\",\n          }}\n        >\n          <ArrowLeft size={20} />\n          <span>Back</span>\n        </button>\n      </div>\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        style={{\n          padding: \"24px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          gap: \"24px\",\n        }}\n      >\n        <div\n          style={{\n            width: \"120px\",\n            height: \"120px\",\n            borderRadius: \"50%\",\n            border: \"3px solid #D4AF37\",\n            overflow: \"hidden\",\n            background: \"#0E1625\",\n          }}\n        >\n          <img\n            src={avatarSrc}\n            alt={displayName}\n            style={{\n              width: \"100%\",\n              height: \"100%\",\n              objectFit: \"contain\",\n            }}\n          />\n        </div>\n\n        <div\n          style={{\n            textAlign: \"center\",\n            color: \"white\",\n          }}\n        >\n          <h2\n            style={{\n              fontSize: \"1.5rem\",\n              fontWeight: \"bold\",\n              marginBottom: \"4px\",\n              color: \"#D4AF37\",\n            }}\n          >\n            {displayName}\n          </h2>\n          {user.handle && (\n            <p\n              style={{\n                color: \"#aaa\",\n                fontSize: \"0.95rem\",\n                marginBottom: \"12px\",\n              }}\n            >\n              @{user.handle}\n            </p>\n          )}\n\n          <LevelBadgeCompact level={userLevel} size=\"large\" />\n        </div>\n\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(2, 1fr)\",\n            gap: \"16px\",\n            width: \"100%\",\n            maxWidth: \"400px\",\n          }}\n        >\n          <div\n            style={{\n              background: \"rgba(14, 22, 37, 0.6)\",\n              border: \"1px solid rgba(212, 175, 55, 0.3)\",\n              borderRadius: \"12px\",\n              padding: \"16px\",\n              textAlign: \"center\",\n            }}\n          >\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                marginBottom: \"8px\",\n              }}\n            >\n              <Trophy size={20} color=\"#D4AF37\" />\n              <span\n                style={{\n                  color: \"#D4AF37\",\n                  fontSize: \"0.9rem\",\n                  fontWeight: \"600\",\n                }}\n              >\n                XP\n              </span>\n            </div>\n            <p\n              style={{\n                color: \"white\",\n                fontSize: \"1.4rem\",\n                fontWeight: \"bold\",\n              }}\n            >\n              {(user.xp || 0).toLocaleString()}\n            </p>\n          </div>\n\n          <div\n            style={{\n              background: \"rgba(14, 22, 37, 0.6)\",\n              border: \"1px solid rgba(239, 68, 68, 0.3)\",\n              borderRadius: \"12px\",\n              padding: \"16px\",\n              textAlign: \"center\",\n            }}\n          >\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                marginBottom: \"8px\",\n              }}\n            >\n              <Flame size={20} color=\"#ef4444\" />\n              <span\n                style={{\n                  color: \"#ef4444\",\n                  fontSize: \"0.9rem\",\n                  fontWeight: \"600\",\n                }}\n              >\n                Streak\n              </span>\n            </div>\n            <p\n              style={{\n                color: \"white\",\n                fontSize: \"1.4rem\",\n                fontWeight: \"bold\",\n              }}\n            >\n              {user.streak || 0}\n            </p>\n          </div>\n\n          <div\n            style={{\n              background: \"rgba(14, 22, 37, 0.6)\",\n              border: \"1px solid rgba(234, 179, 8, 0.3)\",\n              borderRadius: \"12px\",\n              padding: \"16px\",\n              textAlign: \"center\",\n            }}\n          >\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                marginBottom: \"8px\",\n              }}\n            >\n              <Coins size={20} color=\"#eab308\" />\n              <span\n                style={{\n                  color: \"#eab308\",\n                  fontSize: \"0.9rem\",\n                  fontWeight: \"600\",\n                }}\n              >\n                Coins\n              </span>\n            </div>\n            <p\n              style={{\n                color: \"white\",\n                fontSize: \"1.4rem\",\n                fontWeight: \"bold\",\n              }}\n            >\n              {(user.coins || 0).toLocaleString()}\n            </p>\n          </div>\n\n          <div\n            style={{\n              background: \"rgba(14, 22, 37, 0.6)\",\n              border: \"1px solid rgba(59, 130, 246, 0.3)\",\n              borderRadius: \"12px\",\n              padding: \"16px\",\n              textAlign: \"center\",\n            }}\n          >\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                marginBottom: \"8px\",\n              }}\n            >\n              <Shield size={20} color=\"#3b82f6\" />\n              <span\n                style={{\n                  color: \"#3b82f6\",\n                  fontSize: \"0.9rem\",\n                  fontWeight: \"600\",\n                }}\n              >\n                Shields\n              </span>\n            </div>\n            <p\n              style={{\n                color: \"white\",\n                fontSize: \"1.4rem\",\n                fontWeight: \"bold\",\n              }}\n            >\n              {user.shield_count || 0}\n            </p>\n          </div>\n        </div>\n\n        {isUserFriend && (\n          <motion.button\n            onClick={handleRemoveFriend}\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            style={{\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: \"8px\",\n              padding: \"12px 24px\",\n              background: \"rgba(239, 68, 68, 0.1)\",\n              border: \"1px solid rgba(239, 68, 68, 0.3)\",\n              borderRadius: \"12px\",\n              color: \"#ef4444\",\n              fontSize: \"1rem\",\n              fontWeight: \"600\",\n              cursor: \"pointer\",\n              marginTop: \"16px\",\n            }}\n          >\n            <UserMinus size={18} />\n            <span>Remove Friend</span>\n          </motion.button>\n        )}\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11346,"size_tokens":null},"src/components/QuickMessageModal.jsx":{"content":"import { motion, AnimatePresence } from \"framer-motion\";\nimport { X, Send } from \"lucide-react\";\n\nconst QUICK_MESSAGES = [\n  { id: 1, text: \"Assalamu alaikum! üëã\", emoji: \"üëã\" },\n  { id: 2, text: \"May Allah bless you! ü§≤\", emoji: \"ü§≤\" },\n  { id: 3, text: \"JazakAllah Khair! üåü\", emoji: \"üåü\" },\n  { id: 4, text: \"Keep up the great work! üí™\", emoji: \"üí™\" },\n  { id: 5, text: \"Let's learn together! üìö\", emoji: \"üìö\" },\n  { id: 6, text: \"Challenge me again! ‚öîÔ∏è\", emoji: \"‚öîÔ∏è\" },\n  { id: 7, text: \"ŸÖÿß ÿ¥ÿßÿ° ÿßŸÑŸÑŸá! Amazing progress! üéØ\", emoji: \"üéØ\" },\n  { id: 8, text: \"See you in Jannah! üåô\", emoji: \"üåô\" }\n];\n\nexport default function QuickMessageModal({ friend, onClose }) {\n  const handleSendMessage = (message) => {\n    console.log(`Sending \"${message.text}\" to ${friend.nickname}`);\n    onClose();\n  };\n\n  return (\n    <AnimatePresence>\n      <div\n        onClick={onClose}\n        style={{\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: \"rgba(0, 0, 0, 0.7)\",\n          display: \"flex\",\n          alignItems: \"flex-end\",\n          justifyContent: \"center\",\n          zIndex: 10000,\n          padding: 0\n        }}\n      >\n        <motion.div\n          initial={{ y: \"100%\" }}\n          animate={{ y: 0 }}\n          exit={{ y: \"100%\" }}\n          transition={{ type: \"spring\", damping: 30, stiffness: 300 }}\n          onClick={(e) => e.stopPropagation()}\n          style={{\n            background: \"linear-gradient(180deg, #0A1A2F 0%, #081426 100%)\",\n            borderTopLeftRadius: \"24px\",\n            borderTopRightRadius: \"24px\",\n            padding: \"24px\",\n            width: \"100%\",\n            maxWidth: \"500px\",\n            maxHeight: \"70vh\",\n            overflowY: \"auto\",\n            boxShadow: \"0 -4px 30px rgba(212, 175, 55, 0.3)\"\n          }}\n        >\n          {/* Header */}\n          <div style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\",\n            marginBottom: \"20px\"\n          }}>\n            <h3 style={{\n              color: \"#D4AF37\",\n              fontSize: \"1.3rem\",\n              fontWeight: \"700\",\n              margin: 0\n            }}>\n              Quick Message\n            </h3>\n            <button\n              onClick={onClose}\n              style={{\n                background: \"transparent\",\n                border: \"none\",\n                color: \"#888\",\n                cursor: \"pointer\",\n                padding: \"4px\"\n              }}\n            >\n              <X size={24} />\n            </button>\n          </div>\n\n          {/* Friend Info */}\n          <div style={{\n            textAlign: \"center\",\n            marginBottom: \"24px\",\n            padding: \"16px\",\n            background: \"rgba(212, 175, 55, 0.1)\",\n            borderRadius: \"12px\",\n            border: \"1px solid rgba(212, 175, 55, 0.3)\"\n          }}>\n            <p style={{\n              color: \"#fff\",\n              fontSize: \"1rem\",\n              marginBottom: \"4px\"\n            }}>\n              Send a quick message to\n            </p>\n            <p style={{\n              color: \"#D4AF37\",\n              fontSize: \"1.2rem\",\n              fontWeight: \"600\",\n              margin: 0\n            }}>\n              {friend.nickname}\n            </p>\n          </div>\n\n          {/* Quick Message Options */}\n          <div style={{\n            display: \"grid\",\n            gridTemplateColumns: \"1fr\",\n            gap: \"12px\"\n          }}>\n            {QUICK_MESSAGES.map((message) => (\n              <motion.button\n                key={message.id}\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={() => handleSendMessage(message)}\n                style={{\n                  background: \"rgba(14, 22, 37, 0.8)\",\n                  border: \"1px solid rgba(212, 175, 55, 0.3)\",\n                  borderRadius: \"12px\",\n                  padding: \"16px\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: \"12px\",\n                  cursor: \"pointer\",\n                  transition: \"all 0.2s ease\"\n                }}\n              >\n                <div style={{\n                  fontSize: \"1.5rem\",\n                  width: \"40px\",\n                  height: \"40px\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  background: \"rgba(212, 175, 55, 0.2)\",\n                  borderRadius: \"50%\"\n                }}>\n                  {message.emoji}\n                </div>\n                <p style={{\n                  color: \"#fff\",\n                  fontSize: \"1rem\",\n                  margin: 0,\n                  flex: 1,\n                  textAlign: \"left\"\n                }}>\n                  {message.text}\n                </p>\n                <Send size={18} color=\"#10b981\" />\n              </motion.button>\n            ))}\n          </div>\n        </motion.div>\n      </div>\n    </AnimatePresence>\n  );\n}\n","path":null,"size_bytes":5114,"size_tokens":null},"src/pages/Premium.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport { Crown, RefreshCw, Smartphone } from \"lucide-react\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { purchase, restorePurchases, isNativeAppRequired, getPlatform, loadProducts } from \"../services/iapService\";\nimport { markPremiumActivated } from \"../services/premiumStateService\";\nimport NotificationModal from \"../components/NotificationModal\";\nimport MainMascot from \"../assets/mascots/mascot_sitting.webp\";\n\nconst Premium = () => {\n  const navigate = useNavigate();\n  const { premium, purchaseIndividual } = useProgressStore();\n  const [loading, setLoading] = useState(false);\n  const [restoring, setRestoring] = useState(false);\n  const [requiresNativeApp, setRequiresNativeApp] = useState(false);\n  const [products, setProducts] = useState({});\n  \n  const [notification, setNotification] = useState({\n    isOpen: false,\n    title: \"\",\n    message: \"\",\n    type: \"info\",\n  });\n\n  const showNotification = (title, message, type = \"info\") => {\n    setNotification({ isOpen: true, title, message, type });\n  };\n\n  const closeNotification = () => {\n    setNotification({ ...notification, isOpen: false });\n  };\n\n  useEffect(() => {\n    const checkPlatform = async () => {\n      const needsNative = isNativeAppRequired();\n      setRequiresNativeApp(needsNative);\n      \n      if (!needsNative) {\n        try {\n          const loadedProducts = await loadProducts();\n          setProducts(loadedProducts);\n        } catch (error) {\n          console.error(\"Failed to load products:\", error);\n        }\n      }\n    };\n    checkPlatform();\n  }, []);\n\n  const handleRestorePurchases = async () => {\n    setRestoring(true);\n    try {\n      const result = await restorePurchases();\n      \n      if (result.success && result.verified) {\n        purchaseIndividual();\n        showNotification(\"Restored!\", \"Your purchases have been restored successfully.\", \"success\");\n        setTimeout(() => navigate(\"/\"), 1500);\n      } else if (result.requiresDeviceTransfer) {\n        showNotification(\n          \"Device Limit Reached\",\n          \"Your premium is active on another device. You can only use premium on one device at a time.\",\n          \"device\"\n        );\n      } else {\n        showNotification(\n          \"No Purchases Found\",\n          result.message || result.error || \"We couldn't find any purchases to restore.\",\n          \"info\"\n        );\n      }\n    } catch (error) {\n      console.error(\"Restore failed:\", error);\n      showNotification(\n        \"Restore Failed\",\n        \"Failed to restore purchases. Please check your connection and try again.\",\n        \"error\"\n      );\n    } finally {\n      setRestoring(false);\n    }\n  };\n\n  const handlePurchase = async () => {\n    if (requiresNativeApp) {\n      return;\n    }\n    \n    setLoading(true);\n    \n    try {\n      const result = await purchase(\"premium_lifetime\");\n      \n      if (result.success) {\n        purchaseIndividual();\n        markPremiumActivated(\"single\");\n        setTimeout(() => navigate(\"/\"), 1000);\n      } else {\n        console.error(\"Purchase failed:\", result.error);\n        showNotification(\n          \"Purchase Failed\",\n          result.error || \"Payment was not completed. Please try again.\",\n          \"error\"\n        );\n      }\n    } catch (error) {\n      console.error(\"Purchase failed:\", error);\n      showNotification(\n        \"Payment Failed\",\n        \"Something went wrong with your payment. Please try again.\",\n        \"error\"\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (premium) {\n    return (\n      <div \n        className=\"min-h-screen flex items-center justify-center pb-24 px-4\"\n        style={{\n          background: \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n        }}\n      >\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          className=\"w-full max-w-[480px] text-center\"\n        >\n          <img\n            src={MainMascot}\n            alt=\"Mascot\"\n            className=\"w-24 h-24 mx-auto mb-4\"\n          />\n          \n          <div className=\"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-[var(--gold)] to-yellow-600 rounded-full flex items-center justify-center\">\n            <Crown size={32} className=\"text-white\" />\n          </div>\n          \n          <h1 className=\"text-2xl font-bold mb-2 text-[var(--gold)]\">\n            You Have Premium! üëë\n          </h1>\n          \n          <p className=\"text-gray-300 mb-6 text-sm\">\n            Lifetime Premium Access\n          </p>\n\n          <button\n            onClick={() => navigate(\"/\")}\n            className=\"premium-btn\"\n          >\n            Back to Home\n          </button>\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      className=\"min-h-screen flex items-center justify-center pb-24 px-4\"\n      style={{\n        background: \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, scale: 0.95 }}\n        animate={{ opacity: 1, scale: 1 }}\n      >\n        <div className=\"premium-container\">\n          <img src={MainMascot} className=\"premium-mascot\" alt=\"Mascot\" />\n\n          <h1 className=\"premium-title\">Unlock Your Full Potential</h1>\n\n          <p className=\"premium-subtitle\">\n            Lifetime access ‚Ä¢ No ads ‚Ä¢ All learning paths ‚Ä¢ Works across devices\n          </p>\n\n          {requiresNativeApp ? (\n            <div className=\"native-app-required\">\n              <div className=\"native-app-icon\">\n                <Smartphone size={48} className=\"text-[var(--gold)]\" />\n              </div>\n              <h2 className=\"native-app-title\">Download the App to Purchase</h2>\n              <p className=\"native-app-text\">\n                To complete your purchase, please download Islam Quest from the App Store or Google Play Store.\n              </p>\n              <p className=\"native-app-text\" style={{ marginTop: '8px', fontSize: '0.8rem', opacity: 0.8 }}>\n                Already purchased? Tap \"Restore Purchases\" below.\n              </p>\n            </div>\n          ) : (\n            <div className=\"premium-card\">\n              <h2 className=\"premium-plan-title\">Lifetime Premium</h2>\n              <div className=\"premium-price\">¬£4.99 ‚Äî One-time</div>\n\n              <ul className=\"premium-list\">\n                <li>‚úî All 14 Learning Paths</li>\n                <li>‚úî Unlimited Lessons</li>\n                <li>‚úî Global Events Access</li>\n                <li>‚úî No Ads Ever</li>\n                <li>‚úî Works Across Devices</li>\n              </ul>\n\n              <button \n                className=\"premium-btn\"\n                onClick={handlePurchase}\n                disabled={loading}\n              >\n                {loading ? \"Processing...\" : \"Unlock Premium ‚Äî ¬£4.99\"}\n              </button>\n            </div>\n          )}\n\n          <p className=\"premium-footer\">\n            Secure payment ‚Ä¢ Instant access ‚Ä¢ Lifetime unlock\n          </p>\n\n          <button \n            className=\"restore-btn\"\n            onClick={handleRestorePurchases}\n            disabled={restoring}\n          >\n            <RefreshCw size={16} className={restoring ? \"spin\" : \"\"} />\n            {restoring ? \"Restoring...\" : \"Restore Purchases\"}\n          </button>\n        </div>\n      </motion.div>\n\n      <NotificationModal\n        isOpen={notification.isOpen}\n        onClose={closeNotification}\n        title={notification.title}\n        message={notification.message}\n        type={notification.type}\n      />\n\n      <style>{`\n        .premium-container {\n          text-align: center;\n          padding: 20px;\n          max-width: 480px;\n          margin: 0 auto;\n        }\n\n        .premium-mascot {\n          width: 120px;\n          margin: 0 auto 10px;\n          display: block;\n        }\n\n        .premium-title {\n          color: #FFD700;\n          font-size: 1.9rem;\n          margin-bottom: 6px;\n        }\n\n        .premium-subtitle {\n          color: #cfd6e1;\n          font-size: 0.9rem;\n          margin-bottom: 20px;\n          line-height: 1.4rem;\n        }\n\n        .premium-card {\n          background: #0b1e36;\n          border: 3px solid #FFD700;\n          border-radius: 24px;\n          padding: 20px;\n          margin: 14px auto;\n          box-shadow: 0 0 18px rgba(255,215,0,0.28);\n          width: 100%;\n          max-width: 360px;\n        }\n\n        .premium-plan-title {\n          color: #FFD700;\n          font-size: 1.3rem;\n          margin-bottom: 4px;\n        }\n\n        .premium-price {\n          color: #FFD700;\n          font-size: 1rem;\n          font-weight: 600;\n          margin-bottom: 12px;\n        }\n\n        .premium-list {\n          list-style: none;\n          padding: 0;\n          margin-bottom: 16px;\n          font-size: 0.9rem;\n          line-height: 1.6rem;\n          color: #fff;\n          text-align: left;\n        }\n\n        .premium-list li {\n          padding-left: 4px;\n        }\n\n        .premium-btn {\n          width: 100%;\n          padding: 14px;\n          background: linear-gradient(90deg, #FFD700, #FFB700);\n          border: none;\n          border-radius: 14px;\n          color: #0a1a2f;\n          font-weight: 700;\n          font-size: 1rem;\n          box-shadow: 0 0 12px rgba(255,215,0,0.4);\n          cursor: pointer;\n          transition: all 0.2s ease;\n        }\n\n        .premium-btn:hover {\n          transform: scale(1.02);\n          box-shadow: 0 0 16px rgba(255,215,0,0.5);\n        }\n\n        .premium-btn:disabled {\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n\n        .premium-footer {\n          margin-top: 24px;\n          font-size: 0.75rem;\n          color: #9ea5b0;\n        }\n\n        .restore-btn {\n          display: inline-flex;\n          align-items: center;\n          gap: 8px;\n          margin-top: 16px;\n          padding: 10px 20px;\n          background: transparent;\n          border: 1px solid rgba(255, 215, 0, 0.3);\n          border-radius: 10px;\n          color: #9ea5b0;\n          font-size: 0.85rem;\n          cursor: pointer;\n          transition: all 0.2s ease;\n        }\n\n        .restore-btn:hover {\n          border-color: rgba(255, 215, 0, 0.6);\n          color: #FFD700;\n        }\n\n        .restore-btn:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n\n        .spin {\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n\n        .native-app-required {\n          background: #0b1e36;\n          border: 2px solid rgba(255, 215, 0, 0.3);\n          border-radius: 24px;\n          padding: 32px 20px;\n          margin: 20px auto;\n          max-width: 360px;\n          text-align: center;\n        }\n\n        .native-app-icon {\n          margin-bottom: 16px;\n        }\n\n        .native-app-title {\n          color: #FFD700;\n          font-size: 1.2rem;\n          margin-bottom: 12px;\n        }\n\n        .native-app-text {\n          color: #cfd6e1;\n          font-size: 0.9rem;\n          line-height: 1.5;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default Premium;\n","path":null,"size_bytes":11354,"size_tokens":null},"src/pages/ResetPremium.jsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useProgressStore } from \"../store/progressStore\";\n\nexport default function ResetPremium() {\n  const [status, setStatus] = useState(\"Resetting...\");\n\n  useEffect(() => {\n    try {\n      // Reset premium in Zustand store\n      useProgressStore.setState({\n        premium: false,\n        premiumStatus: \"free\",\n        premiumType: null,\n        hasPremium: false,\n        premiumActivatedAt: null\n      });\n      \n      // Also update the localStorage directly with correct key\n      const stored = localStorage.getItem(\"islamQuestProgress_v4\");\n      if (stored) {\n        const parsed = JSON.parse(stored);\n        parsed.state = {\n          ...parsed.state,\n          premium: false,\n          premiumStatus: \"free\", \n          premiumType: null,\n          hasPremium: false,\n          premiumActivatedAt: null\n        };\n        localStorage.setItem(\"islamQuestProgress_v4\", JSON.stringify(parsed));\n      }\n      \n      console.log(\"‚úÖ Premium status reset to free user\");\n      setStatus(\"Premium reset! Redirecting...\");\n      \n      // Redirect to home after 1 second\n      setTimeout(() => {\n        window.location.href = \"/\";\n      }, 1000);\n    } catch (e) {\n      console.error(\"Reset error:\", e);\n      setStatus(\"Error resetting. Try clearing browser data.\");\n    }\n  }, []);\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        inset: 0,\n        background: \"#0a0f1e\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        color: \"white\",\n        textAlign: \"center\",\n        padding: \"32px\",\n      }}\n    >\n      <h1 style={{ fontSize: \"2rem\", marginBottom: \"16px\", color: \"#D4AF37\" }}>\n        {status}\n      </h1>\n      <p style={{ fontSize: \"1.1rem\", color: \"#aaa\" }}>\n        You will be redirected to the home page...\n      </p>\n    </div>\n  );\n}\n","path":null,"size_bytes":1916,"size_tokens":null},"src/lib/deviceFingerprint.js":{"content":"export function getDeviceFingerprint() {\n  let fp = localStorage.getItem(\"iq_device_fp\");\n  if (!fp) {\n    fp = crypto.randomUUID();\n    localStorage.setItem(\"iq_device_fp\", fp);\n  }\n  return fp;\n}\n","path":null,"size_bytes":198,"size_tokens":null},"src/lib/supabaseClient.js":{"content":"// src/lib/supabaseClient.js\n// -----------------------------------------------------------\n// IslamQuest ‚Äî Silent Auth + Identity Binding (Phase 3, Step 3)\n// -----------------------------------------------------------\n// This client is responsible for:\n// 1) Silent account creation on first launch\n// 2) Auto-login on every app open\n// 3) Permanent Supabase UID for all user data\n// 4) Premium restore and multi-device support (Phase 5)\n// -----------------------------------------------------------\n\nimport { createClient } from \"@supabase/supabase-js\";\n\n// DO NOT EDIT ‚Äî these must match your Supabase dashboard\nconst SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;\nconst SUPABASE_ANON_KEY = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\n// -----------------------------------------------------------\n// Create the Supabase client\n// -----------------------------------------------------------\nexport const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n  },\n});\n\n// -----------------------------------------------------------\n// Silent Identity Generator\n// Creates a hidden email + password for anonymous accounts\n// -----------------------------------------------------------\nfunction generateHiddenIdentity() {\n  const uid = crypto.randomUUID().replace(/-/g, \"\");\n  return {\n    email: `iq_user_${uid}@autologin.islamquest`,\n    password: crypto.randomUUID() + \"_\" + Date.now(),\n  };\n}\n\n// -----------------------------------------------------------\n// Silent Sign-In\n// Called automatically on app start\n// -----------------------------------------------------------\n\nexport async function ensureSignedIn() {\n  // 1) Check existing session\n  const {\n    data: { session },\n  } = await supabase.auth.getSession();\n\n  if (session) {\n    console.log(\"üîê Supabase: Existing session found\");\n    return session.user;\n  }\n\n  // 2) Skip silent account creation during onboarding flow or for first-time users\n  // This prevents creating anonymous accounts that conflict with real email signup\n  const onboardingStep = localStorage.getItem(\"iq_onboarding_step\");\n  const profileComplete = localStorage.getItem(\"iq_profile_complete\");\n  \n  // If no profile complete AND no session, this is a first-time user - start onboarding\n  if (!profileComplete && !onboardingStep) {\n    console.log(\"üîê First-time user detected - starting onboarding flow\");\n    localStorage.setItem(\"iq_onboarding_step\", \"bismillah\");\n    return null;\n  }\n  \n  if (onboardingStep) {\n    console.log(\"üîê Skipping silent signup - user is in onboarding flow:\", onboardingStep);\n    return null;\n  }\n\n  // 3) No session ‚Üí create or load hidden identity\n  let storedIdentity = JSON.parse(localStorage.getItem(\"iq_hidden_identity_v1\"));\n\n  if (!storedIdentity) {\n    storedIdentity = generateHiddenIdentity();\n    localStorage.setItem(\n      \"iq_hidden_identity_v1\",\n      JSON.stringify(storedIdentity)\n    );\n  }\n\n  // 3) Try to sign in with hidden identity\n  const { data: signInData, error: signInError } =\n    await supabase.auth.signInWithPassword({\n      email: storedIdentity.email,\n      password: storedIdentity.password,\n    });\n\n  // 4) If user doesn't exist ‚Üí sign up silently\n  if (signInError) {\n    console.warn(\"üîê Creating NEW Supabase silent account‚Ä¶\");\n\n    const { data: signUpData, error: signUpError } =\n      await supabase.auth.signUp({\n        email: storedIdentity.email,\n        password: storedIdentity.password,\n      });\n\n    if (signUpError) {\n      console.error(\"‚ùå Silent signup failed:\", signUpError);\n      throw signUpError;\n    }\n\n    console.log(\"üÜï Silent account created:\", signUpData.user.id);\n    return signUpData.user;\n  }\n\n  console.log(\"üîë Logged in silently:\", signInData.user.id);\n  return signInData.user;\n}\n\n// -----------------------------------------------------------\n// Get Current UID (always returns permanent user ID)\n// -----------------------------------------------------------\nexport async function getUID() {\n  const {\n    data: { session },\n  } = await supabase.auth.getSession();\n\n  return session?.user?.id || null;\n}\n\n// -----------------------------------------------------------\n// Logout ‚Äî used later in Phase 5\n// -----------------------------------------------------------\nexport async function logoutUser() {\n  await supabase.auth.signOut();\n  localStorage.removeItem(\"iq_hidden_identity_v1\");\n  window.location.href = \"/\";\n}\n","path":null,"size_bytes":4495,"size_tokens":null},"src/lib/userProfile.js":{"content":"// src/lib/userProfile.js\n// -------------------------------------------------------\n// Cloud Profile Management - Identity Pipeline\n// -------------------------------------------------------\n// ARCHITECTURE (Nov 2025):\n// - Profiles are ONLY created after onboarding via createProfileAfterOnboarding()\n// - NO profile creation at app startup\n// - Avatar stored as INTEGER (index) in DB, string key in app\n// - saveCloudProfile() only updates existing profiles, never inserts\n\nimport { supabase } from \"./supabaseClient\";\nimport { avatarKeyToIndex, avatarIndexToKey } from \"../utils/avatarUtils\";\n\n// Default avatar for new profiles (index 0 = avatar_man_lantern)\nconst DEFAULT_AVATAR_KEY = \"avatar_man_lantern\";\nconst DEFAULT_AVATAR_INDEX = 0;\n\n/**\n * üîπ ensureSignedIn()\n * Silent authentication:\n * - Checks existing session\n * - Creates hidden account on first launch\n */\nexport async function ensureSignedIn() {\n  // Check for existing session\n  const {\n    data: { session },\n  } = await supabase.auth.getSession();\n\n  if (session?.user) {\n    return session.user;\n  }\n\n  // Create hidden account\n  const {\n    data: { user },\n    error,\n  } = await supabase.auth.signUp({\n    email: `hidden_${crypto.randomUUID()}@hidden.local`,\n    password: crypto.randomUUID(),\n  });\n\n  if (error) {\n    console.error(\"Silent signup failed:\", error);\n    return null;\n  }\n\n  return user;\n}\n\n/**\n * üîπ checkProfileExists(userId)\n * Returns the profile if it exists, null if not.\n * Does NOT create a profile - use createProfileAfterOnboarding() for that.\n */\nexport async function checkProfileExists(userId) {\n  if (!userId) {\n    console.warn(\"checkProfileExists called without userId\");\n    return null;\n  }\n\n  const { data: existingProfile, error: selectError } = await supabase\n    .from(\"profiles\")\n    .select(\"user_id, username, handle, avatar, xp, coins, streak\")\n    .eq(\"user_id\", userId)\n    .maybeSingle();\n\n  if (selectError && selectError.code !== \"PGRST116\") {\n    console.error(\"checkProfileExists: select error\", selectError);\n    return null;\n  }\n\n  if (existingProfile) {\n    // Normalize avatar: convert integer to string if needed\n    if (typeof existingProfile.avatar === \"number\") {\n      existingProfile.avatar = avatarIndexToKey(existingProfile.avatar);\n    }\n    console.log(\"PROFILE EXISTS ‚Üí\", existingProfile.user_id);\n    return existingProfile;\n  }\n\n  console.log(\"NO PROFILE FOUND for user ‚Üí\", userId);\n  return null;\n}\n\n/**\n * üîπ createProfileAfterOnboarding({ userId, deviceId, username, avatar, handle })\n * Creates a new profile with ALL required fields.\n * Called ONLY from completeOnboarding() after user finishes onboarding.\n * NO null fields allowed - all fields must be populated.\n */\nexport async function createProfileAfterOnboarding({ userId, deviceId, username, avatar, handle }) {\n  if (!userId) {\n    console.error(\"createProfileAfterOnboarding: Missing userId\");\n    return { success: false, error: \"Missing userId\" };\n  }\n\n  if (!username || !handle) {\n    console.error(\"createProfileAfterOnboarding: Missing required fields\", { username, handle });\n    return { success: false, error: \"Missing required fields (username or handle)\" };\n  }\n\n  // Convert avatar string key to integer index for DB\n  let avatarIndex = DEFAULT_AVATAR_INDEX;\n  if (avatar) {\n    if (typeof avatar === \"string\") {\n      avatarIndex = avatarKeyToIndex(avatar);\n    } else if (typeof avatar === \"number\") {\n      avatarIndex = avatar;\n    }\n  }\n\n  const newProfileData = {\n    user_id: userId,\n    device_id: deviceId || null,\n    username: username.trim(),\n    handle: handle.trim().toLowerCase(),\n    avatar: avatarIndex,\n    xp: 0,\n    coins: 0,\n    streak: 0,\n    shield_count: 0,\n    created_at: new Date().toISOString(),\n  };\n\n  console.log(\"CREATING PROFILE ‚Üí\", userId, { username, handle, avatar: avatarIndex });\n\n  const { data: insertedProfile, error: insertError } = await supabase\n    .from(\"profiles\")\n    .insert(newProfileData)\n    .select(\"user_id, username, handle, avatar, xp, coins, streak\")\n    .maybeSingle();\n\n  if (insertError) {\n    // Duplicate key = profile already exists (race condition or re-onboarding)\n    if (insertError.code === \"23505\") {\n      console.log(\"createProfileAfterOnboarding: Profile already exists, updating instead\");\n      // Update the existing profile instead\n      return await saveCloudProfile(userId, { username, avatar, handle });\n    }\n    console.error(\"createProfileAfterOnboarding: insert error\", insertError);\n    return { success: false, error: insertError };\n  }\n\n  // Normalize avatar back to string key for app use\n  if (insertedProfile && typeof insertedProfile.avatar === \"number\") {\n    insertedProfile.avatar = avatarIndexToKey(insertedProfile.avatar);\n  }\n\n  console.log(\"PROFILE CREATED SUCCESSFULLY ‚Üí\", userId);\n  return { success: true, data: insertedProfile };\n}\n\n/**\n * üîπ loadCloudProfile(userId)\n * Returns the full profile row.\n * Normalizes avatar to string key if stored as integer.\n */\nexport async function loadCloudProfile(userId) {\n  if (!userId) return null;\n\n  const { data, error } = await supabase\n    .from(\"profiles\")\n    .select(\"*\")\n    .eq(\"user_id\", userId)\n    .maybeSingle();\n\n  if (error || !data) {\n    return null;\n  }\n\n  // Normalize avatar: convert integer to string if needed\n  const result = { ...data };\n  if (typeof data.avatar === \"number\") {\n    result.avatar = avatarIndexToKey(data.avatar);\n  }\n\n  return result;\n}\n\n/**\n * üîπ saveCloudProfile(userId, partialData)\n * Updates ONLY identity fields (username, avatar, handle) on EXISTING profiles.\n * NEVER sends null/undefined values - only truthy fields are sent.\n * NEVER inserts new profiles - use createProfileAfterOnboarding() for that.\n * Avatar can be string key or integer index (converted to integer for DB).\n */\nexport async function saveCloudProfile(userId, partialData) {\n  if (!userId) {\n    console.warn(\"saveCloudProfile: No userId provided\");\n    return { success: false, error: \"No userId\" };\n  }\n\n  // Build payload with ONLY non-null identity fields\n  const dataToSave = { updated_at: new Date().toISOString() };\n\n  // Only include username if it's a non-empty string\n  if (partialData.username && typeof partialData.username === \"string\" && partialData.username.trim()) {\n    dataToSave.username = partialData.username.trim();\n  }\n\n  // Only include handle if it's a non-empty string\n  if (partialData.handle && typeof partialData.handle === \"string\" && partialData.handle.trim()) {\n    dataToSave.handle = partialData.handle.trim().toLowerCase();\n  }\n\n  // Only include avatar if it's set - convert string key to integer index\n  if (partialData.avatar) {\n    if (typeof partialData.avatar === \"string\") {\n      dataToSave.avatar = avatarKeyToIndex(partialData.avatar);\n    } else if (typeof partialData.avatar === \"number\") {\n      dataToSave.avatar = partialData.avatar;\n    }\n  }\n\n  // Don't send empty payload\n  if (Object.keys(dataToSave).length <= 1) {\n    console.warn(\"saveCloudProfile: No valid fields to update\");\n    return { success: false, error: \"No valid fields\" };\n  }\n\n  console.log(\"PROFILE UPDATE ‚Üí\", userId, dataToSave);\n\n  const { data, error } = await supabase\n    .from(\"profiles\")\n    .update(dataToSave)\n    .eq(\"user_id\", userId)\n    .select();\n\n  if (error) {\n    console.error(\"saveCloudProfile: Update FAILED:\", error);\n    if (error.code === \"23505\" && error.message?.includes(\"handle\")) {\n      return { success: false, error: \"handle_taken\" };\n    }\n    return { success: false, error };\n  }\n\n  if (!data || data.length === 0) {\n    console.warn(\"saveCloudProfile: No rows updated (profile may not exist)\");\n    return { success: false, error: \"No rows updated\" };\n  }\n\n  // Normalize avatar back to string key\n  const result = { ...data[0] };\n  if (typeof result.avatar === \"number\") {\n    result.avatar = avatarIndexToKey(result.avatar);\n  }\n\n  return { success: true, data: result };\n}\n\n/**\n * üîπ isProfileComplete(profile)\n * Returns true if profile has all required identity fields.\n * Used to determine if onboarding is needed.\n */\nexport function isProfileComplete(profile) {\n  if (!profile) return false;\n  \n  // Must have username (not the temp \"UserXXXX\" pattern) and handle\n  const hasValidUsername = profile.username && \n    typeof profile.username === \"string\" && \n    !profile.username.match(/^User\\d{4}$/);\n  \n  const hasHandle = profile.handle && \n    typeof profile.handle === \"string\" && \n    profile.handle.trim().length > 0;\n  \n  return hasValidUsername && hasHandle;\n}\n","path":null,"size_bytes":8537,"size_tokens":null},"src/components/GlobalErrorBoundary.jsx":{"content":"import React from \"react\";\n\nexport default class GlobalErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"screen\" style={{ padding: \"2rem\", color: \"white\" }}>\n          <h2>Something went wrong</h2>\n          <p>Try refreshing the app.</p>\n        </div>\n      );\n    }\n    return this.props.children;\n  }\n}\n","path":null,"size_bytes":543,"size_tokens":null},"src/lib/supabaseSafe.js":{"content":"export async function safeCall(fn, fallback = null) {\n  try {\n    const res = await fn();\n    if (res?.error) throw res.error;\n    return res;\n  } catch (e) {\n    console.warn(\"[safeCall] failed:\", e.message);\n    return fallback;\n  }\n}\n","path":null,"size_bytes":237,"size_tokens":null},"src/sync/dailyQuestSync.js":{"content":"import { supabase } from \"../lib/supabaseClient.js\";\nimport { useDailyQuestStore } from \"../store/dailyQuestStore.js\";\n\nconst getToday = () => new Date().toISOString().split(\"T\")[0];\n\nexport async function pullDailyQuestFromCloud() {\n  try {\n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user) return null;\n\n    const { data, error } = await supabase\n      .from(\"daily_quests\")\n      .select(\"*\")\n      .eq(\"user_id\", auth.user.id)\n      .maybeSingle();\n\n    if (error) {\n      console.warn(\"[DailyQuestSync] Pull ERROR:\", error);\n      return null;\n    }\n\n    return data;\n  } catch (e) {\n    console.warn(\"[DailyQuestSync] Pull exception:\", e.message);\n    return null;\n  }\n}\n\nexport async function pushDailyQuestToCloud(retry = true) {\n  try {\n    const store = useDailyQuestStore.getState();\n    const { date, questions, completed, rewardGiven } = store;\n\n    const { data: auth } = await supabase.auth.getUser();\n    if (!auth?.user) return;\n\n    const questDate = date || getToday();\n    const safeQuestions = Array.isArray(questions) ? questions : [];\n\n    const payload = {\n      user_id: auth.user.id,\n      quest_date: questDate,\n      questions: JSON.stringify(safeQuestions),\n      completed: Boolean(completed),\n      reward_given: Boolean(rewardGiven),\n      updated_at: new Date().toISOString(),\n    };\n\n    const { error } = await supabase\n      .from(\"daily_quests\")\n      .upsert(payload, { onConflict: \"user_id\" });\n\n    if (error) {\n      console.warn(\"[DailyQuestSync] Push ERROR:\", error);\n      if (retry) {\n        console.log(\"[DailyQuestSync] Retrying push...\");\n        await pushDailyQuestToCloud(false);\n      }\n    }\n  } catch (e) {\n    console.warn(\"[DailyQuestSync] Push exception:\", e.message);\n    if (retry) {\n      try {\n        await pushDailyQuestToCloud(false);\n      } catch (retryErr) {\n        console.warn(\"[DailyQuestSync] Retry failed:\", retryErr.message);\n      }\n    }\n  }\n}\n\nexport function mergeDailyQuest(cloud) {\n  if (!cloud) return;\n\n  try {\n    let questions = [];\n    if (cloud.questions) {\n      if (typeof cloud.questions === \"string\") {\n        try {\n          questions = JSON.parse(cloud.questions);\n        } catch (e) {\n          console.warn(\"[DailyQuestSync] Failed to parse questions JSON\");\n          questions = [];\n        }\n      } else if (Array.isArray(cloud.questions)) {\n        questions = cloud.questions;\n      }\n    }\n\n    if (!Array.isArray(questions) || questions.length === 0) {\n      console.warn(\"[DailyQuestSync] Invalid/empty questions, skipping merge\");\n      return;\n    }\n\n    const store = useDailyQuestStore.getState();\n    if (store.setDailyQuestFromSync) {\n      store.setDailyQuestFromSync({\n        quest_date: cloud.quest_date || getToday(),\n        questions: JSON.stringify(questions),\n        completed: cloud.completed || false,\n        reward_given: cloud.reward_given || false,\n      });\n    }\n  } catch (e) {\n    console.warn(\"[DailyQuestSync] mergeDailyQuest exception:\", e.message);\n  }\n}\n\nexport async function pullStreakShieldFromCloud() {\n  return null;\n}\n\nexport function mergeStreakShield() {\n  return;\n}\n","path":null,"size_bytes":3141,"size_tokens":null},"src/pages/quiz/QuestionStep.jsx":{"content":"import { useState } from \"react\";\n\nexport default function QuestionStep({ question, onAnswer }) {\n  const [selected, setSelected] = useState(null);\n  const [locked, setLocked] = useState(false);\n\n  const handleSelect = (option) => {\n    if (locked) return;\n\n    setSelected(option);\n    setLocked(true);\n\n    setTimeout(() => {\n      onAnswer(option);\n      setSelected(null);\n      setLocked(false);\n    }, 800);\n  };\n\n  return (\n    <div style={{ paddingBottom: 20 }}>\n      <h2 className=\"quiz-question-title\">{question.text}</h2>\n\n      <div className=\"quiz-options\">\n        {question.options.map((opt, index) => (\n          <button\n            key={index}\n            onClick={() => handleSelect(opt)}\n            disabled={locked}\n            className={`quiz-option ${selected === opt ? \"selected\" : \"\"}`}\n            style={{\n              padding: \"14px 16px\",\n              marginBottom: 12,\n              width: \"100%\",\n              borderRadius: 12,\n              background:\n                selected === opt ? \"var(--accent)\" : \"var(--card-bg)\",\n              color: selected === opt ? \"#fff\" : \"var(--text)\",\n              transition: \"all 0.25s ease\",\n            }}\n          >\n            {opt}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1277,"size_tokens":null},"src/sync/revisionSync.js":{"content":"import { supabase } from \"../lib/supabaseClient.js\";\nimport {\n  convertFromCloudRow,\n  convertToCloudRow,\n  mergeLocalAndCloud,\n  validateRevisionItem,\n} from \"./revisionData.js\";\nimport { useReviseStore } from \"../store/reviseStore.js\";\n\nexport async function pullCloudRevision() {\n  console.log(\"[RevisionSync] pullCloudRevision() start\");\n\n  const { data: userData } = await supabase.auth.getUser();\n  const userId = userData?.user?.id;\n  if (!userId) {\n    console.log(\"[RevisionSync] No user authenticated, skip pull\");\n    return [];\n  }\n\n  const { data, error } = await supabase\n    .from(\"revision_items\")\n    .select(\"*\")\n    .eq(\"user_id\", userId);\n\n  if (error) {\n    if (error.code === \"42P01\") {\n      console.log(\"[RevisionSync] Table not ready, using local-only mode\");\n      return [];\n    }\n    console.warn(\"[RevisionSync] pullCloudRevision ERROR:\", error);\n    return [];\n  }\n\n  console.log(`[RevisionSync] pullCloudRevision() fetched ${data?.length || 0} rows`);\n  return (data || []).map(convertFromCloudRow);\n}\n\nexport async function pushLocalRevision() {\n  console.log(\"[RevisionSync] pushLocalRevision() start\");\n\n  const items = useReviseStore.getState().getWeakPool() || [];\n  const ready = items.filter((i) => validateRevisionItem(i));\n  console.log(`[RevisionSync] weakPool size: ${items.length}, valid: ${ready.length}`);\n\n  const { data: userData } = await supabase.auth.getUser();\n  const userId = userData?.user?.id;\n  if (!userId) {\n    console.log(\"[RevisionSync] No user authenticated, skip push\");\n    return;\n  }\n\n  if (!ready.length) {\n    console.log(\"[RevisionSync] No valid items to push\");\n    return;\n  }\n\n  const rows = ready.map((i) => convertToCloudRow(userId, i));\n  console.log(`[RevisionSync] Prepared ${rows.length} rows for UPSERT`);\n\n  const { error } = await supabase\n    .from(\"revision_items\")\n    .upsert(rows, {\n      onConflict: \"user_id,lesson_id,card_id\",\n    });\n\n  if (error) {\n    if (error.code === \"42P01\" || error.code === \"42P10\") {\n      console.log(\"[RevisionSync] Table/constraint not ready, using local-only mode\");\n      return;\n    }\n    console.warn(\"[RevisionSync] UPSERT ERROR:\", error);\n    return;\n  }\n\n  useReviseStore.setState({ needsSync: false });\n  console.log(\"[RevisionSync] UPSERT successful\");\n}\n\nexport async function mergeRevisionData(cloudItems) {\n  console.log(\"[RevisionSync] mergeRevisionData() start\");\n\n  const localItems = useReviseStore.getState().getWeakPool() || [];\n  const safeCloudItems = Array.isArray(cloudItems) ? cloudItems : [];\n\n  const merged = mergeLocalAndCloud(localItems, safeCloudItems);\n  useReviseStore.getState().setWeakPool(merged);\n\n  console.log(`[RevisionSync] merge complete: local ${localItems.length} ‚Üí merged ${merged.length}`);\n}\n","path":null,"size_bytes":2758,"size_tokens":null},"src/sync/profileSync.js":{"content":"import { supabase } from \"../lib/supabaseClient.js\";\nimport { useProgressStore } from \"../store/progressStore.js\";\n\nconst DEFAULT_PROFILE = {\n  xp: 0,\n  coins: 0,\n  streak: 0,\n  shield_count: 0,\n};\n\nexport async function pullProfileFromCloud() {\n  try {\n    const { data: userData } = await supabase.auth.getUser();\n    const userId = userData?.user?.id;\n\n    if (!userId) return null;\n\n    const { data, error } = await supabase\n      .from(\"profiles\")\n      .select(\"xp, coins, streak, shield_count, premium, updated_at\")\n      .eq(\"user_id\", userId)\n      .maybeSingle();\n\n    if (error) {\n      if (error.code !== \"PGRST116\") {\n        console.warn(\"[ProfileSync] Pull error:\", error.message);\n      }\n      return null;\n    }\n\n    return data;\n  } catch (e) {\n    console.warn(\"[ProfileSync] Pull exception:\", e.message);\n    return null;\n  }\n}\n\nexport async function pushProfileToCloud(retry = true) {\n  try {\n    const { data: userData } = await supabase.auth.getUser();\n    const userId = userData?.user?.id;\n\n    if (!userId) return;\n\n    const progressState = useProgressStore.getState();\n    const payload = progressState.serializeForSupabase();\n\n    if (!payload || Object.keys(payload).length === 0) return;\n\n    const { error } = await supabase\n      .from(\"profiles\")\n      .update(payload)\n      .eq(\"user_id\", userId);\n\n    if (error) {\n      if (error.code !== \"PGRST116\") {\n        console.warn(\"[ProfileSync] Push error:\", error.message);\n      }\n      if (retry) {\n        await pushProfileToCloud(false);\n      }\n    }\n  } catch (e) {\n    console.warn(\"[ProfileSync] Push exception:\", e.message);\n    if (retry) {\n      try {\n        await pushProfileToCloud(false);\n      } catch (retryErr) {\n        console.warn(\"[ProfileSync] Retry failed:\", retryErr.message);\n      }\n    }\n  }\n}\n\nexport function mergeProfileData(cloud) {\n  if (!cloud) return;\n\n  const store = useProgressStore.getState();\n  const localTs = store.getLastUpdatedAt();\n  const cloudTs = cloud.updated_at ? new Date(cloud.updated_at).getTime() : 0;\n\n  if (cloudTs > localTs) {\n    store.setFromCloudSync({\n      xp: cloud.xp ?? DEFAULT_PROFILE.xp,\n      coins: cloud.coins ?? DEFAULT_PROFILE.coins,\n      streak: cloud.streak ?? DEFAULT_PROFILE.streak,\n      shieldCount: cloud.shield_count ?? DEFAULT_PROFILE.shield_count,\n      premium: cloud.premium ?? false,\n    }, cloud.updated_at);\n  }\n}\n","path":null,"size_bytes":2387,"size_tokens":null},"src/sync/engine.js":{"content":"import { safeCall } from \"../lib/supabaseSafe.js\";\n\nimport {\n  pullCloudRevision,\n  pushLocalRevision,\n  mergeRevisionData,\n} from \"./revisionSync.js\";\n\nimport {\n  pullProfileFromCloud,\n  pushProfileToCloud,\n  mergeProfileData,\n} from \"./profileSync.js\";\n\nimport {\n  pullDailyQuestFromCloud,\n  pullStreakShieldFromCloud,\n  pushDailyQuestToCloud,\n  mergeDailyQuest,\n  mergeStreakShield\n} from \"./dailyQuestSync.js\";\n\n// --------------------\n// SYNC ON APP OPEN\n// --------------------\nexport async function syncOnAppOpen() {\n  console.log(\"[SyncEngine] syncOnAppOpen()\");\n\n  try {\n    // 1. REVISION\n    const cloudRevision = await safeCall(() => pullCloudRevision(), []);\n    await mergeRevisionData(cloudRevision);\n    await safeCall(() => pushLocalRevision());\n\n    // 2. PROFILE\n    const cloudProfile = await safeCall(() => pullProfileFromCloud(), null);\n    mergeProfileData(cloudProfile);\n    await safeCall(() => pushProfileToCloud());\n\n    // 3. DAILY QUEST\n    const cloudQuest = await safeCall(() => pullDailyQuestFromCloud(), null);\n    mergeDailyQuest(cloudQuest);\n    await safeCall(() => pushDailyQuestToCloud());\n\n    // 4. STREAK SHIELD\n    const cloudShield = await safeCall(() => pullStreakShieldFromCloud(), null);\n    mergeStreakShield(cloudShield);\n  } catch (e) {\n    console.warn(\"[SyncEngine] syncOnAppOpen error:\", e.message);\n  }\n\n  console.log(\"[SyncEngine] syncOnAppOpen() complete\");\n}\n\n// --------------------\n// SYNC ON FOREGROUND\n// --------------------\nexport async function syncOnForeground() {\n  console.log(\"[SyncEngine] syncOnForeground()\");\n\n  try {\n    // REVISION\n    const cloudRevision = await safeCall(() => pullCloudRevision(), []);\n    await mergeRevisionData(cloudRevision);\n    await safeCall(() => pushLocalRevision());\n\n    // PROFILE\n    const cloudProfile = await safeCall(() => pullProfileFromCloud(), null);\n    mergeProfileData(cloudProfile);\n    await safeCall(() => pushProfileToCloud());\n\n    // DAILY QUEST\n    const cloudQuest = await safeCall(() => pullDailyQuestFromCloud(), null);\n    mergeDailyQuest(cloudQuest);\n    await safeCall(() => pushDailyQuestToCloud());\n\n    // STREAK SHIELD\n    const cloudShield = await safeCall(() => pullStreakShieldFromCloud(), null);\n    mergeStreakShield(cloudShield);\n  } catch (e) {\n    console.warn(\"[SyncEngine] syncOnForeground error:\", e.message);\n  }\n\n  console.log(\"[SyncEngine] syncOnForeground() complete\");\n}\n\n// --------------------\n// FULL SYNC\n// --------------------\nexport async function syncAll() {\n  console.log(\"[SyncEngine] syncAll()\");\n\n  try {\n    const cloudRevision = await safeCall(() => pullCloudRevision(), []);\n    await mergeRevisionData(cloudRevision);\n    await safeCall(() => pushLocalRevision());\n\n    const cloudProfile = await safeCall(() => pullProfileFromCloud(), null);\n    mergeProfileData(cloudProfile);\n    await safeCall(() => pushProfileToCloud());\n\n    // DAILY QUEST\n    const cloudQuest = await safeCall(() => pullDailyQuestFromCloud(), null);\n    mergeDailyQuest(cloudQuest);\n    await safeCall(() => pushDailyQuestToCloud());\n\n    // STREAK SHIELD\n    const cloudShield = await safeCall(() => pullStreakShieldFromCloud(), null);\n    mergeStreakShield(cloudShield);\n  } catch (e) {\n    console.warn(\"[SyncEngine] syncAll error:\", e.message);\n  }\n\n  console.log(\"[SyncEngine] syncAll() complete\");\n}\n\n// --------------------\n// PROFILE-ONLY SYNC\n// --------------------\nexport async function syncProfileOnly() {\n  console.log(\"[SyncEngine] syncProfileOnly()\");\n\n  try {\n    const cloudProfile = await safeCall(() => pullProfileFromCloud(), null);\n    mergeProfileData(cloudProfile);\n    await safeCall(() => pushProfileToCloud());\n  } catch (e) {\n    console.warn(\"[SyncEngine] syncProfileOnly error:\", e.message);\n  }\n\n  console.log(\"[SyncEngine] syncProfileOnly() complete\");\n}\n","path":null,"size_bytes":3823,"size_tokens":null},"src/sync/revisionData.js":{"content":"export function normalizeLocalRevisionItem(item) {\n  return {\n    cardId: item.cardId,\n    lessonId: item.lessonId,\n    timesCorrect: item.timesCorrect || 0,\n    timesWrong: item.timesWrong || 0,\n    lastReviewedAt: item.lastReviewedAt || null,\n    nextReviewAt: item.nextReviewAt || null,\n    updatedAt: item.updatedAt || Date.now(),\n  };\n}\n\nexport function convertFromCloudRow(row) {\n  return {\n    cardId: row.card_id,\n    lessonId: row.lesson_id,\n    timesCorrect: row.times_correct || 0,\n    timesWrong: row.times_wrong || 0,\n    lastReviewedAt: row.last_reviewed_at || null,\n    nextReviewAt: row.next_review_at || null,\n    updatedAt: new Date(row.updated_at || 0).getTime(),\n  };\n}\n\nexport function convertToCloudRow(userId, item) {\n  return {\n    user_id: userId,\n    lesson_id: item.lessonId,\n    card_id: item.cardId,\n    times_correct: item.timesCorrect || 0,\n    times_wrong: item.timesWrong || 0,\n    last_reviewed_at: item.lastReviewedAt\n      ? new Date(item.lastReviewedAt).toISOString()\n      : null,\n    next_review_at: item.nextReviewAt\n      ? new Date(item.nextReviewAt).toISOString()\n      : null,\n    updated_at: new Date(item.updatedAt || Date.now()).toISOString(),\n  };\n}\n\nexport function validateRevisionItem(item) {\n  return (\n    item &&\n    typeof item.cardId !== \"undefined\" &&\n    typeof item.lessonId !== \"undefined\"\n  );\n}\n\nexport function mergeLocalAndCloud(localArr, cloudArr) {\n  const map = new Map();\n\n  for (const c of cloudArr) {\n    if (!c || !c.cardId || !c.lessonId) continue;\n    map.set(`${c.lessonId}-${c.cardId}`, c);\n  }\n\n  for (const l of localArr) {\n    if (!l || !l.cardId || !l.lessonId) continue;\n    const key = `${l.lessonId}-${l.cardId}`;\n    if (!map.has(key)) {\n      map.set(key, l);\n    } else {\n      const existing = map.get(key);\n      if ((l.updatedAt || 0) > (existing.updatedAt || 0)) {\n        map.set(key, l);\n      }\n    }\n  }\n\n  return Array.from(map.values());\n}\n","path":null,"size_bytes":1935,"size_tokens":null},"supabase/functions/send-daily-notifications/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nserve(async (req) => {\n  try {\n    const supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\n    const serviceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\n    const oneSignalAppId = Deno.env.get(\"ONESIGNAL_APP_ID\");\n    const oneSignalApiKey = Deno.env.get(\"ONESIGNAL_REST_API_KEY\");\n\n    if (!supabaseUrl || !serviceKey) {\n      return new Response(\"Missing Supabase credentials\", { status: 500 });\n    }\n\n    if (!oneSignalAppId || !oneSignalApiKey) {\n      return new Response(\"Missing OneSignal credentials\", { status: 500 });\n    }\n\n    const supabase = createClient(supabaseUrl, serviceKey);\n\n    const { data: tokens, error } = await supabase\n      .from(\"push_tokens\")\n      .select(\"*\");\n\n    if (error) {\n      console.error(\"Error fetching tokens:\", error);\n      return new Response(`Error: ${error.message}`, { status: 500 });\n    }\n\n    if (!tokens || tokens.length === 0) {\n      return new Response(\"No tokens found\", { status: 200 });\n    }\n\n    let successCount = 0;\n    let failCount = 0;\n\n    for (const t of tokens) {\n      try {\n        const response = await fetch(\"https://onesignal.com/api/v1/notifications\", {\n          method: \"POST\",\n          headers: {\n            \"Authorization\": `Basic ${oneSignalApiKey}`,\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            app_id: oneSignalAppId,\n            include_player_ids: [t.device_token],\n            headings: { en: \"Don't lose your streak! üî•\" },\n            contents: { en: \"Come back and complete today's Daily Quest.\" },\n          }),\n        });\n\n        if (response.ok) {\n          successCount++;\n        } else {\n          failCount++;\n          console.error(`Failed to send to ${t.device_token}:`, await response.text());\n        }\n      } catch (err) {\n        failCount++;\n        console.error(`Error sending to ${t.device_token}:`, err);\n      }\n    }\n\n    return new Response(\n      JSON.stringify({\n        message: \"Notifications processed\",\n        success: successCount,\n        failed: failCount,\n        total: tokens.length,\n      }),\n      {\n        headers: { \"Content-Type\": \"application/json\" },\n        status: 200,\n      }\n    );\n  } catch (err) {\n    console.error(\"Function error:\", err);\n    return new Response(`Server error: ${err.message}`, { status: 500 });\n  }\n});\n","path":null,"size_bytes":2474,"size_tokens":null},"src/backend/lessonProgress.js":{"content":"import { supabase } from \"../lib/supabaseClient.js\";\n\nexport async function logLessonStart(userId, pathId, lessonId) {\n  const { error } = await supabase.from(\"lesson_progress\").insert({\n    user_id: userId,\n    path_id: pathId,\n    lesson_id: lessonId,\n    completed: false,\n    score: 0,\n    updated_at: new Date().toISOString(),\n  });\n  if (error) {\n    console.error(\"[LessonProgress] logLessonStart error:\", error);\n  } else {\n    console.log(\"[LessonProgress] logLessonStart success:\", pathId, lessonId);\n  }\n}\n\nexport async function logLessonComplete(userId, pathId, lessonId, score, passed) {\n  const { error } = await supabase.from(\"lesson_progress\").insert({\n    user_id: userId,\n    path_id: pathId,\n    lesson_id: lessonId,\n    completed: passed,\n    score: score,\n    updated_at: new Date().toISOString(),\n  });\n  if (error) {\n    console.error(\"[LessonProgress] logLessonComplete error:\", error);\n  } else {\n    console.log(\"[LessonProgress] logLessonComplete success:\", pathId, lessonId, score, passed);\n  }\n}\n\nexport async function logLessonExit(userId, pathId, lessonId) {\n  console.log(\"[LessonProgress] logLessonExit:\", pathId, lessonId);\n}\n","path":null,"size_bytes":1160,"size_tokens":null},"src/supabaseClient.js":{"content":"export { supabase, ensureSignedIn, getUID, logoutUser } from \"./lib/supabaseClient.js\";\n","path":null,"size_bytes":88,"size_tokens":null},"src/backend/streakLogs.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nexport async function logStreakEvent(userId, maintained = true) {\n  const today = new Date().toISOString().split(\"T\")[0];\n  const { error } = await supabase.from(\"streak_logs\").insert({\n    user_id: userId,\n    date: today,\n    maintained: maintained,\n    created_at: new Date().toISOString(),\n  });\n  if (error) {\n    console.error(\"[StreakLogs] logStreakEvent error:\", error);\n  } else {\n    console.log(\"[StreakLogs] logStreakEvent success:\", today, maintained);\n  }\n}\n","path":null,"size_bytes":523,"size_tokens":null},"src/backend/purchaseLogs.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nexport async function logPurchase(userId, productId, amount, currency = \"GBP\", platform = \"web\", receipt = null) {\n  const insertData = {\n    user_id: userId,\n    product_id: productId,\n    amount: amount,\n    currency: currency,\n    timestamp: Date.now(),\n  };\n  \n  if (platform) insertData.platform = platform;\n  if (receipt) insertData.receipt = receipt;\n  \n  const { error } = await supabase.from(\"purchases\").insert(insertData);\n  if (error) {\n    console.error(\"[PurchaseLogs] logPurchase error:\", error);\n  } else {\n    console.log(\"[PurchaseLogs] logPurchase success:\", productId, amount, platform);\n  }\n}\n\nexport async function checkExistingPurchase(userId) {\n  const { data, error } = await supabase\n    .from(\"purchases\")\n    .select(\"*\")\n    .eq(\"user_id\", userId)\n    .order(\"timestamp\", { ascending: false })\n    .limit(1);\n    \n  if (error) {\n    console.error(\"[PurchaseLogs] checkExistingPurchase error:\", error);\n    return null;\n  }\n  \n  return data?.[0] || null;\n}\n","path":null,"size_bytes":1036,"size_tokens":null},"src/backend/challengeLogs.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nexport async function logChallengeRequest(userId, mode, opponentId = null) {\n  const { error } = await supabase.from(\"challenge_logs\").insert({\n    user_id: userId,\n    event_type: \"request\",\n    challenge_mode: mode,\n    opponent_id: opponentId,\n    timestamp: Date.now(),\n  });\n  if (!error) {\n    console.log(\"[ChallengeLogs] logChallengeRequest success:\", mode);\n  }\n}\n\nexport async function logChallengeResult(userId, mode, result, xpEarned, opponentId = null) {\n  const { error } = await supabase.from(\"challenge_logs\").insert({\n    user_id: userId,\n    event_type: \"result\",\n    challenge_mode: mode,\n    opponent_id: opponentId,\n    result,\n    xp_earned: xpEarned,\n    timestamp: Date.now(),\n  });\n  if (!error) {\n    console.log(\"[ChallengeLogs] logChallengeResult success:\", mode, result, xpEarned);\n  }\n}\n","path":null,"size_bytes":868,"size_tokens":null},"src/backend/xpLogs.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nexport async function logXpEvent(userId, amount, source) {\n  const { error } = await supabase.from(\"xp_logs\").insert({\n    user_id: userId,\n    amount: amount,\n    source: source,\n    timestamp: Date.now(),\n  });\n  if (error) {\n    console.error(\"[XpLogs] logXpEvent error:\", error);\n  } else {\n    console.log(\"[XpLogs] logXpEvent success:\", amount, source);\n  }\n}\n","path":null,"size_bytes":417,"size_tokens":null},"src/backend/leaderboardSnapshots.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nexport async function createDailyLeaderboardSnapshot() {\n  const today = new Date().toISOString().split(\"T\")[0];\n\n  // Fetch global leaderboard\n  const { data: profiles } = await supabase\n    .from(\"profiles\")\n    .select(\"user_id, xp, streak, username, avatar\")\n    .order(\"xp\", { ascending: false })\n    .limit(100);\n\n  // Fetch event entries\n  const { data: events } = await supabase\n    .from(\"event_entries\")\n    .select(\"*\");\n\n  // Insert global leaderboard\n  const { error: globalErr } = await supabase.from(\"leaderboard_snapshots\").upsert({\n    snapshot_date: today,\n    leaderboard_type: \"global\",\n    data: profiles || [],\n  }, { onConflict: \"snapshot_date,leaderboard_type\" });\n\n  if (globalErr) {\n    console.error(\"[LeaderboardSnapshots] global snapshot error:\", globalErr);\n  }\n\n  // Insert event leaderboard\n  const { error: eventErr } = await supabase.from(\"leaderboard_snapshots\").upsert({\n    snapshot_date: today,\n    leaderboard_type: \"event\",\n    data: events || [],\n  }, { onConflict: \"snapshot_date,leaderboard_type\" });\n\n  if (eventErr) {\n    console.error(\"[LeaderboardSnapshots] event snapshot error:\", eventErr);\n  }\n\n  // Insert streak leaderboard\n  const streakData = profiles\n    ? [...profiles].sort((a, b) => (b.streak || 0) - (a.streak || 0)).slice(0, 50)\n    : [];\n\n  const { error: streakErr } = await supabase.from(\"leaderboard_snapshots\").upsert({\n    snapshot_date: today,\n    leaderboard_type: \"streak\",\n    data: streakData,\n  }, { onConflict: \"snapshot_date,leaderboard_type\" });\n\n  if (streakErr) {\n    console.error(\"[LeaderboardSnapshots] streak snapshot error:\", streakErr);\n  } else {\n    console.log(\"[LeaderboardSnapshots] Daily snapshot created for\", today);\n  }\n}\n","path":null,"size_bytes":1765,"size_tokens":null},"src/pages/ResetPassword.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport { Lock, Eye, EyeOff, Check, X } from \"lucide-react\";\nimport { supabase } from \"../lib/supabaseClient\";\n\nexport default function ResetPassword() {\n  const navigate = useNavigate();\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [hashError, setHashError] = useState(\"\");\n\n  useEffect(() => {\n    const hash = window.location.hash;\n    if (hash.includes(\"error=\")) {\n      const params = new URLSearchParams(hash.substring(1));\n      const errorDesc = params.get(\"error_description\");\n      if (errorDesc) {\n        setHashError(decodeURIComponent(errorDesc.replace(/\\+/g, \" \")));\n      } else {\n        setHashError(\"The reset link is invalid or has expired. Please request a new one.\");\n      }\n    }\n  }, []);\n\n  const handleReset = async () => {\n    if (!password.trim()) {\n      setError(\"Please enter a new password.\");\n      return;\n    }\n\n    if (password.length < 6) {\n      setError(\"Password must be at least 6 characters.\");\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      setError(\"Passwords do not match.\");\n      return;\n    }\n\n    setLoading(true);\n    setError(\"\");\n\n    try {\n      const { error: updateError } = await supabase.auth.updateUser({\n        password: password,\n      });\n\n      if (updateError) {\n        setError(updateError.message || \"Failed to update password.\");\n        setLoading(false);\n        return;\n      }\n\n      setSuccess(true);\n      setLoading(false);\n\n      setTimeout(() => {\n        navigate(\"/auth\");\n      }, 2000);\n    } catch (err) {\n      setError(\"Something went wrong. Please try again.\");\n      setLoading(false);\n    }\n  };\n\n  if (hashError) {\n    return (\n      <div\n        className=\"screen no-extra-space flex items-center justify-center px-4\"\n        style={{\n          background: \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n        }}\n      >\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          style={{\n            background: \"linear-gradient(180deg, #0f1a2e 0%, #0a1220 100%)\",\n            border: \"1px solid rgba(255,255,255,0.1)\",\n            borderRadius: \"20px\",\n            padding: \"32px 24px\",\n            maxWidth: \"380px\",\n            width: \"100%\",\n            textAlign: \"center\",\n          }}\n        >\n          <div\n            style={{\n              width: \"60px\",\n              height: \"60px\",\n              borderRadius: \"50%\",\n              background: \"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              margin: \"0 auto 20px\",\n            }}\n          >\n            <X size={28} color=\"#fff\" />\n          </div>\n\n          <h2\n            style={{\n              fontSize: \"1.25rem\",\n              fontWeight: 700,\n              color: \"#ef4444\",\n              marginBottom: \"12px\",\n            }}\n          >\n            Link Expired\n          </h2>\n\n          <p style={{ color: \"rgba(255,255,255,0.7)\", fontSize: \"0.9rem\", marginBottom: \"24px\", lineHeight: 1.6 }}>\n            {hashError}\n          </p>\n\n          <button\n            onClick={() => navigate(\"/auth\")}\n            style={{\n              background: \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\",\n              border: \"none\",\n              borderRadius: \"12px\",\n              padding: \"14px 24px\",\n              color: \"#fff\",\n              fontWeight: 600,\n              cursor: \"pointer\",\n              width: \"100%\",\n            }}\n          >\n            Back to Login\n          </button>\n        </motion.div>\n      </div>\n    );\n  }\n\n  if (success) {\n    return (\n      <div\n        className=\"screen no-extra-space flex items-center justify-center px-4\"\n        style={{\n          background: \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n        }}\n      >\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          style={{\n            background: \"linear-gradient(180deg, #0f1a2e 0%, #0a1220 100%)\",\n            border: \"1px solid rgba(255,255,255,0.1)\",\n            borderRadius: \"20px\",\n            padding: \"32px 24px\",\n            maxWidth: \"380px\",\n            width: \"100%\",\n            textAlign: \"center\",\n          }}\n        >\n          <div\n            style={{\n              width: \"60px\",\n              height: \"60px\",\n              borderRadius: \"50%\",\n              background: \"linear-gradient(135deg, #10b981 0%, #059669 100%)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              margin: \"0 auto 20px\",\n            }}\n          >\n            <Check size={28} color=\"#fff\" />\n          </div>\n\n          <h2\n            style={{\n              fontSize: \"1.25rem\",\n              fontWeight: 700,\n              color: \"#10b981\",\n              marginBottom: \"12px\",\n            }}\n          >\n            Password Updated!\n          </h2>\n\n          <p style={{ color: \"rgba(255,255,255,0.7)\", fontSize: \"0.9rem\", lineHeight: 1.6 }}>\n            Your password has been successfully reset. Redirecting you to the app...\n          </p>\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"screen no-extra-space flex items-center justify-center px-4\"\n      style={{\n        background: \"radial-gradient(circle at 20% 20%, rgba(10,15,30,1) 0%, rgba(3,6,20,1) 70%)\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, scale: 0.95 }}\n        animate={{ opacity: 1, scale: 1 }}\n        style={{\n          background: \"linear-gradient(180deg, #0f1a2e 0%, #0a1220 100%)\",\n          border: \"1px solid rgba(255,255,255,0.1)\",\n          borderRadius: \"20px\",\n          padding: \"32px 24px\",\n          maxWidth: \"380px\",\n          width: \"100%\",\n        }}\n      >\n        <h2\n          style={{\n            fontSize: \"1.5rem\",\n            fontWeight: 700,\n            background: \"linear-gradient(90deg, #fff 0%, #ffd88a 100%)\",\n            WebkitBackgroundClip: \"text\",\n            WebkitTextFillColor: \"transparent\",\n            marginBottom: \"8px\",\n            textAlign: \"center\",\n          }}\n        >\n          Set New Password\n        </h2>\n\n        <p style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.9rem\", marginBottom: \"24px\", textAlign: \"center\" }}>\n          Enter your new password below\n        </p>\n\n        <div style={{ position: \"relative\", marginBottom: \"16px\" }}>\n          <Lock\n            size={18}\n            color=\"rgba(255,255,255,0.4)\"\n            style={{\n              position: \"absolute\",\n              left: \"14px\",\n              top: \"50%\",\n              transform: \"translateY(-50%)\",\n            }}\n          />\n          <input\n            type={showPassword ? \"text\" : \"password\"}\n            placeholder=\"New password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            style={{\n              width: \"100%\",\n              background: \"#0b1e36\",\n              border: \"1px solid rgba(255,255,255,0.1)\",\n              borderRadius: \"12px\",\n              padding: \"14px 44px 14px 42px\",\n              color: \"#fff\",\n              fontSize: \"0.95rem\",\n              outline: \"none\",\n            }}\n          />\n          <button\n            type=\"button\"\n            onClick={() => setShowPassword(!showPassword)}\n            style={{\n              position: \"absolute\",\n              right: \"14px\",\n              top: \"50%\",\n              transform: \"translateY(-50%)\",\n              background: \"transparent\",\n              border: \"none\",\n              cursor: \"pointer\",\n              padding: 0,\n            }}\n          >\n            {showPassword ? (\n              <EyeOff size={18} color=\"rgba(255,255,255,0.4)\" />\n            ) : (\n              <Eye size={18} color=\"rgba(255,255,255,0.4)\" />\n            )}\n          </button>\n        </div>\n\n        <div style={{ position: \"relative\", marginBottom: \"16px\" }}>\n          <Lock\n            size={18}\n            color=\"rgba(255,255,255,0.4)\"\n            style={{\n              position: \"absolute\",\n              left: \"14px\",\n              top: \"50%\",\n              transform: \"translateY(-50%)\",\n            }}\n          />\n          <input\n            type={showConfirmPassword ? \"text\" : \"password\"}\n            placeholder=\"Confirm new password\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n            onKeyDown={(e) => e.key === \"Enter\" && handleReset()}\n            style={{\n              width: \"100%\",\n              background: \"#0b1e36\",\n              border: \"1px solid rgba(255,255,255,0.1)\",\n              borderRadius: \"12px\",\n              padding: \"14px 44px 14px 42px\",\n              color: \"#fff\",\n              fontSize: \"0.95rem\",\n              outline: \"none\",\n            }}\n          />\n          <button\n            type=\"button\"\n            onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n            style={{\n              position: \"absolute\",\n              right: \"14px\",\n              top: \"50%\",\n              transform: \"translateY(-50%)\",\n              background: \"transparent\",\n              border: \"none\",\n              cursor: \"pointer\",\n              padding: 0,\n            }}\n          >\n            {showConfirmPassword ? (\n              <EyeOff size={18} color=\"rgba(255,255,255,0.4)\" />\n            ) : (\n              <Eye size={18} color=\"rgba(255,255,255,0.4)\" />\n            )}\n          </button>\n        </div>\n\n        {error && (\n          <motion.p\n            initial={{ opacity: 0, y: -5 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{ color: \"#ef4444\", fontSize: \"0.85rem\", marginBottom: \"16px\", textAlign: \"center\" }}\n          >\n            {error}\n          </motion.p>\n        )}\n\n        <button\n          onClick={handleReset}\n          disabled={loading}\n          style={{\n            width: \"100%\",\n            background: loading\n              ? \"rgba(139, 92, 246, 0.5)\"\n              : \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            padding: \"14px\",\n            color: \"#fff\",\n            fontWeight: 600,\n            fontSize: \"0.95rem\",\n            cursor: loading ? \"not-allowed\" : \"pointer\",\n          }}\n        >\n          {loading ? \"Updating...\" : \"Update Password\"}\n        </button>\n\n        <button\n          onClick={() => navigate(\"/auth\")}\n          style={{\n            width: \"100%\",\n            background: \"transparent\",\n            border: \"1px solid rgba(255,255,255,0.2)\",\n            borderRadius: \"12px\",\n            padding: \"12px\",\n            color: \"rgba(255,255,255,0.7)\",\n            fontWeight: 500,\n            fontSize: \"0.9rem\",\n            cursor: \"pointer\",\n            marginTop: \"12px\",\n          }}\n        >\n          Back to Login\n        </button>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11526,"size_tokens":null},"src/components/challenges/BossPlayedTodayModal.jsx":{"content":"import ZaydChallenge from \"../../assets/mascots/mascot_boss.webp\";\nimport \"./ChallengeModals.css\";\n\nexport default function BossPlayedTodayModal({ onClose }) {\n  return (\n    <div className=\"challenge-modal-overlay\">\n      <div className=\"challenge-modal\">\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={ZaydChallenge} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            You've already conquered the Boss Level today! Rest up and come back tomorrow!\n          </div>\n        </div>\n\n        <h2 className=\"challenge-modal-title\" style={{ color: \"#d4af37\" }}>\n          Already Played Today\n        </h2>\n\n        <p style={{ color: \"#cbd5e1\", fontSize: \"0.95rem\", lineHeight: 1.6, marginBottom: 20 }}>\n          The Boss Level challenge can only be attempted <strong style={{ color: \"#10b981\" }}>once per day</strong>. \n          This keeps the challenge special and gives you time to study!\n        </p>\n\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={onClose}\n          style={{\n            background: \"linear-gradient(135deg, #1e3a5f, #0f1c2e)\",\n            boxShadow: \"0 4px 15px rgba(30, 58, 95, 0.4)\"\n          }}\n        >\n          Got it! üëç\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1415,"size_tokens":null},"supabase/functions/register-device/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n  \n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { userId, deviceId } = await req.json();\n    \n    if (!userId || !deviceId) {\n      return new Response(\n        JSON.stringify({ error: \"Missing userId or deviceId\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: user, error: fetchError } = await supabase\n      .from(\"users\")\n      .select(\"active_device_id\")\n      .eq(\"id\", userId)\n      .maybeSingle();\n    \n    if (fetchError) {\n      console.error(\"User fetch error:\", fetchError);\n    }\n    \n    let isNewDevice = false;\n    let previousDeviceLoggedOut = false;\n    \n    if (!user) {\n      const { error: insertError } = await supabase\n        .from(\"users\")\n        .insert({\n          id: userId,\n          active_device_id: deviceId,\n          premium: false,\n          created_at: new Date().toISOString()\n        });\n      \n      if (insertError) {\n        console.error(\"User insert error:\", insertError);\n      }\n      \n      isNewDevice = true;\n    } else if (!user.active_device_id) {\n      const { error: updateError } = await supabase\n        .from(\"users\")\n        .update({ \n          active_device_id: deviceId,\n          updated_at: new Date().toISOString()\n        })\n        .eq(\"id\", userId);\n      \n      if (updateError) {\n        console.error(\"Device update error:\", updateError);\n      }\n      \n      isNewDevice = true;\n    } else if (user.active_device_id !== deviceId) {\n      const { error: updateError } = await supabase\n        .from(\"users\")\n        .update({ \n          active_device_id: deviceId,\n          updated_at: new Date().toISOString()\n        })\n        .eq(\"id\", userId);\n      \n      if (updateError) {\n        console.error(\"Device switch error:\", updateError);\n      }\n      \n      isNewDevice = true;\n      previousDeviceLoggedOut = true;\n      \n      console.log(`[DeviceLimit] User ${userId} switched from device ${user.active_device_id} to ${deviceId}`);\n    }\n    \n    return new Response(\n      JSON.stringify({\n        success: true,\n        isNewDevice: isNewDevice,\n        previousDeviceLoggedOut: previousDeviceLoggedOut\n      }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"Device registration error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":3388,"size_tokens":null},"src/services/analyticsService.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\nimport { getDeviceId } from \"./deviceService\";\n\nconst getPlatform = () => {\n  const userAgent = navigator.userAgent || \"\";\n  if (/iPad|iPhone|iPod/.test(userAgent)) return \"ios\";\n  if (/Android/.test(userAgent)) return \"android\";\n  return \"web\";\n};\n\nexport const logEvent = async (eventType, eventDetails = {}) => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    const userId = user?.id || null;\n    \n    let deviceId = null;\n    try {\n      deviceId = await getDeviceId();\n    } catch (e) {\n      console.warn(\"[Analytics] Could not get device ID:\", e);\n    }\n\n    const platform = getPlatform();\n\n    if (process.env.NODE_ENV === \"development\") {\n      console.log(\"[Analytics]\", eventType, { userId, deviceId, platform, ...eventDetails });\n    }\n\n    await supabase.functions.invoke(\"log-event\", {\n      body: {\n        event_type: eventType,\n        user_id: userId,\n        device_id: deviceId,\n        platform,\n        event_details: eventDetails,\n      },\n    });\n\n    return true;\n  } catch (error) {\n    console.error(\"[Analytics] Failed to log event:\", error);\n    return false;\n  }\n};\n\nexport const ANALYTICS_EVENTS = {\n  PURCHASE_INITIATED: \"purchase_initiated\",\n  PURCHASE_TOKEN_RECEIVED: \"purchase_token_received\",\n  PURCHASE_VERIFIED_SERVER: \"purchase_verified_server\",\n  PURCHASE_REFUNDED: \"purchase_refunded\",\n  PURCHASE_REVOKED: \"purchase_revoked\",\n  RESTORE_PURCHASES_ATTEMPTED: \"restore_purchases_attempted\",\n  RESTORE_PURCHASES_SUCCESS: \"restore_purchases_success\",\n  RESTORE_PURCHASES_FAILED: \"restore_purchases_failed\",\n\n  FAMILY_INVITE_SENT: \"family_invite_sent\",\n  FAMILY_INVITE_LINK_OPENED: \"family_invite_link_opened\",\n  FAMILY_INVITE_ACCEPTED: \"family_invite_accepted\",\n  FAMILY_INVITE_FAILED: \"family_invite_failed\",\n  FAMILY_LIMIT_REACHED: \"family_limit_reached\",\n\n  LOGIN_SUCCESS: \"login_success\",\n  LOGIN_FAILED: \"login_failed\",\n  ACTIVE_DEVICE_CHANGED: \"active_device_changed\",\n  DEVICE_LIMIT_TRIGGERED: \"device_limit_triggered\",\n  LOGOUT: \"logout\",\n\n  RECEIPT_REPLAY_BLOCKED: \"receipt_replay_blocked\",\n  INVALID_RECEIPT: \"invalid_receipt\",\n  REFUNDED_RECEIPT_DETECTED: \"refunded_receipt_detected\",\n\n  NETWORK_ERROR: \"network_error\",\n  SUPABASE_ERROR: \"supabase_error\",\n  UNKNOWN_ERROR: \"unknown_error\",\n\n  ACCOUNT_DELETED: \"account_deleted\",\n};\n","path":null,"size_bytes":2357,"size_tokens":null},"src/services/purchaseVerificationService.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\n\nconst SUPABASE_FUNCTIONS_URL = import.meta.env.VITE_SUPABASE_URL?.replace(\".supabase.co\", \".supabase.co/functions/v1\") || \"\";\n\nexport const verifyReceipt = async ({ platform, productId, receipt, userId, deviceId, nonce, isRestore = false }) => {\n  try {\n    const endpoint = platform === \"ios\" ? \"verify-apple-receipt\" : \"verify-google-receipt\";\n    \n    const { data: session } = await supabase.auth.getSession();\n    const accessToken = session?.session?.access_token;\n    \n    if (!accessToken) {\n      console.error(\"[VerificationService] No auth session\");\n      return { success: false, error: \"Not authenticated\" };\n    }\n    \n    const response = await fetch(`${SUPABASE_FUNCTIONS_URL}/${endpoint}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${accessToken}`\n      },\n      body: JSON.stringify({\n        receipt,\n        productId,\n        userId,\n        deviceId,\n        nonce,\n        isRestore\n      })\n    });\n    \n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      console.error(\"[VerificationService] Backend error:\", errorData);\n      return { \n        success: false, \n        error: errorData.error || `Verification failed (${response.status})` \n      };\n    }\n    \n    const result = await response.json();\n    \n    if (result.verified) {\n      console.log(\"[VerificationService] Purchase verified successfully\");\n      return { \n        success: true, \n        premium: true,\n        planType: result.planType,\n        purchaseId: result.purchaseId\n      };\n    } else {\n      console.error(\"[VerificationService] Verification rejected:\", result.reason);\n      return { \n        success: false, \n        error: result.reason || \"Purchase verification failed\" \n      };\n    }\n  } catch (error) {\n    console.error(\"[VerificationService] Network error:\", error);\n    return { success: false, error: \"Network error during verification\" };\n  }\n};\n\nexport const validatePremiumStatus = async (userId, deviceId) => {\n  try {\n    const { data: session } = await supabase.auth.getSession();\n    const accessToken = session?.session?.access_token;\n    \n    if (!accessToken) {\n      return { premium: false, error: \"Not authenticated\" };\n    }\n    \n    const response = await fetch(`${SUPABASE_FUNCTIONS_URL}/validate-premium-status`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${accessToken}`\n      },\n      body: JSON.stringify({ userId, deviceId })\n    });\n    \n    if (!response.ok) {\n      console.error(\"[VerificationService] Status check failed\");\n      return { premium: false, error: \"Status check failed\" };\n    }\n    \n    const result = await response.json();\n    return {\n      premium: result.premium,\n      planType: result.planType,\n      deviceMatch: result.deviceMatch,\n      familyGroupId: result.familyGroupId\n    };\n  } catch (error) {\n    console.error(\"[VerificationService] Status check error:\", error);\n    return { premium: false, error: error.message };\n  }\n};\n\nexport const registerDevice = async (userId, deviceId) => {\n  try {\n    const { data: session } = await supabase.auth.getSession();\n    const accessToken = session?.session?.access_token;\n    \n    if (!accessToken) {\n      return { success: false, error: \"Not authenticated\" };\n    }\n    \n    const response = await fetch(`${SUPABASE_FUNCTIONS_URL}/register-device`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${accessToken}`\n      },\n      body: JSON.stringify({ userId, deviceId })\n    });\n    \n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      return { success: false, error: errorData.error || \"Device registration failed\" };\n    }\n    \n    const result = await response.json();\n    return {\n      success: true,\n      isNewDevice: result.isNewDevice,\n      previousDeviceLoggedOut: result.previousDeviceLoggedOut\n    };\n  } catch (error) {\n    console.error(\"[VerificationService] Device registration error:\", error);\n    return { success: false, error: error.message };\n  }\n};\n\nexport default {\n  verifyReceipt,\n  validatePremiumStatus,\n  registerDevice\n};\n","path":null,"size_bytes":4329,"size_tokens":null},"src/services/iapService.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\nimport { getDeviceId, hashDeviceId } from \"./deviceService\";\nimport { verifyReceipt, validatePremiumStatus } from \"./purchaseVerificationService\";\nimport { logEvent, ANALYTICS_EVENTS } from \"./analyticsService\";\n\nconst PRODUCTS = {\n  premium_lifetime: {\n    id: \"premium_lifetime\",\n    googleId: \"premium_lifetime\",\n    appleId: \"premium_lifetime\",\n    type: \"non-consumable\",\n    planType: \"single\"\n  }\n};\n\nlet storeKit = null;\nlet googleBilling = null;\nlet platformType = null;\n\nconst detectPlatform = () => {\n  if (typeof window === \"undefined\") return null;\n  \n  if (window.Capacitor?.isNativePlatform()) {\n    return window.Capacitor.getPlatform();\n  }\n  \n  const userAgent = navigator.userAgent || \"\";\n  if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n    return \"ios\";\n  }\n  if (/android/i.test(userAgent)) {\n    return \"android\";\n  }\n  \n  return null;\n};\n\nexport const initializeIAP = async () => {\n  platformType = detectPlatform();\n  \n  if (!platformType) {\n    console.log(\"[IAP] Web environment - IAP not available\");\n    return { success: false, platform: \"web\" };\n  }\n  \n  try {\n    if (platformType === \"ios\") {\n      if (window.webkit?.messageHandlers?.storeKit) {\n        storeKit = window.webkit.messageHandlers.storeKit;\n        console.log(\"[IAP] StoreKit initialized\");\n        return { success: true, platform: \"ios\" };\n      }\n      \n      if (window.CdvPurchase?.store) {\n        storeKit = window.CdvPurchase.store;\n        await registerProducts(storeKit, \"ios\");\n        console.log(\"[IAP] CdvPurchase StoreKit initialized\");\n        return { success: true, platform: \"ios\" };\n      }\n    }\n    \n    if (platformType === \"android\") {\n      if (window.CdvPurchase?.store) {\n        googleBilling = window.CdvPurchase.store;\n        await registerProducts(googleBilling, \"android\");\n        console.log(\"[IAP] Google Play Billing initialized\");\n        return { success: true, platform: \"android\" };\n      }\n      \n      if (window.PlayBilling) {\n        googleBilling = window.PlayBilling;\n        console.log(\"[IAP] PlayBilling initialized\");\n        return { success: true, platform: \"android\" };\n      }\n    }\n    \n    console.log(\"[IAP] No native billing plugin found\");\n    return { success: false, platform: platformType, error: \"No billing plugin available\" };\n  } catch (error) {\n    console.error(\"[IAP] Initialization error:\", error);\n    return { success: false, platform: platformType, error: error.message };\n  }\n};\n\nconst registerProducts = async (store, platform) => {\n  const productType = store.NON_CONSUMABLE || \"non consumable\";\n  \n  Object.values(PRODUCTS).forEach(product => {\n    const storeId = platform === \"ios\" ? product.appleId : product.googleId;\n    store.register({\n      id: storeId,\n      type: productType\n    });\n  });\n  \n  await store.refresh();\n};\n\nexport const loadProducts = async () => {\n  const initResult = await initializeIAP();\n  \n  if (!initResult.success) {\n    return Object.values(PRODUCTS).map(p => ({\n      id: p.id,\n      title: \"Lifetime Premium\",\n      description: \"Unlock all features forever\",\n      available: false,\n      requiresNativeApp: true\n    }));\n  }\n  \n  const store = platformType === \"ios\" ? storeKit : googleBilling;\n  \n  try {\n    const products = Object.values(PRODUCTS).map(product => {\n      const storeId = platformType === \"ios\" ? product.appleId : product.googleId;\n      const storeProduct = store.get?.(storeId) || store.products?.find(p => p.id === storeId);\n      \n      return {\n        id: product.id,\n        storeId: storeId,\n        title: storeProduct?.title || \"Lifetime Premium\",\n        description: storeProduct?.description || \"Unlock all features forever\",\n        price: storeProduct?.price || \"Loading...\",\n        priceAmount: storeProduct?.priceMicros ? storeProduct.priceMicros / 1000000 : null,\n        currency: storeProduct?.currency || \"GBP\",\n        available: !!storeProduct\n      };\n    });\n    \n    return products;\n  } catch (error) {\n    console.error(\"[IAP] Error loading products:\", error);\n    return [];\n  }\n};\n\nconst generateNonce = () => {\n  const array = new Uint8Array(32);\n  crypto.getRandomValues(array);\n  return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n};\n\nexport const purchase = async (productId) => {\n  const product = PRODUCTS[productId];\n  if (!product) {\n    return { success: false, error: \"Invalid product ID\" };\n  }\n  \n  const initResult = await initializeIAP();\n  if (!initResult.success) {\n    return { \n      success: false, \n      error: \"Please download the app from App Store or Google Play to make purchases\",\n      requiresNativeApp: true\n    };\n  }\n  \n  const { data: userData } = await supabase.auth.getUser();\n  if (!userData?.user?.id) {\n    return { success: false, error: \"Please sign in to make a purchase\" };\n  }\n  \n  const userId = userData.user.id;\n  const deviceId = await getDeviceId();\n  const hashedDeviceId = await hashDeviceId(deviceId);\n  const nonce = generateNonce();\n  \n  logEvent(ANALYTICS_EVENTS.PURCHASE_INITIATED, { productId, platform: platformType });\n  \n  const store = platformType === \"ios\" ? storeKit : googleBilling;\n  const storeId = platformType === \"ios\" ? product.appleId : product.googleId;\n  \n  return new Promise((resolve) => {\n    const timeout = setTimeout(() => {\n      resolve({ success: false, error: \"Purchase timed out\" });\n    }, 120000);\n    \n    const handlePurchaseComplete = async (purchasedProduct) => {\n      clearTimeout(timeout);\n      \n      try {\n        const receipt = purchasedProduct.transaction?.receipt \n          || purchasedProduct.receipt \n          || purchasedProduct.purchaseToken;\n        \n        if (!receipt) {\n          resolve({ success: false, error: \"No receipt received\" });\n          return;\n        }\n        \n        console.log(\"[IAP] Receipt received, sending to backend for verification...\");\n        logEvent(ANALYTICS_EVENTS.PURCHASE_TOKEN_RECEIVED, { productId: product.id, platform: platformType });\n        \n        const verificationResult = await verifyReceipt({\n          platform: platformType,\n          productId: product.id,\n          receipt: receipt,\n          userId: userId,\n          deviceId: hashedDeviceId,\n          nonce: nonce\n        });\n        \n        if (!verificationResult.success) {\n          console.error(\"[IAP] Backend verification failed:\", verificationResult.error);\n          logEvent(ANALYTICS_EVENTS.INVALID_RECEIPT, { productId: product.id, error: verificationResult.error });\n          resolve({ success: false, error: verificationResult.error || \"Purchase verification failed\" });\n          return;\n        }\n        \n        logEvent(ANALYTICS_EVENTS.PURCHASE_VERIFIED_SERVER, { productId: product.id, platform: platformType });\n        \n        if (store.finish) {\n          await store.finish(purchasedProduct);\n        }\n        \n        console.log(\"[IAP] Purchase verified and completed successfully\");\n        resolve({ \n          success: true, \n          platform: platformType, \n          productId: product.id,\n          planType: product.planType\n        });\n      } catch (error) {\n        console.error(\"[IAP] Error processing purchase:\", error);\n        resolve({ success: false, error: error.message });\n      }\n    };\n    \n    const handlePurchaseError = (error) => {\n      clearTimeout(timeout);\n      console.error(\"[IAP] Purchase error:\", error);\n      \n      if (error.code === \"E_USER_CANCELLED\" || error.message?.includes(\"cancel\")) {\n        resolve({ success: false, error: \"Purchase cancelled\", cancelled: true });\n      } else {\n        resolve({ success: false, error: error.message || \"Purchase failed\" });\n      }\n    };\n    \n    try {\n      if (store.when) {\n        store.when(storeId).approved(handlePurchaseComplete);\n        store.when(storeId).error(handlePurchaseError);\n        store.when(storeId).cancelled(() => {\n          clearTimeout(timeout);\n          resolve({ success: false, error: \"Purchase cancelled\", cancelled: true });\n        });\n      }\n      \n      if (store.order) {\n        store.order(storeId);\n      } else if (store.purchase) {\n        store.purchase({ productId: storeId });\n      } else {\n        clearTimeout(timeout);\n        resolve({ success: false, error: \"Purchase method not available\" });\n      }\n    } catch (error) {\n      clearTimeout(timeout);\n      handlePurchaseError(error);\n    }\n  });\n};\n\nexport const restorePurchases = async () => {\n  const initResult = await initializeIAP();\n  \n  const { data: userData } = await supabase.auth.getUser();\n  if (!userData?.user?.id) {\n    return { success: false, error: \"Please sign in to restore purchases\" };\n  }\n  \n  const userId = userData.user.id;\n  const deviceId = await getDeviceId();\n  const hashedDeviceId = await hashDeviceId(deviceId);\n  \n  logEvent(ANALYTICS_EVENTS.RESTORE_PURCHASES_ATTEMPTED, { platform: platformType });\n  \n  const backendResult = await validatePremiumStatus(userId, hashedDeviceId);\n  \n  if (backendResult.requiresDeviceTransfer) {\n    console.log(\"[IAP] Premium exists but requires device transfer\");\n    logEvent(ANALYTICS_EVENTS.DEVICE_LIMIT_TRIGGERED, { planType: backendResult.planType });\n    return {\n      success: false,\n      verified: false,\n      requiresDeviceTransfer: true,\n      planType: backendResult.planType,\n      error: \"Your premium is active on another device. You can only use premium on one device at a time.\"\n    };\n  }\n  \n  if (backendResult.premium) {\n    const { markPremiumActivated } = await import(\"./premiumStateService\");\n    markPremiumActivated(backendResult.planType);\n    \n    console.log(\"[IAP] Restored from backend (verified):\", backendResult.planType);\n    logEvent(ANALYTICS_EVENTS.RESTORE_PURCHASES_SUCCESS, { source: \"backend\", planType: backendResult.planType });\n    return {\n      success: true,\n      verified: true,\n      source: \"backend\",\n      planType: backendResult.planType,\n      message: \"Premium status restored!\"\n    };\n  }\n  \n  if (!initResult.success) {\n    return { \n      success: false, \n      error: \"No purchases found. Please purchase premium to unlock features.\" \n    };\n  }\n  \n  const store = platformType === \"ios\" ? storeKit : googleBilling;\n  \n  return new Promise((resolve) => {\n    const timeout = setTimeout(() => {\n      resolve({ success: false, error: \"Restore timed out\" });\n    }, 30000);\n    \n    let restored = false;\n    let restoredPlanType = null;\n    \n    const handleRestored = async (product) => {\n      const config = Object.values(PRODUCTS).find(p => \n        p.googleId === product.id || p.appleId === product.id\n      );\n      \n      if (config && product.owned) {\n        const receipt = product.transaction?.receipt || product.receipt || product.purchaseToken;\n        \n        if (receipt) {\n          const verificationResult = await verifyReceipt({\n            platform: platformType,\n            productId: config.id,\n            receipt: receipt,\n            userId: userId,\n            deviceId: hashedDeviceId,\n            nonce: generateNonce(),\n            isRestore: true\n          });\n          \n          if (verificationResult.success) {\n            console.log(\"[IAP] Restore verified by backend:\", config.planType);\n            restored = true;\n            restoredPlanType = config.planType;\n            \n            if (store.finish) {\n              await store.finish(product);\n            }\n          } else {\n            console.log(\"[IAP] Restore verification failed:\", verificationResult.error);\n          }\n        }\n      }\n    };\n    \n    try {\n      Object.values(PRODUCTS).forEach(p => {\n        const storeId = platformType === \"ios\" ? p.appleId : p.googleId;\n        if (store.when) {\n          store.when(storeId).owned(handleRestored);\n        }\n      });\n      \n      if (store.refresh) {\n        store.refresh().then(() => {\n          clearTimeout(timeout);\n          setTimeout(() => {\n            resolve({\n              success: restored,\n              verified: restored,\n              source: \"store\",\n              planType: restoredPlanType,\n              message: restored ? \"Purchases restored!\" : \"No purchases found\"\n            });\n          }, 1000);\n        });\n      } else if (store.restorePurchases) {\n        store.restorePurchases().then((purchases) => {\n          clearTimeout(timeout);\n          if (purchases && purchases.length > 0) {\n            purchases.forEach(handleRestored);\n          }\n          resolve({\n            success: restored,\n            verified: restored,\n            source: \"store\",\n            planType: restoredPlanType,\n            message: restored ? \"Purchases restored!\" : \"No purchases found\"\n          });\n        });\n      } else {\n        clearTimeout(timeout);\n        resolve({ success: false, error: \"Restore not available\" });\n      }\n    } catch (error) {\n      clearTimeout(timeout);\n      console.error(\"[IAP] Restore error:\", error);\n      resolve({ success: false, error: error.message });\n    }\n  });\n};\n\nexport const getPlatform = () => platformType;\n\nexport const isNativeAppRequired = () => {\n  return !detectPlatform();\n};\n\nexport default {\n  initializeIAP,\n  loadProducts,\n  purchase,\n  restorePurchases,\n  getPlatform,\n  isNativeAppRequired\n};\n","path":null,"size_bytes":13278,"size_tokens":null},"supabase/functions/delete-user-account/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n\n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    });\n\n    const token = authHeader.replace(\"Bearer \", \"\");\n    const { data: userData, error: authError } = await supabase.auth.getUser(token);\n    \n    if (authError || !userData?.user) {\n      return new Response(\n        JSON.stringify({ error: \"Invalid or expired token\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const userId = userData.user.id;\n    console.log(`[DeleteAccount] Starting deletion for user: ${userId}`);\n\n    await supabase.from(\"revision_items\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Deleted revision items\");\n\n    await supabase.from(\"event_entries\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Deleted event entries\");\n\n    await supabase.from(\"push_tokens\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Deleted push tokens\");\n\n    await supabase.from(\"friend_requests\").delete().or(`from_user.eq.${userId},to_user.eq.${userId}`);\n    console.log(\"[DeleteAccount] Deleted friend requests\");\n\n    await supabase.from(\"friendships\").delete().or(`user1_id.eq.${userId},user2_id.eq.${userId}`);\n    console.log(\"[DeleteAccount] Deleted friendships\");\n\n    const { data: ownedGroups } = await supabase\n      .from(\"family_groups\")\n      .select(\"id\")\n      .eq(\"owner_id\", userId);\n\n    if (ownedGroups && ownedGroups.length > 0) {\n      for (const group of ownedGroups) {\n        await supabase.from(\"family_members\").delete().eq(\"family_group_id\", group.id);\n      }\n      await supabase.from(\"family_groups\").delete().eq(\"owner_id\", userId);\n      console.log(\"[DeleteAccount] Deleted owned family groups and members\");\n    }\n\n    await supabase.from(\"family_members\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Removed from family memberships\");\n\n    await supabase.from(\"purchases\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Deleted purchases\");\n\n    await supabase.from(\"users\").delete().eq(\"id\", userId);\n    console.log(\"[DeleteAccount] Deleted users record\");\n\n    await supabase.from(\"profiles\").delete().eq(\"user_id\", userId);\n    console.log(\"[DeleteAccount] Deleted profile\");\n\n    const { error: deleteAuthError } = await supabase.auth.admin.deleteUser(userId);\n    \n    if (deleteAuthError) {\n      console.error(\"[DeleteAccount] Auth deletion error:\", deleteAuthError);\n      return new Response(\n        JSON.stringify({ error: \"Failed to delete authentication\" }),\n        { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    console.log(`[DeleteAccount] Successfully deleted user: ${userId}`);\n\n    return new Response(\n      JSON.stringify({ success: true, message: \"Account deleted successfully\" }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n\n  } catch (error) {\n    console.error(\"[DeleteAccount] Error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message || \"Account deletion failed\" }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":4120,"size_tokens":null},"supabase/functions/google-webhook/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method !== \"POST\") {\n    return new Response(\"Method not allowed\", { status: 405 });\n  }\n  \n  try {\n    const body = await req.json();\n    \n    const messageData = body.message?.data;\n    if (!messageData) {\n      console.log(\"[GoogleWebhook] No message data received\");\n      return new Response(JSON.stringify({ received: true }), {\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    \n    const decodedData = JSON.parse(atob(messageData));\n    const { oneTimeProductNotification, voidedPurchaseNotification } = decodedData;\n    \n    console.log(\"[GoogleWebhook] Received notification:\", JSON.stringify(decodedData));\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    if (oneTimeProductNotification) {\n      const { notificationType, purchaseToken, sku } = oneTimeProductNotification;\n      \n      switch (notificationType) {\n        case 2:\n          console.log(`[GoogleWebhook] ONE_TIME_PRODUCT_CANCELED for ${sku}`);\n          \n          const { data: purchase } = await supabase\n            .from(\"purchases\")\n            .select(\"user_id\")\n            .eq(\"receipt_token\", purchaseToken)\n            .maybeSingle();\n          \n          if (purchase?.user_id) {\n            await supabase\n              .from(\"purchases\")\n              .update({ refunded: true })\n              .eq(\"receipt_token\", purchaseToken);\n            \n            await supabase\n              .from(\"users\")\n              .update({ premium: false, plan_type: null })\n              .eq(\"id\", purchase.user_id);\n            \n            console.log(`[GoogleWebhook] Revoked premium for user ${purchase.user_id}`);\n          }\n          break;\n        \n        case 1:\n          console.log(`[GoogleWebhook] ONE_TIME_PRODUCT_PURCHASED for ${sku}`);\n          break;\n        \n        default:\n          console.log(`[GoogleWebhook] Unknown notificationType: ${notificationType}`);\n      }\n    }\n    \n    if (voidedPurchaseNotification) {\n      const { purchaseToken, orderId, productType, refundType } = voidedPurchaseNotification;\n      \n      console.log(`[GoogleWebhook] VOIDED_PURCHASE: orderId=${orderId}, refundType=${refundType}`);\n      \n      const { data: purchase } = await supabase\n        .from(\"purchases\")\n        .select(\"user_id\")\n        .or(`receipt_token.eq.${purchaseToken},order_id.eq.${orderId}`)\n        .maybeSingle();\n      \n      if (purchase?.user_id) {\n        await supabase\n          .from(\"purchases\")\n          .update({ refunded: true })\n          .or(`receipt_token.eq.${purchaseToken},order_id.eq.${orderId}`);\n        \n        await supabase\n          .from(\"users\")\n          .update({ premium: false, plan_type: null })\n          .eq(\"id\", purchase.user_id);\n        \n        console.log(`[GoogleWebhook] Revoked premium for user ${purchase.user_id} (voided)`);\n      }\n    }\n    \n    return new Response(JSON.stringify({ received: true }), {\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n    \n  } catch (error) {\n    console.error(\"[GoogleWebhook] Error:\", error);\n    return new Response(JSON.stringify({ error: error.message }), {\n      status: 500,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n});\n","path":null,"size_bytes":3528,"size_tokens":null},"src/pages/Goodbye.jsx":{"content":"import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion } from \"framer-motion\";\nimport ScreenContainer from \"../components/ScreenContainer\";\n\nexport default function Goodbye() {\n  const navigate = useNavigate();\n\n  const handleReturnToStart = () => {\n    navigate(\"/onboarding/bismillah\", { replace: true });\n  };\n\n  return (\n    <ScreenContainer>\n      <div\n        style={{\n          minHeight: \"100vh\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          padding: \"40px 24px\",\n          textAlign: \"center\",\n        }}\n      >\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, ease: \"easeOut\" }}\n          style={{\n            maxWidth: \"360px\",\n            width: \"100%\",\n          }}\n        >\n          <div\n            style={{\n              width: \"80px\",\n              height: \"80px\",\n              borderRadius: \"50%\",\n              background: \"linear-gradient(135deg, rgba(79, 213, 255, 0.15) 0%, rgba(16, 185, 129, 0.1) 100%)\",\n              border: \"2px solid rgba(79, 213, 255, 0.3)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              margin: \"0 auto 32px\",\n              fontSize: \"2rem\",\n            }}\n          >\n            <span role=\"img\" aria-label=\"wave\">\n              üåô\n            </span>\n          </div>\n\n          <h1\n            style={{\n              fontSize: \"1.5rem\",\n              fontWeight: 700,\n              color: \"#fff\",\n              marginBottom: \"16px\",\n              lineHeight: 1.4,\n            }}\n          >\n            Your account has been deleted.\n          </h1>\n\n          <p\n            style={{\n              fontSize: \"1rem\",\n              color: \"rgba(255, 255, 255, 0.7)\",\n              marginBottom: \"40px\",\n              lineHeight: 1.6,\n            }}\n          >\n            You're always welcome back anytime.\n          </p>\n\n          <motion.button\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            onClick={handleReturnToStart}\n            style={{\n              background: \"linear-gradient(135deg, #4fd5ff 0%, #38bdf8 100%)\",\n              color: \"#0a1929\",\n              border: \"none\",\n              padding: \"16px 32px\",\n              borderRadius: \"14px\",\n              fontSize: \"1rem\",\n              fontWeight: 700,\n              cursor: \"pointer\",\n              width: \"100%\",\n              maxWidth: \"280px\",\n              boxShadow: \"0 4px 20px rgba(79, 213, 255, 0.3)\",\n              transition: \"box-shadow 0.3s ease\",\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.boxShadow = \"0 6px 30px rgba(79, 213, 255, 0.4)\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.boxShadow = \"0 4px 20px rgba(79, 213, 255, 0.3)\";\n            }}\n          >\n            Return to Start\n          </motion.button>\n        </motion.div>\n      </div>\n    </ScreenContainer>\n  );\n}\n","path":null,"size_bytes":3150,"size_tokens":null},"src/services/premiumStateService.js":{"content":"import { supabase } from \"../lib/supabaseClient\";\nimport { getDeviceId, hashDeviceId } from \"./deviceService\";\nimport { validatePremiumStatus, registerDevice } from \"./purchaseVerificationService\";\n\n// ================================================================\n// TESTING MODE: Premium status is determined ONLY by profiles.premium\n// This bypasses all IAP verification, device binding, and Edge Functions\n// When real Play Store / App Store verification is ready, restore the\n// original getPremiumStatus and syncPremiumOnAppOpen functions below\n// ================================================================\n\nconst PREMIUM_CACHE_KEY = \"iq_premium_cache\";\nconst CACHE_MAX_AGE = 24 * 60 * 60 * 1000;\n\nconst getPremiumCache = () => {\n  try {\n    const cached = localStorage.getItem(PREMIUM_CACHE_KEY);\n    if (!cached) return null;\n    \n    const data = JSON.parse(cached);\n    const age = Date.now() - data.timestamp;\n    \n    if (age > CACHE_MAX_AGE) {\n      console.log(\"[PremiumState] Cache expired, will refresh\");\n      return { ...data, expired: true };\n    }\n    \n    return data;\n  } catch (error) {\n    console.error(\"[PremiumState] Cache read error:\", error);\n    return null;\n  }\n};\n\nconst setPremiumCache = (premium, planType, deviceId) => {\n  try {\n    localStorage.setItem(PREMIUM_CACHE_KEY, JSON.stringify({\n      premium,\n      planType,\n      deviceId,\n      timestamp: Date.now()\n    }));\n  } catch (error) {\n    console.error(\"[PremiumState] Cache write error:\", error);\n  }\n};\n\nexport const clearPremiumCache = () => {\n  localStorage.removeItem(PREMIUM_CACHE_KEY);\n};\n\n// TESTING MODE: Simplified premium check using only profiles.premium boolean\nexport const getPremiumStatus = async (forceRefresh = false) => {\n  const cache = getPremiumCache();\n  \n  // Offline fallback - use cache if available\n  if (!navigator.onLine) {\n    console.log(\"[PremiumState] Offline - using cached status\");\n    if (cache) {\n      return {\n        premium: cache.premium,\n        planType: cache.planType,\n        source: \"offline_cache\"\n      };\n    }\n    return { premium: false, planType: null, source: \"offline_no_cache\" };\n  }\n  \n  // Use cache if valid and not forcing refresh\n  if (!forceRefresh && cache && !cache.expired) {\n    console.log(\"[PremiumState] Using valid cache\");\n    return {\n      premium: cache.premium,\n      planType: cache.planType,\n      source: \"cache\"\n    };\n  }\n  \n  try {\n    const { data: userData } = await supabase.auth.getUser();\n    const userId = userData?.user?.id;\n    \n    if (!userId) {\n      console.log(\"[PremiumState] No user logged in\");\n      return { premium: false, planType: null, source: \"no_user\" };\n    }\n    \n    // TESTING MODE: Simply fetch profiles.premium boolean\n    console.log(\"[PremiumState] TESTING MODE - fetching profiles.premium for user:\", userId);\n    const { data, error } = await supabase\n      .from(\"profiles\")\n      .select(\"premium\")\n      .eq(\"user_id\", userId)\n      .single();\n    \n    if (error) {\n      console.error(\"[PremiumState] Error fetching premium status:\", error);\n      if (cache) {\n        return {\n          premium: cache.premium,\n          planType: cache.planType,\n          source: \"stale_cache\"\n        };\n      }\n      return { premium: false, planType: null, source: \"error\" };\n    }\n    \n    const isPremium = data?.premium || false;\n    console.log(\"[PremiumState] TESTING MODE - profiles.premium =\", isPremium);\n    \n    // Cache the result\n    setPremiumCache(isPremium, null, null);\n    \n    return {\n      premium: isPremium,\n      planType: null,\n      source: \"profiles_table\"\n    };\n  } catch (error) {\n    console.error(\"[PremiumState] Error in getPremiumStatus:\", error);\n    \n    if (cache) {\n      console.log(\"[PremiumState] Using stale cache as fallback\");\n      return {\n        premium: cache.premium,\n        planType: cache.planType,\n        source: \"stale_cache\"\n      };\n    }\n    \n    return { premium: false, planType: null, source: \"error\" };\n  }\n};\n\nexport const initializeDeviceBinding = async () => {\n  try {\n    const { data: userData } = await supabase.auth.getUser();\n    const userId = userData?.user?.id;\n    \n    if (!userId) {\n      console.log(\"[PremiumState] No user for device binding\");\n      return { success: false, error: \"Not authenticated\" };\n    }\n    \n    const deviceId = await getDeviceId();\n    const hashedDeviceId = await hashDeviceId(deviceId);\n    \n    const result = await registerDevice(userId, hashedDeviceId);\n    \n    if (result.success) {\n      console.log(\"[PremiumState] Device registered successfully\");\n      if (result.previousDeviceLoggedOut) {\n        console.log(\"[PremiumState] Previous device was logged out\");\n      }\n    }\n    \n    return result;\n  } catch (error) {\n    console.error(\"[PremiumState] Device binding error:\", error);\n    return { success: false, error: error.message };\n  }\n};\n\n// TESTING MODE: Simplified sync - just fetch profiles.premium, skip device binding\nexport const syncPremiumOnAppOpen = async () => {\n  try {\n    // TESTING MODE: Skip device binding, just get premium status from profiles table\n    const status = await getPremiumStatus(true);\n    \n    console.log(\"[PremiumState] TESTING MODE - App open sync complete:\", {\n      premium: status.premium,\n      source: status.source\n    });\n    \n    return status;\n  } catch (error) {\n    console.error(\"[PremiumState] App open sync error:\", error);\n    const cache = getPremiumCache();\n    return {\n      premium: cache?.premium || false,\n      planType: cache?.planType || null,\n      source: \"error_fallback\"\n    };\n  }\n};\n\nexport const markPremiumActivated = (planType) => {\n  const deviceId = localStorage.getItem(\"iq_device_hash\") \n    ? JSON.parse(localStorage.getItem(\"iq_device_hash\")).hash \n    : null;\n  \n  setPremiumCache(true, planType, deviceId);\n};\n\nexport const markPremiumRevoked = () => {\n  clearPremiumCache();\n};\n\nexport default {\n  getPremiumStatus,\n  initializeDeviceBinding,\n  syncPremiumOnAppOpen,\n  clearPremiumCache,\n  markPremiumActivated,\n  markPremiumRevoked\n};\n","path":null,"size_bytes":6050,"size_tokens":null},"supabase/functions/log-event/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n\n  try {\n    const { event_type, user_id, device_id, platform, event_details } = await req.json();\n\n    if (!event_type) {\n      return new Response(\n        JSON.stringify({ error: \"event_type is required\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    });\n\n    const { error } = await supabase.from(\"analytics_events\").insert({\n      event_type,\n      user_id: user_id || null,\n      device_id: device_id || null,\n      platform: platform || null,\n      event_details: event_details || {},\n    });\n\n    if (error) {\n      console.error(\"[LogEvent] Insert error:\", error);\n      return new Response(\n        JSON.stringify({ error: \"Failed to log event\" }),\n        { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    return new Response(\n      JSON.stringify({ success: true }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n\n  } catch (error) {\n    console.error(\"[LogEvent] Error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message || \"Failed to log event\" }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":1950,"size_tokens":null},"src/components/DeleteAccountModal.jsx":{"content":"import React, { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Trash2, AlertTriangle } from \"lucide-react\";\n\nexport default function DeleteAccountModal({ isOpen, onClose, onConfirm, isDeleting = false }) {\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        style={{\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: \"rgba(0,0,0,0.85)\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          zIndex: 9999,\n          padding: \"20px\",\n        }}\n        onClick={onClose}\n      >\n        <motion.div\n          initial={{ scale: 0.9, opacity: 0, y: 20 }}\n          animate={{ scale: 1, opacity: 1, y: 0 }}\n          exit={{ scale: 0.9, opacity: 0, y: 20 }}\n          transition={{ type: \"spring\", damping: 25, stiffness: 300 }}\n          onClick={(e) => e.stopPropagation()}\n          style={{\n            background: \"linear-gradient(180deg, #0B1E2D 0%, #0a1929 100%)\",\n            border: \"1px solid rgba(239, 68, 68, 0.3)\",\n            borderRadius: \"20px\",\n            padding: \"28px 24px\",\n            maxWidth: \"360px\",\n            width: \"100%\",\n            textAlign: \"center\",\n            boxShadow: \"0 20px 60px rgba(0,0,0,0.6), 0 0 40px rgba(239, 68, 68, 0.1)\",\n          }}\n        >\n          <div\n            style={{\n              width: \"64px\",\n              height: \"64px\",\n              borderRadius: \"50%\",\n              background: \"linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(185, 28, 28, 0.15) 100%)\",\n              border: \"2px solid rgba(239, 68, 68, 0.4)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              margin: \"0 auto 20px\",\n            }}\n          >\n            <Trash2 size={28} color=\"#ef4444\" />\n          </div>\n\n          <h3\n            style={{\n              color: \"#ef4444\",\n              fontSize: \"1.25rem\",\n              fontWeight: 700,\n              marginBottom: \"16px\",\n              letterSpacing: \"-0.02em\",\n            }}\n          >\n            Delete Account?\n          </h3>\n\n          <p\n            style={{\n              color: \"rgba(255,255,255,0.85)\",\n              fontSize: \"0.95rem\",\n              marginBottom: \"20px\",\n              lineHeight: \"1.6\",\n            }}\n          >\n            Are you sure? This will permanently delete your account, your premium access, and all stored data.\n          </p>\n\n          <div\n            style={{\n              background: \"rgba(239, 68, 68, 0.1)\",\n              border: \"1px solid rgba(239, 68, 68, 0.25)\",\n              borderRadius: \"10px\",\n              padding: \"12px\",\n              marginBottom: \"24px\",\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: \"10px\",\n            }}\n          >\n            <AlertTriangle size={18} color=\"#ef4444\" style={{ flexShrink: 0 }} />\n            <p\n              style={{\n                color: \"rgba(255,255,255,0.7)\",\n                fontSize: \"0.8rem\",\n                textAlign: \"left\",\n                lineHeight: \"1.4\",\n                margin: 0,\n              }}\n            >\n              This cannot be undone.\n            </p>\n          </div>\n\n          <div\n            style={{\n              display: \"flex\",\n              gap: \"12px\",\n            }}\n          >\n            <button\n              onClick={onClose}\n              disabled={isDeleting}\n              style={{\n                flex: 1,\n                background: \"transparent\",\n                border: \"1px solid rgba(255, 255, 255, 0.2)\",\n                color: \"rgba(255, 255, 255, 0.8)\",\n                padding: \"14px 16px\",\n                borderRadius: \"12px\",\n                fontSize: \"0.95rem\",\n                fontWeight: \"600\",\n                cursor: isDeleting ? \"not-allowed\" : \"pointer\",\n                transition: \"all 0.3s\",\n                opacity: isDeleting ? 0.5 : 1,\n              }}\n              onMouseEnter={(e) => {\n                if (!isDeleting) {\n                  e.currentTarget.style.background = \"rgba(255, 255, 255, 0.05)\";\n                  e.currentTarget.style.borderColor = \"rgba(255, 255, 255, 0.3)\";\n                }\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.background = \"transparent\";\n                e.currentTarget.style.borderColor = \"rgba(255, 255, 255, 0.2)\";\n              }}\n            >\n              Cancel\n            </button>\n\n            <button\n              onClick={onConfirm}\n              disabled={isDeleting}\n              style={{\n                flex: 1,\n                background: isDeleting \n                  ? \"rgba(239, 68, 68, 0.5)\" \n                  : \"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)\",\n                color: \"white\",\n                border: \"none\",\n                padding: \"14px 16px\",\n                borderRadius: \"12px\",\n                fontSize: \"0.95rem\",\n                fontWeight: \"700\",\n                cursor: isDeleting ? \"not-allowed\" : \"pointer\",\n                transition: \"all 0.3s\",\n                boxShadow: isDeleting ? \"none\" : \"0 4px 12px rgba(239, 68, 68, 0.3)\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n              }}\n              onMouseEnter={(e) => {\n                if (!isDeleting) {\n                  e.currentTarget.style.boxShadow = \"0 6px 20px rgba(239, 68, 68, 0.5)\";\n                  e.currentTarget.style.transform = \"translateY(-1px)\";\n                }\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.boxShadow = isDeleting ? \"none\" : \"0 4px 12px rgba(239, 68, 68, 0.3)\";\n                e.currentTarget.style.transform = \"translateY(0)\";\n              }}\n            >\n              {isDeleting ? (\n                <>\n                  <span style={{\n                    width: \"16px\",\n                    height: \"16px\",\n                    border: \"2px solid rgba(255,255,255,0.3)\",\n                    borderTopColor: \"white\",\n                    borderRadius: \"50%\",\n                    animation: \"spin 0.8s linear infinite\",\n                  }} />\n                  Deleting...\n                </>\n              ) : (\n                \"Yes, Delete Account\"\n              )}\n            </button>\n          </div>\n        </motion.div>\n      </motion.div>\n      <style>{`\n        @keyframes spin {\n          to { transform: rotate(360deg); }\n        }\n      `}</style>\n    </AnimatePresence>\n  );\n}\n","path":null,"size_bytes":6791,"size_tokens":null},"src/services/deviceService.js":{"content":"const DEVICE_ID_KEY = \"iq_device_id\";\nconst DEVICE_HASH_KEY = \"iq_device_hash\";\n\nexport const generateDeviceId = () => {\n  const timestamp = Date.now().toString(36);\n  const randomPart = Math.random().toString(36).substring(2, 15);\n  const randomPart2 = Math.random().toString(36).substring(2, 15);\n  \n  let fingerprint = \"\";\n  if (typeof window !== \"undefined\") {\n    fingerprint = [\n      navigator.userAgent,\n      navigator.language,\n      screen.width + \"x\" + screen.height,\n      new Date().getTimezoneOffset()\n    ].join(\"|\").substring(0, 20);\n  }\n  \n  return `${timestamp}-${randomPart}-${randomPart2}-${btoa(fingerprint).substring(0, 8)}`;\n};\n\nexport const getDeviceId = async () => {\n  try {\n    let deviceId = localStorage.getItem(DEVICE_ID_KEY);\n    \n    if (!deviceId) {\n      deviceId = generateDeviceId();\n      localStorage.setItem(DEVICE_ID_KEY, deviceId);\n    }\n    \n    return deviceId;\n  } catch (error) {\n    console.error(\"[DeviceService] Error getting device ID:\", error);\n    return generateDeviceId();\n  }\n};\n\nexport const hashDeviceId = async (deviceId) => {\n  try {\n    const cached = localStorage.getItem(DEVICE_HASH_KEY);\n    const cachedData = cached ? JSON.parse(cached) : null;\n    \n    if (cachedData && cachedData.deviceId === deviceId) {\n      return cachedData.hash;\n    }\n    \n    const encoder = new TextEncoder();\n    const data = encoder.encode(deviceId + \"_iq_salt_2024\");\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, \"0\")).join(\"\");\n    \n    localStorage.setItem(DEVICE_HASH_KEY, JSON.stringify({\n      deviceId: deviceId,\n      hash: hashHex\n    }));\n    \n    return hashHex;\n  } catch (error) {\n    console.error(\"[DeviceService] Error hashing device ID:\", error);\n    return btoa(deviceId).replace(/[^a-zA-Z0-9]/g, \"\");\n  }\n};\n\nexport const clearDeviceId = () => {\n  localStorage.removeItem(DEVICE_ID_KEY);\n  localStorage.removeItem(DEVICE_HASH_KEY);\n};\n\nexport default {\n  getDeviceId,\n  hashDeviceId,\n  generateDeviceId,\n  clearDeviceId\n};\n","path":null,"size_bytes":2138,"size_tokens":null},"src/components/NotificationModal.jsx":{"content":"import React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { CheckCircle, XCircle, AlertTriangle, Info, Smartphone } from \"lucide-react\";\n\nconst iconMap = {\n  success: { icon: CheckCircle, color: \"#10b981\", bgColor: \"rgba(16, 185, 129, 0.15)\", borderColor: \"rgba(16, 185, 129, 0.3)\" },\n  error: { icon: XCircle, color: \"#ef4444\", bgColor: \"rgba(239, 68, 68, 0.15)\", borderColor: \"rgba(239, 68, 68, 0.3)\" },\n  warning: { icon: AlertTriangle, color: \"#fbbf24\", bgColor: \"rgba(251, 191, 36, 0.15)\", borderColor: \"rgba(251, 191, 36, 0.3)\" },\n  info: { icon: Info, color: \"#4fd5ff\", bgColor: \"rgba(79, 213, 255, 0.15)\", borderColor: \"rgba(79, 213, 255, 0.3)\" },\n  device: { icon: Smartphone, color: \"#fbbf24\", bgColor: \"rgba(251, 191, 36, 0.15)\", borderColor: \"rgba(251, 191, 36, 0.3)\" },\n};\n\nexport default function NotificationModal({ \n  isOpen, \n  onClose, \n  title, \n  message, \n  type = \"info\",\n  buttonText = \"OK\" \n}) {\n  if (!isOpen) return null;\n\n  const config = iconMap[type] || iconMap.info;\n  const IconComponent = config.icon;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        style={{\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: \"rgba(0,0,0,0.85)\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          zIndex: 9999,\n          padding: \"20px\",\n        }}\n        onClick={onClose}\n      >\n        <motion.div\n          initial={{ scale: 0.9, opacity: 0, y: 20 }}\n          animate={{ scale: 1, opacity: 1, y: 0 }}\n          exit={{ scale: 0.9, opacity: 0, y: 20 }}\n          transition={{ type: \"spring\", damping: 25, stiffness: 300 }}\n          onClick={(e) => e.stopPropagation()}\n          style={{\n            background: \"linear-gradient(180deg, #0B1E2D 0%, #0a1929 100%)\",\n            border: `1px solid ${config.borderColor}`,\n            borderRadius: \"20px\",\n            padding: \"28px 24px\",\n            maxWidth: \"340px\",\n            width: \"100%\",\n            textAlign: \"center\",\n            boxShadow: `0 20px 60px rgba(0,0,0,0.6), 0 0 40px ${config.bgColor}`,\n          }}\n        >\n          <div\n            style={{\n              width: \"64px\",\n              height: \"64px\",\n              borderRadius: \"50%\",\n              background: config.bgColor,\n              border: `2px solid ${config.borderColor}`,\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              margin: \"0 auto 20px\",\n            }}\n          >\n            <IconComponent size={28} color={config.color} />\n          </div>\n\n          {title && (\n            <h3\n              style={{\n                color: config.color,\n                fontSize: \"1.25rem\",\n                fontWeight: 700,\n                marginBottom: \"12px\",\n                letterSpacing: \"-0.02em\",\n              }}\n            >\n              {title}\n            </h3>\n          )}\n\n          <p\n            style={{\n              color: \"rgba(255,255,255,0.85)\",\n              fontSize: \"0.95rem\",\n              marginBottom: \"24px\",\n              lineHeight: \"1.6\",\n            }}\n          >\n            {message}\n          </p>\n\n          <button\n            onClick={onClose}\n            style={{\n              width: \"100%\",\n              background: `linear-gradient(135deg, ${config.color} 0%, ${config.color}cc 100%)`,\n              color: type === \"warning\" || type === \"device\" ? \"#0a1929\" : \"white\",\n              border: \"none\",\n              padding: \"14px 16px\",\n              borderRadius: \"12px\",\n              fontSize: \"0.95rem\",\n              fontWeight: \"700\",\n              cursor: \"pointer\",\n              transition: \"all 0.3s\",\n              boxShadow: `0 4px 12px ${config.bgColor}`,\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.transform = \"translateY(-1px)\";\n              e.currentTarget.style.boxShadow = `0 6px 20px ${config.bgColor}`;\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.transform = \"translateY(0)\";\n              e.currentTarget.style.boxShadow = `0 4px 12px ${config.bgColor}`;\n            }}\n          >\n            {buttonText}\n          </button>\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n","path":null,"size_bytes":4457,"size_tokens":null},"supabase/functions/apple-webhook/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nfunction decodeJWTPayload(jwt: string): any {\n  const parts = jwt.split(\".\");\n  if (parts.length !== 3) {\n    throw new Error(\"Invalid JWT format\");\n  }\n  \n  const payload = parts[1];\n  const decoded = atob(payload.replace(/-/g, \"+\").replace(/_/g, \"/\"));\n  return JSON.parse(decoded);\n}\n\nserve(async (req) => {\n  if (req.method !== \"POST\") {\n    return new Response(\"Method not allowed\", { status: 405 });\n  }\n  \n  try {\n    const body = await req.json();\n    const { signedPayload } = body;\n    \n    if (!signedPayload) {\n      console.log(\"[AppleWebhook] No signedPayload received\");\n      return new Response(JSON.stringify({ received: true }), {\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    \n    const payload = decodeJWTPayload(signedPayload);\n    const notificationType = payload.notificationType;\n    const data = payload.data;\n    \n    console.log(`[AppleWebhook] Received notification: ${notificationType}`);\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    switch (notificationType) {\n      case \"REFUND\":\n      case \"REVOKE\": {\n        const transactionInfo = data?.signedTransactionInfo \n          ? decodeJWTPayload(data.signedTransactionInfo) \n          : null;\n        \n        if (transactionInfo?.originalTransactionId) {\n          const { data: purchase } = await supabase\n            .from(\"purchases\")\n            .select(\"user_id\")\n            .eq(\"receipt_token\", transactionInfo.originalTransactionId)\n            .maybeSingle();\n          \n          if (purchase?.user_id) {\n            await supabase\n              .from(\"purchases\")\n              .update({ refunded: true })\n              .eq(\"receipt_token\", transactionInfo.originalTransactionId);\n            \n            await supabase\n              .from(\"users\")\n              .update({ premium: false, plan_type: null })\n              .eq(\"id\", purchase.user_id);\n            \n            console.log(`[AppleWebhook] Revoked premium for user ${purchase.user_id}`);\n          }\n        }\n        break;\n      }\n      \n      case \"DID_RENEW\":\n        console.log(\"[AppleWebhook] DID_RENEW ignored for lifetime products\");\n        break;\n      \n      case \"CONSUMPTION_REQUEST\":\n        console.log(\"[AppleWebhook] Consumption request received\");\n        break;\n      \n      default:\n        console.log(`[AppleWebhook] Unhandled notification type: ${notificationType}`);\n    }\n    \n    return new Response(JSON.stringify({ received: true }), {\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n    \n  } catch (error) {\n    console.error(\"[AppleWebhook] Error:\", error);\n    return new Response(JSON.stringify({ error: error.message }), {\n      status: 500,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n});\n","path":null,"size_bytes":3065,"size_tokens":null},"supabase/functions/daily-validation/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\nconst GOOGLE_CLIENT_EMAIL = Deno.env.get(\"GOOGLE_CLIENT_EMAIL\");\nconst GOOGLE_PRIVATE_KEY = Deno.env.get(\"GOOGLE_PRIVATE_KEY\");\nconst GOOGLE_PACKAGE_NAME = Deno.env.get(\"GOOGLE_PACKAGE_NAME\");\n\nserve(async (req) => {\n  console.log(\"[DailyValidation] Starting daily purchase validation\");\n  \n  try {\n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { data: purchases, error: fetchError } = await supabase\n      .from(\"purchases\")\n      .select(\"id, user_id, platform, product_id, receipt_token, refunded\")\n      .eq(\"verified\", true)\n      .eq(\"refunded\", false);\n    \n    if (fetchError) {\n      console.error(\"[DailyValidation] Failed to fetch purchases:\", fetchError);\n      return new Response(\n        JSON.stringify({ error: \"Failed to fetch purchases\" }),\n        { status: 500, headers: { \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    console.log(`[DailyValidation] Found ${purchases?.length || 0} verified purchases to validate`);\n    \n    let revokedCount = 0;\n    let validCount = 0;\n    let errorCount = 0;\n    \n    for (const purchase of purchases || []) {\n      try {\n        if (purchase.platform === \"android\" && GOOGLE_CLIENT_EMAIL && GOOGLE_PRIVATE_KEY && GOOGLE_PACKAGE_NAME) {\n          const isValid = await validateGooglePurchase(\n            purchase.product_id,\n            purchase.receipt_token\n          );\n          \n          if (!isValid) {\n            await revokePremium(supabase, purchase.id, purchase.user_id);\n            revokedCount++;\n            console.log(`[DailyValidation] Revoked Android purchase ${purchase.id}`);\n          } else {\n            validCount++;\n          }\n        } else if (purchase.platform === \"ios\") {\n          validCount++;\n          console.log(`[DailyValidation] iOS purchase ${purchase.id} - skipped (Apple webhooks handle revocations)`);\n        } else {\n          validCount++;\n        }\n      } catch (error) {\n        console.error(`[DailyValidation] Error validating purchase ${purchase.id}:`, error);\n        errorCount++;\n      }\n    }\n    \n    console.log(`[DailyValidation] Complete: ${validCount} valid, ${revokedCount} revoked, ${errorCount} errors`);\n    \n    return new Response(\n      JSON.stringify({\n        success: true,\n        processed: purchases?.length || 0,\n        valid: validCount,\n        revoked: revokedCount,\n        errors: errorCount\n      }),\n      { headers: { \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"[DailyValidation] Fatal error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n\nasync function validateGooglePurchase(productId: string, purchaseToken: string): Promise<boolean> {\n  try {\n    const accessToken = await getGoogleAccessToken();\n    \n    const url = `https://androidpublisher.googleapis.com/androidpublisher/v3/applications/${GOOGLE_PACKAGE_NAME}/purchases/products/${productId}/tokens/${purchaseToken}`;\n    \n    const response = await fetch(url, {\n      headers: {\n        \"Authorization\": `Bearer ${accessToken}`,\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    \n    if (!response.ok) {\n      console.log(`[DailyValidation] Google API returned ${response.status} for ${productId}`);\n      return false;\n    }\n    \n    const data = await response.json();\n    \n    if (data.purchaseState !== 0) {\n      return false;\n    }\n    \n    return true;\n  } catch (error) {\n    console.error(\"[DailyValidation] Google validation error:\", error);\n    return true;\n  }\n}\n\nasync function getGoogleAccessToken(): Promise<string> {\n  const now = Math.floor(Date.now() / 1000);\n  \n  const header = { alg: \"RS256\", typ: \"JWT\" };\n  const payload = {\n    iss: GOOGLE_CLIENT_EMAIL,\n    scope: \"https://www.googleapis.com/auth/androidpublisher\",\n    aud: \"https://oauth2.googleapis.com/token\",\n    iat: now,\n    exp: now + 3600\n  };\n  \n  const encodedHeader = btoa(JSON.stringify(header)).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  const encodedPayload = btoa(JSON.stringify(payload)).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  const message = `${encodedHeader}.${encodedPayload}`;\n  \n  const privateKeyPem = GOOGLE_PRIVATE_KEY!.replace(/\\\\n/g, \"\\n\");\n  const b64 = privateKeyPem\n    .replace(/-----BEGIN PRIVATE KEY-----/, \"\")\n    .replace(/-----END PRIVATE KEY-----/, \"\")\n    .replace(/\\s/g, \"\");\n  const binary = atob(b64);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  \n  const privateKey = await crypto.subtle.importKey(\n    \"pkcs8\",\n    bytes.buffer,\n    { name: \"RSASSA-PKCS1-v1_5\", hash: \"SHA-256\" },\n    false,\n    [\"sign\"]\n  );\n  \n  const signature = await crypto.subtle.sign(\n    \"RSASSA-PKCS1-v1_5\",\n    privateKey,\n    new TextEncoder().encode(message)\n  );\n  \n  const encodedSignature = btoa(String.fromCharCode(...new Uint8Array(signature)))\n    .replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  const jwt = `${message}.${encodedSignature}`;\n  \n  const tokenResponse = await fetch(\"https://oauth2.googleapis.com/token\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n    body: `grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer&assertion=${jwt}`\n  });\n  \n  const tokenData = await tokenResponse.json();\n  return tokenData.access_token;\n}\n\nasync function revokePremium(supabase: any, purchaseId: string, userId: string) {\n  await supabase\n    .from(\"purchases\")\n    .update({ refunded: true })\n    .eq(\"id\", purchaseId);\n  \n  await supabase\n    .from(\"users\")\n    .update({ premium: false, plan_type: null })\n    .eq(\"id\", userId);\n}\n","path":null,"size_bytes":6049,"size_tokens":null},"supabase/functions/accept-family-invite/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n  \n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { inviteToken, userId } = await req.json();\n    \n    if (!inviteToken || !userId) {\n      return new Response(\n        JSON.stringify({ error: \"Missing inviteToken or userId\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: invite, error: inviteError } = await supabase\n      .from(\"family_members\")\n      .select(`\n        id,\n        family_group_id,\n        invited_email,\n        accepted,\n        family_groups (\n          id,\n          owner_id,\n          max_members\n        )\n      `)\n      .eq(\"invite_token\", inviteToken)\n      .maybeSingle();\n    \n    if (inviteError || !invite) {\n      return new Response(\n        JSON.stringify({ error: \"Invalid or expired invite token\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    if (invite.accepted) {\n      return new Response(\n        JSON.stringify({ error: \"Invite already accepted\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: acceptedCount } = await supabase\n      .from(\"family_members\")\n      .select(\"id\")\n      .eq(\"family_group_id\", invite.family_group_id)\n      .eq(\"accepted\", true);\n    \n    const maxMembers = invite.family_groups?.max_members || 5;\n    if (acceptedCount && acceptedCount.length >= maxMembers) {\n      return new Response(\n        JSON.stringify({ error: \"Family group is full\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { error: updateError } = await supabase\n      .from(\"family_members\")\n      .update({\n        user_id: userId,\n        accepted: true,\n        accepted_at: new Date().toISOString()\n      })\n      .eq(\"id\", invite.id);\n    \n    if (updateError) {\n      console.error(\"Failed to accept invite:\", updateError);\n      return new Response(\n        JSON.stringify({ error: \"Failed to accept invite\" }),\n        { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: owner } = await supabase\n      .from(\"users\")\n      .select(\"premium, plan_type\")\n      .eq(\"id\", invite.family_groups?.owner_id)\n      .maybeSingle();\n    \n    const isPremium = owner?.premium && owner?.plan_type === \"family\";\n    \n    if (isPremium) {\n      await supabase\n        .from(\"users\")\n        .upsert({\n          id: userId,\n          premium: true,\n          plan_type: \"family\",\n          updated_at: new Date().toISOString()\n        }, { onConflict: \"id\" });\n    }\n    \n    console.log(`[FamilyInvite] User ${userId} joined family group ${invite.family_group_id}`);\n    \n    return new Response(\n      JSON.stringify({\n        success: true,\n        familyGroupId: invite.family_group_id,\n        premium: isPremium,\n        planType: isPremium ? \"family\" : null\n      }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"Accept invite error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":4192,"size_tokens":null},"supabase/functions/validate-premium-status/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n  \n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { userId, deviceId } = await req.json();\n    \n    if (!userId || !deviceId) {\n      return new Response(\n        JSON.stringify({ error: \"Missing userId or deviceId\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: user, error: userError } = await supabase\n      .from(\"users\")\n      .select(\"premium, plan_type, active_device_id\")\n      .eq(\"id\", userId)\n      .maybeSingle();\n    \n    if (userError) {\n      console.error(\"User fetch error:\", userError);\n      return new Response(\n        JSON.stringify({ premium: false, error: \"User not found\" }),\n        { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    if (!user) {\n      return new Response(\n        JSON.stringify({ premium: false, planType: null, deviceMatch: true }),\n        { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    if (user.premium) {\n      const deviceMatch = user.active_device_id === deviceId;\n      \n      if (!deviceMatch) {\n        if (user.active_device_id) {\n          console.log(`[ValidatePremium] Device mismatch for user ${userId}. Premium not granted on this device.`);\n          return new Response(\n            JSON.stringify({\n              premium: false,\n              requiresDeviceTransfer: true,\n              planType: user.plan_type\n            }),\n            { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n          );\n        }\n        \n        const { error: updateError } = await supabase\n          .from(\"users\")\n          .update({ \n            active_device_id: deviceId,\n            updated_at: new Date().toISOString()\n          })\n          .eq(\"id\", userId);\n        \n        if (updateError) {\n          console.error(\"[ValidatePremium] Failed to set initial device:\", updateError);\n          return new Response(\n            JSON.stringify({ premium: false, error: \"Device setup failed\" }),\n            { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n          );\n        }\n        console.log(`[ValidatePremium] Initial device set for user ${userId}`);\n      }\n      \n      return new Response(\n        JSON.stringify({\n          premium: true,\n          planType: user.plan_type,\n          deviceMatch: true\n        }),\n        { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: familyMembership } = await supabase\n      .from(\"family_members\")\n      .select(`\n        id,\n        family_group_id,\n        accepted,\n        family_groups (\n          owner_id\n        )\n      `)\n      .eq(\"user_id\", userId)\n      .eq(\"accepted\", true)\n      .maybeSingle();\n    \n    if (familyMembership && familyMembership.family_groups) {\n      const { data: owner } = await supabase\n        .from(\"users\")\n        .select(\"premium, plan_type\")\n        .eq(\"id\", familyMembership.family_groups.owner_id)\n        .eq(\"premium\", true)\n        .eq(\"plan_type\", \"family\")\n        .maybeSingle();\n      \n      if (owner) {\n        const deviceMatch = user?.active_device_id === deviceId;\n        \n        if (!deviceMatch) {\n          if (user?.active_device_id) {\n            console.log(`[ValidatePremium] Family member device mismatch for user ${userId}`);\n            return new Response(\n              JSON.stringify({\n                premium: false,\n                requiresDeviceTransfer: true,\n                planType: \"family\",\n                familyGroupId: familyMembership.family_group_id\n              }),\n              { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n            );\n          }\n          \n          await supabase\n            .from(\"users\")\n            .upsert({\n              id: userId,\n              active_device_id: deviceId,\n              updated_at: new Date().toISOString()\n            }, { onConflict: \"id\" });\n        }\n        \n        return new Response(\n          JSON.stringify({\n            premium: true,\n            planType: \"family\",\n            familyGroupId: familyMembership.family_group_id,\n            deviceMatch: true,\n            isOwner: false\n          }),\n          { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n    }\n    \n    return new Response(\n      JSON.stringify({\n        premium: false,\n        planType: null,\n        deviceMatch: true\n      }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"Validation error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":5696,"size_tokens":null},"supabase/functions/verify-apple-receipt/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst APPLE_KEY_ID = Deno.env.get(\"APPLE_KEY_ID\")!;\nconst APPLE_ISSUER_ID = Deno.env.get(\"APPLE_ISSUER_ID\")!;\nconst APPLE_BUNDLE_ID = Deno.env.get(\"APPLE_BUNDLE_ID\")!;\nconst APPLE_PRIVATE_KEY = Deno.env.get(\"APPLE_PRIVATE_KEY\")!;\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nconst IS_SANDBOX = Deno.env.get(\"APPLE_SANDBOX\") === \"true\";\nconst APPLE_API_BASE = IS_SANDBOX \n  ? \"https://api.storekit-sandbox.itunes.apple.com\"\n  : \"https://api.storekit.itunes.apple.com\";\n\nfunction base64UrlEncode(data: string): string {\n  return btoa(data).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n}\n\nfunction pemToArrayBuffer(pem: string): ArrayBuffer {\n  const b64 = pem\n    .replace(/-----BEGIN PRIVATE KEY-----/, \"\")\n    .replace(/-----END PRIVATE KEY-----/, \"\")\n    .replace(/\\s/g, \"\");\n  const binary = atob(b64);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\nasync function createAppleJWT(): Promise<string> {\n  const now = Math.floor(Date.now() / 1000);\n  \n  const header = { alg: \"ES256\", kid: APPLE_KEY_ID, typ: \"JWT\" };\n  const payload = {\n    iss: APPLE_ISSUER_ID,\n    iat: now,\n    exp: now + 3600,\n    aud: \"appstoreconnect-v1\",\n    bid: APPLE_BUNDLE_ID\n  };\n  \n  const encodedHeader = base64UrlEncode(JSON.stringify(header));\n  const encodedPayload = base64UrlEncode(JSON.stringify(payload));\n  const message = `${encodedHeader}.${encodedPayload}`;\n  \n  const privateKeyPem = atob(APPLE_PRIVATE_KEY);\n  const privateKey = await crypto.subtle.importKey(\n    \"pkcs8\",\n    pemToArrayBuffer(privateKeyPem),\n    { name: \"ECDSA\", namedCurve: \"P-256\" },\n    false,\n    [\"sign\"]\n  );\n  \n  const signature = await crypto.subtle.sign(\n    { name: \"ECDSA\", hash: \"SHA-256\" },\n    privateKey,\n    new TextEncoder().encode(message)\n  );\n  \n  const encodedSignature = base64UrlEncode(String.fromCharCode(...new Uint8Array(signature)));\n  \n  return `${message}.${encodedSignature}`;\n}\n\nasync function verifyWithApple(transactionId: string): Promise<any> {\n  const jwt = await createAppleJWT();\n  \n  const response = await fetch(\n    `${APPLE_API_BASE}/inApps/v1/transactions/${transactionId}`,\n    {\n      headers: {\n        \"Authorization\": `Bearer ${jwt}`,\n        \"Content-Type\": \"application/json\"\n      }\n    }\n  );\n  \n  if (!response.ok) {\n    const error = await response.text();\n    throw new Error(`Apple API error: ${response.status} - ${error}`);\n  }\n  \n  return await response.json();\n}\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n  \n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { receipt, productId, userId, deviceId, nonce, isRestore } = await req.json();\n    \n    if (!receipt || !productId || !userId || !deviceId || !nonce) {\n      return new Response(\n        JSON.stringify({ error: \"Missing required fields\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: existingPurchase } = await supabase\n      .from(\"purchases\")\n      .select(\"id, user_id\")\n      .eq(\"receipt_token\", receipt)\n      .eq(\"verified\", true)\n      .maybeSingle();\n    \n    if (existingPurchase) {\n      if (existingPurchase.user_id !== userId) {\n        return new Response(\n          JSON.stringify({ verified: false, reason: \"This purchase belongs to a different account\" }),\n          { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n      \n      if (!isRestore) {\n        return new Response(\n          JSON.stringify({ verified: false, reason: \"Receipt already used\" }),\n          { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n    }\n    \n    let transactionInfo;\n    try {\n      transactionInfo = await verifyWithApple(receipt);\n    } catch (error) {\n      console.error(\"Apple verification failed:\", error);\n      return new Response(\n        JSON.stringify({ verified: false, reason: \"Apple verification failed\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const expectedProducts = [\"premium_lifetime\", \"premium_family_lifetime\"];\n    if (!expectedProducts.includes(transactionInfo.productId)) {\n      return new Response(\n        JSON.stringify({ verified: false, reason: \"Invalid product\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    if (transactionInfo.revocationDate) {\n      return new Response(\n        JSON.stringify({ verified: false, reason: \"Purchase was refunded\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const planType = transactionInfo.productId === \"premium_family_lifetime\" ? \"family\" : \"single\";\n    \n    const { data: purchase, error: purchaseError } = await supabase\n      .from(\"purchases\")\n      .insert({\n        user_id: userId,\n        platform: \"ios\",\n        product_id: productId,\n        receipt_token: receipt,\n        verified: true,\n        refunded: false,\n        nonce: nonce,\n        device_id: deviceId,\n        created_at: new Date().toISOString()\n      })\n      .select()\n      .single();\n    \n    if (purchaseError) {\n      console.error(\"Purchase insert error:\", purchaseError);\n    }\n    \n    const { error: userError } = await supabase\n      .from(\"users\")\n      .upsert({\n        id: userId,\n        premium: true,\n        plan_type: planType,\n        active_device_id: deviceId,\n        updated_at: new Date().toISOString()\n      }, { onConflict: \"id\" });\n    \n    if (userError) {\n      console.error(\"User update error:\", userError);\n    }\n    \n    if (planType === \"family\") {\n      const { data: existingGroup } = await supabase\n        .from(\"family_groups\")\n        .select(\"id\")\n        .eq(\"owner_id\", userId)\n        .maybeSingle();\n      \n      if (!existingGroup) {\n        await supabase\n          .from(\"family_groups\")\n          .insert({\n            owner_id: userId,\n            max_members: 5,\n            created_at: new Date().toISOString()\n          });\n      }\n    }\n    \n    return new Response(\n      JSON.stringify({\n        verified: true,\n        planType: planType,\n        purchaseId: purchase?.id\n      }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"Verification error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":7410,"size_tokens":null},"supabase/functions/verify-google-receipt/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst GOOGLE_CLIENT_EMAIL = Deno.env.get(\"GOOGLE_CLIENT_EMAIL\")!;\nconst GOOGLE_PRIVATE_KEY = Deno.env.get(\"GOOGLE_PRIVATE_KEY\")!;\nconst GOOGLE_PACKAGE_NAME = Deno.env.get(\"GOOGLE_PACKAGE_NAME\")!;\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_SERVICE_ROLE_KEY = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\")!;\n\nfunction base64UrlEncode(data: string): string {\n  return btoa(data).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n}\n\nfunction pemToArrayBuffer(pem: string): ArrayBuffer {\n  const b64 = pem\n    .replace(/-----BEGIN PRIVATE KEY-----/, \"\")\n    .replace(/-----END PRIVATE KEY-----/, \"\")\n    .replace(/\\s/g, \"\");\n  const binary = atob(b64);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\nasync function getGoogleAccessToken(): Promise<string> {\n  const now = Math.floor(Date.now() / 1000);\n  \n  const header = { alg: \"RS256\", typ: \"JWT\" };\n  const payload = {\n    iss: GOOGLE_CLIENT_EMAIL,\n    scope: \"https://www.googleapis.com/auth/androidpublisher\",\n    aud: \"https://oauth2.googleapis.com/token\",\n    iat: now,\n    exp: now + 3600\n  };\n  \n  const encodedHeader = base64UrlEncode(JSON.stringify(header));\n  const encodedPayload = base64UrlEncode(JSON.stringify(payload));\n  const message = `${encodedHeader}.${encodedPayload}`;\n  \n  const privateKeyPem = GOOGLE_PRIVATE_KEY.replace(/\\\\n/g, \"\\n\");\n  const privateKey = await crypto.subtle.importKey(\n    \"pkcs8\",\n    pemToArrayBuffer(privateKeyPem),\n    { name: \"RSASSA-PKCS1-v1_5\", hash: \"SHA-256\" },\n    false,\n    [\"sign\"]\n  );\n  \n  const signature = await crypto.subtle.sign(\n    \"RSASSA-PKCS1-v1_5\",\n    privateKey,\n    new TextEncoder().encode(message)\n  );\n  \n  const encodedSignature = base64UrlEncode(String.fromCharCode(...new Uint8Array(signature)));\n  const jwt = `${message}.${encodedSignature}`;\n  \n  const tokenResponse = await fetch(\"https://oauth2.googleapis.com/token\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n    body: `grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer&assertion=${jwt}`\n  });\n  \n  if (!tokenResponse.ok) {\n    const error = await tokenResponse.text();\n    throw new Error(`Failed to get Google access token: ${error}`);\n  }\n  \n  const tokenData = await tokenResponse.json();\n  return tokenData.access_token;\n}\n\nasync function verifyWithGoogle(productId: string, purchaseToken: string): Promise<any> {\n  const accessToken = await getGoogleAccessToken();\n  \n  const url = `https://androidpublisher.googleapis.com/androidpublisher/v3/applications/${GOOGLE_PACKAGE_NAME}/purchases/products/${productId}/tokens/${purchaseToken}`;\n  \n  const response = await fetch(url, {\n    headers: {\n      \"Authorization\": `Bearer ${accessToken}`,\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  \n  if (!response.ok) {\n    const error = await response.text();\n    throw new Error(`Google API error: ${response.status} - ${error}`);\n  }\n  \n  return await response.json();\n}\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n  \n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"No authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY);\n    \n    const { receipt, productId, userId, deviceId, nonce, isRestore } = await req.json();\n    \n    if (!receipt || !productId || !userId || !deviceId || !nonce) {\n      return new Response(\n        JSON.stringify({ error: \"Missing required fields\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const { data: existingPurchase } = await supabase\n      .from(\"purchases\")\n      .select(\"id, user_id\")\n      .eq(\"receipt_token\", receipt)\n      .eq(\"verified\", true)\n      .maybeSingle();\n    \n    if (existingPurchase) {\n      if (existingPurchase.user_id !== userId) {\n        return new Response(\n          JSON.stringify({ verified: false, reason: \"This purchase belongs to a different account\" }),\n          { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n      \n      if (!isRestore) {\n        return new Response(\n          JSON.stringify({ verified: false, reason: \"Receipt already used\" }),\n          { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n    }\n    \n    let purchaseInfo;\n    try {\n      purchaseInfo = await verifyWithGoogle(productId, receipt);\n    } catch (error) {\n      console.error(\"Google verification failed:\", error);\n      return new Response(\n        JSON.stringify({ verified: false, reason: \"Google verification failed\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    if (purchaseInfo.purchaseState !== 0) {\n      return new Response(\n        JSON.stringify({ verified: false, reason: \"Purchase not completed\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n    \n    const planType = productId === \"premium_family_lifetime\" ? \"family\" : \"single\";\n    \n    const { data: purchase, error: purchaseError } = await supabase\n      .from(\"purchases\")\n      .insert({\n        user_id: userId,\n        platform: \"android\",\n        product_id: productId,\n        receipt_token: receipt,\n        verified: true,\n        refunded: false,\n        nonce: nonce,\n        device_id: deviceId,\n        order_id: purchaseInfo.orderId,\n        created_at: new Date().toISOString()\n      })\n      .select()\n      .single();\n    \n    if (purchaseError) {\n      console.error(\"Purchase insert error:\", purchaseError);\n    }\n    \n    const { error: userError } = await supabase\n      .from(\"users\")\n      .upsert({\n        id: userId,\n        premium: true,\n        plan_type: planType,\n        active_device_id: deviceId,\n        updated_at: new Date().toISOString()\n      }, { onConflict: \"id\" });\n    \n    if (userError) {\n      console.error(\"User update error:\", userError);\n    }\n    \n    if (planType === \"family\") {\n      const { data: existingGroup } = await supabase\n        .from(\"family_groups\")\n        .select(\"id\")\n        .eq(\"owner_id\", userId)\n        .maybeSingle();\n      \n      if (!existingGroup) {\n        await supabase\n          .from(\"family_groups\")\n          .insert({\n            owner_id: userId,\n            max_members: 5,\n            created_at: new Date().toISOString()\n          });\n      }\n    }\n    \n    return new Response(\n      JSON.stringify({\n        verified: true,\n        planType: planType,\n        purchaseId: purchase?.id\n      }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n    \n  } catch (error) {\n    console.error(\"Verification error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":7556,"size_tokens":null},"src/store/friendChallengesStore.js":{"content":"import { create } from \"zustand\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useProgressStore } from \"./progressStore\";\nimport { useFriendsStore } from \"./friendsStore\";\nimport { CHALLENGE_MODES } from \"./challengeStore\";\n\nconst CHALLENGE_EXPIRY_HOURS = 48;\nconst VIEWED_RESULTS_KEY = \"iq_viewed_challenge_results\";\n\nconst getViewedResultIds = () => {\n  try {\n    const stored = localStorage.getItem(VIEWED_RESULTS_KEY);\n    return stored ? JSON.parse(stored) : [];\n  } catch {\n    return [];\n  }\n};\n\nconst addViewedResultId = (challengeId) => {\n  const viewed = getViewedResultIds();\n  if (!viewed.includes(challengeId)) {\n    viewed.push(challengeId);\n    localStorage.setItem(VIEWED_RESULTS_KEY, JSON.stringify(viewed));\n  }\n};\n\nexport const useFriendChallengesStore = create((set, get) => ({\n  pendingIncoming: [],\n  pendingOutgoing: [],\n  activeChallenges: [],\n  completedChallenges: [],\n  resultsToView: [],\n  unreadCount: 0,\n  loading: false,\n  error: null,\n  currentUserId: null,\n  realtimeChannel: null,\n  initialized: false,\n  initializingPromise: null,\n\n  initialize: async () => {\n    if (get().initialized) return;\n    \n    if (get().initializingPromise) {\n      console.log(\"[FriendChallenges] Already initializing, waiting...\");\n      return get().initializingPromise;\n    }\n    \n    const initPromise = (async () => {\n      const { data: userData } = await supabase.auth.getUser();\n      if (!userData?.user?.id) {\n        console.log(\"[FriendChallenges] No user logged in\");\n        set({ initializingPromise: null });\n        return;\n      }\n      \n      const userId = userData.user.id;\n      set({ currentUserId: userId });\n      \n      await get().loadChallenges();\n      get().setupRealtimeSubscription(userId);\n      set({ initialized: true, initializingPromise: null });\n      \n      console.log(\"[FriendChallenges] Initialized for user:\", userId);\n    })();\n    \n    set({ initializingPromise: initPromise });\n    return initPromise;\n  },\n\n  cleanup: () => {\n    const { realtimeChannel } = get();\n    if (realtimeChannel) {\n      supabase.removeChannel(realtimeChannel);\n    }\n    set({\n      pendingIncoming: [],\n      pendingOutgoing: [],\n      activeChallenges: [],\n      completedChallenges: [],\n      resultsToView: [],\n      unreadCount: 0,\n      currentUserId: null,\n      realtimeChannel: null,\n      initialized: false,\n      initializingPromise: null,\n    });\n  },\n\n  loadChallenges: async () => {\n    const { currentUserId } = get();\n    if (!currentUserId) return;\n    \n    set({ loading: true, error: null });\n    \n    try {\n      // PARALLEL fetch: challenges and friends list together\n      const [challengesResult, friendsResult] = await Promise.all([\n        supabase.from(\"friend_challenges\").select(\"*\").or(`sender_id.eq.${currentUserId},receiver_id.eq.${currentUserId}`).order(\"created_at\", { ascending: false }),\n        supabase.from(\"friends\").select(\"user_id, friend_id\").or(`user_id.eq.${currentUserId},friend_id.eq.${currentUserId}`).eq(\"status\", \"accepted\"),\n      ]);\n      \n      if (challengesResult.error) throw challengesResult.error;\n      \n      const data = challengesResult.data || [];\n      const friendsData = friendsResult.data || [];\n      \n      const friendIds = new Set(friendsData.map(f => f.user_id === currentUserId ? f.friend_id : f.user_id));\n      \n      // Filter out orphaned challenges (async delete in background)\n      const validChallenges = [];\n      const orphanedIds = [];\n      \n      for (const c of data) {\n        const otherUserId = c.sender_id === currentUserId ? c.receiver_id : c.sender_id;\n        if (friendIds.has(otherUserId)) {\n          validChallenges.push(c);\n        } else {\n          orphanedIds.push(c.id);\n        }\n      }\n      \n      // Background delete orphaned challenges (fire and forget)\n      if (orphanedIds.length > 0) {\n        supabase.from(\"friend_challenges\").delete().in(\"id\", orphanedIds).then(() => {});\n      }\n      \n      const now = new Date();\n      const challenges = validChallenges.filter(c => {\n        if (c.status === \"cancelled\" || c.status === \"declined\") return false;\n        if (c.status === \"pending\") {\n          const createdAt = new Date(c.created_at);\n          const hoursSinceCreation = (now - createdAt) / (1000 * 60 * 60);\n          return hoursSinceCreation < CHALLENGE_EXPIRY_HOURS;\n        }\n        return true;\n      });\n      \n      const pendingIncoming = challenges.filter(\n        c => c.receiver_id === currentUserId && c.status === \"pending\"\n      );\n      const pendingOutgoing = challenges.filter(\n        c => c.sender_id === currentUserId && c.status === \"pending\"\n      );\n      const activeChallenges = challenges.filter(\n        c => c.status === \"accepted\" || c.status === \"sender_done\" || c.status === \"receiver_done\"\n      );\n      const completedChallenges = challenges.filter(c => c.status === \"finished\");\n      \n      const viewedIds = getViewedResultIds();\n      const resultsToView = completedChallenges.filter(c => {\n        if (viewedIds.includes(c.id)) return false;\n        return true;\n      });\n      \n      const unreadCount = pendingIncoming.length + resultsToView.length;\n      \n      set({\n        pendingIncoming,\n        pendingOutgoing,\n        activeChallenges,\n        completedChallenges,\n        resultsToView,\n        unreadCount,\n        loading: false,\n      });\n      \n    } catch (error) {\n      set({ error: error.message, loading: false });\n    }\n  },\n\n  setupRealtimeSubscription: (userId) => {\n    const channel = supabase\n      .channel(`friend_challenges_${userId}`)\n      .on(\"postgres_changes\", { event: \"*\", schema: \"public\", table: \"friend_challenges\", filter: `sender_id=eq.${userId}` }, () => get().loadChallenges())\n      .on(\"postgres_changes\", { event: \"*\", schema: \"public\", table: \"friend_challenges\", filter: `receiver_id=eq.${userId}` }, () => get().loadChallenges())\n      .subscribe();\n    \n    set({ realtimeChannel: channel });\n  },\n\n  handleRealtimeUpdate: () => {\n    get().loadChallenges();\n  },\n\n  refreshChallenge: async (challengeId) => {\n    if (!challengeId) return null;\n    \n    try {\n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .select(\"*\")\n        .eq(\"id\", challengeId)\n        .single();\n      \n      if (error) return null;\n      \n      console.log(\"[FriendChallenges] Refreshed:\", {\n        id: challengeId,\n        status: data?.status,\n        senderScore: data?.sender_score,\n        receiverScore: data?.receiver_score\n      });\n      \n      return data;\n    } catch (error) {\n      console.error(\"[FriendChallenges] Refresh exception:\", error);\n      return null;\n    }\n  },\n\n  clearPendingIncomingCount: () => {\n    const { resultsToView } = get();\n    set({ unreadCount: resultsToView.length });\n  },\n\n  createChallenge: async (friendId, modeId, questions) => {\n    const { currentUserId, pendingOutgoing, activeChallenges } = get();\n    if (!currentUserId) {\n      return { success: false, error: \"Not logged in\" };\n    }\n    \n    if (friendId === currentUserId) {\n      return { success: false, error: \"Cannot challenge yourself\" };\n    }\n    \n    const isDevFriend = typeof friendId === 'string' && friendId.startsWith('dev_friend_');\n    if (isDevFriend) {\n      return { \n        success: false, \n        error: \"Friend challenges are not available with test friends. Add real friends to challenge them!\" \n      };\n    }\n    \n    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n    if (!uuidRegex.test(friendId)) {\n      return { \n        success: false, \n        error: \"Invalid friend ID. Please try again.\" \n      };\n    }\n    \n    const existingWithFriend = [...pendingOutgoing, ...activeChallenges].find(\n      c => (c.sender_id === currentUserId && c.receiver_id === friendId) ||\n           (c.receiver_id === currentUserId && c.sender_id === friendId)\n    );\n    \n    if (existingWithFriend) {\n      return { success: false, error: \"Active challenge already exists with this friend\" };\n    }\n    \n    const modeConfig = Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n    if (!modeConfig) {\n      return { success: false, error: \"Invalid challenge mode\" };\n    }\n    \n    try {\n      console.log(\"[FriendChallenges] Creating challenge:\", {\n        sender: currentUserId,\n        receiver: friendId,\n        mode: modeId,\n        questionCount: questions?.length\n      });\n      \n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .insert({\n          sender_id: currentUserId,\n          receiver_id: friendId,\n          challenge_type: modeId,\n          status: \"pending\",\n          questions: questions,\n          created_at: new Date().toISOString(),\n        })\n        .select()\n        .single();\n      \n      if (error) {\n        console.error(\"[FriendChallenges] Insert error:\", error);\n        throw error;\n      }\n      \n      await get().loadChallenges();\n      \n      console.log(\"[FriendChallenges] Challenge created successfully:\", data.id);\n      return { success: true, challenge: data };\n    } catch (error) {\n      console.error(\"[FriendChallenges] Create error:\", error);\n      return { success: false, error: error.message };\n    }\n  },\n\n  acceptChallenge: async (challengeId) => {\n    const { currentUserId } = get();\n    console.log(\"[FriendChallenges] Accept challenge called:\", { challengeId, currentUserId });\n    \n    if (!currentUserId) return { success: false, error: \"Not logged in\" };\n    \n    try {\n      console.log(\"[FriendChallenges] Updating challenge status to accepted...\");\n      \n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .update({ status: \"accepted\" })\n        .eq(\"id\", challengeId)\n        .eq(\"receiver_id\", currentUserId)\n        .eq(\"status\", \"pending\")\n        .select()\n        .single();\n      \n      if (error) {\n        console.error(\"[FriendChallenges] Accept update error:\", error);\n        throw error;\n      }\n      \n      if (!data) {\n        console.error(\"[FriendChallenges] No rows updated for challenge:\", challengeId);\n        return { success: false, error: \"Challenge not found or already accepted\" };\n      }\n      \n      await get().loadChallenges();\n      \n      console.log(\"[FriendChallenges] Challenge accepted successfully:\", challengeId, \"Status:\", data.status);\n      return { success: true, challenge: data };\n    } catch (error) {\n      console.error(\"[FriendChallenges] Accept error:\", error);\n      return { success: false, error: error.message };\n    }\n  },\n\n  declineChallenge: async (challengeId) => {\n    const { currentUserId } = get();\n    if (!currentUserId) return { success: false, error: \"Not logged in\" };\n    \n    try {\n      const { error } = await supabase\n        .from(\"friend_challenges\")\n        .update({ status: \"cancelled\" })\n        .eq(\"id\", challengeId)\n        .eq(\"receiver_id\", currentUserId)\n        .eq(\"status\", \"pending\");\n      \n      if (error) throw error;\n      \n      await get().loadChallenges();\n      \n      console.log(\"[FriendChallenges] Challenge declined:\", challengeId);\n      return { success: true };\n    } catch (error) {\n      console.error(\"[FriendChallenges] Decline error:\", error);\n      return { success: false, error: error.message };\n    }\n  },\n\n  cancelChallenge: async (challengeId) => {\n    const { currentUserId } = get();\n    if (!currentUserId) return { success: false, error: \"Not logged in\" };\n    \n    try {\n      const { error } = await supabase\n        .from(\"friend_challenges\")\n        .update({ status: \"cancelled\" })\n        .eq(\"id\", challengeId)\n        .eq(\"sender_id\", currentUserId)\n        .eq(\"status\", \"pending\");\n      \n      if (error) throw error;\n      \n      await get().loadChallenges();\n      \n      console.log(\"[FriendChallenges] Challenge cancelled:\", challengeId);\n      return { success: true };\n    } catch (error) {\n      console.error(\"[FriendChallenges] Cancel error:\", error);\n      return { success: false, error: error.message };\n    }\n  },\n\n  submitResult: async (challengeId, score, answers, completionTime = null, chain = null) => {\n    console.log(\"[FriendChallenges] submitResult called:\", { challengeId, score, completionTime });\n    \n    const { data: userData } = await supabase.auth.getUser();\n    const currentUserId = userData?.user?.id;\n    \n    if (!currentUserId) {\n      console.error(\"[FriendChallenges] submitResult: No user ID\");\n      return { success: false, error: \"Not logged in\" };\n    }\n    \n    console.log(\"[FriendChallenges] submitResult for user:\", currentUserId?.slice(0,8));\n    \n    const { data: challenge, error: fetchError } = await supabase\n      .from(\"friend_challenges\")\n      .select(\"*\")\n      .eq(\"id\", challengeId)\n      .single();\n    \n    if (fetchError || !challenge) {\n      console.error(\"[FriendChallenges] Could not find challenge:\", challengeId, fetchError);\n      return { success: false, error: \"Challenge not found\" };\n    }\n    \n    console.log(\"[FriendChallenges] Current challenge state:\", {\n      id: challenge.id?.slice(0,8),\n      status: challenge.status,\n      senderScore: challenge.sender_score,\n      receiverScore: challenge.receiver_score\n    });\n    \n    const isSender = challenge.sender_id === currentUserId;\n    const updateData = {};\n    \n    if (isSender) {\n      updateData.sender_score = score;\n      updateData.sender_time = completionTime;\n      updateData.sender_chain = chain;\n      updateData.sender_answers = answers;\n      \n      if (challenge.receiver_score !== null || challenge.status === \"receiver_done\") {\n        updateData.status = \"finished\";\n        console.log(\"[FriendChallenges] Sender finishing - receiver already done, marking FINISHED\");\n      } else {\n        updateData.status = \"sender_done\";\n        console.log(\"[FriendChallenges] Sender finishing - waiting for receiver\");\n      }\n    } else {\n      updateData.receiver_score = score;\n      updateData.receiver_time = completionTime;\n      updateData.receiver_chain = chain;\n      updateData.receiver_answers = answers;\n      \n      if (challenge.sender_score !== null || challenge.status === \"sender_done\") {\n        updateData.status = \"finished\";\n        console.log(\"[FriendChallenges] Receiver finishing - sender already done, marking FINISHED\");\n      } else {\n        updateData.status = \"receiver_done\";\n        console.log(\"[FriendChallenges] Receiver finishing - waiting for sender\");\n      }\n    }\n    \n    try {\n      const normalizedTime = completionTime != null ? Math.round(Number(completionTime)) : null;\n      \n      const coreUpdate = isSender \n        ? { \n            sender_score: score, \n            sender_time: normalizedTime,\n            status: updateData.status\n          }\n        : { \n            receiver_score: score, \n            receiver_time: normalizedTime,\n            status: updateData.status\n          };\n      \n      console.log(\"[FriendChallenges] Submitting:\", coreUpdate, \"chain:\", chain);\n      \n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .update(coreUpdate)\n        .eq(\"id\", challengeId)\n        .select()\n        .single();\n      \n      if (error) {\n        console.error(\"[FriendChallenges] Submit error:\", error);\n        throw error;\n      }\n      \n      await get().loadChallenges();\n      \n      console.log(\"[FriendChallenges] Result submitted:\", challengeId, coreUpdate.status);\n      return { success: true, challenge: data };\n    } catch (error) {\n      console.error(\"[FriendChallenges] Submit error:\", error);\n      return { success: false, error: error.message };\n    }\n  },\n\n  markResultViewed: async (challengeId) => {\n    console.log(\"[FriendChallenges] markResultViewed called:\", challengeId);\n    \n    addViewedResultId(challengeId);\n    \n    const { resultsToView } = get();\n    const updatedResults = resultsToView.filter(c => c.id !== challengeId);\n    \n    set({ \n      resultsToView: updatedResults,\n      unreadCount: updatedResults.length + get().pendingIncoming.length\n    });\n    \n    console.log(\"[FriendChallenges] markResultViewed: removed and persisted, remaining:\", updatedResults.length);\n  },\n\n  getChallengeById: (challengeId) => {\n    const { pendingIncoming, pendingOutgoing, activeChallenges, completedChallenges } = get();\n    return [...pendingIncoming, ...pendingOutgoing, ...activeChallenges, ...completedChallenges]\n      .find(c => c.id === challengeId);\n  },\n\n  fetchChallengeById: async (challengeId) => {\n    try {\n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .select(\"*\")\n        .eq(\"id\", challengeId)\n        .single();\n      \n      if (error) {\n        console.error(\"[FriendChallenges] fetchChallengeById error:\", error);\n        return null;\n      }\n      \n      return data;\n    } catch (error) {\n      console.error(\"[FriendChallenges] fetchChallengeById error:\", error);\n      return null;\n    }\n  },\n\n  ensureChallengeLoaded: async (challengeId) => {\n    console.log(\"[FriendChallenges] ensureChallengeLoaded start:\", challengeId);\n    \n    const timeoutPromise = new Promise((_, reject) => \n      setTimeout(() => reject(new Error(\"ensureChallengeLoaded timeout\")), 8000)\n    );\n    \n    try {\n      const loadPromise = (async () => {\n        const { data: userData } = await supabase.auth.getUser();\n        const userId = userData?.user?.id;\n        \n        if (!userId) {\n          console.error(\"[FriendChallenges] ensureChallengeLoaded: No user ID\");\n          throw new Error(\"Not authenticated\");\n        }\n        \n        console.log(\"[FriendChallenges] ensureChallengeLoaded: user:\", userId?.slice(0,8));\n        \n        if (!get().initialized || get().currentUserId !== userId) {\n          set({ currentUserId: userId });\n          await get().loadChallenges();\n          set({ initialized: true });\n        }\n        \n        let challenge = get().getChallengeById(challengeId);\n        if (challenge) {\n          console.log(\"[FriendChallenges] ensureChallengeLoaded: found in local state\");\n          return challenge;\n        }\n        \n        console.log(\"[FriendChallenges] ensureChallengeLoaded: fetching directly from DB\");\n        const { data, error } = await supabase\n          .from(\"friend_challenges\")\n          .select(\"*\")\n          .eq(\"id\", challengeId)\n          .single();\n        \n        if (error) {\n          console.error(\"[FriendChallenges] ensureChallengeLoaded DB error:\", error);\n          throw new Error(\"Challenge not found in database\");\n        }\n        \n        if (!data) {\n          console.error(\"[FriendChallenges] ensureChallengeLoaded: No data returned\");\n          throw new Error(\"Challenge not found\");\n        }\n        \n        console.log(\"[FriendChallenges] ensureChallengeLoaded: fetched from DB:\", data.id?.slice(0,8));\n        \n        await get().loadChallenges();\n        \n        return data;\n      })();\n      \n      return await Promise.race([loadPromise, timeoutPromise]);\n    } catch (error) {\n      console.error(\"[FriendChallenges] ensureChallengeLoaded error:\", error.message);\n      throw error;\n    }\n  },\n\n  getActiveWithFriend: (friendId) => {\n    const { currentUserId, pendingOutgoing, pendingIncoming, activeChallenges } = get();\n    return [...pendingOutgoing, ...pendingIncoming, ...activeChallenges].find(\n      c => (c.sender_id === currentUserId && c.receiver_id === friendId) ||\n           (c.receiver_id === currentUserId && c.sender_id === friendId)\n    );\n  },\n\n  getChallengeStateForFriend: (friendId) => {\n    const { currentUserId, pendingOutgoing, pendingIncoming, activeChallenges, resultsToView } = get();\n    \n    const pending = pendingOutgoing.find(\n      c => c.receiver_id === friendId\n    );\n    if (pending) return { type: \"pending_sent\", challenge: pending };\n    \n    const received = pendingIncoming.find(\n      c => c.sender_id === friendId\n    );\n    if (received) return { type: \"pending_received\", challenge: received };\n    \n    const active = activeChallenges.find(\n      c => (c.sender_id === currentUserId && c.receiver_id === friendId) ||\n           (c.receiver_id === currentUserId && c.sender_id === friendId)\n    );\n    if (active) {\n      const isSender = active.sender_id === currentUserId;\n      const myTurnDone = isSender \n        ? (active.sender_score !== null)\n        : (active.receiver_score !== null);\n      \n      if (myTurnDone && active.status !== \"finished\") {\n        return { type: \"waiting_for_friend\", challenge: active };\n      }\n      \n      if (!myTurnDone) {\n        return { type: \"ready_to_play\", challenge: active };\n      }\n    }\n    \n    const result = resultsToView.find(\n      c => (c.sender_id === currentUserId && c.receiver_id === friendId) ||\n           (c.receiver_id === currentUserId && c.sender_id === friendId)\n    );\n    if (result) return { type: \"results_ready\", challenge: result };\n    \n    return null;\n  },\n\n  determineWinner: (challenge) => {\n    const modeConfig = Object.values(CHALLENGE_MODES).find(m => m.id === challenge.challenge_type);\n    \n    const senderScore = challenge.sender_score || 0;\n    const receiverScore = challenge.receiver_score || 0;\n    \n    if (senderScore > receiverScore) return challenge.sender_id;\n    if (receiverScore > senderScore) return challenge.receiver_id;\n    \n    if (modeConfig?.trackTime || modeConfig?.id === \"sudden_death\") {\n      const senderTime = challenge.sender_time || Infinity;\n      const receiverTime = challenge.receiver_time || Infinity;\n      if (senderTime < receiverTime) return challenge.sender_id;\n      if (receiverTime < senderTime) return challenge.receiver_id;\n    }\n    \n    return \"draw\";\n  },\n\n  getRewards: (challenge, winnerId) => {\n    const { currentUserId } = get();\n    const modeConfig = Object.values(CHALLENGE_MODES).find(m => m.id === challenge.challenge_type);\n    if (!modeConfig) return { xp: 0, coins: 0 };\n    \n    if (winnerId === \"draw\") {\n      return modeConfig.rewards.draw || { xp: 0, coins: 0 };\n    }\n    \n    const isWinner = winnerId === currentUserId;\n    return isWinner ? modeConfig.rewards.win : modeConfig.rewards.lose;\n  },\n}));\n","path":null,"size_bytes":22154,"size_tokens":null},"src/utils/challengeQuestions.js":{"content":"import { useChallengeStore, CHALLENGE_MODES } from \"../store/challengeStore\";\n\nexport const generateQuestionsForChallenge = (modeId) => {\n  const modeConfig = Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n  if (!modeConfig) {\n    console.error(\"[ChallengeQuestions] Invalid mode:\", modeId);\n    return [];\n  }\n  \n  const questions = useChallengeStore.getState().getQuestionsForMode(modeConfig);\n  \n  const sanitizedQuestions = questions.map((q, index) => ({\n    id: `q_${index}`,\n    question: q.question,\n    options: q.options,\n    answer: q.answer,\n    difficulty: q.difficulty || \"medium\",\n  }));\n  \n  console.log(`[ChallengeQuestions] Generated ${sanitizedQuestions.length} questions for ${modeId}`);\n  return sanitizedQuestions;\n};\n\nexport const getModeConfig = (modeId) => {\n  return Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n};\n\nexport const getModeIcon = (modeId) => {\n  const mode = getModeConfig(modeId);\n  return mode?.icon || \"üéÆ\";\n};\n\nexport const getModeName = (modeId) => {\n  const mode = getModeConfig(modeId);\n  return mode?.name || \"Challenge\";\n};\n\nexport const getModeRewards = (modeId, result) => {\n  const mode = getModeConfig(modeId);\n  if (!mode) return { xp: 0, coins: 0 };\n  return mode.rewards[result] || { xp: 0, coins: 0 };\n};\n","path":null,"size_bytes":1288,"size_tokens":null},"src/components/challenges/FriendChallengeWaitingModal.jsx":{"content":"import { useModalStore } from \"../../store/modalStore\";\nimport { getModeIcon, getModeName } from \"../../utils/challengeQuestions\";\nimport assets from \"../../assets/assets\";\nimport \"./ChallengeModals.css\";\nimport { useEffect, useState, useRef, useCallback } from \"react\";\nimport { supabase } from \"../../lib/supabaseClient\";\nimport { useFriendChallengesStore } from \"../../store/friendChallengesStore\";\n\nexport default function FriendChallengeWaitingModal({ friendName, modeId, score, totalQuestions, onClose, challengeId }) {\n  const { hideModal } = useModalStore();\n  const loadChallenges = useFriendChallengesStore(state => state.loadChallenges);\n  const [challengeData, setChallengeData] = useState(null);\n  const channelRef = useRef(null);\n  const mountedRef = useRef(true);\n  \n  const receiverAccepted = challengeData && (\n    challengeData.status === 'accepted' || \n    challengeData.status === 'sender_done' || \n    challengeData.status === 'receiver_done' || \n    challengeData.status === 'finished'\n  );\n  \n  const receiverFinished = challengeData && \n    challengeData.receiver_score !== null && \n    challengeData.receiver_score !== undefined;\n  \n  const fetchChallenge = useCallback(async () => {\n    if (!mountedRef.current || !challengeId) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from(\"friend_challenges\")\n        .select(\"status, receiver_score\")\n        .eq(\"id\", challengeId)\n        .single();\n      \n      if (error || !data || !mountedRef.current) return;\n      \n      setChallengeData(data);\n      loadChallenges();\n    } catch (err) {}\n  }, [challengeId, loadChallenges]);\n  \n  useEffect(() => {\n    mountedRef.current = true;\n    \n    if (!challengeId) return;\n    \n    // Initial fetch\n    fetchChallenge();\n    \n    // Real-time subscription for instant updates\n    channelRef.current = supabase\n      .channel(`waiting_${challengeId}`)\n      .on(\"postgres_changes\", { event: \"UPDATE\", schema: \"public\", table: \"friend_challenges\", filter: `id=eq.${challengeId}` },\n        (payload) => {\n          if (!mountedRef.current) return;\n          const data = payload.new;\n          setChallengeData({ status: data.status, receiver_score: data.receiver_score });\n          loadChallenges();\n        }\n      )\n      .subscribe();\n    \n    return () => {\n      mountedRef.current = false;\n      if (channelRef.current) {\n        supabase.removeChannel(channelRef.current);\n        channelRef.current = null;\n      }\n    };\n  }, [challengeId, fetchChallenge, loadChallenges]);\n  \n  const handleClose = () => {\n    hideModal();\n    onClose?.();\n  };\n  \n  return (\n    <div className=\"challenge-modal-overlay\" onClick={handleClose}>\n      <div className=\"challenge-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={assets.mascots.mascot_countdown} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            {receiverFinished \n              ? \"Your friend finished! Time to see the results!\" \n              : receiverAccepted \n              ? \"Your friend accepted! They're taking the challenge now...\"\n              : \"You finished! Now we wait for your friend...\"}\n          </div>\n        </div>\n\n        <div \n          className=\"challenge-mode-icon\"\n          style={{ \n            background: receiverFinished \n              ? \"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)\" \n              : receiverAccepted\n              ? \"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)\"\n              : \"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)\",\n            fontSize: \"2rem\",\n            margin: \"16px auto\",\n            transition: \"all 0.3s ease\"\n          }}\n        >\n          {receiverFinished ? \"‚ú®\" : receiverAccepted ? \"‚ö°\" : \"‚è≥\"}\n        </div>\n\n        <h2 className=\"challenge-modal-title\" style={{ \n          color: receiverFinished ? \"#22c55e\" : receiverAccepted ? \"#3b82f6\" : \"#f59e0b\",\n          transition: \"color 0.3s ease\"\n        }}>\n          {receiverFinished ? \"Time for Results!\" : receiverAccepted ? \"Challenge Accepted!\" : `Waiting for ${friendName}`}\n        </h2>\n\n        <p style={{ color: \"#cbd5e1\", fontSize: \"1rem\", lineHeight: 1.6, marginBottom: 8 }}>\n          You've completed the <strong>{getModeName(modeId)}</strong> challenge!\n        </p>\n\n        {score !== undefined && totalQuestions !== undefined && (\n          <div style={{\n            background: \"rgba(212, 175, 55, 0.15)\",\n            border: \"1px solid rgba(212, 175, 55, 0.3)\",\n            borderRadius: \"12px\",\n            padding: \"12px 20px\",\n            margin: \"16px 0\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: \"8px\"\n          }}>\n            <span style={{ fontSize: \"1.5rem\" }}>üéØ</span>\n            <span style={{ color: \"#D4AF37\", fontWeight: \"700\", fontSize: \"1.2rem\" }}>\n              Your Score: {score}/{totalQuestions}\n            </span>\n          </div>\n        )}\n        \n        <p style={{ color: \"#94a3b8\", fontSize: \"0.85rem\", marginBottom: 24 }}>\n          {receiverFinished \n            ? \"Your friend completed the challenge. Tap Got it! to see your results.\"\n            : receiverAccepted\n            ? \"Your friend is now taking the quiz...\"\n            : \"You'll see the results when your friend finishes.\"}\n        </p>\n\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={handleClose}\n          style={{\n            background: receiverFinished \n              ? \"linear-gradient(135deg, #22c55e, #16a34a)\"\n              : receiverAccepted\n              ? \"linear-gradient(135deg, #3b82f6, #2563eb)\"\n              : \"linear-gradient(135deg, #f59e0b, #d97706)\",\n            boxShadow: receiverFinished \n              ? \"0 4px 15px rgba(34, 197, 94, 0.3)\"\n              : receiverAccepted\n              ? \"0 4px 15px rgba(59, 130, 246, 0.3)\"\n              : \"0 4px 15px rgba(245, 158, 11, 0.3)\",\n            transition: \"all 0.3s ease\"\n          }}\n        >\n          Got it!\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":6244,"size_tokens":null},"src/components/challenges/FriendChallengeResultsModal.jsx":{"content":"import { useModalStore } from \"../../store/modalStore\";\nimport { useFriendChallengesStore } from \"../../store/friendChallengesStore\";\nimport { useProgressStore } from \"../../store/progressStore\";\nimport { getModeIcon, getModeName } from \"../../utils/challengeQuestions\";\nimport { getAvatarImage } from \"../../utils/avatarUtils\";\nimport { CHALLENGE_MODES } from \"../../store/challengeStore\";\nimport assets from \"../../assets/assets\";\nimport \"./ChallengeModals.css\";\n\nexport default function FriendChallengeResultsModal({ \n  challenge,\n  currentUserId,\n  onChallengeAgain,\n  onClose \n}) {\n  const { hideModal } = useModalStore();\n  const { markResultViewed, determineWinner, getRewards } = useFriendChallengesStore();\n  const { addXP, addCoins } = useProgressStore();\n  \n  const isSender = challenge?.sender_id === currentUserId;\n  const modeId = challenge?.challenge_type;\n  const modeConfig = Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n  \n  const myScore = isSender ? challenge?.sender_score : challenge?.receiver_score;\n  const opponentScore = isSender ? challenge?.receiver_score : challenge?.sender_score;\n  const myTime = isSender ? challenge?.sender_time : challenge?.receiver_time;\n  const opponentTime = isSender ? challenge?.receiver_time : challenge?.sender_time;\n  \n  const winnerId = determineWinner(challenge);\n  const isWinner = winnerId === currentUserId;\n  const isDraw = winnerId === \"draw\";\n  \n  const rewards = getRewards(challenge, winnerId);\n  \n  const handleClose = async () => {\n    console.log(\"[ResultsModal] handleClose called\");\n    try {\n      await markResultViewed(challenge.id);\n      if (rewards.xp > 0) addXP(rewards.xp);\n      if (rewards.coins > 0) addCoins(rewards.coins);\n    } catch (err) {\n      console.error(\"[ResultsModal] handleClose error:\", err);\n    }\n    onClose?.();\n  };\n  \n  const handleChallengeAgain = async () => {\n    console.log(\"[ResultsModal] handleChallengeAgain called\");\n    try {\n      await markResultViewed(challenge.id);\n      if (rewards.xp > 0) addXP(rewards.xp);\n      if (rewards.coins > 0) addCoins(rewards.coins);\n    } catch (err) {\n      console.error(\"[ResultsModal] handleChallengeAgain error:\", err);\n    }\n    onChallengeAgain?.();\n  };\n  \n  const resultColor = isDraw ? \"#f59e0b\" : (isWinner ? \"#10b981\" : \"#ef4444\");\n  const resultText = isDraw ? \"It's a Draw!\" : (isWinner ? \"You Won!\" : \"You Lost\");\n  const resultEmoji = isDraw ? \"ü§ù\" : (isWinner ? \"üèÜ\" : \"üòî\");\n  \n  const getMascot = () => {\n    if (isWinner) return assets.mascots.mascot_congratulation;\n    if (isDraw) return assets.mascots.mascot_sitting_v2;\n    return assets.mascots.mascot_defeated;\n  };\n  \n  return (\n    <div className=\"challenge-modal-overlay\" onClick={handleClose}>\n      <div className=\"challenge-modal\" onClick={(e) => e.stopPropagation()}>\n        <img \n          src={getMascot()} \n          alt=\"Zayd\" \n          style={{ width: 90, height: \"auto\", marginBottom: 8 }}\n        />\n\n        <div \n          style={{ \n            fontSize: \"2.5rem\",\n            margin: \"4px 0\"\n          }}\n        >\n          {resultEmoji}\n        </div>\n\n        <h2 className=\"challenge-modal-title\" style={{ color: resultColor, marginBottom: 4 }}>\n          {resultText}\n        </h2>\n\n        <p style={{ color: \"#94a3b8\", fontSize: \"0.85rem\", marginBottom: 12 }}>\n          {getModeIcon(modeId)} {getModeName(modeId)}\n        </p>\n\n        <div style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          gap: 20,\n          margin: \"12px 0\",\n          padding: \"14px 20px\",\n          background: \"rgba(255,255,255,0.05)\",\n          borderRadius: 12,\n        }}>\n          <div style={{ textAlign: \"center\" }}>\n            <p style={{ color: \"#94a3b8\", fontSize: \"0.75rem\", margin: 0 }}>You</p>\n            <p style={{ \n              color: isWinner || isDraw ? \"#10b981\" : \"#fff\", \n              fontSize: \"1.6rem\", \n              fontWeight: 700, \n              margin: \"2px 0\" \n            }}>\n              {myScore}\n            </p>\n            {myTime != null && (\n              <p style={{ color: \"#64748b\", fontSize: \"0.7rem\", margin: 0 }}>\n                {Math.round(myTime)}s\n              </p>\n            )}\n          </div>\n          \n          <div style={{ \n            color: \"#64748b\",\n            fontSize: \"1rem\",\n            fontWeight: 500\n          }}>\n            vs\n          </div>\n          \n          <div style={{ textAlign: \"center\" }}>\n            <p style={{ color: \"#94a3b8\", fontSize: \"0.75rem\", margin: 0 }}>Opponent</p>\n            <p style={{ \n              color: !isWinner && !isDraw ? \"#ef4444\" : \"#fff\", \n              fontSize: \"1.6rem\", \n              fontWeight: 700, \n              margin: \"2px 0\" \n            }}>\n              {opponentScore}\n            </p>\n            {opponentTime != null && (\n              <p style={{ color: \"#64748b\", fontSize: \"0.7rem\", margin: 0 }}>\n                {Math.round(opponentTime)}s\n              </p>\n            )}\n          </div>\n        </div>\n\n        {(rewards.xp > 0 || rewards.coins > 0) && (\n          <div style={{\n            display: \"flex\",\n            justifyContent: \"center\",\n            gap: 16,\n            margin: \"16px 0\",\n          }}>\n            {rewards.xp > 0 && (\n              <div style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: 6,\n                background: \"rgba(212, 175, 55, 0.15)\",\n                padding: \"8px 14px\",\n                borderRadius: 20,\n                border: \"1px solid rgba(212, 175, 55, 0.3)\"\n              }}>\n                <span>‚ö°</span>\n                <span style={{ color: \"#d4af37\", fontWeight: 600 }}>+{rewards.xp} XP</span>\n              </div>\n            )}\n            {rewards.coins > 0 && (\n              <div style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: 6,\n                background: \"rgba(212, 175, 55, 0.15)\",\n                padding: \"8px 14px\",\n                borderRadius: 20,\n                border: \"1px solid rgba(212, 175, 55, 0.3)\"\n              }}>\n                <span>ü™ô</span>\n                <span style={{ color: \"#d4af37\", fontWeight: 600 }}>+{rewards.coins}</span>\n              </div>\n            )}\n          </div>\n        )}\n\n        <div style={{ display: \"flex\", gap: 12, marginTop: 20 }}>\n          <button \n            className=\"challenge-btn-secondary\"\n            onClick={handleClose}\n            style={{\n              flex: 1,\n              background: \"rgba(100, 116, 139, 0.2)\",\n              border: \"1px solid rgba(100, 116, 139, 0.4)\",\n              color: \"#94a3b8\"\n            }}\n          >\n            Close\n          </button>\n          <button \n            className=\"challenge-btn-primary\"\n            onClick={handleChallengeAgain}\n            style={{\n              flex: 2,\n              background: \"linear-gradient(135deg, #8b5cf6, #6366f1)\",\n              boxShadow: \"0 4px 15px rgba(139, 92, 246, 0.3)\"\n            }}\n          >\n            Challenge Again!\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7172,"size_tokens":null},"src/components/challenges/FriendChallengeSentModal.jsx":{"content":"import { useModalStore } from \"../../store/modalStore\";\nimport { getModeIcon, getModeName } from \"../../utils/challengeQuestions\";\nimport mascot_quiz from \"../../assets/mascots/mascot_quiz.webp\";\nimport mascot_power from \"../../assets/mascots/mascot_power.webp\";\nimport mascot_running from \"../../assets/mascots/mascot_running.webp\";\nimport mascot_locked from \"../../assets/mascots/mascot_locked.webp\";\nimport \"./ChallengeModals.css\";\n\nconst getMascotForMode = (modeId) => {\n  switch (modeId) {\n    case \"mind_battle\":\n      return mascot_quiz;\n    case \"lightning_round\":\n      return mascot_power;\n    case \"speed_run\":\n      return mascot_running;\n    case \"sudden_death\":\n      return mascot_locked;\n    default:\n      return mascot_quiz;\n  }\n};\n\nexport default function FriendChallengeSentModal({ friendName, modeId, onClose }) {\n  const { hideModal } = useModalStore();\n  \n  const handleClose = () => {\n    hideModal();\n    onClose?.();\n  };\n  \n  return (\n    <div className=\"challenge-modal-overlay\" onClick={handleClose}>\n      <div className=\"challenge-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={getMascotForMode(modeId)} \n            alt=\"Challenge\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            Challenge sent! Now we wait...\n          </div>\n        </div>\n\n        <h2 className=\"challenge-modal-title\" style={{ color: \"#10b981\" }}>\n          Challenge Sent!\n        </h2>\n\n        <p style={{ color: \"#cbd5e1\", fontSize: \"1rem\", lineHeight: 1.6, marginBottom: 8 }}>\n          <strong>{getModeName(modeId)}</strong> challenge sent to\n        </p>\n        <p style={{ color: \"#d4af37\", fontSize: \"1.1rem\", fontWeight: 600, marginBottom: 20 }}>\n          {friendName}\n        </p>\n\n        <p style={{ color: \"#94a3b8\", fontSize: \"0.85rem\", marginBottom: 24 }}>\n          You'll be notified when they accept!\n        </p>\n\n        <button \n          className=\"challenge-btn-primary\"\n          onClick={handleClose}\n          style={{\n            background: \"linear-gradient(135deg, #10b981, #059669)\",\n            boxShadow: \"0 4px 15px rgba(16, 185, 129, 0.3)\"\n          }}\n        >\n          Got it!\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2375,"size_tokens":null},"src/components/challenges/FriendChallengeReceivedModal.jsx":{"content":"import { useState } from \"react\";\nimport { useModalStore } from \"../../store/modalStore\";\nimport { getModeIcon, getModeName } from \"../../utils/challengeQuestions\";\nimport { getAvatarImage } from \"../../utils/avatarUtils\";\nimport assets from \"../../assets/assets\";\nimport \"./ChallengeModals.css\";\n\nexport default function FriendChallengeReceivedModal({ \n  challenge, \n  senderName, \n  senderAvatar,\n  onAccept, \n  onDecline, \n  onClose \n}) {\n  const { hideModal } = useModalStore();\n  const [loading, setLoading] = useState(false);\n  \n  const handleAccept = async () => {\n    setLoading(true);\n    await onAccept?.();\n    hideModal();\n  };\n  \n  const handleDecline = async () => {\n    setLoading(true);\n    await onDecline?.();\n    hideModal();\n    onClose?.();\n  };\n  \n  const handleClose = () => {\n    hideModal();\n    onClose?.();\n  };\n  \n  const modeId = challenge?.challenge_type;\n  \n  return (\n    <div className=\"challenge-modal-overlay\" onClick={handleClose}>\n      <div className=\"challenge-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"challenge-zayd-container\">\n          <img \n            src={assets.mascots.mascot_boss} \n            alt=\"Zayd\" \n            className=\"challenge-zayd-bounce\"\n            style={{ width: 100, height: \"auto\" }}\n          />\n          <div className=\"zayd-speech-bubble\">\n            You've been challenged!\n          </div>\n        </div>\n\n        <div style={{ \n          display: \"flex\", \n          alignItems: \"center\", \n          justifyContent: \"center\",\n          gap: 12,\n          margin: \"16px 0\"\n        }}>\n          <img \n            src={getAvatarImage(senderAvatar, { userId: challenge?.sender_id, nickname: senderName })} \n            alt={senderName}\n            style={{ \n              width: 50, \n              height: 50, \n              borderRadius: \"50%\",\n              border: \"2px solid rgba(212, 175, 55, 0.5)\"\n            }}\n          />\n          <div>\n            <p style={{ color: \"#d4af37\", fontSize: \"1.1rem\", fontWeight: 600, margin: 0 }}>\n              {senderName}\n            </p>\n            <p style={{ color: \"#94a3b8\", fontSize: \"0.85rem\", margin: 0 }}>\n              wants to challenge you!\n            </p>\n          </div>\n        </div>\n\n        <div \n          className=\"challenge-mode-icon\"\n          style={{ \n            background: \"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)\",\n            fontSize: \"2rem\",\n            margin: \"16px auto\"\n          }}\n        >\n          {getModeIcon(modeId)}\n        </div>\n\n        <h2 className=\"challenge-modal-title\">\n          {getModeName(modeId)}\n        </h2>\n\n        <p style={{ color: \"#94a3b8\", fontSize: \"0.9rem\", marginBottom: 24 }}>\n          Accept to start the challenge now!\n        </p>\n\n        <div style={{ display: \"flex\", gap: 12 }}>\n          <button \n            className=\"challenge-btn-secondary\"\n            onClick={handleDecline}\n            disabled={loading}\n            style={{\n              flex: 1,\n              background: \"rgba(239, 68, 68, 0.2)\",\n              border: \"1px solid rgba(239, 68, 68, 0.4)\",\n              color: \"#ef4444\"\n            }}\n          >\n            {loading ? \"...\" : \"Decline\"}\n          </button>\n          <button \n            className=\"challenge-btn-primary\"\n            onClick={handleAccept}\n            disabled={loading}\n            style={{\n              flex: 2,\n              background: \"linear-gradient(135deg, #10b981, #059669)\",\n              boxShadow: \"0 4px 15px rgba(16, 185, 129, 0.3)\"\n            }}\n          >\n            {loading ? \"Loading...\" : \"Accept Challenge!\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3686,"size_tokens":null},"src/pages/challenges/FriendChallengeGame.jsx":{"content":"import { useState, useEffect, useRef, useMemo } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"../../hooks/useNavigate\";\nimport { useFriendChallengesStore } from \"../../store/friendChallengesStore\";\nimport { CHALLENGE_MODES, calculateLongestChain } from \"../../store/challengeStore\";\nimport { useModalStore, MODAL_TYPES } from \"../../store/modalStore\";\nimport { useRewards } from \"../../hooks/useRewards\";\nimport { useAnalytics } from \"../../hooks/useAnalytics\";\nimport { useVibration } from \"../../hooks/useVibration\";\nimport { useFriendsStore } from \"../../store/friendsStore\";\nimport { useUserStore } from \"../../store/useUserStore\";\nimport assets from \"../../assets/assets\";\nimport mascot_running from \"../../assets/mascots/mascot_running.webp\";\nimport { getAvatarImage } from \"../../utils/avatarUtils\";\nimport \"./ChallengeGame.css\";\n\nconst getModeConfig = (modeId) => {\n  if (!modeId) return null;\n  if (typeof modeId === 'object' && modeId.id) return modeId;\n  if (typeof modeId === 'string') {\n    const foundById = Object.values(CHALLENGE_MODES).find(m => m.id === modeId);\n    if (foundById) return foundById;\n    const modeKey = modeId.toUpperCase();\n    if (CHALLENGE_MODES[modeKey]) return CHALLENGE_MODES[modeKey];\n    if (CHALLENGE_MODES[modeId]) return CHALLENGE_MODES[modeId];\n  }\n  console.error('Failed to normalize mode:', modeId);\n  return null;\n};\n\nexport default function FriendChallengeGame() {\n  const navigate = useNavigate();\n  const { challengeId } = useParams();\n  const { showModal } = useModalStore();\n  const { addRewards } = useRewards();\n  const analytics = useAnalytics();\n  const { vibrate } = useVibration();\n  const { id: currentUserId } = useUserStore();\n  const { getAllFriends } = useFriendsStore();\n  \n  const submitResult = useFriendChallengesStore(state => state.submitResult);\n  const determineWinner = useFriendChallengesStore(state => state.determineWinner);\n  const getRewards = useFriendChallengesStore(state => state.getRewards);\n  const markResultViewed = useFriendChallengesStore(state => state.markResultViewed);\n  const ensureChallengeLoaded = useFriendChallengesStore(state => state.ensureChallengeLoaded);\n  \n  const [questions, setQuestions] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [timeLeft, setTimeLeft] = useState(0);\n  const [isTimeUp, setIsTimeUp] = useState(false);\n  const [score, setScore] = useState(0);\n  const [chainLength, setChainLength] = useState(0);\n  const [gameEnded, setGameEnded] = useState(false);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [opponentInfo, setOpponentInfo] = useState(null);\n  const [gameInitialized, setGameInitialized] = useState(false);\n  const [challenge, setChallenge] = useState(null);\n  const [isSender, setIsSender] = useState(false);\n  const [userId, setUserId] = useState(null);\n  \n  const timerRef = useRef(null);\n  const elapsedTimerRef = useRef(null);\n  const selectedAnswerRef = useRef(null);\n  const isCompletingRef = useRef(false);\n  const startTimeRef = useRef(null);\n  const completionTimeRef = useRef(null);\n\n  const mode = challenge ? getModeConfig(challenge.challenge_type) : null;\n\n  useEffect(() => {\n    let isMounted = true;\n    \n    const loadChallenge = async () => {\n      console.log('[FriendChallengeGame] Starting challenge load:', challengeId);\n      \n      try {\n        const loadedChallenge = await ensureChallengeLoaded(challengeId);\n        \n        if (!isMounted) {\n          console.log('[FriendChallengeGame] Component unmounted, aborting');\n          return;\n        }\n        \n        console.log('[FriendChallengeGame] Challenge loaded:', {\n          id: loadedChallenge.id?.slice(0,8),\n          status: loadedChallenge.status,\n          sender: loadedChallenge.sender_id?.slice(0,8),\n          receiver: loadedChallenge.receiver_id?.slice(0,8),\n          senderScore: loadedChallenge.sender_score,\n          receiverScore: loadedChallenge.receiver_score,\n          questionCount: loadedChallenge.questions?.length\n        });\n        \n        const { supabase } = await import('../../lib/supabaseClient');\n        const { data: userData } = await supabase.auth.getUser();\n        const fetchedUserId = userData?.user?.id;\n        \n        console.log('[FriendChallengeGame] User ID:', fetchedUserId?.slice(0,8));\n        \n        setUserId(fetchedUserId);\n        setChallenge(loadedChallenge);\n        setIsSender(loadedChallenge.sender_id === fetchedUserId);\n        setLoading(false);\n      } catch (err) {\n        console.error('[FriendChallengeGame] Error loading challenge:', err.message);\n        if (isMounted) {\n          setLoading(false);\n          showModal(MODAL_TYPES.ERROR, {\n            title: \"Cannot Load Challenge\",\n            message: err.message || \"Failed to load challenge. Please try again.\",\n            onClose: () => navigate(\"/friends\")\n          });\n        }\n      }\n    };\n    \n    loadChallenge();\n    \n    return () => {\n      isMounted = false;\n    };\n  }, [challengeId, ensureChallengeLoaded, showModal, navigate]);\n\n  useEffect(() => {\n    if (loading || gameInitialized || !challenge) return;\n    \n    const alreadyPlayed = isSender \n      ? challenge.sender_score !== null\n      : challenge.receiver_score !== null;\n    \n    if (alreadyPlayed) {\n      showModal(MODAL_TYPES.ALERT, {\n        title: \"Already Played\",\n        message: \"You've already completed this challenge! Waiting for your friend to finish.\",\n        onClose: () => navigate(\"/challenge\")\n      });\n      return;\n    }\n    \n    const opponentId = isSender ? challenge.receiver_id : challenge.sender_id;\n    const friends = getAllFriends();\n    const friend = friends.find(f => (f.user_id || f.id) === opponentId);\n    if (friend) {\n      setOpponentInfo({\n        name: friend.nickname || friend.username || \"Friend\",\n        avatar: friend.avatar,\n      });\n    }\n    \n    const challengeQuestions = challenge.questions || [];\n    if (challengeQuestions.length === 0) {\n      console.error('[FriendChallengeGame] No questions in challenge');\n      showModal(MODAL_TYPES.ERROR, {\n        title: \"No Questions\",\n        message: \"This challenge has no questions.\",\n        onClose: () => navigate(\"/challenge\")\n      });\n      return;\n    }\n    \n    const modeConfig = getModeConfig(challenge.challenge_type);\n    let gameQuestions = [...challengeQuestions];\n    \n    if ((modeConfig?.id === 'sudden_death' && modeConfig.questionCount) || \n        (modeConfig?.id === 'speed_run' && modeConfig.questionCount)) {\n      const targetCount = modeConfig.questionCount;\n      while (gameQuestions.length < targetCount) {\n        const recycledQuestions = challengeQuestions.map((q, idx) => ({\n          ...q,\n          id: `${q.id || idx}_recycled_${Math.floor(gameQuestions.length / challengeQuestions.length)}`\n        }));\n        gameQuestions = [...gameQuestions, ...recycledQuestions];\n      }\n      gameQuestions = gameQuestions.slice(0, targetCount);\n    }\n    \n    setQuestions(gameQuestions);\n    \n    if (modeConfig?.totalTime) {\n      setTimeLeft(modeConfig.totalTime);\n    } else if (modeConfig?.timePerQuestion) {\n      setTimeLeft(modeConfig.timePerQuestion);\n    }\n    \n    startTimeRef.current = Date.now();\n    setGameInitialized(true);\n    \n    analytics('friend_challenge_started', { \n      mode: modeConfig?.id, \n      challengeId,\n      opponentId \n    });\n    \n    console.log('[FriendChallengeGame] Game initialized:', {\n      id: challengeId,\n      mode: modeConfig?.id,\n      questionCount: gameQuestions.length,\n      isSender\n    });\n  }, [loading, challengeId, isSender, challenge, getAllFriends, analytics, showModal, navigate]);\n\n  useEffect(() => {\n    if (questions.length > 0 && timeLeft > 0 && !gameEnded) {\n      timerRef.current = setInterval(() => {\n        setTimeLeft(prev => {\n          if (prev <= 1) {\n            handleTimeUp();\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n    }\n\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [questions, timeLeft, gameEnded]);\n\n  useEffect(() => {\n    if (questions.length > 0 && mode?.id === 'mind_battle' && !gameEnded) {\n      elapsedTimerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    }\n\n    return () => {\n      if (elapsedTimerRef.current) clearInterval(elapsedTimerRef.current);\n    };\n  }, [questions, gameEnded, mode]);\n\n  const handleTimeUp = () => {\n    setIsTimeUp(true);\n    setGameEnded(true);\n    if (timerRef.current) clearInterval(timerRef.current);\n    \n    setTimeout(() => {\n      handleGameComplete();\n    }, 1000);\n  };\n\n  const handleAnswerSelect = (answerIndex) => {\n    console.log('[FriendChallengeGame] handleAnswerSelect:', {\n      answerIndex,\n      currentIndex,\n      selectedAnswer,\n      gameEnded,\n      mode: mode?.id\n    });\n    \n    if (selectedAnswer !== null || gameEnded) {\n      console.log('[FriendChallengeGame] Blocked - already answered or game ended');\n      return;\n    }\n    \n    vibrate(50);\n    setSelectedAnswer(answerIndex);\n    selectedAnswerRef.current = answerIndex;\n    \n    console.log('[FriendChallengeGame] Answer selected, scheduling next step');\n\n    // Capture current values for the timeout closure\n    const capturedIndex = currentIndex;\n    const capturedAnswers = [...answers];\n\n    if (mode?.id === \"sudden_death\") {\n      const currentQ = questions[currentIndex];\n      const correctAnswer = currentQ.answer ?? currentQ.correctIndex ?? currentQ.correct;\n      const isCorrect = answerIndex === correctAnswer;\n      \n      const newAnswer = {\n        questionId: questions[currentIndex].id || currentIndex,\n        selectedAnswer: answerIndex,\n        correct: isCorrect\n      };\n\n      const updatedAnswers = [...answers, newAnswer];\n      setAnswers(updatedAnswers);\n      \n      const longestChain = calculateLongestChain(updatedAnswers);\n      setChainLength(longestChain);\n\n      if (!isCorrect) {\n        setGameEnded(true);\n        setTimeout(() => handleGameComplete(updatedAnswers), 1500);\n      } else {\n        setTimeout(() => {\n          if (currentIndex < questions.length - 1) {\n            setCurrentIndex(currentIndex + 1);\n            setSelectedAnswer(null);\n            selectedAnswerRef.current = null;\n            if (mode.timePerQuestion) {\n              setTimeLeft(mode.timePerQuestion);\n            }\n          } else {\n            setGameEnded(true);\n            setTimeout(() => handleGameComplete(updatedAnswers), 1500);\n          }\n        }, 800);\n      }\n    } else if (mode?.id === \"speed_run\") {\n      setTimeout(() => processAnswer(answerIndex, capturedIndex, capturedAnswers), 200);\n    } else {\n      setTimeout(() => processAnswer(answerIndex, capturedIndex, capturedAnswers), 800);\n    }\n  };\n\n  const processAnswer = (answerIndex, questionIndex, previousAnswers) => {\n    console.log('[FriendChallengeGame] processAnswer:', { answerIndex, questionIndex, total: questions.length });\n    \n    if (answerIndex === null || answerIndex === undefined) return;\n\n    const currentQ = questions[questionIndex];\n    if (!currentQ) {\n      console.error('[FriendChallengeGame] No question at index:', questionIndex);\n      return;\n    }\n    \n    const correctAnswer = currentQ.answer ?? currentQ.correctIndex ?? currentQ.correct;\n    const isCorrect = answerIndex === correctAnswer;\n    const newAnswer = {\n      questionId: currentQ.id || questionIndex,\n      selectedAnswer: answerIndex,\n      correct: isCorrect\n    };\n\n    const updatedAnswers = [...previousAnswers, newAnswer];\n    setAnswers(updatedAnswers);\n\n    const isLastQuestion = questionIndex >= questions.length - 1;\n    console.log('[FriendChallengeGame] Answered:', { q: questionIndex + 1, isLast: isLastQuestion, answers: updatedAnswers.length });\n\n    if (isLastQuestion) {\n      console.log('[FriendChallengeGame] LAST QUESTION - triggering completion');\n      setGameEnded(true);\n      setTimeout(() => {\n        handleGameComplete(updatedAnswers);\n      }, 100);\n    } else {\n      setCurrentIndex(questionIndex + 1);\n      setSelectedAnswer(null);\n      selectedAnswerRef.current = null;\n\n      if (mode?.timePerQuestion && mode?.id !== \"lightning_round\") {\n        setTimeLeft(mode.timePerQuestion);\n      }\n    }\n  };\n\n  const handleGameComplete = async (finalAnswers = answers) => {\n    console.log('[FriendChallengeGame] handleGameComplete called:', {\n      answersCount: finalAnswers.length,\n      isCompletingRef: isCompletingRef.current\n    });\n    \n    if (isCompletingRef.current) {\n      console.log('[FriendChallengeGame] Already completing, returning');\n      return;\n    }\n    isCompletingRef.current = true;\n    \n    if (timerRef.current) clearInterval(timerRef.current);\n    if (elapsedTimerRef.current) clearInterval(elapsedTimerRef.current);\n    setGameEnded(true);\n    \n    try {\n      if (startTimeRef.current) {\n        completionTimeRef.current = (Date.now() - startTimeRef.current) / 1000;\n      }\n      \n      const finalScore = finalAnswers.filter(a => a.correct).length;\n      setScore(finalScore);\n      \n      const chainLengthResult = mode?.id === 'sudden_death' ? calculateLongestChain(finalAnswers) : null;\n      \n      console.log('[FriendChallengeGame] Submitting result:', {\n        challengeId,\n        score: finalScore,\n        completionTime: completionTimeRef.current,\n        chain: chainLengthResult\n      });\n      \n      const submitResultResponse = await submitResult(\n        challengeId,\n        finalScore,\n        finalAnswers,\n        completionTimeRef.current,\n        chainLengthResult\n      );\n      \n      console.log('[FriendChallengeGame] Submit response:', submitResultResponse);\n      \n      if (!submitResultResponse.success) {\n        console.error('[FriendChallengeGame] Submit failed:', submitResultResponse.error);\n        showModal(MODAL_TYPES.ERROR, {\n          title: \"Error\",\n          message: \"Failed to save your results. Please try again.\",\n          onClose: () => navigate(\"/challenge\")\n        });\n        return;\n      }\n    \n    const updatedChallenge = submitResultResponse.challenge;\n    console.log('[FriendChallengeGame] Updated challenge status:', updatedChallenge?.status);\n    \n    if (updatedChallenge?.status === 'finished') {\n      const winnerId = determineWinner(updatedChallenge);\n      const rewards = getRewards(updatedChallenge, winnerId);\n      \n      let result = \"draw\";\n      if (winnerId !== \"draw\") {\n        result = winnerId === userId ? \"win\" : \"lose\";\n      }\n      \n      if (rewards.xp > 0 || rewards.coins > 0) {\n        addRewards(rewards);\n      }\n      \n      analytics('friend_challenge_completed', {\n        mode: mode?.id,\n        result,\n        score: finalScore,\n        challengeId\n      });\n      \n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_RESULTS, {\n        challenge: updatedChallenge,\n        currentUserId: userId,\n        userScore: finalScore,\n        opponentInfo,\n        onChallengeAgain: () => {\n          markResultViewed(challengeId);\n          navigate(\"/challenge\", {\n            state: {\n              preselectedFriend: opponentInfo ? {\n                id: isSender ? updatedChallenge.receiver_id : updatedChallenge.sender_id,\n                user_id: isSender ? updatedChallenge.receiver_id : updatedChallenge.sender_id,\n                name: opponentInfo.name,\n                avatar: opponentInfo.avatar,\n              } : null,\n            }\n          });\n        },\n        onClose: () => {\n          markResultViewed(challengeId);\n          navigate(\"/challenge\");\n        }\n      });\n    } else {\n      console.log('[FriendChallengeGame] Showing waiting modal');\n      showModal(MODAL_TYPES.FRIEND_CHALLENGE_WAITING, {\n        friendName: opponentInfo?.name || \"Your friend\",\n        modeId: mode?.id,\n        score: finalScore,\n        totalQuestions: questions.length,\n        challengeId: challengeId,\n        onClose: () => navigate(\"/challenge\")\n      });\n    }\n    } catch (error) {\n      console.error('[FriendChallengeGame] Error in handleGameComplete:', error);\n      showModal(MODAL_TYPES.ERROR, {\n        title: \"Error\",\n        message: \"Something went wrong. Please try again.\",\n        onClose: () => navigate(\"/challenge\")\n      });\n    }\n  };\n\n  if (loading || questions.length === 0) {\n    return (\n      <div className=\"screen no-extra-space challenge-game-container\">\n        <div className=\"challenge-loading\">Loading challenge...</div>\n      </div>\n    );\n  }\n\n  const currentQuestion = questions[currentIndex];\n  const progress = ((currentIndex + 1) / questions.length) * 100;\n\n  const opponentAvatarSrc = opponentInfo?.avatar \n    ? getAvatarImage(opponentInfo.avatar, { nickname: opponentInfo.name })\n    : assets.mascots.mascot_pointing_v2;\n\n  return (\n    <div className=\"screen no-extra-space challenge-game-container\">\n      <div className=\"challenge-game-header\">\n        <div className=\"challenge-game-title\">\n          {mode?.id === \"speed_run\" ? (\n            <img \n              src={mascot_running} \n              alt=\"Speed Run\" \n              style={{ width: \"40px\", height: \"auto\" }}\n            />\n          ) : (\n            <span style={{ fontSize: \"1.5rem\" }}>{mode?.icon}</span>\n          )}\n          <span>{mode?.name}</span>\n        </div>\n        {mode?.totalTime && (\n          <div \n            className=\"challenge-game-timer\"\n            style={{\n              color: timeLeft <= 10 ? \"#ef4444\" : \"#10b981\"\n            }}\n          >\n            ‚è±Ô∏è {timeLeft}s\n          </div>\n        )}\n        {mode?.id === 'mind_battle' && (\n          <div \n            className=\"challenge-game-timer\"\n            style={{\n              color: \"#8b5cf6\"\n            }}\n          >\n            üïê {Math.floor(elapsedTime / 60).toString().padStart(2, '0')}:{(elapsedTime % 60).toString().padStart(2, '0')}\n          </div>\n        )}\n      </div>\n\n      <div className=\"challenge-progress-container\">\n        <div className=\"challenge-progress-bar\" style={{ width: `${progress}%` }} />\n      </div>\n      <p className=\"challenge-progress-text\">\n        {mode?.id === \"speed_run\" ? `Question ${currentIndex + 1}` : `Question ${currentIndex + 1} of ${questions.length}`}\n      </p>\n\n      <div style={{ textAlign: \"center\", marginBottom: \"20px\" }}>\n        <div style={{ position: \"relative\", display: \"inline-block\" }}>\n          <img \n            src={opponentAvatarSrc}\n            alt={opponentInfo?.name || \"Opponent\"}\n            style={{\n              width: \"80px\",\n              height: \"80px\",\n              objectFit: \"contain\",\n              borderRadius: \"50%\",\n              border: \"3px solid #D4AF37\"\n            }}\n          />\n          {opponentInfo?.name && (\n            <div style={{\n              marginTop: \"8px\",\n              fontSize: \"0.85rem\",\n              color: \"#D4AF37\",\n              fontWeight: \"600\"\n            }}>\n              vs {opponentInfo.name}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"challenge-question-card\">\n        <h2 className=\"challenge-question-text\">{currentQuestion.question}</h2>\n        \n        <div className=\"challenge-options\">\n          {currentQuestion.options.map((option, index) => {\n            const isSelected = selectedAnswer === index;\n            const correctAnswerIndex = currentQuestion.answer ?? currentQuestion.correctIndex ?? currentQuestion.correct;\n            const isCorrect = index === correctAnswerIndex;\n            const showResult = selectedAnswer !== null;\n\n            return (\n              <button\n                key={index}\n                className={`challenge-option ${isSelected ? 'selected' : ''} ${\n                  showResult && isSelected && isCorrect ? 'correct' : ''\n                } ${showResult && isSelected && !isCorrect ? 'wrong' : ''}`}\n                onClick={() => handleAnswerSelect(index)}\n                disabled={selectedAnswer !== null}\n                style={{\n                  borderColor: isSelected ? (showResult && isCorrect ? '#10b981' : showResult && !isCorrect ? '#ef4444' : '#d4af37') : 'rgba(255,255,255,0.2)'\n                }}\n              >\n                {option}\n                {showResult && isSelected && isCorrect && <span className=\"option-icon\">‚úì</span>}\n                {showResult && isSelected && !isCorrect && <span className=\"option-icon\">‚úó</span>}\n              </button>\n            );\n          })}\n        </div>\n\n        {mode?.id === \"sudden_death\" && answers.length > 0 && (\n          <div className=\"chain-display\">\n            <span>Chain: {answers.length}</span>\n            <span>üî•</span>\n          </div>\n        )}\n      </div>\n\n      {isTimeUp && (\n        <div className=\"challenge-time-up-overlay\">\n          <div className=\"time-up-message\">‚è∞ Time's Up!</div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":21081,"size_tokens":null},"src/onboarding/NameHandleScreen.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport { useUserStore } from \"../store/useUserStore\";\n\nexport default function NameHandleScreen() {\n  const navigate = useNavigate();\n  const { setName, setUsername } = useUserStore();\n  const [nameValue, setNameValue] = useState(\"\");\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"namehandle\");\n  }, []);\n\n  const isValid = nameValue.trim().length > 0;\n\n  const handleContinue = () => {\n    if (!isValid) return;\n\n    const trimmedName = nameValue.trim();\n    \n    setName(trimmedName);\n    setUsername(trimmedName);\n    localStorage.setItem(\"iq_name\", trimmedName);\n\n    navigate(\"/onboarding/avatar\");\n  };\n\n  const goToLogin = () => {\n    navigate(\"/auth\");\n  };\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: \"24px\",\n        paddingRight: \"24px\",\n        paddingTop: \"24px\",\n        justifyContent: \"center\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        style={{\n          width: \"100%\",\n          maxWidth: \"360px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n        }}\n      >\n        <h2 style={{ color: \"#D4AF37\", fontSize: \"1.4rem\", marginBottom: \"8px\" }}>\n          What should we call you?\n        </h2>\n        <p style={{ color: \"#ccc\", fontSize: \"0.95rem\", marginBottom: 24 }}>\n          Enter your display name\n        </p>\n\n        <div style={{ width: \"100%\", marginBottom: \"16px\" }}>\n          <input\n            type=\"text\"\n            value={nameValue}\n            onChange={(e) => setNameValue(e.target.value)}\n            placeholder=\"Your name\"\n            style={{\n              width: \"100%\",\n              padding: \"14px 18px\",\n              borderRadius: \"12px\",\n              border: \"2px solid rgba(212, 175, 55, 0.3)\",\n              background: \"#0E1625\",\n              color: \"white\",\n              fontSize: \"1rem\",\n              textAlign: \"center\",\n              outline: \"none\",\n            }}\n          />\n        </div>\n\n        <motion.button\n          onClick={handleContinue}\n          disabled={!isValid}\n          whileHover={isValid ? { scale: 1.03, filter: \"brightness(1.1)\" } : {}}\n          whileTap={isValid ? { scale: 0.97 } : {}}\n          style={{\n            marginTop: 20,\n            background: isValid ? \"#D4AF37\" : \"#7e6a2b\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: 10,\n            padding: \"12px 36px\",\n            fontWeight: 600,\n            fontSize: \"1rem\",\n            cursor: isValid ? \"pointer\" : \"not-allowed\",\n            width: \"100%\",\n            maxWidth: \"200px\",\n          }}\n        >\n          Continue\n        </motion.button>\n\n        <p\n          onClick={goToLogin}\n          style={{\n            marginTop: \"28px\",\n            color: \"#888\",\n            fontSize: \"0.85rem\",\n            textDecoration: \"underline\",\n            cursor: \"pointer\",\n          }}\n        >\n          Already have an account? Log in\n        </p>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3438,"size_tokens":null},"src/pages/AuthPage.jsx":{"content":"import { useState } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Eye, EyeOff, Mail, Lock, X, Send } from \"lucide-react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { avatarIndexToKey, avatarKeyToIndex } from \"../utils/avatarUtils\";\nimport SittingMascot from \"../assets/mascots/mascot_sitting.webp\";\n\nexport default function AuthPage() {\n  const navigate = useNavigate();\n  const { setOnboarded, setDisplayName, setHandle, setAvatar } = useUserStore();\n\n  const [mode, setMode] = useState(\"login\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState(\"\");\n  const [shake, setShake] = useState(false);\n  const [showForgotModal, setShowForgotModal] = useState(false);\n\n  const isLogin = mode === \"login\";\n  const isValidEmail = email.trim() && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email.trim());\n  const isValidPassword = password.length >= 6;\n  const isFormValid = isValidEmail && isValidPassword;\n\n  const triggerShake = () => {\n    setShake(true);\n    setTimeout(() => setShake(false), 500);\n  };\n\n  const handleSubmit = async () => {\n    setErrorMsg(\"\");\n\n    if (!email.trim()) {\n      setErrorMsg(\"Please enter your email address.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidEmail) {\n      setErrorMsg(\"Please enter a valid email address.\");\n      triggerShake();\n      return;\n    }\n\n    if (!password) {\n      setErrorMsg(\"Please enter a password.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidPassword) {\n      setErrorMsg(\"Password must be at least 6 characters.\");\n      triggerShake();\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      if (isLogin) {\n        const { data, error } = await supabase.auth.signInWithPassword({\n          email: email.trim().toLowerCase(),\n          password,\n        });\n\n        if (error) {\n          if (error.message.includes(\"Email not confirmed\")) {\n            setLoading(false);\n            navigate(\"/check-email\");\n            return;\n          }\n          setErrorMsg(\"Invalid email or password\");\n          triggerShake();\n          setLoading(false);\n          return;\n        }\n\n        if (!data.user.email_confirmed_at) {\n          setLoading(false);\n          navigate(\"/check-email\");\n          return;\n        }\n\n        const { data: profile } = await supabase\n          .from(\"profiles\")\n          .select(\"*\")\n          .eq(\"user_id\", data.user.id)\n          .maybeSingle();\n\n        if (profile) {\n          const displayName = profile.username || \"Student\";\n          const handle = profile.handle || null;\n          const avatarKey = typeof profile.avatar === \"number\"\n            ? avatarIndexToKey(profile.avatar)\n            : profile.avatar || \"avatar_man_lantern\";\n          \n          if (!handle) {\n            console.log(\"Profile missing handle - redirecting to handle screen to complete setup\");\n            localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n            localStorage.setItem(\"iq_name\", displayName);\n            localStorage.setItem(\"iq_avatar\", avatarKey);\n            useUserStore.setState({ \n              user: data.user, \n              userId: data.user.id,\n              username: displayName,\n              avatar: avatarKey,\n              profile: profile,\n              profileReady: false,\n              hasOnboarded: false,\n              loading: false,\n              isHydrated: true,\n            });\n            setLoading(false);\n            navigate(\"/onboarding/handle\");\n            return;\n          }\n          \n          setDisplayName(displayName);\n          setHandle(handle);\n          setAvatar(avatarKey);\n          \n          setOnboarded(true);\n          localStorage.removeItem(\"iq_onboarding_step\");\n          localStorage.setItem(\"iq_profile_complete\", \"true\");\n          localStorage.setItem(\"iq_name\", displayName);\n          localStorage.setItem(\"iq_handle\", handle);\n          localStorage.setItem(\"iq_avatar\", avatarKey);\n          \n          useUserStore.setState({ \n            user: data.user, \n            userId: data.user.id,\n            username: displayName,\n            handle: handle,\n            avatar: avatarKey,\n            profileReady: true,\n            hasOnboarded: true,\n            loading: false,\n            isHydrated: true,\n          });\n          \n          setTimeout(() => {\n            useProgressStore.getState().loadFromSupabase();\n            console.log(\"Progress loaded from cloud after login\");\n          }, 100);\n          \n          setLoading(false);\n          navigate(\"/\");\n        } else {\n          // No profile found - check if user completed onboarding (data in localStorage)\n          const storedName = localStorage.getItem(\"iq_name\") || useUserStore.getState().username;\n          const storedHandle = localStorage.getItem(\"iq_handle\") || useUserStore.getState().handle;\n          const storedAvatar = localStorage.getItem(\"iq_avatar\") || useUserStore.getState().avatar || \"avatar_man_lantern\";\n          \n          if (storedName && storedHandle) {\n            // User completed onboarding but profile was created with old anonymous ID\n            // Create profile for the authenticated user\n            console.log(\"Creating profile for existing user with stored data...\");\n            \n            // Convert avatar key to index for database (expects integer)\n            const avatarIndex = avatarKeyToIndex(storedAvatar);\n            \n            // Get existing progress from localStorage/progressStore to preserve it\n            const progressState = useProgressStore.getState();\n            const localXp = progressState.xp || 0;\n            const localCoins = progressState.coins || 0;\n            const localStreak = progressState.streak || 0;\n            \n            console.log(\"Preserving local progress:\", { xp: localXp, coins: localCoins, streak: localStreak });\n            \n            const { data: upsertData, error: profileError } = await supabase\n              .from(\"profiles\")\n              .upsert({\n                user_id: data.user.id,\n                username: storedName,\n                handle: storedHandle,\n                avatar: avatarIndex,\n                xp: localXp,\n                coins: localCoins,\n                streak: localStreak,\n                created_at: new Date().toISOString(),\n              }, { onConflict: 'user_id' })\n              .select()\n              .single();\n            \n            if (profileError) {\n              console.error(\"Profile creation error:\", profileError);\n              setErrorMsg(\"Could not restore your profile. Please try again.\");\n              setLoading(false);\n              return;\n            }\n            \n            if (!upsertData?.handle) {\n              console.log(\"Profile upserted but missing handle - redirecting to handle screen\");\n              localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n              useUserStore.setState({ \n                user: data.user, \n                userId: data.user.id,\n                username: storedName,\n                avatar: storedAvatar,\n                profileReady: false,\n                hasOnboarded: false,\n                loading: false,\n                isHydrated: true,\n              });\n              setLoading(false);\n              navigate(\"/onboarding/handle\");\n              return;\n            }\n            \n            console.log(\"PROFILE CREATED for existing user:\", data.user.id);\n            \n            setDisplayName(storedName);\n            setHandle(storedHandle);\n            setAvatar(storedAvatar);\n            setOnboarded(true);\n            localStorage.removeItem(\"iq_onboarding_step\");\n            localStorage.setItem(\"iq_profile_complete\", \"true\");\n            \n            useUserStore.setState({ \n              user: data.user, \n              userId: data.user.id,\n              username: storedName,\n              handle: storedHandle,\n              avatar: storedAvatar,\n              profileReady: true,\n              hasOnboarded: true,\n              loading: false,\n              isHydrated: true,\n            });\n            \n            // Sync full progress to cloud (includes lessonStates, paths)\n            setTimeout(() => {\n              useProgressStore.getState().syncToSupabase();\n              console.log(\"Progress synced to cloud after login\");\n            }, 500);\n            \n            setLoading(false);\n            navigate(\"/\");\n          } else {\n            console.log(\"No profile and no stored data - signing out and starting fresh\");\n            await supabase.auth.signOut();\n            useUserStore.setState({ \n              user: null, \n              userId: null,\n              profileReady: false,\n              hasOnboarded: false,\n              loading: false,\n            });\n            setLoading(false);\n            setErrorMsg(\"Please complete your profile setup first.\");\n            localStorage.setItem(\"iq_onboarding_step\", \"bismillah\");\n            setTimeout(() => {\n              navigate(\"/onboarding/bismillah\");\n            }, 1500);\n          }\n        }\n        return;\n      } else {\n        const storedName = localStorage.getItem(\"iq_name\") || useUserStore.getState().username || \"Student\";\n        const storedHandle = localStorage.getItem(\"iq_handle\") || useUserStore.getState().handle;\n        const storedAvatar = localStorage.getItem(\"iq_avatar\") || useUserStore.getState().avatar || \"avatar_man_lantern\";\n        \n        if (!storedHandle) {\n          console.error(\"Missing handle - cannot proceed with signup\");\n          setErrorMsg(\"Please complete your profile setup first.\");\n          setLoading(false);\n          localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n          navigate(\"/onboarding/handle\");\n          return;\n        }\n        \n        const { data, error } = await supabase.auth.signUp({\n          email: email.trim().toLowerCase(),\n          password,\n        });\n\n        if (error) {\n          if (error.message.includes(\"already registered\")) {\n            setErrorMsg(\"This email is already registered. Try logging in.\");\n          } else {\n            setErrorMsg(error.message || \"Could not create account.\");\n          }\n          triggerShake();\n          setLoading(false);\n          return;\n        }\n\n        if (data?.user) {\n          const avatarIndex = avatarKeyToIndex(storedAvatar);\n          \n          const progressState = useProgressStore.getState();\n          const localXp = progressState.xp || 0;\n          const localCoins = progressState.coins || 0;\n          const localStreak = progressState.streak || 0;\n          \n          console.log(\"Preserving local progress on signup:\", { xp: localXp, coins: localCoins, streak: localStreak });\n          \n          const { error: profileError } = await supabase\n            .from(\"profiles\")\n            .upsert({\n              user_id: data.user.id,\n              username: storedName,\n              handle: storedHandle,\n              avatar: avatarIndex,\n              xp: localXp,\n              coins: localCoins,\n              streak: localStreak,\n              created_at: new Date().toISOString(),\n            }, { onConflict: 'user_id' });\n          \n          if (profileError) {\n            console.error(\"Profile creation error:\", profileError);\n            setErrorMsg(\"Account created but profile setup failed. Please try logging in.\");\n            setLoading(false);\n            return;\n          }\n          \n          console.log(\"PROFILE CREATED for user:\", data.user.id);\n          \n          setDisplayName(storedName);\n          setHandle(storedHandle);\n          setAvatar(storedAvatar);\n          \n          useUserStore.setState({ \n            user: data.user, \n            userId: data.user.id,\n            username: storedName,\n            handle: storedHandle,\n            avatar: storedAvatar,\n            loading: false,\n            isHydrated: true,\n          });\n          \n          setTimeout(() => {\n            useProgressStore.getState().syncToSupabase();\n            console.log(\"Progress synced to cloud after signup\");\n          }, 500);\n          \n          setLoading(false);\n          \n          if (data.user.email_confirmed_at) {\n            setOnboarded(true);\n            localStorage.removeItem(\"iq_onboarding_step\");\n            localStorage.setItem(\"iq_profile_complete\", \"true\");\n            useUserStore.setState({ \n              profileReady: true,\n              hasOnboarded: true,\n            });\n            navigate(\"/\");\n          } else {\n            localStorage.setItem(\"iq_onboarding_step\", \"checkemail\");\n            navigate(\"/check-email\");\n          }\n        } else {\n          setLoading(false);\n          localStorage.setItem(\"iq_onboarding_step\", \"checkemail\");\n          navigate(\"/check-email\");\n        }\n      }\n    } catch (err) {\n      console.error(\"Auth error:\", err);\n      setErrorMsg(\"Something went wrong. Please try again.\");\n      triggerShake();\n      setLoading(false);\n    }\n  };\n\n  const shakeAnimation = {\n    shake: {\n      x: [0, -10, 10, -10, 10, -5, 5, 0],\n      transition: { duration: 0.5 }\n    }\n  };\n\n  return (\n    <div\n      className=\"min-h-screen flex flex-col items-center justify-center px-5 py-10\"\n      style={{\n        background: \"linear-gradient(180deg, #0a0f1e 0%, #030614 100%)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        width: \"100%\",\n        minHeight: \"100vh\",\n      }}\n    >\n      <motion.img\n        src={SittingMascot}\n        alt=\"Zayd\"\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.1, duration: 0.5 }}\n        style={{\n          width: \"120px\",\n          height: \"120px\",\n          objectFit: \"contain\",\n          marginBottom: \"-20px\",\n          zIndex: 10,\n          filter: \"drop-shadow(0 10px 20px rgba(0,0,0,0.4))\",\n        }}\n      />\n\n      <motion.div\n        initial={{ opacity: 0, y: 30 }}\n        animate={shake ? \"shake\" : { opacity: 1, y: 0 }}\n        variants={shakeAnimation}\n        transition={{ duration: 0.5 }}\n        style={{\n          background: \"linear-gradient(180deg, #111a2e 0%, #0a1220 100%)\",\n          border: \"1px solid rgba(255,255,255,0.08)\",\n          borderRadius: \"24px\",\n          padding: \"32px 24px\",\n          maxWidth: \"380px\",\n          width: \"100%\",\n          boxShadow: \"0 25px 80px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05)\",\n        }}\n      >\n        <div className=\"text-center mb-6\">\n          <AnimatePresence mode=\"wait\">\n            <motion.h1\n              key={mode}\n              initial={{ opacity: 0, y: -10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: 10 }}\n              style={{\n                fontSize: \"1.75rem\",\n                fontWeight: 700,\n                background: \"linear-gradient(90deg, #fff 0%, #ffd88a 50%, #ffb700 100%)\",\n                WebkitBackgroundClip: \"text\",\n                WebkitTextFillColor: \"transparent\",\n                marginBottom: \"8px\",\n              }}\n            >\n              {isLogin ? \"Welcome Back\" : \"Create Account\"}\n            </motion.h1>\n          </AnimatePresence>\n          <p style={{ color: \"rgba(255,255,255,0.5)\", fontSize: \"0.9rem\" }}>\n            {isLogin ? \"Sign in to continue your journey\" : \"Start your Islamic learning journey\"}\n          </p>\n        </div>\n\n        <div\n          style={{\n            display: \"flex\",\n            background: \"rgba(0,0,0,0.3)\",\n            borderRadius: \"12px\",\n            padding: \"4px\",\n            marginBottom: \"20px\",\n          }}\n        >\n          <button\n            onClick={() => { setMode(\"login\"); setErrorMsg(\"\"); }}\n            style={{\n              flex: 1,\n              padding: \"10px\",\n              borderRadius: \"10px\",\n              border: \"none\",\n              background: isLogin ? \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\" : \"transparent\",\n              color: isLogin ? \"#fff\" : \"rgba(255,255,255,0.5)\",\n              fontWeight: 600,\n              fontSize: \"0.9rem\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n            }}\n          >\n            Log In\n          </button>\n          <button\n            onClick={() => { setMode(\"signup\"); setErrorMsg(\"\"); }}\n            style={{\n              flex: 1,\n              padding: \"10px\",\n              borderRadius: \"10px\",\n              border: \"none\",\n              background: !isLogin ? \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\" : \"transparent\",\n              color: !isLogin ? \"#fff\" : \"rgba(255,255,255,0.5)\",\n              fontWeight: 600,\n              fontSize: \"0.9rem\",\n              cursor: \"pointer\",\n              transition: \"all 0.2s\",\n            }}\n          >\n            Sign Up\n          </button>\n        </div>\n\n        <div style={{ marginBottom: \"16px\" }}>\n          <div style={{ position: \"relative\" }}>\n            <Mail\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{\n                position: \"absolute\",\n                left: \"14px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                pointerEvents: \"none\",\n              }}\n            />\n            <input\n              type=\"email\"\n              placeholder=\"Email address\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              onKeyDown={(e) => e.key === \"Enter\" && handleSubmit()}\n              style={{\n                width: \"100%\",\n                background: \"var(--card-bg, rgba(11, 30, 54, 0.8))\",\n                border: \"1px solid var(--border, rgba(255,255,255,0.1))\",\n                borderRadius: \"12px\",\n                padding: \"14px 16px 14px 44px\",\n                color: \"var(--text, #fff)\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n                transition: \"border-color 0.2s, box-shadow 0.2s\",\n              }}\n              onFocus={(e) => {\n                e.target.style.borderColor = \"rgba(139, 92, 246, 0.5)\";\n                e.target.style.boxShadow = \"0 0 0 3px rgba(139, 92, 246, 0.1)\";\n              }}\n              onBlur={(e) => {\n                e.target.style.borderColor = \"var(--border, rgba(255,255,255,0.1))\";\n                e.target.style.boxShadow = \"none\";\n              }}\n            />\n          </div>\n        </div>\n\n        <div style={{ marginBottom: \"12px\" }}>\n          <div style={{ position: \"relative\" }}>\n            <Lock\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{\n                position: \"absolute\",\n                left: \"14px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                pointerEvents: \"none\",\n              }}\n            />\n            <input\n              type={showPassword ? \"text\" : \"password\"}\n              placeholder={isLogin ? \"Password\" : \"Create password (6+ characters)\"}\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              onKeyDown={(e) => e.key === \"Enter\" && handleSubmit()}\n              style={{\n                width: \"100%\",\n                background: \"var(--card-bg, rgba(11, 30, 54, 0.8))\",\n                border: \"1px solid var(--border, rgba(255,255,255,0.1))\",\n                borderRadius: \"12px\",\n                padding: \"14px 44px 14px 44px\",\n                color: \"var(--text, #fff)\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n                transition: \"border-color 0.2s, box-shadow 0.2s\",\n              }}\n              onFocus={(e) => {\n                e.target.style.borderColor = \"rgba(139, 92, 246, 0.5)\";\n                e.target.style.boxShadow = \"0 0 0 3px rgba(139, 92, 246, 0.1)\";\n              }}\n              onBlur={(e) => {\n                e.target.style.borderColor = \"var(--border, rgba(255,255,255,0.1))\";\n                e.target.style.boxShadow = \"none\";\n              }}\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              style={{\n                position: \"absolute\",\n                right: \"12px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                background: \"transparent\",\n                border: \"none\",\n                cursor: \"pointer\",\n                padding: \"4px\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n              }}\n            >\n              {showPassword ? (\n                <EyeOff size={18} color=\"rgba(255,255,255,0.4)\" />\n              ) : (\n                <Eye size={18} color=\"rgba(255,255,255,0.4)\" />\n              )}\n            </button>\n          </div>\n        </div>\n\n        {errorMsg && (\n          <motion.p\n            initial={{ opacity: 0, y: -5 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{\n              color: \"#ef4444\",\n              fontSize: \"0.8rem\",\n              marginBottom: \"12px\",\n              textAlign: \"center\",\n            }}\n          >\n            {errorMsg}\n          </motion.p>\n        )}\n\n        <motion.button\n          whileTap={{ scale: 0.98 }}\n          onClick={handleSubmit}\n          disabled={loading || !isFormValid}\n          style={{\n            width: \"100%\",\n            height: \"50px\",\n            background: loading || !isFormValid\n              ? \"rgba(139, 92, 246, 0.3)\"\n              : \"linear-gradient(90deg, var(--accent, #6366f1) 0%, var(--accent-glow, #8b5cf6) 100%)\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            color: loading || !isFormValid ? \"rgba(255,255,255,0.5)\" : \"#fff\",\n            fontSize: \"1rem\",\n            fontWeight: 600,\n            cursor: loading || !isFormValid ? \"not-allowed\" : \"pointer\",\n            transition: \"all 0.2s\",\n            boxShadow: loading || !isFormValid ? \"none\" : \"0 4px 20px rgba(139, 92, 246, 0.3)\",\n            marginTop: \"8px\",\n          }}\n        >\n          {loading ? (\n            <span style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", gap: \"8px\" }}>\n              <motion.span\n                animate={{ rotate: 360 }}\n                transition={{ duration: 1, repeat: Infinity, ease: \"linear\" }}\n                style={{\n                  display: \"inline-block\",\n                  width: \"18px\",\n                  height: \"18px\",\n                  border: \"2px solid rgba(255,255,255,0.3)\",\n                  borderTopColor: \"#fff\",\n                  borderRadius: \"50%\",\n                }}\n              />\n              {isLogin ? \"Signing in...\" : \"Creating account...\"}\n            </span>\n          ) : (\n            \"Continue\"\n          )}\n        </motion.button>\n\n        {isLogin && (\n          <button\n            onClick={() => setShowForgotModal(true)}\n            style={{\n              background: \"transparent\",\n              border: \"none\",\n              color: \"rgba(255,255,255,0.5)\",\n              fontSize: \"0.85rem\",\n              marginTop: \"16px\",\n              cursor: \"pointer\",\n              textDecoration: \"underline\",\n              textUnderlineOffset: \"3px\",\n              width: \"100%\",\n              textAlign: \"center\",\n              transition: \"color 0.2s\",\n            }}\n            onMouseEnter={(e) => (e.target.style.color = \"rgba(255,255,255,0.8)\")}\n            onMouseLeave={(e) => (e.target.style.color = \"rgba(255,255,255,0.5)\")}\n          >\n            Forgot Password?\n          </button>\n        )}\n\n        <p\n          style={{\n            marginTop: \"24px\",\n            paddingTop: \"16px\",\n            borderTop: \"1px solid rgba(255,255,255,0.08)\",\n            color: \"rgba(255,255,255,0.35)\",\n            fontSize: \"0.75rem\",\n            textAlign: \"center\",\n            lineHeight: 1.5,\n          }}\n        >\n          By continuing you agree to our Terms of Service & Privacy Policy.\n        </p>\n      </motion.div>\n\n      <AnimatePresence>\n        {showForgotModal && (\n          <ForgotPasswordInlineModal\n            onClose={() => setShowForgotModal(false)}\n          />\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nfunction ForgotPasswordInlineModal({ onClose }) {\n  const [email, setEmail] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const handleReset = async () => {\n    if (!email.trim()) {\n      setError(\"Please enter your email address.\");\n      return;\n    }\n\n    setLoading(true);\n    setError(\"\");\n\n    try {\n      const { error: resetError } = await supabase.auth.resetPasswordForEmail(\n        email.trim().toLowerCase(),\n        {\n          redirectTo: window.location.origin + \"/reset-password\",\n        }\n      );\n\n      if (resetError) {\n        setError(resetError.message || \"Failed to send reset email.\");\n        setLoading(false);\n        return;\n      }\n\n      setSuccess(true);\n      setLoading(false);\n    } catch (err) {\n      setError(\"Something went wrong. Please try again.\");\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    setEmail(\"\");\n    setError(\"\");\n    setSuccess(false);\n    onClose();\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className=\"fixed inset-0 z-50 flex items-center justify-center px-4\"\n      style={{ background: \"rgba(0,0,0,0.7)\", backdropFilter: \"blur(4px)\" }}\n      onClick={handleClose}\n    >\n      <motion.div\n        initial={{ opacity: 0, scale: 0.9, y: 20 }}\n        animate={{ opacity: 1, scale: 1, y: 0 }}\n        exit={{ opacity: 0, scale: 0.9, y: 20 }}\n        transition={{ type: \"spring\", damping: 25, stiffness: 300 }}\n        onClick={(e) => e.stopPropagation()}\n        style={{\n          background: \"linear-gradient(180deg, #0f1a2e 0%, #0a1220 100%)\",\n          border: \"1px solid rgba(255,255,255,0.1)\",\n          borderRadius: \"20px\",\n          padding: \"24px\",\n          maxWidth: \"360px\",\n          width: \"100%\",\n          boxShadow: \"0 20px 60px rgba(0,0,0,0.5)\",\n        }}\n      >\n        <div className=\"flex justify-between items-center mb-5\">\n          <h2\n            style={{\n              fontSize: \"1.25rem\",\n              fontWeight: 700,\n              background: \"linear-gradient(90deg, #fff 0%, #ffd88a 100%)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n            }}\n          >\n            Reset Password\n          </h2>\n          <button\n            onClick={handleClose}\n            style={{\n              background: \"rgba(255,255,255,0.1)\",\n              border: \"none\",\n              borderRadius: \"50%\",\n              width: \"32px\",\n              height: \"32px\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              cursor: \"pointer\",\n            }}\n          >\n            <X size={18} color=\"#fff\" />\n          </button>\n        </div>\n\n        {success ? (\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"text-center py-4\"\n          >\n            <div\n              style={{\n                width: \"60px\",\n                height: \"60px\",\n                borderRadius: \"50%\",\n                background: \"linear-gradient(135deg, #10b981 0%, #059669 100%)\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                margin: \"0 auto 16px\",\n              }}\n            >\n              <Mail size={28} color=\"#fff\" />\n            </div>\n            <p style={{ color: \"#10b981\", fontSize: \"1rem\", fontWeight: 600, marginBottom: \"8px\" }}>\n              Reset Link Sent!\n            </p>\n            <p style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.875rem\", lineHeight: 1.5 }}>\n              A reset link has been sent to your email. Please check your inbox.\n            </p>\n            <button\n              onClick={handleClose}\n              style={{\n                marginTop: \"20px\",\n                background: \"linear-gradient(90deg, var(--accent) 0%, var(--accent-glow, #8b5cf6) 100%)\",\n                border: \"none\",\n                borderRadius: \"12px\",\n                padding: \"12px 24px\",\n                color: \"#fff\",\n                fontWeight: 600,\n                cursor: \"pointer\",\n                width: \"100%\",\n              }}\n            >\n              Got it\n            </button>\n          </motion.div>\n        ) : (\n          <>\n            <p style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.875rem\", marginBottom: \"16px\", lineHeight: 1.5 }}>\n              Enter your email address and we'll send you a link to reset your password.\n            </p>\n\n            <div style={{ position: \"relative\", marginBottom: \"12px\" }}>\n              <Mail\n                size={18}\n                color=\"rgba(255,255,255,0.4)\"\n                style={{\n                  position: \"absolute\",\n                  left: \"14px\",\n                  top: \"50%\",\n                  transform: \"translateY(-50%)\",\n                }}\n              />\n              <input\n                type=\"email\"\n                placeholder=\"Enter your email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                onKeyDown={(e) => e.key === \"Enter\" && handleReset()}\n                style={{\n                  width: \"100%\",\n                  background: \"var(--card-bg, #0b1e36)\",\n                  border: \"1px solid var(--border, rgba(255,255,255,0.1))\",\n                  borderRadius: \"12px\",\n                  padding: \"14px 16px 14px 42px\",\n                  color: \"var(--text, #fff)\",\n                  fontSize: \"0.95rem\",\n                  outline: \"none\",\n                  transition: \"border-color 0.2s\",\n                }}\n              />\n            </div>\n\n            {error && (\n              <motion.p\n                initial={{ opacity: 0, y: -5 }}\n                animate={{ opacity: 1, y: 0 }}\n                style={{ color: \"#ef4444\", fontSize: \"0.8rem\", marginBottom: \"12px\" }}\n              >\n                {error}\n              </motion.p>\n            )}\n\n            <button\n              onClick={handleReset}\n              disabled={loading}\n              style={{\n                width: \"100%\",\n                background: loading\n                  ? \"rgba(139, 92, 246, 0.5)\"\n                  : \"linear-gradient(90deg, var(--accent, #6366f1) 0%, var(--accent-glow, #8b5cf6) 100%)\",\n                border: \"none\",\n                borderRadius: \"12px\",\n                padding: \"14px\",\n                color: \"#fff\",\n                fontWeight: 600,\n                fontSize: \"0.95rem\",\n                cursor: loading ? \"not-allowed\" : \"pointer\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                transition: \"all 0.2s\",\n              }}\n            >\n              {loading ? (\n                \"Sending...\"\n              ) : (\n                <>\n                  <Send size={18} />\n                  Send Reset Link\n                </>\n              )}\n            </button>\n          </>\n        )}\n      </motion.div>\n    </motion.div>\n  );\n}\n","path":null,"size_bytes":31863,"size_tokens":null},"supabase/functions/send-welcome-email/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst SUPABASE_URL = Deno.env.get(\"SUPABASE_URL\")!;\nconst SUPABASE_ANON_KEY = Deno.env.get(\"SUPABASE_ANON_KEY\")!;\n\nserve(async (req) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n\n  try {\n    const authHeader = req.headers.get(\"Authorization\");\n    if (!authHeader) {\n      return new Response(\n        JSON.stringify({ error: \"Missing authorization header\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {\n      global: { headers: { Authorization: authHeader } },\n    });\n\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\n    \n    if (authError || !user) {\n      return new Response(\n        JSON.stringify({ error: \"Unauthorized\" }),\n        { status: 401, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const RESEND_API_KEY = Deno.env.get(\"RESEND_API_KEY\");\n    \n    if (!RESEND_API_KEY) {\n      console.error(\"[WelcomeEmail] Missing RESEND_API_KEY\");\n      return new Response(\n        JSON.stringify({ error: \"Email service not configured\" }),\n        { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const { email, username } = await req.json();\n\n    if (!email || email.toLowerCase() !== user.email?.toLowerCase()) {\n      return new Response(\n        JSON.stringify({ error: \"Email mismatch or not provided\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const displayName = username || \"there\";\n\n    const emailHtml = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n</head>\n<body style=\"margin: 0; padding: 0; background-color: #0a0f1e; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\n  <table role=\"presentation\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"max-width: 600px; margin: 0 auto; padding: 40px 20px;\">\n    <tr>\n      <td style=\"text-align: center; padding-bottom: 30px;\">\n        <h1 style=\"color: #D4AF37; font-size: 28px; margin: 0;\">\n          &#127775; Islam Quest\n        </h1>\n      </td>\n    </tr>\n    <tr>\n      <td style=\"background: linear-gradient(180deg, #0f1a2e 0%, #0a1220 100%); border-radius: 20px; padding: 40px 30px;\">\n        <h2 style=\"color: #ffffff; font-size: 24px; margin: 0 0 20px; text-align: center;\">\n          Assalamu Alaikum, ${displayName}! &#128522;\n        </h2>\n        <p style=\"color: rgba(255,255,255,0.8); font-size: 16px; line-height: 1.6; margin: 0 0 20px;\">\n          Welcome to <strong style=\"color: #D4AF37;\">Islam Quest</strong> - your journey to Islamic knowledge starts now!\n        </p>\n        <p style=\"color: rgba(255,255,255,0.8); font-size: 16px; line-height: 1.6; margin: 0 0 20px;\">\n          We're so excited to have you join our community of learners. Here's what awaits you:\n        </p>\n        <ul style=\"color: rgba(255,255,255,0.8); font-size: 15px; line-height: 1.8; padding-left: 20px; margin: 0 0 25px;\">\n          <li><strong style=\"color: #10b981;\">14 Learning Paths</strong> - From basics to in-depth knowledge</li>\n          <li><strong style=\"color: #10b981;\">Daily Quests</strong> - Build your streak and earn rewards</li>\n          <li><strong style=\"color: #10b981;\">Friend Challenges</strong> - Learn together with friends</li>\n          <li><strong style=\"color: #10b981;\">Achievements</strong> - Track your progress and celebrate milestones</li>\n        </ul>\n        <p style=\"color: rgba(255,255,255,0.8); font-size: 16px; line-height: 1.6; margin: 0 0 30px;\">\n          Start your first lesson today and take the first step on your path to knowledge!\n        </p>\n        <div style=\"text-align: center;\">\n          <p style=\"color: #D4AF37; font-size: 18px; font-weight: 600; margin: 0;\">\n            May Allah bless your journey &#128588;\n          </p>\n        </div>\n      </td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; padding-top: 30px;\">\n        <p style=\"color: rgba(255,255,255,0.5); font-size: 13px; margin: 0;\">\n          Islam Quest - Learn, Grow, Succeed\n        </p>\n        <p style=\"color: rgba(255,255,255,0.3); font-size: 12px; margin: 10px 0 0;\">\n          This email was sent because you created an account on Islam Quest.\n        </p>\n      </td>\n    </tr>\n  </table>\n</body>\n</html>\n    `.trim();\n\n    const response = await fetch(\"https://api.resend.com/emails\", {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${RESEND_API_KEY}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        from: \"Islam Quest <welcome@islamquest.app>\",\n        to: [email],\n        subject: \"Welcome to Islam Quest! Your Journey Begins üåô\",\n        html: emailHtml,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error(\"[WelcomeEmail] Resend API error:\", errorText);\n      return new Response(\n        JSON.stringify({ error: \"Failed to send email\", details: errorText }),\n        { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const result = await response.json();\n    console.log(\"[WelcomeEmail] Sent successfully to:\", email);\n\n    return new Response(\n      JSON.stringify({ success: true, id: result.id }),\n      { headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n\n  } catch (error) {\n    console.error(\"[WelcomeEmail] Error:\", error);\n    return new Response(\n      JSON.stringify({ error: error.message || \"Failed to send welcome email\" }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","path":null,"size_bytes":6154,"size_tokens":null},"src/onboarding/HandleScreen.jsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { avatarIndexToKey } from \"../utils/avatarUtils\";\n\nexport default function HandleScreen() {\n  const navigate = useNavigate();\n  const { setHandle, userId, user } = useUserStore();\n  const [handleValue, setHandleValue] = useState(\"\");\n  const [checking, setChecking] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"handle\");\n  }, []);\n\n  const isValid = handleValue.trim().length > 0;\n\n  const handleContinue = async () => {\n    if (!isValid) return;\n\n    setChecking(true);\n    setError(\"\");\n\n    const trimmedHandle = handleValue.trim().toLowerCase().replace(/^@/, \"\");\n    const uid = user?.id || userId;\n\n    try {\n      const { data, error: err } = await supabase\n        .from(\"profiles\")\n        .select(\"handle, user_id\")\n        .eq(\"handle\", trimmedHandle);\n\n      if (!err && data && data.length > 0) {\n        const otherUser = data.find(d => d.user_id !== uid);\n        if (otherUser) {\n          setError(\"Handle already taken. Try another.\");\n          setChecking(false);\n          return;\n        }\n      }\n    } catch (e) {\n      console.log(\"Handle check skipped (DB not ready)\");\n    }\n\n    setHandle(trimmedHandle);\n    localStorage.setItem(\"iq_handle\", trimmedHandle);\n\n    if (uid) {\n      const { data: existingProfile } = await supabase\n        .from(\"profiles\")\n        .select(\"*\")\n        .eq(\"user_id\", uid)\n        .maybeSingle();\n      \n      if (existingProfile) {\n        console.log(\"Updating existing profile with handle...\");\n        const { error: updateError } = await supabase\n          .from(\"profiles\")\n          .update({ handle: trimmedHandle })\n          .eq(\"user_id\", uid);\n        \n        if (updateError) {\n          console.error(\"Failed to update profile with handle:\", updateError);\n          if (updateError.code === \"23505\") {\n            setError(\"Handle already taken. Try another.\");\n          } else {\n            setError(\"Failed to save handle. Please try again.\");\n          }\n          setChecking(false);\n          return;\n        }\n        \n        console.log(\"Profile updated with handle, completing onboarding...\");\n        \n        const storedName = localStorage.getItem(\"iq_name\") || existingProfile.username || \"Student\";\n        const rawAvatar = localStorage.getItem(\"iq_avatar\") || existingProfile.avatar;\n        const avatarKey = typeof rawAvatar === \"number\" \n          ? avatarIndexToKey(rawAvatar) \n          : (rawAvatar || \"avatar_man_lantern\");\n        \n        const updatedProfile = {\n          ...existingProfile,\n          handle: trimmedHandle,\n          username: storedName,\n          avatar: avatarKey,\n        };\n        \n        localStorage.removeItem(\"iq_onboarding_step\");\n        localStorage.setItem(\"iq_profile_complete\", \"true\");\n        localStorage.setItem(\"iq_name\", storedName);\n        localStorage.setItem(\"iq_handle\", trimmedHandle);\n        localStorage.setItem(\"iq_avatar\", avatarKey);\n        \n        useUserStore.setState({ \n          user: user,\n          userId: uid,\n          username: storedName,\n          handle: trimmedHandle,\n          avatar: avatarKey,\n          name: storedName,\n          profile: updatedProfile,\n          profileReady: true,\n          hasOnboarded: true,\n          loading: false,\n          isHydrated: true,\n        });\n        \n        setChecking(false);\n        navigate(\"/\");\n        return;\n      }\n    }\n\n    localStorage.setItem(\"iq_onboarding_step\", \"auth\");\n    setChecking(false);\n    navigate(\"/auth\");\n  };\n\n  const goToLogin = () => {\n    navigate(\"/auth\");\n  };\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: \"24px\",\n        paddingRight: \"24px\",\n        paddingTop: \"24px\",\n        justifyContent: \"center\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        style={{\n          width: \"100%\",\n          maxWidth: \"360px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n        }}\n      >\n        <h2 style={{ color: \"#D4AF37\", fontSize: \"1.4rem\", marginBottom: \"8px\" }}>\n          Choose a username\n        </h2>\n        <p style={{ color: \"#ccc\", fontSize: \"0.95rem\", marginBottom: 24 }}>\n          This is your unique @handle for friends & challenges\n        </p>\n\n        <div style={{ width: \"100%\", marginBottom: \"8px\" }}>\n          <input\n            type=\"text\"\n            value={handleValue}\n            onChange={(e) => setHandleValue(e.target.value)}\n            placeholder=\"@yourhandle\"\n            style={{\n              width: \"100%\",\n              padding: \"14px 18px\",\n              borderRadius: \"12px\",\n              border: error ? \"2px solid #ef4444\" : \"2px solid rgba(212, 175, 55, 0.3)\",\n              background: \"#0E1625\",\n              color: \"white\",\n              fontSize: \"1rem\",\n              textAlign: \"center\",\n              outline: \"none\",\n            }}\n          />\n          <p style={{ color: \"#888\", fontSize: \"0.8rem\", marginTop: \"6px\" }}>\n            Friends can find you with this handle\n          </p>\n        </div>\n\n        {error && (\n          <motion.p\n            initial={{ opacity: 0, y: -5 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{\n              color: \"#ef4444\",\n              fontSize: \"0.85rem\",\n              marginBottom: \"8px\",\n            }}\n          >\n            {error}\n          </motion.p>\n        )}\n\n        <motion.button\n          onClick={handleContinue}\n          disabled={!isValid || checking}\n          whileHover={isValid && !checking ? { scale: 1.03, filter: \"brightness(1.1)\" } : {}}\n          whileTap={isValid && !checking ? { scale: 0.97 } : {}}\n          style={{\n            marginTop: 20,\n            background: isValid ? \"#D4AF37\" : \"#7e6a2b\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: 10,\n            padding: \"12px 36px\",\n            fontWeight: 600,\n            fontSize: \"1rem\",\n            cursor: isValid && !checking ? \"pointer\" : \"not-allowed\",\n            width: \"100%\",\n            maxWidth: \"200px\",\n          }}\n        >\n          {checking ? \"Checking...\" : \"Continue\"}\n        </motion.button>\n\n        <p\n          onClick={goToLogin}\n          style={{\n            marginTop: \"28px\",\n            color: \"#888\",\n            fontSize: \"0.85rem\",\n            textDecoration: \"underline\",\n            cursor: \"pointer\",\n          }}\n        >\n          Already have an account? Log in\n        </p>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7074,"size_tokens":null},"src/pages/CheckEmailScreen.jsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport { Mail, RefreshCw, CheckCircle } from \"lucide-react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { preloadUserData } from \"../hooks/useDataPreloader\";\nimport { avatarIndexToKey, avatarKeyToIndex } from \"../utils/avatarUtils\";\n\nexport default function CheckEmailScreen() {\n  const navigate = useNavigate();\n  const { setOnboarded, setDisplayName, setHandle, setAvatar } = useUserStore();\n  const [checking, setChecking] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [loadingMessage, setLoadingMessage] = useState(\"\");\n  const [urlError, setUrlError] = useState(\"\");\n\n  useEffect(() => {\n    const getEmail = async () => {\n      const storedEmail = localStorage.getItem(\"iq_email\");\n      if (storedEmail) {\n        setEmail(storedEmail);\n        return;\n      }\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user?.email) {\n        setEmail(user.email);\n      }\n    };\n    getEmail();\n  }, []);\n\n  // Handle auth callback when user returns from confirmation link\n  useEffect(() => {\n    const handleAuthCallback = async () => {\n      const hash = window.location.hash;\n      const searchParams = new URLSearchParams(window.location.search);\n      \n      // Check for errors in URL (from failed confirmation link)\n      if (hash.includes('error=') || searchParams.has('error')) {\n        const hashParams = new URLSearchParams(hash.substring(1));\n        const errorCode = hashParams.get('error_code') || searchParams.get('error_code') || '';\n        const errorDesc = hashParams.get('error_description') || searchParams.get('error_description') || '';\n        \n        console.log(\"[CheckEmail] Auth error in URL:\", errorCode, errorDesc);\n        \n        if (errorCode === 'otp_expired') {\n          setUrlError(\"Your confirmation link has expired. Please click 'Resend confirmation email' to get a new link.\");\n        } else if (errorCode === 'access_denied') {\n          setUrlError(\"There was a problem with your confirmation link. Please request a new one.\");\n        } else {\n          setUrlError(\"Something went wrong. Please try requesting a new confirmation email.\");\n        }\n        \n        // Clear the URL\n        window.history.replaceState(null, '', window.location.pathname);\n        return;\n      }\n      \n      // Check if there are auth tokens in the URL (from successful email confirmation link)\n      if (hash.includes('access_token') || searchParams.has('code')) {\n        console.log(\"[CheckEmail] Auth callback detected in URL, processing...\");\n        \n        // Give Supabase a moment to process the tokens\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        // Check if user is now confirmed\n        const { data: { user } } = await supabase.auth.getUser();\n        if (user?.email_confirmed_at) {\n          console.log(\"[CheckEmail] User confirmed via callback, proceeding...\");\n          // Clear the hash/params from URL\n          window.history.replaceState(null, '', window.location.pathname);\n          await completeLoginAndPreload(user);\n        }\n      }\n    };\n    \n    handleAuthCallback();\n  }, []);\n\n  const createProfileIfMissing = async (user) => {\n    const storedName = localStorage.getItem(\"iq_name\") || \"Student\";\n    const storedHandle = localStorage.getItem(\"iq_handle\");\n    const storedAvatar = localStorage.getItem(\"iq_avatar\") || \"avatar_man_lantern\";\n    \n    if (!storedHandle) {\n      console.log(\"No handle in localStorage - redirecting to signup\");\n      localStorage.setItem(\"iq_onboarding_step\", \"signup\");\n      navigate(\"/signup\");\n      return null;\n    }\n    \n    const avatarIndex = avatarKeyToIndex(storedAvatar);\n    const progressState = useProgressStore.getState();\n    \n    console.log(\"[CheckEmail] Creating profile for confirmed user:\", user.id);\n    \n    const { data: newProfile, error } = await supabase\n      .from(\"profiles\")\n      .upsert({\n        user_id: user.id,\n        username: storedName,\n        handle: storedHandle.trim().toLowerCase(),\n        avatar: avatarIndex,\n        xp: progressState.xp || 0,\n        coins: progressState.coins || 0,\n        streak: progressState.streak || 0,\n        created_at: new Date().toISOString(),\n      }, { onConflict: 'user_id' })\n      .select()\n      .single();\n    \n    if (error) {\n      console.error(\"Failed to create profile:\", error);\n      return null;\n    }\n    \n    console.log(\"[CheckEmail] Profile created successfully\");\n    return {\n      ...newProfile,\n      avatar: storedAvatar,\n    };\n  };\n\n  const completeLoginAndPreload = async (user) => {\n    setLoadingMessage(\"Loading your data...\");\n    \n    let profile = null;\n    const { data: existingProfile } = await supabase\n      .from(\"profiles\")\n      .select(\"*\")\n      .eq(\"user_id\", user.id)\n      .maybeSingle();\n\n    if (existingProfile) {\n      profile = existingProfile;\n    } else {\n      console.log(\"[CheckEmail] No profile found - creating one now...\");\n      profile = await createProfileIfMissing(user);\n      if (!profile) return false;\n    }\n\n    const displayName = profile.username || \"Student\";\n    const handle = profile.handle || null;\n    const avatarKey = typeof profile.avatar === \"number\"\n      ? avatarIndexToKey(profile.avatar)\n      : profile.avatar || \"avatar_man_lantern\";\n    \n    if (!handle) {\n      console.error(\"[CheckEmail] Profile missing handle - redirecting to signup\");\n      localStorage.setItem(\"iq_onboarding_step\", \"signup\");\n      navigate(\"/signup\");\n      return false;\n    }\n    \n    setDisplayName(displayName);\n    setHandle(handle);\n    setAvatar(avatarKey);\n    \n    localStorage.removeItem(\"iq_onboarding_step\");\n    localStorage.removeItem(\"iq_email\");\n    localStorage.setItem(\"iq_profile_complete\", \"true\");\n    localStorage.setItem(\"iq_name\", displayName);\n    localStorage.setItem(\"iq_handle\", handle);\n    localStorage.setItem(\"iq_avatar\", avatarKey);\n    \n    useUserStore.setState({ \n      user: user, \n      userId: user.id,\n      username: displayName,\n      handle: handle,\n      avatar: avatarKey,\n      name: displayName,\n      profile: profile,\n      loading: false,\n      isHydrated: true,\n    });\n\n    setLoadingMessage(\"Loading your progress, friends, and quests...\");\n    \n    console.log(\"[CheckEmail] Starting parallel data preload...\");\n    const preloadResult = await preloadUserData(user.id);\n    console.log(`[CheckEmail] Data preload complete in ${preloadResult.elapsed}ms`);\n    \n    setOnboarded(true);\n    useUserStore.setState({ \n      profileReady: true,\n      hasOnboarded: true,\n    });\n    \n    navigate(\"/\");\n    return true;\n  };\n\n  useEffect(() => {\n    const checkEmailConfirmation = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (user?.email_confirmed_at) {\n        console.log(\"[CheckEmail] Email confirmed! Proceeding to preload...\");\n        await completeLoginAndPreload(user);\n      }\n    };\n\n    const interval = setInterval(checkEmailConfirmation, 3000);\n    checkEmailConfirmation();\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {\n      if (event === 'USER_UPDATED' && session?.user?.email_confirmed_at) {\n        checkEmailConfirmation();\n      }\n    });\n\n    return () => {\n      clearInterval(interval);\n      subscription?.unsubscribe();\n    };\n  }, [navigate, setOnboarded, setDisplayName, setHandle, setAvatar]);\n\n  const handleResendEmail = async () => {\n    setChecking(true);\n    setUrlError(\"\"); // Clear any previous error\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      const userEmail = user?.email || email;\n      if (userEmail) {\n        const appUrl = window.location.origin;\n        console.log(\"[CheckEmail] Resending confirmation to:\", userEmail);\n        await supabase.auth.resend({\n          type: 'signup',\n          email: userEmail,\n          options: {\n            emailRedirectTo: `${appUrl}/check-email`,\n          },\n        });\n        alert(\"New confirmation email sent! Please check your inbox and click the link.\");\n      } else {\n        alert(\"Could not find your email. Please try signing up again.\");\n      }\n    } catch (err) {\n      console.error(\"Resend error:\", err);\n      alert(\"Failed to resend email. Please try again.\");\n    }\n    setChecking(false);\n  };\n\n  const handleCheckNow = async () => {\n    setChecking(true);\n    \n    // First check if we have a current session\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (user?.email_confirmed_at) {\n      console.log(\"[CheckEmail] User confirmed, proceeding...\");\n      const success = await completeLoginAndPreload(user);\n      if (!success) {\n        setChecking(false);\n      }\n      return;\n    }\n    \n    // If no session or not confirmed, the confirmation link may have opened in another tab\n    // Redirect to login page where they can sign in with their confirmed account\n    if (!user) {\n      console.log(\"[CheckEmail] No session found - redirecting to login\");\n      alert(\"Great! Now please sign in with your email and password to continue.\");\n      localStorage.setItem(\"iq_onboarding_step\", \"login\");\n      navigate(\"/login\");\n      setChecking(false);\n      return;\n    }\n    \n    // User exists but not confirmed yet\n    alert(\"Email not confirmed yet. Please check your inbox and click the confirmation link.\");\n    setChecking(false);\n  };\n\n  if (loadingMessage) {\n    return (\n      <div\n        className=\"onboarding-screen\"\n        style={{\n          background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n          color: \"white\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          minHeight: \"100vh\",\n        }}\n      >\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            gap: \"20px\",\n          }}\n        >\n          <motion.div\n            animate={{ rotate: 360 }}\n            transition={{ repeat: Infinity, duration: 1, ease: \"linear\" }}\n            style={{\n              width: \"50px\",\n              height: \"50px\",\n              border: \"3px solid rgba(212, 175, 55, 0.3)\",\n              borderTopColor: \"#D4AF37\",\n              borderRadius: \"50%\",\n            }}\n          />\n          <p style={{ color: \"#D4AF37\", fontSize: \"1rem\", fontWeight: 500 }}>\n            {loadingMessage}\n          </p>\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: \"24px\",\n        paddingRight: \"24px\",\n        paddingTop: \"24px\",\n        justifyContent: \"center\",\n        minHeight: \"100vh\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        style={{\n          width: \"100%\",\n          maxWidth: \"360px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n        }}\n      >\n        <motion.div\n          initial={{ scale: 0 }}\n          animate={{ scale: 1 }}\n          transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\n          style={{\n            width: \"80px\",\n            height: \"80px\",\n            borderRadius: \"50%\",\n            background: \"rgba(212, 175, 55, 0.15)\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            marginBottom: \"24px\",\n          }}\n        >\n          <Mail size={40} color=\"#D4AF37\" />\n        </motion.div>\n\n        <h2 style={{ \n          color: \"#D4AF37\", \n          fontSize: \"1.5rem\", \n          marginBottom: \"12px\",\n          fontWeight: \"600\"\n        }}>\n          Check your email\n        </h2>\n        \n        <p style={{ \n          color: \"#e5e5e5\", \n          fontSize: \"1rem\", \n          marginBottom: \"8px\",\n          lineHeight: 1.5\n        }}>\n          We've sent a confirmation link to\n        </p>\n        \n        {email && (\n          <p style={{ \n            color: \"#D4AF37\", \n            fontSize: \"1rem\", \n            fontWeight: \"600\",\n            marginBottom: \"24px\"\n          }}>\n            {email}\n          </p>\n        )}\n\n        <p style={{ \n          color: \"#999\", \n          fontSize: \"0.9rem\", \n          marginBottom: urlError ? \"16px\" : \"32px\",\n          lineHeight: 1.5\n        }}>\n          Click the link in your email to confirm your account and start your learning journey.\n        </p>\n\n        {urlError && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{\n              background: \"rgba(239, 68, 68, 0.15)\",\n              border: \"1px solid rgba(239, 68, 68, 0.3)\",\n              borderRadius: \"10px\",\n              padding: \"12px 16px\",\n              marginBottom: \"24px\",\n              width: \"100%\",\n            }}\n          >\n            <p style={{ color: \"#ef4444\", fontSize: \"0.9rem\", lineHeight: 1.5 }}>\n              {urlError}\n            </p>\n          </motion.div>\n        )}\n\n        {!urlError && (\n          <motion.div\n            animate={{ \n              scale: [1, 1.05, 1],\n            }}\n            transition={{ \n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            style={{\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: \"8px\",\n              color: \"#888\",\n              marginBottom: \"32px\",\n            }}\n          >\n            <RefreshCw size={16} style={{ animation: \"spin 2s linear infinite\" }} />\n            <span style={{ fontSize: \"0.85rem\" }}>Waiting for confirmation...</span>\n          </motion.div>\n        )}\n\n        <motion.button\n          onClick={handleCheckNow}\n          disabled={checking}\n          whileHover={{ scale: 1.03, filter: \"brightness(1.1)\" }}\n          whileTap={{ scale: 0.97 }}\n          style={{\n            background: \"#D4AF37\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: 10,\n            padding: \"14px 32px\",\n            fontWeight: 600,\n            fontSize: \"1rem\",\n            cursor: checking ? \"not-allowed\" : \"pointer\",\n            width: \"100%\",\n            maxWidth: \"280px\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            gap: \"8px\",\n          }}\n        >\n          <CheckCircle size={18} />\n          {checking ? \"Checking...\" : \"I've confirmed my email\"}\n        </motion.button>\n\n        <motion.button\n          onClick={handleResendEmail}\n          disabled={checking}\n          whileHover={{ scale: 1.02 }}\n          whileTap={{ scale: 0.98 }}\n          style={{\n            marginTop: \"16px\",\n            background: \"transparent\",\n            color: \"#888\",\n            border: \"1px solid rgba(136, 136, 136, 0.3)\",\n            borderRadius: 10,\n            padding: \"12px 24px\",\n            fontWeight: 500,\n            fontSize: \"0.9rem\",\n            cursor: checking ? \"not-allowed\" : \"pointer\",\n          }}\n        >\n          Resend confirmation email\n        </motion.button>\n\n        <p style={{ \n          marginTop: \"32px\",\n          color: \"#666\", \n          fontSize: \"0.8rem\",\n          lineHeight: 1.5\n        }}>\n          Didn't receive the email? Check your spam folder or try resending.\n        </p>\n      </motion.div>\n\n      <style>{`\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      `}</style>\n    </div>\n  );\n}\n","path":null,"size_bytes":16155,"size_tokens":null},"src/pages/LoginPage.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Eye, EyeOff, Mail, Lock, X, Send, ArrowLeft } from \"lucide-react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { preloadUserData } from \"../hooks/useDataPreloader\";\nimport { avatarIndexToKey } from \"../utils/avatarUtils\";\nimport SittingMascot from \"../assets/mascots/mascot_sitting.webp\";\n\nexport default function LoginPage() {\n  const navigate = useNavigate();\n  const { setOnboarded, setDisplayName, setHandle, setAvatar } = useUserStore();\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState(\"\");\n  const [shake, setShake] = useState(false);\n  const [showForgotModal, setShowForgotModal] = useState(false);\n  const [forgotEmail, setForgotEmail] = useState(\"\");\n  const [forgotSending, setForgotSending] = useState(false);\n  const [forgotSuccess, setForgotSuccess] = useState(false);\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"login\");\n  }, []);\n\n  const isValidEmail = email.trim() && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email.trim());\n  const isValidPassword = password.length >= 6;\n  const isFormValid = isValidEmail && isValidPassword;\n\n  const triggerShake = () => {\n    setShake(true);\n    setTimeout(() => setShake(false), 500);\n  };\n\n  const handleLogin = async () => {\n    setErrorMsg(\"\");\n\n    if (!email.trim()) {\n      setErrorMsg(\"Please enter your email address.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidEmail) {\n      setErrorMsg(\"Please enter a valid email address.\");\n      triggerShake();\n      return;\n    }\n\n    if (!password) {\n      setErrorMsg(\"Please enter a password.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidPassword) {\n      setErrorMsg(\"Password must be at least 6 characters.\");\n      triggerShake();\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      // Sign out any existing anonymous session before logging in\n      // This prevents session conflicts with old hidden.local accounts\n      await supabase.auth.signOut();\n\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email: email.trim().toLowerCase(),\n        password,\n      });\n\n      if (error) {\n        if (error.message.includes(\"Email not confirmed\")) {\n          localStorage.setItem(\"iq_email\", email.trim().toLowerCase());\n          setLoading(false);\n          navigate(\"/check-email\");\n          return;\n        }\n        setErrorMsg(\"Invalid email or password\");\n        triggerShake();\n        setLoading(false);\n        return;\n      }\n\n      if (!data.user.email_confirmed_at) {\n        localStorage.setItem(\"iq_email\", email.trim().toLowerCase());\n        setLoading(false);\n        navigate(\"/check-email\");\n        return;\n      }\n\n      console.log(\"[LoginPage] Login successful, preloading data...\");\n\n      const preloadResult = await preloadUserData(data.user.id);\n\n      if (!preloadResult.success) {\n        console.log(\"[LoginPage] No profile found - redirecting to signup\");\n        await supabase.auth.signOut();\n        setErrorMsg(\"No account found. Please sign up first.\");\n        setLoading(false);\n        return;\n      }\n\n      const profile = preloadResult.profile;\n      const displayName = profile.username || \"Student\";\n      const handle = profile.handle || null;\n      const avatarKey = typeof profile.avatar === \"number\"\n        ? avatarIndexToKey(profile.avatar)\n        : profile.avatar || \"avatar_man_lantern\";\n\n      if (!handle) {\n        console.log(\"[LoginPage] Profile missing handle\");\n        setErrorMsg(\"Your profile is incomplete. Please contact support.\");\n        setLoading(false);\n        return;\n      }\n\n      setDisplayName(displayName);\n      setHandle(handle);\n      setAvatar(avatarKey);\n      setOnboarded(true);\n\n      localStorage.removeItem(\"iq_onboarding_step\");\n      localStorage.setItem(\"iq_profile_complete\", \"true\");\n      localStorage.setItem(\"iq_name\", displayName);\n      localStorage.setItem(\"iq_handle\", handle);\n      localStorage.setItem(\"iq_avatar\", avatarKey);\n\n      useUserStore.setState({\n        user: data.user,\n        userId: data.user.id,\n        username: displayName,\n        handle: handle,\n        avatar: avatarKey,\n        name: displayName,\n        profile: profile,\n        profileReady: true,\n        hasOnboarded: true,\n        loading: false,\n        isHydrated: true,\n      });\n\n      console.log(`[LoginPage] Data preloaded in ${preloadResult.elapsed}ms`);\n      setLoading(false);\n      navigate(\"/\");\n    } catch (err) {\n      console.error(\"Login error:\", err);\n      setErrorMsg(\"Something went wrong. Please try again.\");\n      triggerShake();\n      setLoading(false);\n    }\n  };\n\n  const handleForgotPassword = async () => {\n    if (!forgotEmail.trim()) return;\n\n    setForgotSending(true);\n    try {\n      const { error } = await supabase.auth.resetPasswordForEmail(\n        forgotEmail.trim().toLowerCase(),\n        { redirectTo: `${window.location.origin}/reset-password` }\n      );\n\n      if (error) {\n        console.error(\"Reset password error:\", error);\n      }\n\n      setForgotSuccess(true);\n    } catch (err) {\n      console.error(\"Forgot password error:\", err);\n    }\n    setForgotSending(false);\n  };\n\n  const shakeAnimation = {\n    shake: {\n      x: [0, -10, 10, -10, 10, -5, 5, 0],\n      transition: { duration: 0.5 },\n    },\n  };\n\n  return (\n    <div\n      style={{\n        background: \"linear-gradient(180deg, #0a0f1e 0%, #030614 100%)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        width: \"100%\",\n        minHeight: \"100vh\",\n        padding: \"20px\",\n      }}\n    >\n      <motion.button\n        onClick={() => navigate(\"/onboarding/auth-choice\")}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        style={{\n          position: \"absolute\",\n          top: 20,\n          left: 20,\n          background: \"rgba(255,255,255,0.1)\",\n          border: \"none\",\n          borderRadius: \"50%\",\n          width: 40,\n          height: 40,\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          cursor: \"pointer\",\n        }}\n      >\n        <ArrowLeft size={20} color=\"#fff\" />\n      </motion.button>\n\n      <motion.img\n        src={SittingMascot}\n        alt=\"Zayd\"\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.1, duration: 0.5 }}\n        style={{\n          width: \"100px\",\n          height: \"100px\",\n          objectFit: \"contain\",\n          marginBottom: \"-16px\",\n          zIndex: 10,\n          filter: \"drop-shadow(0 10px 20px rgba(0,0,0,0.4))\",\n        }}\n      />\n\n      <motion.div\n        initial={{ opacity: 0, y: 30 }}\n        animate={shake ? \"shake\" : { opacity: 1, y: 0 }}\n        variants={shakeAnimation}\n        transition={{ duration: 0.5 }}\n        style={{\n          background: \"linear-gradient(180deg, #111a2e 0%, #0a1220 100%)\",\n          border: \"1px solid rgba(255,255,255,0.08)\",\n          borderRadius: \"24px\",\n          padding: \"32px 24px\",\n          maxWidth: \"380px\",\n          width: \"100%\",\n          boxShadow: \"0 25px 80px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05)\",\n        }}\n      >\n        <div style={{ textAlign: \"center\", marginBottom: 24 }}>\n          <h1\n            style={{\n              fontSize: \"1.75rem\",\n              fontWeight: 700,\n              background: \"linear-gradient(90deg, #fff 0%, #ffd88a 50%, #ffb700 100%)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n              marginBottom: \"8px\",\n            }}\n          >\n            Welcome Back\n          </h1>\n          <p style={{ color: \"rgba(255,255,255,0.5)\", fontSize: \"0.9rem\" }}>\n            Sign in to continue your journey\n          </p>\n        </div>\n\n        <div style={{ marginBottom: \"16px\" }}>\n          <div style={{ position: \"relative\" }}>\n            <Mail\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{\n                position: \"absolute\",\n                left: \"14px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                pointerEvents: \"none\",\n              }}\n            />\n            <input\n              type=\"email\"\n              placeholder=\"Email address\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              onKeyDown={(e) => e.key === \"Enter\" && handleLogin()}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                borderRadius: \"12px\",\n                padding: \"14px 16px 14px 44px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n          </div>\n        </div>\n\n        <div style={{ marginBottom: \"12px\" }}>\n          <div style={{ position: \"relative\" }}>\n            <Lock\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{\n                position: \"absolute\",\n                left: \"14px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                pointerEvents: \"none\",\n              }}\n            />\n            <input\n              type={showPassword ? \"text\" : \"password\"}\n              placeholder=\"Password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              onKeyDown={(e) => e.key === \"Enter\" && handleLogin()}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                borderRadius: \"12px\",\n                padding: \"14px 44px 14px 44px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              style={{\n                position: \"absolute\",\n                right: \"12px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                background: \"transparent\",\n                border: \"none\",\n                cursor: \"pointer\",\n                padding: \"4px\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n              }}\n            >\n              {showPassword ? (\n                <EyeOff size={18} color=\"rgba(255,255,255,0.4)\" />\n              ) : (\n                <Eye size={18} color=\"rgba(255,255,255,0.4)\" />\n              )}\n            </button>\n          </div>\n        </div>\n\n        <button\n          onClick={() => {\n            setForgotEmail(email);\n            setShowForgotModal(true);\n          }}\n          style={{\n            background: \"transparent\",\n            border: \"none\",\n            color: \"rgba(212, 175, 55, 0.8)\",\n            fontSize: \"0.85rem\",\n            cursor: \"pointer\",\n            marginBottom: \"16px\",\n            padding: 0,\n          }}\n        >\n          Forgot password?\n        </button>\n\n        {errorMsg && (\n          <motion.p\n            initial={{ opacity: 0, y: -5 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{\n              color: \"#ef4444\",\n              fontSize: \"0.8rem\",\n              marginBottom: \"12px\",\n              textAlign: \"center\",\n            }}\n          >\n            {errorMsg}\n          </motion.p>\n        )}\n\n        <motion.button\n          whileTap={{ scale: 0.98 }}\n          onClick={handleLogin}\n          disabled={loading || !isFormValid}\n          style={{\n            width: \"100%\",\n            height: \"50px\",\n            background:\n              loading || !isFormValid\n                ? \"rgba(139, 92, 246, 0.3)\"\n                : \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            color: loading || !isFormValid ? \"rgba(255,255,255,0.5)\" : \"#fff\",\n            fontSize: \"1rem\",\n            fontWeight: 600,\n            cursor: loading || !isFormValid ? \"not-allowed\" : \"pointer\",\n            boxShadow:\n              loading || !isFormValid\n                ? \"none\"\n                : \"0 4px 20px rgba(139, 92, 246, 0.3)\",\n          }}\n        >\n          {loading ? (\n            <span style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", gap: \"8px\" }}>\n              <motion.span\n                animate={{ rotate: 360 }}\n                transition={{ repeat: Infinity, duration: 1, ease: \"linear\" }}\n                style={{ display: \"inline-block\", width: 18, height: 18, border: \"2px solid rgba(255,255,255,0.3)\", borderTopColor: \"#fff\", borderRadius: \"50%\" }}\n              />\n              Signing in...\n            </span>\n          ) : (\n            \"Sign In\"\n          )}\n        </motion.button>\n\n        <p\n          onClick={() => navigate(\"/signup\")}\n          style={{\n            textAlign: \"center\",\n            marginTop: \"20px\",\n            color: \"#888\",\n            fontSize: \"0.85rem\",\n            cursor: \"pointer\",\n          }}\n        >\n          Don't have an account?{\" \"}\n          <span style={{ color: \"#D4AF37\", textDecoration: \"underline\" }}>Sign up</span>\n        </p>\n      </motion.div>\n\n      <AnimatePresence>\n        {showForgotModal && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={() => setShowForgotModal(false)}\n            style={{\n              position: \"fixed\",\n              inset: 0,\n              background: \"rgba(0,0,0,0.7)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              zIndex: 100,\n              padding: 20,\n            }}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                background: \"linear-gradient(180deg, #111a2e 0%, #0a1220 100%)\",\n                borderRadius: \"20px\",\n                padding: \"28px 24px\",\n                maxWidth: \"340px\",\n                width: \"100%\",\n                border: \"1px solid rgba(255,255,255,0.08)\",\n              }}\n            >\n              <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: 16 }}>\n                <h3 style={{ color: \"#fff\", fontSize: \"1.1rem\", fontWeight: 600 }}>\n                  Reset Password\n                </h3>\n                <button\n                  onClick={() => setShowForgotModal(false)}\n                  style={{ background: \"transparent\", border: \"none\", cursor: \"pointer\", padding: 4 }}\n                >\n                  <X size={20} color=\"rgba(255,255,255,0.5)\" />\n                </button>\n              </div>\n\n              {!forgotSuccess ? (\n                <>\n                  <p style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.85rem\", marginBottom: 16 }}>\n                    Enter your email and we'll send you a reset link.\n                  </p>\n                  <input\n                    type=\"email\"\n                    placeholder=\"Email address\"\n                    value={forgotEmail}\n                    onChange={(e) => setForgotEmail(e.target.value)}\n                    style={{\n                      width: \"100%\",\n                      background: \"rgba(11, 30, 54, 0.8)\",\n                      border: \"1px solid rgba(255,255,255,0.1)\",\n                      borderRadius: \"10px\",\n                      padding: \"12px 14px\",\n                      color: \"#fff\",\n                      fontSize: \"0.9rem\",\n                      marginBottom: 16,\n                      outline: \"none\",\n                    }}\n                  />\n                  <button\n                    onClick={handleForgotPassword}\n                    disabled={forgotSending || !forgotEmail.trim()}\n                    style={{\n                      width: \"100%\",\n                      padding: \"12px\",\n                      background: forgotSending || !forgotEmail.trim() ? \"rgba(139, 92, 246, 0.3)\" : \"linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%)\",\n                      border: \"none\",\n                      borderRadius: \"10px\",\n                      color: \"#fff\",\n                      fontWeight: 600,\n                      cursor: forgotSending || !forgotEmail.trim() ? \"not-allowed\" : \"pointer\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      gap: 8,\n                    }}\n                  >\n                    <Send size={16} />\n                    {forgotSending ? \"Sending...\" : \"Send Reset Link\"}\n                  </button>\n                </>\n              ) : (\n                <div style={{ textAlign: \"center\" }}>\n                  <div style={{ fontSize: \"2.5rem\", marginBottom: 12 }}>üìß</div>\n                  <p style={{ color: \"#fff\", fontWeight: 500, marginBottom: 8 }}>\n                    Check your email!\n                  </p>\n                  <p style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.85rem\" }}>\n                    We've sent a password reset link to your email.\n                  </p>\n                </div>\n              )}\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","path":null,"size_bytes":18070,"size_tokens":null},"src/pages/SignUpPage.jsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport { Eye, EyeOff, Mail, Lock, User, AtSign, ArrowLeft, Check, X } from \"lucide-react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { avatarKeyToIndex } from \"../utils/avatarUtils\";\nimport { AVAILABLE_AVATARS } from \"../utils/avatarUtils\";\nimport { useOnboarding } from \"../hooks/useOnboarding\";\nimport assets from \"../assets/assets\";\nimport SittingMascot from \"../assets/mascots/mascot_sitting.webp\";\n\nexport default function SignUpPage() {\n  const navigate = useNavigate();\n  const { checkHandleAvailable } = useOnboarding();\n  const { setDisplayName, setHandle: setStoreHandle, setAvatar: setStoreAvatar } = useUserStore();\n\n  const [displayName, setDisplayNameLocal] = useState(\"\");\n  const [handle, setHandle] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [selectedAvatar, setSelectedAvatar] = useState(null);\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState(\"\");\n  const [shake, setShake] = useState(false);\n  const [handleStatus, setHandleStatus] = useState({ checking: false, available: null, error: null });\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"signup\");\n  }, []);\n\n  const sortedAvatars = useMemo(\n    () => AVAILABLE_AVATARS.map((key) => ({ key, src: assets.avatars[key] })).filter((a) => a.src),\n    []\n  );\n\n  useEffect(() => {\n    if (!handle.trim()) {\n      setHandleStatus({ checking: false, available: null, error: null });\n      return;\n    }\n\n    const timer = setTimeout(async () => {\n      setHandleStatus({ checking: true, available: null, error: null });\n      const result = await checkHandleAvailable(handle);\n      setHandleStatus({\n        checking: false,\n        available: result.available,\n        error: result.error,\n      });\n    }, 500);\n\n    return () => clearTimeout(timer);\n  }, [handle, checkHandleAvailable]);\n\n  const isValidEmail = email.trim() && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email.trim());\n  const isValidPassword = password.length >= 6;\n  const isValidName = displayName.trim().length >= 1;\n  const isValidHandle = handle.trim().length >= 2 && handleStatus.available === true;\n  const hasAvatar = selectedAvatar !== null;\n\n  const isFormValid = isValidName && isValidHandle && isValidEmail && isValidPassword && hasAvatar;\n\n  const triggerShake = () => {\n    setShake(true);\n    setTimeout(() => setShake(false), 500);\n  };\n\n  const handleSignUp = async () => {\n    setErrorMsg(\"\");\n\n    if (!isValidName) {\n      setErrorMsg(\"Please enter your display name.\");\n      triggerShake();\n      return;\n    }\n\n    if (!handle.trim()) {\n      setErrorMsg(\"Please enter a username.\");\n      triggerShake();\n      return;\n    }\n\n    if (handleStatus.available === false) {\n      setErrorMsg(handleStatus.error || \"Username is not available.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidEmail) {\n      setErrorMsg(\"Please enter a valid email address.\");\n      triggerShake();\n      return;\n    }\n\n    if (!isValidPassword) {\n      setErrorMsg(\"Password must be at least 6 characters.\");\n      triggerShake();\n      return;\n    }\n\n    if (!hasAvatar) {\n      setErrorMsg(\"Please select an avatar.\");\n      triggerShake();\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const trimmedHandle = handle.trim().toLowerCase().replace(/^@/, \"\");\n      const trimmedName = displayName.trim();\n      const avatarKey = selectedAvatar;\n\n      localStorage.setItem(\"iq_name\", trimmedName);\n      localStorage.setItem(\"iq_handle\", trimmedHandle);\n      localStorage.setItem(\"iq_avatar\", avatarKey);\n      localStorage.setItem(\"iq_email\", email.trim().toLowerCase());\n\n      // Sign out any existing anonymous session before creating new account\n      // This prevents the confirmation email from going to the wrong address\n      await supabase.auth.signOut();\n\n      // Get the app URL for email confirmation redirect\n      const appUrl = window.location.origin;\n      console.log(\"[SignUp] Using redirect URL:\", appUrl);\n\n      const { data, error } = await supabase.auth.signUp({\n        email: email.trim().toLowerCase(),\n        password,\n        options: {\n          emailRedirectTo: `${appUrl}/check-email`,\n        },\n      });\n\n      if (error) {\n        if (error.message.includes(\"already registered\")) {\n          setErrorMsg(\"This email is already registered. Try logging in.\");\n        } else {\n          setErrorMsg(error.message || \"Could not create account.\");\n        }\n        triggerShake();\n        setLoading(false);\n        return;\n      }\n\n      if (data?.user) {\n        const avatarIndex = avatarKeyToIndex(avatarKey);\n        const progressState = useProgressStore.getState();\n\n        const { error: profileError } = await supabase.from(\"profiles\").upsert(\n          {\n            user_id: data.user.id,\n            username: trimmedName,\n            handle: trimmedHandle,\n            avatar: avatarIndex,\n            xp: progressState.xp || 0,\n            coins: progressState.coins || 0,\n            streak: progressState.streak || 0,\n            created_at: new Date().toISOString(),\n          },\n          { onConflict: \"user_id\" }\n        );\n\n        if (profileError) {\n          console.error(\"Profile creation error:\", profileError);\n          if (profileError.code === \"23505\") {\n            setErrorMsg(\"Username already taken. Please choose another.\");\n            triggerShake();\n            setLoading(false);\n            return;\n          }\n        }\n\n        setDisplayName(trimmedName);\n        setStoreHandle(trimmedHandle);\n        setStoreAvatar(avatarKey);\n\n        useUserStore.setState({\n          user: data.user,\n          userId: data.user.id,\n          username: trimmedName,\n          handle: trimmedHandle,\n          avatar: avatarKey,\n          loading: false,\n          isHydrated: true,\n        });\n\n        setLoading(false);\n\n        if (data.user.email_confirmed_at) {\n          localStorage.removeItem(\"iq_onboarding_step\");\n          localStorage.setItem(\"iq_profile_complete\", \"true\");\n          useUserStore.setState({\n            profileReady: true,\n            hasOnboarded: true,\n          });\n          navigate(\"/\");\n        } else {\n          localStorage.setItem(\"iq_onboarding_step\", \"checkemail\");\n          navigate(\"/check-email\");\n        }\n      }\n    } catch (err) {\n      console.error(\"Signup error:\", err);\n      setErrorMsg(\"Something went wrong. Please try again.\");\n      triggerShake();\n      setLoading(false);\n    }\n  };\n\n  const shakeAnimation = {\n    shake: {\n      x: [0, -10, 10, -10, 10, -5, 5, 0],\n      transition: { duration: 0.5 },\n    },\n  };\n\n  return (\n    <div\n      style={{\n        background: \"linear-gradient(180deg, #0a0f1e 0%, #030614 100%)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        width: \"100%\",\n        minHeight: \"100vh\",\n        padding: \"20px\",\n        paddingTop: \"60px\",\n        paddingBottom: \"40px\",\n        overflowY: \"auto\",\n      }}\n    >\n      <motion.button\n        onClick={() => navigate(\"/onboarding/auth-choice\")}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        style={{\n          position: \"fixed\",\n          top: 20,\n          left: 20,\n          background: \"rgba(255,255,255,0.1)\",\n          border: \"none\",\n          borderRadius: \"50%\",\n          width: 40,\n          height: 40,\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          cursor: \"pointer\",\n          zIndex: 50,\n        }}\n      >\n        <ArrowLeft size={20} color=\"#fff\" />\n      </motion.button>\n\n      <motion.img\n        src={SittingMascot}\n        alt=\"Zayd\"\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.1, duration: 0.5 }}\n        style={{\n          width: \"80px\",\n          height: \"80px\",\n          objectFit: \"contain\",\n          marginBottom: \"-12px\",\n          zIndex: 10,\n          filter: \"drop-shadow(0 10px 20px rgba(0,0,0,0.4))\",\n        }}\n      />\n\n      <motion.div\n        initial={{ opacity: 0, y: 30 }}\n        animate={shake ? \"shake\" : { opacity: 1, y: 0 }}\n        variants={shakeAnimation}\n        transition={{ duration: 0.5 }}\n        style={{\n          background: \"linear-gradient(180deg, #111a2e 0%, #0a1220 100%)\",\n          border: \"1px solid rgba(255,255,255,0.08)\",\n          borderRadius: \"24px\",\n          padding: \"28px 20px\",\n          maxWidth: \"400px\",\n          width: \"100%\",\n          boxShadow: \"0 25px 80px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05)\",\n        }}\n      >\n        <div style={{ textAlign: \"center\", marginBottom: 20 }}>\n          <h1\n            style={{\n              fontSize: \"1.5rem\",\n              fontWeight: 700,\n              background: \"linear-gradient(90deg, #fff 0%, #ffd88a 50%, #ffb700 100%)\",\n              WebkitBackgroundClip: \"text\",\n              WebkitTextFillColor: \"transparent\",\n              marginBottom: \"6px\",\n            }}\n          >\n            Create Account\n          </h1>\n          <p style={{ color: \"rgba(255,255,255,0.5)\", fontSize: \"0.85rem\" }}>\n            Start your Islamic learning journey\n          </p>\n        </div>\n\n        <div style={{ marginBottom: \"14px\" }}>\n          <label style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.8rem\", marginBottom: 6, display: \"block\" }}>\n            Display Name\n          </label>\n          <div style={{ position: \"relative\" }}>\n            <User\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{ position: \"absolute\", left: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }}\n            />\n            <input\n              type=\"text\"\n              placeholder=\"Your name\"\n              value={displayName}\n              onChange={(e) => setDisplayNameLocal(e.target.value)}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                borderRadius: \"12px\",\n                padding: \"12px 14px 12px 42px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n          </div>\n        </div>\n\n        <div style={{ marginBottom: \"14px\" }}>\n          <label style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.8rem\", marginBottom: 6, display: \"block\" }}>\n            Username\n          </label>\n          <div style={{ position: \"relative\" }}>\n            <AtSign\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{ position: \"absolute\", left: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }}\n            />\n            <input\n              type=\"text\"\n              placeholder=\"yourhandle\"\n              value={handle}\n              onChange={(e) => setHandle(e.target.value.toLowerCase().replace(/[^a-z0-9_]/g, \"\"))}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: `1px solid ${handleStatus.available === false ? \"#ef4444\" : handleStatus.available === true ? \"#22c55e\" : \"rgba(255,255,255,0.1)\"}`,\n                borderRadius: \"12px\",\n                padding: \"12px 42px 12px 42px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n            {handleStatus.checking && (\n              <motion.span\n                animate={{ rotate: 360 }}\n                transition={{ repeat: Infinity, duration: 1, ease: \"linear\" }}\n                style={{\n                  position: \"absolute\",\n                  right: \"14px\",\n                  top: \"50%\",\n                  transform: \"translateY(-50%)\",\n                  width: 18,\n                  height: 18,\n                  border: \"2px solid rgba(255,255,255,0.2)\",\n                  borderTopColor: \"#D4AF37\",\n                  borderRadius: \"50%\",\n                  display: \"inline-block\",\n                }}\n              />\n            )}\n            {!handleStatus.checking && handleStatus.available === true && (\n              <Check size={18} color=\"#22c55e\" style={{ position: \"absolute\", right: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }} />\n            )}\n            {!handleStatus.checking && handleStatus.available === false && (\n              <X size={18} color=\"#ef4444\" style={{ position: \"absolute\", right: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }} />\n            )}\n          </div>\n          {handleStatus.error && (\n            <p style={{ color: \"#ef4444\", fontSize: \"0.75rem\", marginTop: 4 }}>{handleStatus.error}</p>\n          )}\n          <p style={{ color: \"rgba(255,255,255,0.4)\", fontSize: \"0.7rem\", marginTop: 4 }}>\n            Friends can find you with @{handle || \"yourhandle\"}\n          </p>\n        </div>\n\n        <div style={{ marginBottom: \"14px\" }}>\n          <label style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.8rem\", marginBottom: 6, display: \"block\" }}>\n            Email\n          </label>\n          <div style={{ position: \"relative\" }}>\n            <Mail\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{ position: \"absolute\", left: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }}\n            />\n            <input\n              type=\"email\"\n              placeholder=\"your@email.com\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                borderRadius: \"12px\",\n                padding: \"12px 14px 12px 42px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n          </div>\n        </div>\n\n        <div style={{ marginBottom: \"18px\" }}>\n          <label style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.8rem\", marginBottom: 6, display: \"block\" }}>\n            Password\n          </label>\n          <div style={{ position: \"relative\" }}>\n            <Lock\n              size={18}\n              color=\"rgba(255,255,255,0.4)\"\n              style={{ position: \"absolute\", left: \"14px\", top: \"50%\", transform: \"translateY(-50%)\" }}\n            />\n            <input\n              type={showPassword ? \"text\" : \"password\"}\n              placeholder=\"6+ characters\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              style={{\n                width: \"100%\",\n                background: \"rgba(11, 30, 54, 0.8)\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                borderRadius: \"12px\",\n                padding: \"12px 42px 12px 42px\",\n                color: \"#fff\",\n                fontSize: \"0.95rem\",\n                outline: \"none\",\n              }}\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              style={{\n                position: \"absolute\",\n                right: \"12px\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                background: \"transparent\",\n                border: \"none\",\n                cursor: \"pointer\",\n                padding: \"4px\",\n              }}\n            >\n              {showPassword ? <EyeOff size={18} color=\"rgba(255,255,255,0.4)\" /> : <Eye size={18} color=\"rgba(255,255,255,0.4)\" />}\n            </button>\n          </div>\n        </div>\n\n        <div style={{ marginBottom: \"20px\" }}>\n          <label style={{ color: \"rgba(255,255,255,0.6)\", fontSize: \"0.8rem\", marginBottom: 10, display: \"block\" }}>\n            Choose Your Avatar\n          </label>\n          <div\n            style={{\n              display: \"grid\",\n              gridTemplateColumns: \"repeat(6, 1fr)\",\n              gap: 8,\n              maxHeight: \"160px\",\n              overflowY: \"auto\",\n              padding: \"4px\",\n            }}\n          >\n            {sortedAvatars.map(({ key, src }) => (\n              <motion.button\n                key={key}\n                onClick={() => setSelectedAvatar(key)}\n                whileHover={{ scale: 1.1 }}\n                whileTap={{ scale: 0.95 }}\n                style={{\n                  width: \"100%\",\n                  aspectRatio: \"1\",\n                  borderRadius: \"50%\",\n                  padding: 2,\n                  border: selectedAvatar === key ? \"2px solid #D4AF37\" : \"2px solid transparent\",\n                  background: \"#0E1625\",\n                  overflow: \"hidden\",\n                  cursor: \"pointer\",\n                }}\n              >\n                <img src={src} alt={key} style={{ width: \"100%\", height: \"100%\", objectFit: \"contain\" }} />\n              </motion.button>\n            ))}\n          </div>\n        </div>\n\n        {errorMsg && (\n          <motion.p\n            initial={{ opacity: 0, y: -5 }}\n            animate={{ opacity: 1, y: 0 }}\n            style={{ color: \"#ef4444\", fontSize: \"0.8rem\", marginBottom: \"12px\", textAlign: \"center\" }}\n          >\n            {errorMsg}\n          </motion.p>\n        )}\n\n        <motion.button\n          whileTap={{ scale: 0.98 }}\n          onClick={handleSignUp}\n          disabled={loading || !isFormValid}\n          style={{\n            width: \"100%\",\n            height: \"50px\",\n            background: loading || !isFormValid ? \"rgba(212, 175, 55, 0.3)\" : \"linear-gradient(90deg, #D4AF37 0%, #c9a227 100%)\",\n            border: \"none\",\n            borderRadius: \"12px\",\n            color: loading || !isFormValid ? \"rgba(255,255,255,0.5)\" : \"#0A1A2F\",\n            fontSize: \"1rem\",\n            fontWeight: 700,\n            cursor: loading || !isFormValid ? \"not-allowed\" : \"pointer\",\n            boxShadow: loading || !isFormValid ? \"none\" : \"0 4px 20px rgba(212, 175, 55, 0.3)\",\n          }}\n        >\n          {loading ? (\n            <span style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", gap: \"8px\" }}>\n              <motion.span\n                animate={{ rotate: 360 }}\n                transition={{ repeat: Infinity, duration: 1, ease: \"linear\" }}\n                style={{ display: \"inline-block\", width: 18, height: 18, border: \"2px solid rgba(0,0,0,0.2)\", borderTopColor: \"#0A1A2F\", borderRadius: \"50%\" }}\n              />\n              Creating account...\n            </span>\n          ) : (\n            \"Create Account\"\n          )}\n        </motion.button>\n\n        <p\n          onClick={() => navigate(\"/login\")}\n          style={{ textAlign: \"center\", marginTop: \"16px\", color: \"#888\", fontSize: \"0.85rem\", cursor: \"pointer\" }}\n        >\n          Already have an account? <span style={{ color: \"#D4AF37\", textDecoration: \"underline\" }}>Log in</span>\n        </p>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":19301,"size_tokens":null},"src/hooks/useOnboarding.js":{"content":"import { useCallback } from \"react\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { avatarKeyToIndex } from \"../utils/avatarUtils\";\nimport { useProgressStore } from \"../store/progressStore\";\n\nconst ONBOARDING_STEPS = {\n  BISMILLAH: \"bismillah\",\n  SALAAM: \"salaam\",\n  AUTH_CHOICE: \"authchoice\",\n  LOGIN: \"login\",\n  SIGNUP: \"signup\",\n  CHECK_EMAIL: \"checkemail\",\n};\n\nconst STEP_ROUTES = {\n  [ONBOARDING_STEPS.BISMILLAH]: \"/onboarding/bismillah\",\n  [ONBOARDING_STEPS.SALAAM]: \"/onboarding/salaam\",\n  [ONBOARDING_STEPS.AUTH_CHOICE]: \"/onboarding/auth-choice\",\n  [ONBOARDING_STEPS.LOGIN]: \"/login\",\n  [ONBOARDING_STEPS.SIGNUP]: \"/signup\",\n  [ONBOARDING_STEPS.CHECK_EMAIL]: \"/check-email\",\n};\n\nexport function useOnboarding() {\n  const saveStep = useCallback((step) => {\n    localStorage.setItem(\"iq_onboarding_step\", step);\n  }, []);\n\n  const getStep = useCallback(() => {\n    return localStorage.getItem(\"iq_onboarding_step\") || ONBOARDING_STEPS.BISMILLAH;\n  }, []);\n\n  const getStepRoute = useCallback((step) => {\n    return STEP_ROUTES[step] || STEP_ROUTES[ONBOARDING_STEPS.BISMILLAH];\n  }, []);\n\n  const clearStep = useCallback(() => {\n    localStorage.removeItem(\"iq_onboarding_step\");\n  }, []);\n\n  const saveUserData = useCallback((data) => {\n    if (data.name) localStorage.setItem(\"iq_name\", data.name);\n    if (data.handle) localStorage.setItem(\"iq_handle\", data.handle);\n    if (data.avatar) localStorage.setItem(\"iq_avatar\", data.avatar);\n    if (data.email) localStorage.setItem(\"iq_email\", data.email);\n  }, []);\n\n  const getUserData = useCallback(() => {\n    return {\n      name: localStorage.getItem(\"iq_name\") || \"\",\n      handle: localStorage.getItem(\"iq_handle\") || \"\",\n      avatar: localStorage.getItem(\"iq_avatar\") || \"avatar_man_lantern\",\n      email: localStorage.getItem(\"iq_email\") || \"\",\n    };\n  }, []);\n\n  const clearUserData = useCallback(() => {\n    localStorage.removeItem(\"iq_name\");\n    localStorage.removeItem(\"iq_handle\");\n    localStorage.removeItem(\"iq_avatar\");\n    localStorage.removeItem(\"iq_email\");\n  }, []);\n\n  const checkHandleAvailable = useCallback(async (handle, currentUserId = null) => {\n    const trimmed = handle.trim().toLowerCase().replace(/^@/, \"\");\n    \n    if (!trimmed || trimmed.length < 2) {\n      return { available: false, error: \"Handle must be at least 2 characters\" };\n    }\n\n    if (!/^[a-z0-9_]+$/.test(trimmed)) {\n      return { available: false, error: \"Only letters, numbers, and underscores allowed\" };\n    }\n\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"handle, user_id\")\n        .eq(\"handle\", trimmed);\n\n      if (error) {\n        console.warn(\"Handle check error:\", error);\n        return { available: true, error: null };\n      }\n\n      if (data && data.length > 0) {\n        const otherUser = data.find(d => d.user_id !== currentUserId);\n        if (otherUser) {\n          return { available: false, error: \"Handle already taken\" };\n        }\n      }\n\n      return { available: true, error: null };\n    } catch (e) {\n      console.warn(\"Handle check failed:\", e);\n      return { available: true, error: null };\n    }\n  }, []);\n\n  const createProfile = useCallback(async (userId, data) => {\n    const { name, handle, avatar } = data;\n    const avatarIndex = avatarKeyToIndex(avatar);\n    const progressState = useProgressStore.getState();\n\n    const { error } = await supabase\n      .from(\"profiles\")\n      .upsert({\n        user_id: userId,\n        username: name,\n        handle: handle.trim().toLowerCase().replace(/^@/, \"\"),\n        avatar: avatarIndex,\n        xp: progressState.xp || 0,\n        coins: progressState.coins || 0,\n        streak: progressState.streak || 0,\n        created_at: new Date().toISOString(),\n      }, { onConflict: \"user_id\" });\n\n    if (error) {\n      console.error(\"Profile creation error:\", error);\n      return { success: false, error: error.message };\n    }\n\n    return { success: true };\n  }, []);\n\n  const completeOnboarding = useCallback(() => {\n    clearStep();\n    localStorage.setItem(\"iq_profile_complete\", \"true\");\n    \n    useUserStore.setState({\n      hasOnboarded: true,\n      profileReady: true,\n      loading: false,\n      isHydrated: true,\n    });\n  }, [clearStep]);\n\n  return {\n    STEPS: ONBOARDING_STEPS,\n    saveStep,\n    getStep,\n    getStepRoute,\n    clearStep,\n    saveUserData,\n    getUserData,\n    clearUserData,\n    checkHandleAvailable,\n    createProfile,\n    completeOnboarding,\n  };\n}\n\nexport { ONBOARDING_STEPS };\n","path":null,"size_bytes":4566,"size_tokens":null},"src/onboarding/AuthChoiceScreen.jsx":{"content":"import React, { useEffect } from \"react\";\nimport { useNavigate } from \"../hooks/useNavigate\";\nimport { motion } from \"framer-motion\";\nimport zayd from \"../assets/mascots/mascot_onboarding.webp\";\n\nexport default function AuthChoiceScreen() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    localStorage.setItem(\"iq_onboarding_step\", \"authchoice\");\n  }, []);\n\n  return (\n    <div\n      className=\"onboarding-screen\"\n      style={{\n        background: \"linear-gradient(180deg, #0A1A2F 0%, #060D18 100%)\",\n        color: \"white\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        textAlign: \"center\",\n        paddingLeft: 24,\n        paddingRight: 24,\n        paddingTop: 24,\n        minHeight: \"100vh\",\n      }}\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        style={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"center\",\n          width: \"100%\",\n          maxWidth: \"360px\",\n        }}\n      >\n        <motion.img\n          src={zayd}\n          alt=\"Zayd mascot\"\n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.2, duration: 0.5 }}\n          style={{\n            width: 140,\n            height: \"auto\",\n            objectFit: \"contain\",\n            marginBottom: 24,\n            filter: \"drop-shadow(0 10px 20px rgba(0,0,0,0.4))\",\n          }}\n        />\n\n        <h2\n          style={{\n            fontFamily: \"Amiri, serif\",\n            color: \"#D4AF37\",\n            fontSize: \"1.5rem\",\n            marginBottom: 8,\n          }}\n        >\n          Ready to begin?\n        </h2>\n        <p style={{ color: \"#e5e5e5\", fontSize: \"0.95rem\", marginBottom: 32 }}>\n          Create an account or sign in to continue your journey of sacred knowledge.\n        </p>\n\n        <motion.button\n          onClick={() => navigate(\"/signup\")}\n          whileHover={{ scale: 1.03, filter: \"brightness(1.1)\" }}\n          whileTap={{ scale: 0.97 }}\n          style={{\n            width: \"100%\",\n            background: \"linear-gradient(90deg, #D4AF37 0%, #c9a227 100%)\",\n            color: \"#0A1A2F\",\n            border: \"none\",\n            borderRadius: 12,\n            padding: \"16px 24px\",\n            fontWeight: 700,\n            fontSize: \"1.1rem\",\n            cursor: \"pointer\",\n            marginBottom: 16,\n            boxShadow: \"0 4px 20px rgba(212, 175, 55, 0.3)\",\n          }}\n        >\n          Create Account\n        </motion.button>\n\n        <motion.button\n          onClick={() => navigate(\"/login\")}\n          whileHover={{ scale: 1.03 }}\n          whileTap={{ scale: 0.97 }}\n          style={{\n            width: \"100%\",\n            background: \"transparent\",\n            color: \"#D4AF37\",\n            border: \"2px solid rgba(212, 175, 55, 0.5)\",\n            borderRadius: 12,\n            padding: \"14px 24px\",\n            fontWeight: 600,\n            fontSize: \"1rem\",\n            cursor: \"pointer\",\n          }}\n        >\n          I already have an account\n        </motion.button>\n\n        <p\n          style={{\n            marginTop: 32,\n            color: \"#666\",\n            fontSize: \"0.75rem\",\n            lineHeight: 1.5,\n          }}\n        >\n          By continuing, you agree to our Terms of Service and Privacy Policy\n        </p>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3494,"size_tokens":null},"src/hooks/useDataPreloader.js":{"content":"import { useCallback } from \"react\";\nimport { useUserStore } from \"../store/useUserStore\";\nimport { useProgressStore } from \"../store/progressStore\";\nimport { useDailyQuestStore } from \"../store/dailyQuestStore\";\nimport { useFriendsStore } from \"../store/friendsStore\";\nimport { useFriendChallengesStore } from \"../store/friendChallengesStore\";\nimport { useEventsStore } from \"../store/eventsStore\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { avatarIndexToKey } from \"../utils/avatarUtils\";\n\nexport function useDataPreloader() {\n  const preloadAllData = useCallback(async (userId) => {\n    if (!userId) {\n      console.error(\"[DataPreloader] No userId provided\");\n      return { success: false, error: \"No user ID\" };\n    }\n\n    console.log(\"[DataPreloader] Starting parallel data load for:\", userId);\n    const startTime = Date.now();\n\n    try {\n      const results = await Promise.all([\n        loadProfile(userId),\n        loadProgress(userId),\n        loadDailyQuest(userId),\n        loadFriends(),\n        loadFriendChallenges(),\n        loadStreakShield(),\n      ]);\n\n      const elapsed = Date.now() - startTime;\n      console.log(`[DataPreloader] All data loaded in ${elapsed}ms`);\n\n      const [profileResult, progressResult] = results;\n\n      if (!profileResult.success) {\n        return { success: false, error: \"Failed to load profile\" };\n      }\n\n      return {\n        success: true,\n        profile: profileResult.profile,\n        elapsed,\n      };\n    } catch (error) {\n      console.error(\"[DataPreloader] Error:\", error);\n      return { success: false, error: error.message };\n    }\n  }, []);\n\n  return { preloadAllData };\n}\n\nasync function loadProfile(userId) {\n  try {\n    const { data: profile, error } = await supabase\n      .from(\"profiles\")\n      .select(\"*\")\n      .eq(\"user_id\", userId)\n      .maybeSingle();\n\n    if (error) {\n      console.error(\"[DataPreloader] Profile load error:\", error);\n      return { success: false, error: error.message };\n    }\n\n    if (!profile) {\n      return { success: false, error: \"No profile found\" };\n    }\n\n    const avatarKey = typeof profile.avatar === \"number\"\n      ? avatarIndexToKey(profile.avatar)\n      : profile.avatar || \"avatar_man_lantern\";\n\n    useUserStore.setState({\n      profile,\n      username: profile.username || \"\",\n      handle: profile.handle || \"\",\n      avatar: avatarKey,\n      name: profile.username || \"\",\n      profileReady: true,\n    });\n\n    localStorage.setItem(\"iq_name\", profile.username || \"\");\n    localStorage.setItem(\"iq_handle\", profile.handle || \"\");\n    localStorage.setItem(\"iq_avatar\", avatarKey);\n\n    return { success: true, profile };\n  } catch (e) {\n    console.error(\"[DataPreloader] Profile error:\", e);\n    return { success: false, error: e.message };\n  }\n}\n\nasync function loadProgress(userId) {\n  try {\n    await useProgressStore.getState().loadFromSupabase();\n    return { success: true };\n  } catch (e) {\n    console.warn(\"[DataPreloader] Progress load warning:\", e);\n    return { success: true };\n  }\n}\n\nasync function loadDailyQuest(userId) {\n  try {\n    await useDailyQuestStore.getState().loadDailyQuestFromCloud(userId);\n    return { success: true };\n  } catch (e) {\n    console.warn(\"[DataPreloader] Daily quest load warning:\", e);\n    return { success: true };\n  }\n}\n\nasync function loadFriends() {\n  try {\n    await useFriendsStore.getState().initialize();\n    return { success: true };\n  } catch (e) {\n    console.warn(\"[DataPreloader] Friends load warning:\", e);\n    return { success: true };\n  }\n}\n\nasync function loadFriendChallenges() {\n  try {\n    await useFriendChallengesStore.getState().initialize();\n    return { success: true };\n  } catch (e) {\n    console.warn(\"[DataPreloader] Friend challenges load warning:\", e);\n    return { success: true };\n  }\n}\n\nasync function loadStreakShield() {\n  try {\n    await useProgressStore.getState().loadStreakShieldFromCloud();\n    return { success: true };\n  } catch (e) {\n    console.warn(\"[DataPreloader] Streak shield load warning:\", e);\n    return { success: true };\n  }\n}\n\nexport async function preloadUserData(userId) {\n  if (!userId) {\n    console.error(\"[preloadUserData] No userId provided\");\n    return { success: false, error: \"No user ID\" };\n  }\n\n  console.log(\"[preloadUserData] Starting parallel data load...\");\n  const startTime = Date.now();\n\n  try {\n    const results = await Promise.all([\n      loadProfile(userId),\n      loadProgress(userId),\n      loadDailyQuest(userId),\n      loadFriends(),\n      loadFriendChallenges(),\n      loadStreakShield(),\n    ]);\n\n    const elapsed = Date.now() - startTime;\n    console.log(`[preloadUserData] Complete in ${elapsed}ms`);\n\n    const [profileResult] = results;\n    return {\n      success: profileResult.success,\n      profile: profileResult.profile,\n      elapsed,\n    };\n  } catch (error) {\n    console.error(\"[preloadUserData] Error:\", error);\n    return { success: false, error: error.message };\n  }\n}\n","path":null,"size_bytes":4956,"size_tokens":null}},"version":2}
REPLIT AGENT ‚Äî PLEASE UPDATE THE FOLLOWING FILES TO FULLY IMPLEMENT THE CLOUD-BACKED FRIENDS + LEADERBOARD SYSTEM.
FOLLOW EVERY STEP EXACTLY.
DO NOT DELETE ANY OTHER APP FEATURES.

‚úÖ 1. Update src/store/friendsStore.js

Goal:
Create a complete cloud-backed friends engine with:

loadFriends()

loadRequests()

loadLeaderboard()

sendRequest()

acceptRequest()

declineRequest()

removeFriend()

searchUsers()

Rules:

Friends table = friends

profiles table = profiles

friend requests = rows where status = 'pending'

accepted friends = rows where status = 'accepted'

Always fetch avatar, username, handle, xp

Use user_id everywhere (no ‚Äúid‚Äù column here)

Avoid duplicates

Protect mutual friendships

Highlight current user later in Friends.jsx

Implement clean code with async functions + error handling.

‚úÖ 2. Update src/pages/Friends.jsx

Replace all leaderboard & friends logic with cloud-backed logic:

FRIENDS TAB

Load friends list from friendsStore

Show avatar, username/handle, streak, xp

Sort alphabetically

REQUESTS TAB

Show incoming + outgoing pending requests

Buttons: Accept / Decline / Cancel

SEARCH TAB

Search by handle first

Fallback to username

Disable sending duplicates

Prevent sending to self

LEADERBOARD TAB

Two sub-tabs:

‚≠ê GLOBAL

Fetch from:

select user_id, username, handle, avatar, xp 
from profiles 
order by xp desc 
limit 100;


Highlight current user visually

Format name as: username || handle, and then @handle

Include avatars

No pagination

‚≠ê FRIENDS

Same style as global

Use cached friend profiles

Sort descending by xp

UI RULES

Keep the original UI theme, layout, spacing, gradients

Restore all leaderboard cards from the ZIP version

Do NOT remove animations or hover effects

Replace old mock logic inside those cards with real data

(You already know the old Friends.jsx was over 1000 lines ‚Äî restore only the UI parts, NOT the old logic.)

‚úÖ 3. Update src/pages/FriendProfile.jsx
Add / fix:

Load full profile from Supabase

Fields:

username

handle

avatar

xp

streak

coins

shield_count

Add ‚ÄúRemove Friend‚Äù button (cloud-backed)

Keep original UI theme + layout

‚úÖ 4. Update src/hooks or stores using user data
Fix everywhere that expects cloud data:

Replace any id references with user_id

Replace uses of nickname / display_name with username or handle

Keep fallback: username || handle

‚úÖ 5. GLOBAL CLEANUP

Remove all leftover mock friend data

Remove legacy leaderboard arrays

Remove all deprecated functions that touched:

local friend storage

local leaderboard

temporary mock users

Do NOT remove anything outside Friends, Leaderboard, FriendProfile, or the friends store.

üöÄ 6. Final Deliverable

When finished, provide:

Summary of all files modified

Summary of UI restored

Summary of cloud features now active

Any syntax issues fixed

üî• END OF PROMPT ‚Äî BEGIN EXECUTION